var Gv=s=>{throw TypeError(s)};var gf=(s,e,t)=>e.has(s)||Gv("Cannot "+t);var V=(s,e,t)=>(gf(s,e,"read from private field"),t?t.call(s):e.get(s)),Ce=(s,e,t)=>e.has(s)?Gv("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),ge=(s,e,t,n)=>(gf(s,e,"write to private field"),n?n.call(s,t):e.set(s,t),t),Ke=(s,e,t)=>(gf(s,e,"access private method"),t);var Kc=(s,e,t,n)=>({set _(i){ge(s,e,i,t)},get _(){return V(s,e,n)}});function DI(s,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in s)){const r=Object.getOwnPropertyDescriptor(n,i);r&&Object.defineProperty(s,i,r.get?r:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function XT(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var yf={exports:{}},Oa={},vf={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kv;function OI(){if(Kv)return Ve;Kv=1;var s=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),r=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function m(D){return D===null||typeof D!="object"?null:(D=p&&D[p]||D["@@iterator"],typeof D=="function"?D:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,S={};function x(D,j,ie){this.props=D,this.context=j,this.refs=S,this.updater=ie||v}x.prototype.isReactComponent={},x.prototype.setState=function(D,j){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,j,"setState")},x.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function b(){}b.prototype=x.prototype;function w(D,j,ie){this.props=D,this.context=j,this.refs=S,this.updater=ie||v}var L=w.prototype=new b;L.constructor=w,y(L,x.prototype),L.isPureReactComponent=!0;var I=Array.isArray,k=Object.prototype.hasOwnProperty,M={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function C(D,j,ie){var ce,de={},fe=null,ve=null;if(j!=null)for(ce in j.ref!==void 0&&(ve=j.ref),j.key!==void 0&&(fe=""+j.key),j)k.call(j,ce)&&!P.hasOwnProperty(ce)&&(de[ce]=j[ce]);var Ie=arguments.length-2;if(Ie===1)de.children=ie;else if(1<Ie){for(var Me=Array(Ie),Qe=0;Qe<Ie;Qe++)Me[Qe]=arguments[Qe+2];de.children=Me}if(D&&D.defaultProps)for(ce in Ie=D.defaultProps,Ie)de[ce]===void 0&&(de[ce]=Ie[ce]);return{$$typeof:s,type:D,key:fe,ref:ve,props:de,_owner:M.current}}function U(D,j){return{$$typeof:s,type:D.type,key:j,ref:D.ref,props:D.props,_owner:D._owner}}function O(D){return typeof D=="object"&&D!==null&&D.$$typeof===s}function W(D){var j={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(ie){return j[ie]})}var ne=/\/+/g;function oe(D,j){return typeof D=="object"&&D!==null&&D.key!=null?W(""+D.key):j.toString(36)}function se(D,j,ie,ce,de){var fe=typeof D;(fe==="undefined"||fe==="boolean")&&(D=null);var ve=!1;if(D===null)ve=!0;else switch(fe){case"string":case"number":ve=!0;break;case"object":switch(D.$$typeof){case s:case e:ve=!0}}if(ve)return ve=D,de=de(ve),D=ce===""?"."+oe(ve,0):ce,I(de)?(ie="",D!=null&&(ie=D.replace(ne,"$&/")+"/"),se(de,j,ie,"",function(Qe){return Qe})):de!=null&&(O(de)&&(de=U(de,ie+(!de.key||ve&&ve.key===de.key?"":(""+de.key).replace(ne,"$&/")+"/")+D)),j.push(de)),1;if(ve=0,ce=ce===""?".":ce+":",I(D))for(var Ie=0;Ie<D.length;Ie++){fe=D[Ie];var Me=ce+oe(fe,Ie);ve+=se(fe,j,ie,Me,de)}else if(Me=m(D),typeof Me=="function")for(D=Me.call(D),Ie=0;!(fe=D.next()).done;)fe=fe.value,Me=ce+oe(fe,Ie++),ve+=se(fe,j,ie,Me,de);else if(fe==="object")throw j=String(D),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.");return ve}function re(D,j,ie){if(D==null)return D;var ce=[],de=0;return se(D,ce,"","",function(fe){return j.call(ie,fe,de++)}),ce}function X(D){if(D._status===-1){var j=D._result;j=j(),j.then(function(ie){(D._status===0||D._status===-1)&&(D._status=1,D._result=ie)},function(ie){(D._status===0||D._status===-1)&&(D._status=2,D._result=ie)}),D._status===-1&&(D._status=0,D._result=j)}if(D._status===1)return D._result.default;throw D._result}var Z={current:null},F={transition:null},ee={ReactCurrentDispatcher:Z,ReactCurrentBatchConfig:F,ReactCurrentOwner:M};function J(){throw Error("act(...) is not supported in production builds of React.")}return Ve.Children={map:re,forEach:function(D,j,ie){re(D,function(){j.apply(this,arguments)},ie)},count:function(D){var j=0;return re(D,function(){j++}),j},toArray:function(D){return re(D,function(j){return j})||[]},only:function(D){if(!O(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},Ve.Component=x,Ve.Fragment=t,Ve.Profiler=i,Ve.PureComponent=w,Ve.StrictMode=n,Ve.Suspense=u,Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ee,Ve.act=J,Ve.cloneElement=function(D,j,ie){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var ce=y({},D.props),de=D.key,fe=D.ref,ve=D._owner;if(j!=null){if(j.ref!==void 0&&(fe=j.ref,ve=M.current),j.key!==void 0&&(de=""+j.key),D.type&&D.type.defaultProps)var Ie=D.type.defaultProps;for(Me in j)k.call(j,Me)&&!P.hasOwnProperty(Me)&&(ce[Me]=j[Me]===void 0&&Ie!==void 0?Ie[Me]:j[Me])}var Me=arguments.length-2;if(Me===1)ce.children=ie;else if(1<Me){Ie=Array(Me);for(var Qe=0;Qe<Me;Qe++)Ie[Qe]=arguments[Qe+2];ce.children=Ie}return{$$typeof:s,type:D.type,key:de,ref:fe,props:ce,_owner:ve}},Ve.createContext=function(D){return D={$$typeof:o,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:r,_context:D},D.Consumer=D},Ve.createElement=C,Ve.createFactory=function(D){var j=C.bind(null,D);return j.type=D,j},Ve.createRef=function(){return{current:null}},Ve.forwardRef=function(D){return{$$typeof:l,render:D}},Ve.isValidElement=O,Ve.lazy=function(D){return{$$typeof:h,_payload:{_status:-1,_result:D},_init:X}},Ve.memo=function(D,j){return{$$typeof:d,type:D,compare:j===void 0?null:j}},Ve.startTransition=function(D){var j=F.transition;F.transition={};try{D()}finally{F.transition=j}},Ve.unstable_act=J,Ve.useCallback=function(D,j){return Z.current.useCallback(D,j)},Ve.useContext=function(D){return Z.current.useContext(D)},Ve.useDebugValue=function(){},Ve.useDeferredValue=function(D){return Z.current.useDeferredValue(D)},Ve.useEffect=function(D,j){return Z.current.useEffect(D,j)},Ve.useId=function(){return Z.current.useId()},Ve.useImperativeHandle=function(D,j,ie){return Z.current.useImperativeHandle(D,j,ie)},Ve.useInsertionEffect=function(D,j){return Z.current.useInsertionEffect(D,j)},Ve.useLayoutEffect=function(D,j){return Z.current.useLayoutEffect(D,j)},Ve.useMemo=function(D,j){return Z.current.useMemo(D,j)},Ve.useReducer=function(D,j,ie){return Z.current.useReducer(D,j,ie)},Ve.useRef=function(D){return Z.current.useRef(D)},Ve.useState=function(D){return Z.current.useState(D)},Ve.useSyncExternalStore=function(D,j,ie){return Z.current.useSyncExternalStore(D,j,ie)},Ve.useTransition=function(){return Z.current.useTransition()},Ve.version="18.3.1",Ve}var Hv;function Nm(){return Hv||(Hv=1,vf.exports=OI()),vf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zv;function NI(){if(zv)return Oa;zv=1;var s=Nm(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,d){var h,p={},m=null,v=null;d!==void 0&&(m=""+d),u.key!==void 0&&(m=""+u.key),u.ref!==void 0&&(v=u.ref);for(h in u)n.call(u,h)&&!r.hasOwnProperty(h)&&(p[h]=u[h]);if(l&&l.defaultProps)for(h in u=l.defaultProps,u)p[h]===void 0&&(p[h]=u[h]);return{$$typeof:e,type:l,key:m,ref:v,props:p,_owner:i.current}}return Oa.Fragment=t,Oa.jsx=o,Oa.jsxs=o,Oa}var Wv;function MI(){return Wv||(Wv=1,yf.exports=NI()),yf.exports}var A=MI(),B=Nm();const FI=XT(B),BI=DI({__proto__:null,default:FI},[B]);var Hc={},xf={exports:{}},mn={},Sf={exports:{}},Ef={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qv;function UI(){return qv||(qv=1,(function(s){function e(F,ee){var J=F.length;F.push(ee);e:for(;0<J;){var D=J-1>>>1,j=F[D];if(0<i(j,ee))F[D]=ee,F[J]=j,J=D;else break e}}function t(F){return F.length===0?null:F[0]}function n(F){if(F.length===0)return null;var ee=F[0],J=F.pop();if(J!==ee){F[0]=J;e:for(var D=0,j=F.length,ie=j>>>1;D<ie;){var ce=2*(D+1)-1,de=F[ce],fe=ce+1,ve=F[fe];if(0>i(de,J))fe<j&&0>i(ve,de)?(F[D]=ve,F[fe]=J,D=fe):(F[D]=de,F[ce]=J,D=ce);else if(fe<j&&0>i(ve,J))F[D]=ve,F[fe]=J,D=fe;else break e}}return ee}function i(F,ee){var J=F.sortIndex-ee.sortIndex;return J!==0?J:F.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;s.unstable_now=function(){return r.now()}}else{var o=Date,l=o.now();s.unstable_now=function(){return o.now()-l}}var u=[],d=[],h=1,p=null,m=3,v=!1,y=!1,S=!1,x=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function L(F){for(var ee=t(d);ee!==null;){if(ee.callback===null)n(d);else if(ee.startTime<=F)n(d),ee.sortIndex=ee.expirationTime,e(u,ee);else break;ee=t(d)}}function I(F){if(S=!1,L(F),!y)if(t(u)!==null)y=!0,X(k);else{var ee=t(d);ee!==null&&Z(I,ee.startTime-F)}}function k(F,ee){y=!1,S&&(S=!1,b(C),C=-1),v=!0;var J=m;try{for(L(ee),p=t(u);p!==null&&(!(p.expirationTime>ee)||F&&!W());){var D=p.callback;if(typeof D=="function"){p.callback=null,m=p.priorityLevel;var j=D(p.expirationTime<=ee);ee=s.unstable_now(),typeof j=="function"?p.callback=j:p===t(u)&&n(u),L(ee)}else n(u);p=t(u)}if(p!==null)var ie=!0;else{var ce=t(d);ce!==null&&Z(I,ce.startTime-ee),ie=!1}return ie}finally{p=null,m=J,v=!1}}var M=!1,P=null,C=-1,U=5,O=-1;function W(){return!(s.unstable_now()-O<U)}function ne(){if(P!==null){var F=s.unstable_now();O=F;var ee=!0;try{ee=P(!0,F)}finally{ee?oe():(M=!1,P=null)}}else M=!1}var oe;if(typeof w=="function")oe=function(){w(ne)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,re=se.port2;se.port1.onmessage=ne,oe=function(){re.postMessage(null)}}else oe=function(){x(ne,0)};function X(F){P=F,M||(M=!0,oe())}function Z(F,ee){C=x(function(){F(s.unstable_now())},ee)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(F){F.callback=null},s.unstable_continueExecution=function(){y||v||(y=!0,X(k))},s.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<F?Math.floor(1e3/F):5},s.unstable_getCurrentPriorityLevel=function(){return m},s.unstable_getFirstCallbackNode=function(){return t(u)},s.unstable_next=function(F){switch(m){case 1:case 2:case 3:var ee=3;break;default:ee=m}var J=m;m=ee;try{return F()}finally{m=J}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(F,ee){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var J=m;m=F;try{return ee()}finally{m=J}},s.unstable_scheduleCallback=function(F,ee,J){var D=s.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?D+J:D):J=D,F){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=J+j,F={id:h++,callback:ee,priorityLevel:F,startTime:J,expirationTime:j,sortIndex:-1},J>D?(F.sortIndex=J,e(d,F),t(u)===null&&F===t(d)&&(S?(b(C),C=-1):S=!0,Z(I,J-D))):(F.sortIndex=j,e(u,F),y||v||(y=!0,X(k))),F},s.unstable_shouldYield=W,s.unstable_wrapCallback=function(F){var ee=m;return function(){var J=m;m=ee;try{return F.apply(this,arguments)}finally{m=J}}}})(Ef)),Ef}var Yv;function $I(){return Yv||(Yv=1,Sf.exports=UI()),Sf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qv;function jI(){if(Qv)return mn;Qv=1;var s=Nm(),e=$I();function t(a){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+a,f=1;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function r(a,c){o(a,c),o(a+"Capture",c)}function o(a,c){for(i[a]=c,a=0;a<c.length;a++)n.add(c[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function m(a){return u.call(p,a)?!0:u.call(h,a)?!1:d.test(a)?p[a]=!0:(h[a]=!0,!1)}function v(a,c,f,g){if(f!==null&&f.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return g?!1:f!==null?!f.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function y(a,c,f,g){if(c===null||typeof c>"u"||v(a,c,f,g))return!0;if(g)return!1;if(f!==null)switch(f.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function S(a,c,f,g,E,T,_){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=g,this.attributeNamespace=E,this.mustUseProperty=f,this.propertyName=a,this.type=c,this.sanitizeURL=T,this.removeEmptyString=_}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){x[a]=new S(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var c=a[0];x[c]=new S(c,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){x[a]=new S(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){x[a]=new S(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){x[a]=new S(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){x[a]=new S(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){x[a]=new S(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){x[a]=new S(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){x[a]=new S(a,5,!1,a.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function w(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var c=a.replace(b,w);x[c]=new S(c,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var c=a.replace(b,w);x[c]=new S(c,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var c=a.replace(b,w);x[c]=new S(c,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){x[a]=new S(a,1,!1,a.toLowerCase(),null,!1,!1)}),x.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){x[a]=new S(a,1,!1,a.toLowerCase(),null,!0,!0)});function L(a,c,f,g){var E=x.hasOwnProperty(c)?x[c]:null;(E!==null?E.type!==0:g||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(y(c,f,E,g)&&(f=null),g||E===null?m(c)&&(f===null?a.removeAttribute(c):a.setAttribute(c,""+f)):E.mustUseProperty?a[E.propertyName]=f===null?E.type===3?!1:"":f:(c=E.attributeName,g=E.attributeNamespace,f===null?a.removeAttribute(c):(E=E.type,f=E===3||E===4&&f===!0?"":""+f,g?a.setAttributeNS(g,c,f):a.setAttribute(c,f))))}var I=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),M=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),W=Symbol.for("react.context"),ne=Symbol.for("react.forward_ref"),oe=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),Z=Symbol.for("react.offscreen"),F=Symbol.iterator;function ee(a){return a===null||typeof a!="object"?null:(a=F&&a[F]||a["@@iterator"],typeof a=="function"?a:null)}var J=Object.assign,D;function j(a){if(D===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);D=c&&c[1]||""}return`
`+D+a}var ie=!1;function ce(a,c){if(!a||ie)return"";ie=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Y){var g=Y}Reflect.construct(a,[],c)}else{try{c.call()}catch(Y){g=Y}a.call(c.prototype)}else{try{throw Error()}catch(Y){g=Y}a()}}catch(Y){if(Y&&g&&typeof Y.stack=="string"){for(var E=Y.stack.split(`
`),T=g.stack.split(`
`),_=E.length-1,N=T.length-1;1<=_&&0<=N&&E[_]!==T[N];)N--;for(;1<=_&&0<=N;_--,N--)if(E[_]!==T[N]){if(_!==1||N!==1)do if(_--,N--,0>N||E[_]!==T[N]){var $=`
`+E[_].replace(" at new "," at ");return a.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",a.displayName)),$}while(1<=_&&0<=N);break}}}finally{ie=!1,Error.prepareStackTrace=f}return(a=a?a.displayName||a.name:"")?j(a):""}function de(a){switch(a.tag){case 5:return j(a.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return a=ce(a.type,!1),a;case 11:return a=ce(a.type.render,!1),a;case 1:return a=ce(a.type,!0),a;default:return""}}function fe(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case P:return"Fragment";case M:return"Portal";case U:return"Profiler";case C:return"StrictMode";case oe:return"Suspense";case se:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case W:return(a.displayName||"Context")+".Consumer";case O:return(a._context.displayName||"Context")+".Provider";case ne:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case re:return c=a.displayName||null,c!==null?c:fe(a.type)||"Memo";case X:c=a._payload,a=a._init;try{return fe(a(c))}catch{}}return null}function ve(a){var c=a.type;switch(a.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=c.render,a=a.displayName||a.name||"",c.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fe(c);case 8:return c===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function Ie(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Me(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Qe(a){var c=Me(a)?"checked":"value",f=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),g=""+a[c];if(!a.hasOwnProperty(c)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var E=f.get,T=f.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return E.call(this)},set:function(_){g=""+_,T.call(this,_)}}),Object.defineProperty(a,c,{enumerable:f.enumerable}),{getValue:function(){return g},setValue:function(_){g=""+_},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function Lt(a){a._valueTracker||(a._valueTracker=Qe(a))}function xe(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var f=c.getValue(),g="";return a&&(g=Me(a)?a.checked?"true":"false":a.value),a=g,a!==f?(c.setValue(a),!0):!1}function We(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Bt(a,c){var f=c.checked;return J({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??a._wrapperState.initialChecked})}function Ki(a,c){var f=c.defaultValue==null?"":c.defaultValue,g=c.checked!=null?c.checked:c.defaultChecked;f=Ie(c.value!=null?c.value:f),a._wrapperState={initialChecked:g,initialValue:f,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function Ue(a,c){c=c.checked,c!=null&&L(a,"checked",c,!1)}function At(a,c){Ue(a,c);var f=Ie(c.value),g=c.type;if(f!=null)g==="number"?(f===0&&a.value===""||a.value!=f)&&(a.value=""+f):a.value!==""+f&&(a.value=""+f);else if(g==="submit"||g==="reset"){a.removeAttribute("value");return}c.hasOwnProperty("value")?qn(a,c.type,f):c.hasOwnProperty("defaultValue")&&qn(a,c.type,Ie(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(a.defaultChecked=!!c.defaultChecked)}function sn(a,c,f){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var g=c.type;if(!(g!=="submit"&&g!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+a._wrapperState.initialValue,f||c===a.value||(a.value=c),a.defaultValue=c}f=a.name,f!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,f!==""&&(a.name=f)}function qn(a,c,f){(c!=="number"||We(a.ownerDocument)!==a)&&(f==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+f&&(a.defaultValue=""+f))}var Ut=Array.isArray;function bn(a,c,f,g){if(a=a.options,c){c={};for(var E=0;E<f.length;E++)c["$"+f[E]]=!0;for(f=0;f<a.length;f++)E=c.hasOwnProperty("$"+a[f].value),a[f].selected!==E&&(a[f].selected=E),E&&g&&(a[f].defaultSelected=!0)}else{for(f=""+Ie(f),c=null,E=0;E<a.length;E++){if(a[E].value===f){a[E].selected=!0,g&&(a[E].defaultSelected=!0);return}c!==null||a[E].disabled||(c=a[E])}c!==null&&(c.selected=!0)}}function Yn(a,c){if(c.dangerouslySetInnerHTML!=null)throw Error(t(91));return J({},c,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function Yo(a,c){var f=c.value;if(f==null){if(f=c.children,c=c.defaultValue,f!=null){if(c!=null)throw Error(t(92));if(Ut(f)){if(1<f.length)throw Error(t(93));f=f[0]}c=f}c==null&&(c=""),f=c}a._wrapperState={initialValue:Ie(f)}}function Hi(a,c){var f=Ie(c.value),g=Ie(c.defaultValue);f!=null&&(f=""+f,f!==a.value&&(a.value=f),c.defaultValue==null&&a.defaultValue!==f&&(a.defaultValue=f)),g!=null&&(a.defaultValue=""+g)}function Qo(a){var c=a.textContent;c===a._wrapperState.initialValue&&c!==""&&c!==null&&(a.value=c)}function Zs(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Dr(a,c){return a==null||a==="http://www.w3.org/1999/xhtml"?Zs(c):a==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Or,Xo=(function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,f,g,E){MSApp.execUnsafeLocalFunction(function(){return a(c,f,g,E)})}:a})(function(a,c){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=c;else{for(Or=Or||document.createElement("div"),Or.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Or.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}});function ei(a,c){if(c){var f=a.firstChild;if(f&&f===a.lastChild&&f.nodeType===3){f.nodeValue=c;return}}a.textContent=c}var Qn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},FR=["Webkit","ms","Moz","O"];Object.keys(Qn).forEach(function(a){FR.forEach(function(c){c=c+a.charAt(0).toUpperCase()+a.substring(1),Qn[c]=Qn[a]})});function i0(a,c,f){return c==null||typeof c=="boolean"||c===""?"":f||typeof c!="number"||c===0||Qn.hasOwnProperty(a)&&Qn[a]?(""+c).trim():c+"px"}function r0(a,c){a=a.style;for(var f in c)if(c.hasOwnProperty(f)){var g=f.indexOf("--")===0,E=i0(f,c[f],g);f==="float"&&(f="cssFloat"),g?a.setProperty(f,E):a[f]=E}}var BR=J({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ld(a,c){if(c){if(BR[a]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(t(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(t(61))}if(c.style!=null&&typeof c.style!="object")throw Error(t(62))}}function Id(a,c){if(a.indexOf("-")===-1)return typeof c.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _d=null;function kd(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Cd=null,Nr=null,Mr=null;function o0(a){if(a=xa(a)){if(typeof Cd!="function")throw Error(t(280));var c=a.stateNode;c&&(c=rc(c),Cd(a.stateNode,a.type,c))}}function a0(a){Nr?Mr?Mr.push(a):Mr=[a]:Nr=a}function l0(){if(Nr){var a=Nr,c=Mr;if(Mr=Nr=null,o0(a),c)for(a=0;a<c.length;a++)o0(c[a])}}function c0(a,c){return a(c)}function u0(){}var Pd=!1;function d0(a,c,f){if(Pd)return a(c,f);Pd=!0;try{return c0(a,c,f)}finally{Pd=!1,(Nr!==null||Mr!==null)&&(u0(),l0())}}function Jo(a,c){var f=a.stateNode;if(f===null)return null;var g=rc(f);if(g===null)return null;f=g[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(a=a.type,g=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!g;break e;default:a=!1}if(a)return null;if(f&&typeof f!="function")throw Error(t(231,c,typeof f));return f}var Dd=!1;if(l)try{var Zo={};Object.defineProperty(Zo,"passive",{get:function(){Dd=!0}}),window.addEventListener("test",Zo,Zo),window.removeEventListener("test",Zo,Zo)}catch{Dd=!1}function UR(a,c,f,g,E,T,_,N,$){var Y=Array.prototype.slice.call(arguments,3);try{c.apply(f,Y)}catch(le){this.onError(le)}}var ea=!1,Fl=null,Bl=!1,Od=null,$R={onError:function(a){ea=!0,Fl=a}};function jR(a,c,f,g,E,T,_,N,$){ea=!1,Fl=null,UR.apply($R,arguments)}function VR(a,c,f,g,E,T,_,N,$){if(jR.apply(this,arguments),ea){if(ea){var Y=Fl;ea=!1,Fl=null}else throw Error(t(198));Bl||(Bl=!0,Od=Y)}}function zi(a){var c=a,f=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(f=c.return),a=c.return;while(a)}return c.tag===3?f:null}function h0(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function f0(a){if(zi(a)!==a)throw Error(t(188))}function GR(a){var c=a.alternate;if(!c){if(c=zi(a),c===null)throw Error(t(188));return c!==a?null:a}for(var f=a,g=c;;){var E=f.return;if(E===null)break;var T=E.alternate;if(T===null){if(g=E.return,g!==null){f=g;continue}break}if(E.child===T.child){for(T=E.child;T;){if(T===f)return f0(E),a;if(T===g)return f0(E),c;T=T.sibling}throw Error(t(188))}if(f.return!==g.return)f=E,g=T;else{for(var _=!1,N=E.child;N;){if(N===f){_=!0,f=E,g=T;break}if(N===g){_=!0,g=E,f=T;break}N=N.sibling}if(!_){for(N=T.child;N;){if(N===f){_=!0,f=T,g=E;break}if(N===g){_=!0,g=T,f=E;break}N=N.sibling}if(!_)throw Error(t(189))}}if(f.alternate!==g)throw Error(t(190))}if(f.tag!==3)throw Error(t(188));return f.stateNode.current===f?a:c}function p0(a){return a=GR(a),a!==null?m0(a):null}function m0(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var c=m0(a);if(c!==null)return c;a=a.sibling}return null}var g0=e.unstable_scheduleCallback,y0=e.unstable_cancelCallback,KR=e.unstable_shouldYield,HR=e.unstable_requestPaint,xt=e.unstable_now,zR=e.unstable_getCurrentPriorityLevel,Nd=e.unstable_ImmediatePriority,v0=e.unstable_UserBlockingPriority,Ul=e.unstable_NormalPriority,WR=e.unstable_LowPriority,x0=e.unstable_IdlePriority,$l=null,ds=null;function qR(a){if(ds&&typeof ds.onCommitFiberRoot=="function")try{ds.onCommitFiberRoot($l,a,void 0,(a.current.flags&128)===128)}catch{}}var Xn=Math.clz32?Math.clz32:XR,YR=Math.log,QR=Math.LN2;function XR(a){return a>>>=0,a===0?32:31-(YR(a)/QR|0)|0}var jl=64,Vl=4194304;function ta(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Gl(a,c){var f=a.pendingLanes;if(f===0)return 0;var g=0,E=a.suspendedLanes,T=a.pingedLanes,_=f&268435455;if(_!==0){var N=_&~E;N!==0?g=ta(N):(T&=_,T!==0&&(g=ta(T)))}else _=f&~E,_!==0?g=ta(_):T!==0&&(g=ta(T));if(g===0)return 0;if(c!==0&&c!==g&&(c&E)===0&&(E=g&-g,T=c&-c,E>=T||E===16&&(T&4194240)!==0))return c;if((g&4)!==0&&(g|=f&16),c=a.entangledLanes,c!==0)for(a=a.entanglements,c&=g;0<c;)f=31-Xn(c),E=1<<f,g|=a[f],c&=~E;return g}function JR(a,c){switch(a){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZR(a,c){for(var f=a.suspendedLanes,g=a.pingedLanes,E=a.expirationTimes,T=a.pendingLanes;0<T;){var _=31-Xn(T),N=1<<_,$=E[_];$===-1?((N&f)===0||(N&g)!==0)&&(E[_]=JR(N,c)):$<=c&&(a.expiredLanes|=N),T&=~N}}function Md(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function S0(){var a=jl;return jl<<=1,(jl&4194240)===0&&(jl=64),a}function Fd(a){for(var c=[],f=0;31>f;f++)c.push(a);return c}function na(a,c,f){a.pendingLanes|=c,c!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,c=31-Xn(c),a[c]=f}function eL(a,c){var f=a.pendingLanes&~c;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=c,a.mutableReadLanes&=c,a.entangledLanes&=c,c=a.entanglements;var g=a.eventTimes;for(a=a.expirationTimes;0<f;){var E=31-Xn(f),T=1<<E;c[E]=0,g[E]=-1,a[E]=-1,f&=~T}}function Bd(a,c){var f=a.entangledLanes|=c;for(a=a.entanglements;f;){var g=31-Xn(f),E=1<<g;E&c|a[g]&c&&(a[g]|=c),f&=~E}}var Je=0;function E0(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var T0,Ud,b0,A0,w0,$d=!1,Kl=[],ti=null,ni=null,si=null,sa=new Map,ia=new Map,ii=[],tL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function R0(a,c){switch(a){case"focusin":case"focusout":ti=null;break;case"dragenter":case"dragleave":ni=null;break;case"mouseover":case"mouseout":si=null;break;case"pointerover":case"pointerout":sa.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":ia.delete(c.pointerId)}}function ra(a,c,f,g,E,T){return a===null||a.nativeEvent!==T?(a={blockedOn:c,domEventName:f,eventSystemFlags:g,nativeEvent:T,targetContainers:[E]},c!==null&&(c=xa(c),c!==null&&Ud(c)),a):(a.eventSystemFlags|=g,c=a.targetContainers,E!==null&&c.indexOf(E)===-1&&c.push(E),a)}function nL(a,c,f,g,E){switch(c){case"focusin":return ti=ra(ti,a,c,f,g,E),!0;case"dragenter":return ni=ra(ni,a,c,f,g,E),!0;case"mouseover":return si=ra(si,a,c,f,g,E),!0;case"pointerover":var T=E.pointerId;return sa.set(T,ra(sa.get(T)||null,a,c,f,g,E)),!0;case"gotpointercapture":return T=E.pointerId,ia.set(T,ra(ia.get(T)||null,a,c,f,g,E)),!0}return!1}function L0(a){var c=Wi(a.target);if(c!==null){var f=zi(c);if(f!==null){if(c=f.tag,c===13){if(c=h0(f),c!==null){a.blockedOn=c,w0(a.priority,function(){b0(f)});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){a.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Hl(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var f=Vd(a.domEventName,a.eventSystemFlags,c[0],a.nativeEvent);if(f===null){f=a.nativeEvent;var g=new f.constructor(f.type,f);_d=g,f.target.dispatchEvent(g),_d=null}else return c=xa(f),c!==null&&Ud(c),a.blockedOn=f,!1;c.shift()}return!0}function I0(a,c,f){Hl(a)&&f.delete(c)}function sL(){$d=!1,ti!==null&&Hl(ti)&&(ti=null),ni!==null&&Hl(ni)&&(ni=null),si!==null&&Hl(si)&&(si=null),sa.forEach(I0),ia.forEach(I0)}function oa(a,c){a.blockedOn===c&&(a.blockedOn=null,$d||($d=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,sL)))}function aa(a){function c(E){return oa(E,a)}if(0<Kl.length){oa(Kl[0],a);for(var f=1;f<Kl.length;f++){var g=Kl[f];g.blockedOn===a&&(g.blockedOn=null)}}for(ti!==null&&oa(ti,a),ni!==null&&oa(ni,a),si!==null&&oa(si,a),sa.forEach(c),ia.forEach(c),f=0;f<ii.length;f++)g=ii[f],g.blockedOn===a&&(g.blockedOn=null);for(;0<ii.length&&(f=ii[0],f.blockedOn===null);)L0(f),f.blockedOn===null&&ii.shift()}var Fr=I.ReactCurrentBatchConfig,zl=!0;function iL(a,c,f,g){var E=Je,T=Fr.transition;Fr.transition=null;try{Je=1,jd(a,c,f,g)}finally{Je=E,Fr.transition=T}}function rL(a,c,f,g){var E=Je,T=Fr.transition;Fr.transition=null;try{Je=4,jd(a,c,f,g)}finally{Je=E,Fr.transition=T}}function jd(a,c,f,g){if(zl){var E=Vd(a,c,f,g);if(E===null)rh(a,c,g,Wl,f),R0(a,g);else if(nL(E,a,c,f,g))g.stopPropagation();else if(R0(a,g),c&4&&-1<tL.indexOf(a)){for(;E!==null;){var T=xa(E);if(T!==null&&T0(T),T=Vd(a,c,f,g),T===null&&rh(a,c,g,Wl,f),T===E)break;E=T}E!==null&&g.stopPropagation()}else rh(a,c,g,null,f)}}var Wl=null;function Vd(a,c,f,g){if(Wl=null,a=kd(g),a=Wi(a),a!==null)if(c=zi(a),c===null)a=null;else if(f=c.tag,f===13){if(a=h0(c),a!==null)return a;a=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null);return Wl=a,null}function _0(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zR()){case Nd:return 1;case v0:return 4;case Ul:case WR:return 16;case x0:return 536870912;default:return 16}default:return 16}}var ri=null,Gd=null,ql=null;function k0(){if(ql)return ql;var a,c=Gd,f=c.length,g,E="value"in ri?ri.value:ri.textContent,T=E.length;for(a=0;a<f&&c[a]===E[a];a++);var _=f-a;for(g=1;g<=_&&c[f-g]===E[T-g];g++);return ql=E.slice(a,1<g?1-g:void 0)}function Yl(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Ql(){return!0}function C0(){return!1}function An(a){function c(f,g,E,T,_){this._reactName=f,this._targetInst=E,this.type=g,this.nativeEvent=T,this.target=_,this.currentTarget=null;for(var N in a)a.hasOwnProperty(N)&&(f=a[N],this[N]=f?f(T):T[N]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Ql:C0,this.isPropagationStopped=C0,this}return J(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Ql)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Ql)},persist:function(){},isPersistent:Ql}),c}var Br={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kd=An(Br),la=J({},Br,{view:0,detail:0}),oL=An(la),Hd,zd,ca,Xl=J({},la,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qd,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ca&&(ca&&a.type==="mousemove"?(Hd=a.screenX-ca.screenX,zd=a.screenY-ca.screenY):zd=Hd=0,ca=a),Hd)},movementY:function(a){return"movementY"in a?a.movementY:zd}}),P0=An(Xl),aL=J({},Xl,{dataTransfer:0}),lL=An(aL),cL=J({},la,{relatedTarget:0}),Wd=An(cL),uL=J({},Br,{animationName:0,elapsedTime:0,pseudoElement:0}),dL=An(uL),hL=J({},Br,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),fL=An(hL),pL=J({},Br,{data:0}),D0=An(pL),mL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vL(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=yL[a])?!!c[a]:!1}function qd(){return vL}var xL=J({},la,{key:function(a){if(a.key){var c=mL[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=Yl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?gL[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qd,charCode:function(a){return a.type==="keypress"?Yl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Yl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),SL=An(xL),EL=J({},Xl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),O0=An(EL),TL=J({},la,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qd}),bL=An(TL),AL=J({},Br,{propertyName:0,elapsedTime:0,pseudoElement:0}),wL=An(AL),RL=J({},Xl,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),LL=An(RL),IL=[9,13,27,32],Yd=l&&"CompositionEvent"in window,ua=null;l&&"documentMode"in document&&(ua=document.documentMode);var _L=l&&"TextEvent"in window&&!ua,N0=l&&(!Yd||ua&&8<ua&&11>=ua),M0=" ",F0=!1;function B0(a,c){switch(a){case"keyup":return IL.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function U0(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ur=!1;function kL(a,c){switch(a){case"compositionend":return U0(c);case"keypress":return c.which!==32?null:(F0=!0,M0);case"textInput":return a=c.data,a===M0&&F0?null:a;default:return null}}function CL(a,c){if(Ur)return a==="compositionend"||!Yd&&B0(a,c)?(a=k0(),ql=Gd=ri=null,Ur=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return N0&&c.locale!=="ko"?null:c.data;default:return null}}var PL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $0(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!PL[a.type]:c==="textarea"}function j0(a,c,f,g){a0(g),c=nc(c,"onChange"),0<c.length&&(f=new Kd("onChange","change",null,f,g),a.push({event:f,listeners:c}))}var da=null,ha=null;function DL(a){ry(a,0)}function Jl(a){var c=Kr(a);if(xe(c))return a}function OL(a,c){if(a==="change")return c}var V0=!1;if(l){var Qd;if(l){var Xd="oninput"in document;if(!Xd){var G0=document.createElement("div");G0.setAttribute("oninput","return;"),Xd=typeof G0.oninput=="function"}Qd=Xd}else Qd=!1;V0=Qd&&(!document.documentMode||9<document.documentMode)}function K0(){da&&(da.detachEvent("onpropertychange",H0),ha=da=null)}function H0(a){if(a.propertyName==="value"&&Jl(ha)){var c=[];j0(c,ha,a,kd(a)),d0(DL,c)}}function NL(a,c,f){a==="focusin"?(K0(),da=c,ha=f,da.attachEvent("onpropertychange",H0)):a==="focusout"&&K0()}function ML(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Jl(ha)}function FL(a,c){if(a==="click")return Jl(c)}function BL(a,c){if(a==="input"||a==="change")return Jl(c)}function UL(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var Jn=typeof Object.is=="function"?Object.is:UL;function fa(a,c){if(Jn(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var f=Object.keys(a),g=Object.keys(c);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var E=f[g];if(!u.call(c,E)||!Jn(a[E],c[E]))return!1}return!0}function z0(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function W0(a,c){var f=z0(a);a=0;for(var g;f;){if(f.nodeType===3){if(g=a+f.textContent.length,a<=c&&g>=c)return{node:f,offset:c-a};a=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=z0(f)}}function q0(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?q0(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function Y0(){for(var a=window,c=We();c instanceof a.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)a=c.contentWindow;else break;c=We(a.document)}return c}function Jd(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function $L(a){var c=Y0(),f=a.focusedElem,g=a.selectionRange;if(c!==f&&f&&f.ownerDocument&&q0(f.ownerDocument.documentElement,f)){if(g!==null&&Jd(f)){if(c=g.start,a=g.end,a===void 0&&(a=c),"selectionStart"in f)f.selectionStart=c,f.selectionEnd=Math.min(a,f.value.length);else if(a=(c=f.ownerDocument||document)&&c.defaultView||window,a.getSelection){a=a.getSelection();var E=f.textContent.length,T=Math.min(g.start,E);g=g.end===void 0?T:Math.min(g.end,E),!a.extend&&T>g&&(E=g,g=T,T=E),E=W0(f,T);var _=W0(f,g);E&&_&&(a.rangeCount!==1||a.anchorNode!==E.node||a.anchorOffset!==E.offset||a.focusNode!==_.node||a.focusOffset!==_.offset)&&(c=c.createRange(),c.setStart(E.node,E.offset),a.removeAllRanges(),T>g?(a.addRange(c),a.extend(_.node,_.offset)):(c.setEnd(_.node,_.offset),a.addRange(c)))}}for(c=[],a=f;a=a.parentNode;)a.nodeType===1&&c.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<c.length;f++)a=c[f],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var jL=l&&"documentMode"in document&&11>=document.documentMode,$r=null,Zd=null,pa=null,eh=!1;function Q0(a,c,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;eh||$r==null||$r!==We(g)||(g=$r,"selectionStart"in g&&Jd(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),pa&&fa(pa,g)||(pa=g,g=nc(Zd,"onSelect"),0<g.length&&(c=new Kd("onSelect","select",null,c,f),a.push({event:c,listeners:g}),c.target=$r)))}function Zl(a,c){var f={};return f[a.toLowerCase()]=c.toLowerCase(),f["Webkit"+a]="webkit"+c,f["Moz"+a]="moz"+c,f}var jr={animationend:Zl("Animation","AnimationEnd"),animationiteration:Zl("Animation","AnimationIteration"),animationstart:Zl("Animation","AnimationStart"),transitionend:Zl("Transition","TransitionEnd")},th={},X0={};l&&(X0=document.createElement("div").style,"AnimationEvent"in window||(delete jr.animationend.animation,delete jr.animationiteration.animation,delete jr.animationstart.animation),"TransitionEvent"in window||delete jr.transitionend.transition);function ec(a){if(th[a])return th[a];if(!jr[a])return a;var c=jr[a],f;for(f in c)if(c.hasOwnProperty(f)&&f in X0)return th[a]=c[f];return a}var J0=ec("animationend"),Z0=ec("animationiteration"),ey=ec("animationstart"),ty=ec("transitionend"),ny=new Map,sy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oi(a,c){ny.set(a,c),r(c,[a])}for(var nh=0;nh<sy.length;nh++){var sh=sy[nh],VL=sh.toLowerCase(),GL=sh[0].toUpperCase()+sh.slice(1);oi(VL,"on"+GL)}oi(J0,"onAnimationEnd"),oi(Z0,"onAnimationIteration"),oi(ey,"onAnimationStart"),oi("dblclick","onDoubleClick"),oi("focusin","onFocus"),oi("focusout","onBlur"),oi(ty,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),r("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),r("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),r("onBeforeInput",["compositionend","keypress","textInput","paste"]),r("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),r("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KL=new Set("cancel close invalid load scroll toggle".split(" ").concat(ma));function iy(a,c,f){var g=a.type||"unknown-event";a.currentTarget=f,VR(g,c,void 0,a),a.currentTarget=null}function ry(a,c){c=(c&4)!==0;for(var f=0;f<a.length;f++){var g=a[f],E=g.event;g=g.listeners;e:{var T=void 0;if(c)for(var _=g.length-1;0<=_;_--){var N=g[_],$=N.instance,Y=N.currentTarget;if(N=N.listener,$!==T&&E.isPropagationStopped())break e;iy(E,N,Y),T=$}else for(_=0;_<g.length;_++){if(N=g[_],$=N.instance,Y=N.currentTarget,N=N.listener,$!==T&&E.isPropagationStopped())break e;iy(E,N,Y),T=$}}}if(Bl)throw a=Od,Bl=!1,Od=null,a}function ot(a,c){var f=c[dh];f===void 0&&(f=c[dh]=new Set);var g=a+"__bubble";f.has(g)||(oy(c,a,2,!1),f.add(g))}function ih(a,c,f){var g=0;c&&(g|=4),oy(f,a,g,c)}var tc="_reactListening"+Math.random().toString(36).slice(2);function ga(a){if(!a[tc]){a[tc]=!0,n.forEach(function(f){f!=="selectionchange"&&(KL.has(f)||ih(f,!1,a),ih(f,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[tc]||(c[tc]=!0,ih("selectionchange",!1,c))}}function oy(a,c,f,g){switch(_0(c)){case 1:var E=iL;break;case 4:E=rL;break;default:E=jd}f=E.bind(null,c,f,a),E=void 0,!Dd||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(E=!0),g?E!==void 0?a.addEventListener(c,f,{capture:!0,passive:E}):a.addEventListener(c,f,!0):E!==void 0?a.addEventListener(c,f,{passive:E}):a.addEventListener(c,f,!1)}function rh(a,c,f,g,E){var T=g;if((c&1)===0&&(c&2)===0&&g!==null)e:for(;;){if(g===null)return;var _=g.tag;if(_===3||_===4){var N=g.stateNode.containerInfo;if(N===E||N.nodeType===8&&N.parentNode===E)break;if(_===4)for(_=g.return;_!==null;){var $=_.tag;if(($===3||$===4)&&($=_.stateNode.containerInfo,$===E||$.nodeType===8&&$.parentNode===E))return;_=_.return}for(;N!==null;){if(_=Wi(N),_===null)return;if($=_.tag,$===5||$===6){g=T=_;continue e}N=N.parentNode}}g=g.return}d0(function(){var Y=T,le=kd(f),ue=[];e:{var ae=ny.get(a);if(ae!==void 0){var me=Kd,Te=a;switch(a){case"keypress":if(Yl(f)===0)break e;case"keydown":case"keyup":me=SL;break;case"focusin":Te="focus",me=Wd;break;case"focusout":Te="blur",me=Wd;break;case"beforeblur":case"afterblur":me=Wd;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=P0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=lL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=bL;break;case J0:case Z0:case ey:me=dL;break;case ty:me=wL;break;case"scroll":me=oL;break;case"wheel":me=LL;break;case"copy":case"cut":case"paste":me=fL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=O0}var we=(c&4)!==0,St=!we&&a==="scroll",z=we?ae!==null?ae+"Capture":null:ae;we=[];for(var G=Y,q;G!==null;){q=G;var he=q.stateNode;if(q.tag===5&&he!==null&&(q=he,z!==null&&(he=Jo(G,z),he!=null&&we.push(ya(G,he,q)))),St)break;G=G.return}0<we.length&&(ae=new me(ae,Te,null,f,le),ue.push({event:ae,listeners:we}))}}if((c&7)===0){e:{if(ae=a==="mouseover"||a==="pointerover",me=a==="mouseout"||a==="pointerout",ae&&f!==_d&&(Te=f.relatedTarget||f.fromElement)&&(Wi(Te)||Te[Ps]))break e;if((me||ae)&&(ae=le.window===le?le:(ae=le.ownerDocument)?ae.defaultView||ae.parentWindow:window,me?(Te=f.relatedTarget||f.toElement,me=Y,Te=Te?Wi(Te):null,Te!==null&&(St=zi(Te),Te!==St||Te.tag!==5&&Te.tag!==6)&&(Te=null)):(me=null,Te=Y),me!==Te)){if(we=P0,he="onMouseLeave",z="onMouseEnter",G="mouse",(a==="pointerout"||a==="pointerover")&&(we=O0,he="onPointerLeave",z="onPointerEnter",G="pointer"),St=me==null?ae:Kr(me),q=Te==null?ae:Kr(Te),ae=new we(he,G+"leave",me,f,le),ae.target=St,ae.relatedTarget=q,he=null,Wi(le)===Y&&(we=new we(z,G+"enter",Te,f,le),we.target=q,we.relatedTarget=St,he=we),St=he,me&&Te)t:{for(we=me,z=Te,G=0,q=we;q;q=Vr(q))G++;for(q=0,he=z;he;he=Vr(he))q++;for(;0<G-q;)we=Vr(we),G--;for(;0<q-G;)z=Vr(z),q--;for(;G--;){if(we===z||z!==null&&we===z.alternate)break t;we=Vr(we),z=Vr(z)}we=null}else we=null;me!==null&&ay(ue,ae,me,we,!1),Te!==null&&St!==null&&ay(ue,St,Te,we,!0)}}e:{if(ae=Y?Kr(Y):window,me=ae.nodeName&&ae.nodeName.toLowerCase(),me==="select"||me==="input"&&ae.type==="file")var Le=OL;else if($0(ae))if(V0)Le=BL;else{Le=ML;var _e=NL}else(me=ae.nodeName)&&me.toLowerCase()==="input"&&(ae.type==="checkbox"||ae.type==="radio")&&(Le=FL);if(Le&&(Le=Le(a,Y))){j0(ue,Le,f,le);break e}_e&&_e(a,ae,Y),a==="focusout"&&(_e=ae._wrapperState)&&_e.controlled&&ae.type==="number"&&qn(ae,"number",ae.value)}switch(_e=Y?Kr(Y):window,a){case"focusin":($0(_e)||_e.contentEditable==="true")&&($r=_e,Zd=Y,pa=null);break;case"focusout":pa=Zd=$r=null;break;case"mousedown":eh=!0;break;case"contextmenu":case"mouseup":case"dragend":eh=!1,Q0(ue,f,le);break;case"selectionchange":if(jL)break;case"keydown":case"keyup":Q0(ue,f,le)}var ke;if(Yd)e:{switch(a){case"compositionstart":var Oe="onCompositionStart";break e;case"compositionend":Oe="onCompositionEnd";break e;case"compositionupdate":Oe="onCompositionUpdate";break e}Oe=void 0}else Ur?B0(a,f)&&(Oe="onCompositionEnd"):a==="keydown"&&f.keyCode===229&&(Oe="onCompositionStart");Oe&&(N0&&f.locale!=="ko"&&(Ur||Oe!=="onCompositionStart"?Oe==="onCompositionEnd"&&Ur&&(ke=k0()):(ri=le,Gd="value"in ri?ri.value:ri.textContent,Ur=!0)),_e=nc(Y,Oe),0<_e.length&&(Oe=new D0(Oe,a,null,f,le),ue.push({event:Oe,listeners:_e}),ke?Oe.data=ke:(ke=U0(f),ke!==null&&(Oe.data=ke)))),(ke=_L?kL(a,f):CL(a,f))&&(Y=nc(Y,"onBeforeInput"),0<Y.length&&(le=new D0("onBeforeInput","beforeinput",null,f,le),ue.push({event:le,listeners:Y}),le.data=ke))}ry(ue,c)})}function ya(a,c,f){return{instance:a,listener:c,currentTarget:f}}function nc(a,c){for(var f=c+"Capture",g=[];a!==null;){var E=a,T=E.stateNode;E.tag===5&&T!==null&&(E=T,T=Jo(a,f),T!=null&&g.unshift(ya(a,T,E)),T=Jo(a,c),T!=null&&g.push(ya(a,T,E))),a=a.return}return g}function Vr(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function ay(a,c,f,g,E){for(var T=c._reactName,_=[];f!==null&&f!==g;){var N=f,$=N.alternate,Y=N.stateNode;if($!==null&&$===g)break;N.tag===5&&Y!==null&&(N=Y,E?($=Jo(f,T),$!=null&&_.unshift(ya(f,$,N))):E||($=Jo(f,T),$!=null&&_.push(ya(f,$,N)))),f=f.return}_.length!==0&&a.push({event:c,listeners:_})}var HL=/\r\n?/g,zL=/\u0000|\uFFFD/g;function ly(a){return(typeof a=="string"?a:""+a).replace(HL,`
`).replace(zL,"")}function sc(a,c,f){if(c=ly(c),ly(a)!==c&&f)throw Error(t(425))}function ic(){}var oh=null,ah=null;function lh(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var ch=typeof setTimeout=="function"?setTimeout:void 0,WL=typeof clearTimeout=="function"?clearTimeout:void 0,cy=typeof Promise=="function"?Promise:void 0,qL=typeof queueMicrotask=="function"?queueMicrotask:typeof cy<"u"?function(a){return cy.resolve(null).then(a).catch(YL)}:ch;function YL(a){setTimeout(function(){throw a})}function uh(a,c){var f=c,g=0;do{var E=f.nextSibling;if(a.removeChild(f),E&&E.nodeType===8)if(f=E.data,f==="/$"){if(g===0){a.removeChild(E),aa(c);return}g--}else f!=="$"&&f!=="$?"&&f!=="$!"||g++;f=E}while(f);aa(c)}function ai(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return a}function uy(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var f=a.data;if(f==="$"||f==="$!"||f==="$?"){if(c===0)return a;c--}else f==="/$"&&c++}a=a.previousSibling}return null}var Gr=Math.random().toString(36).slice(2),hs="__reactFiber$"+Gr,va="__reactProps$"+Gr,Ps="__reactContainer$"+Gr,dh="__reactEvents$"+Gr,QL="__reactListeners$"+Gr,XL="__reactHandles$"+Gr;function Wi(a){var c=a[hs];if(c)return c;for(var f=a.parentNode;f;){if(c=f[Ps]||f[hs]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(a=uy(a);a!==null;){if(f=a[hs])return f;a=uy(a)}return c}a=f,f=a.parentNode}return null}function xa(a){return a=a[hs]||a[Ps],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function Kr(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function rc(a){return a[va]||null}var hh=[],Hr=-1;function li(a){return{current:a}}function at(a){0>Hr||(a.current=hh[Hr],hh[Hr]=null,Hr--)}function rt(a,c){Hr++,hh[Hr]=a.current,a.current=c}var ci={},qt=li(ci),un=li(!1),qi=ci;function zr(a,c){var f=a.type.contextTypes;if(!f)return ci;var g=a.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===c)return g.__reactInternalMemoizedMaskedChildContext;var E={},T;for(T in f)E[T]=c[T];return g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=c,a.__reactInternalMemoizedMaskedChildContext=E),E}function dn(a){return a=a.childContextTypes,a!=null}function oc(){at(un),at(qt)}function dy(a,c,f){if(qt.current!==ci)throw Error(t(168));rt(qt,c),rt(un,f)}function hy(a,c,f){var g=a.stateNode;if(c=c.childContextTypes,typeof g.getChildContext!="function")return f;g=g.getChildContext();for(var E in g)if(!(E in c))throw Error(t(108,ve(a)||"Unknown",E));return J({},f,g)}function ac(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||ci,qi=qt.current,rt(qt,a),rt(un,un.current),!0}function fy(a,c,f){var g=a.stateNode;if(!g)throw Error(t(169));f?(a=hy(a,c,qi),g.__reactInternalMemoizedMergedChildContext=a,at(un),at(qt),rt(qt,a)):at(un),rt(un,f)}var Ds=null,lc=!1,fh=!1;function py(a){Ds===null?Ds=[a]:Ds.push(a)}function JL(a){lc=!0,py(a)}function ui(){if(!fh&&Ds!==null){fh=!0;var a=0,c=Je;try{var f=Ds;for(Je=1;a<f.length;a++){var g=f[a];do g=g(!0);while(g!==null)}Ds=null,lc=!1}catch(E){throw Ds!==null&&(Ds=Ds.slice(a+1)),g0(Nd,ui),E}finally{Je=c,fh=!1}}return null}var Wr=[],qr=0,cc=null,uc=0,Nn=[],Mn=0,Yi=null,Os=1,Ns="";function Qi(a,c){Wr[qr++]=uc,Wr[qr++]=cc,cc=a,uc=c}function my(a,c,f){Nn[Mn++]=Os,Nn[Mn++]=Ns,Nn[Mn++]=Yi,Yi=a;var g=Os;a=Ns;var E=32-Xn(g)-1;g&=~(1<<E),f+=1;var T=32-Xn(c)+E;if(30<T){var _=E-E%5;T=(g&(1<<_)-1).toString(32),g>>=_,E-=_,Os=1<<32-Xn(c)+E|f<<E|g,Ns=T+a}else Os=1<<T|f<<E|g,Ns=a}function ph(a){a.return!==null&&(Qi(a,1),my(a,1,0))}function mh(a){for(;a===cc;)cc=Wr[--qr],Wr[qr]=null,uc=Wr[--qr],Wr[qr]=null;for(;a===Yi;)Yi=Nn[--Mn],Nn[Mn]=null,Ns=Nn[--Mn],Nn[Mn]=null,Os=Nn[--Mn],Nn[Mn]=null}var wn=null,Rn=null,ct=!1,Zn=null;function gy(a,c){var f=$n(5,null,null,0);f.elementType="DELETED",f.stateNode=c,f.return=a,c=a.deletions,c===null?(a.deletions=[f],a.flags|=16):c.push(f)}function yy(a,c){switch(a.tag){case 5:var f=a.type;return c=c.nodeType!==1||f.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(a.stateNode=c,wn=a,Rn=ai(c.firstChild),!0):!1;case 6:return c=a.pendingProps===""||c.nodeType!==3?null:c,c!==null?(a.stateNode=c,wn=a,Rn=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(f=Yi!==null?{id:Os,overflow:Ns}:null,a.memoizedState={dehydrated:c,treeContext:f,retryLane:1073741824},f=$n(18,null,null,0),f.stateNode=c,f.return=a,a.child=f,wn=a,Rn=null,!0):!1;default:return!1}}function gh(a){return(a.mode&1)!==0&&(a.flags&128)===0}function yh(a){if(ct){var c=Rn;if(c){var f=c;if(!yy(a,c)){if(gh(a))throw Error(t(418));c=ai(f.nextSibling);var g=wn;c&&yy(a,c)?gy(g,f):(a.flags=a.flags&-4097|2,ct=!1,wn=a)}}else{if(gh(a))throw Error(t(418));a.flags=a.flags&-4097|2,ct=!1,wn=a}}}function vy(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;wn=a}function dc(a){if(a!==wn)return!1;if(!ct)return vy(a),ct=!0,!1;var c;if((c=a.tag!==3)&&!(c=a.tag!==5)&&(c=a.type,c=c!=="head"&&c!=="body"&&!lh(a.type,a.memoizedProps)),c&&(c=Rn)){if(gh(a))throw xy(),Error(t(418));for(;c;)gy(a,c),c=ai(c.nextSibling)}if(vy(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8){var f=a.data;if(f==="/$"){if(c===0){Rn=ai(a.nextSibling);break e}c--}else f!=="$"&&f!=="$!"&&f!=="$?"||c++}a=a.nextSibling}Rn=null}}else Rn=wn?ai(a.stateNode.nextSibling):null;return!0}function xy(){for(var a=Rn;a;)a=ai(a.nextSibling)}function Yr(){Rn=wn=null,ct=!1}function vh(a){Zn===null?Zn=[a]:Zn.push(a)}var ZL=I.ReactCurrentBatchConfig;function Sa(a,c,f){if(a=f.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(t(309));var g=f.stateNode}if(!g)throw Error(t(147,a));var E=g,T=""+a;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===T?c.ref:(c=function(_){var N=E.refs;_===null?delete N[T]:N[T]=_},c._stringRef=T,c)}if(typeof a!="string")throw Error(t(284));if(!f._owner)throw Error(t(290,a))}return a}function hc(a,c){throw a=Object.prototype.toString.call(c),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a))}function Sy(a){var c=a._init;return c(a._payload)}function Ey(a){function c(z,G){if(a){var q=z.deletions;q===null?(z.deletions=[G],z.flags|=16):q.push(G)}}function f(z,G){if(!a)return null;for(;G!==null;)c(z,G),G=G.sibling;return null}function g(z,G){for(z=new Map;G!==null;)G.key!==null?z.set(G.key,G):z.set(G.index,G),G=G.sibling;return z}function E(z,G){return z=vi(z,G),z.index=0,z.sibling=null,z}function T(z,G,q){return z.index=q,a?(q=z.alternate,q!==null?(q=q.index,q<G?(z.flags|=2,G):q):(z.flags|=2,G)):(z.flags|=1048576,G)}function _(z){return a&&z.alternate===null&&(z.flags|=2),z}function N(z,G,q,he){return G===null||G.tag!==6?(G=uf(q,z.mode,he),G.return=z,G):(G=E(G,q),G.return=z,G)}function $(z,G,q,he){var Le=q.type;return Le===P?le(z,G,q.props.children,he,q.key):G!==null&&(G.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===X&&Sy(Le)===G.type)?(he=E(G,q.props),he.ref=Sa(z,G,q),he.return=z,he):(he=Mc(q.type,q.key,q.props,null,z.mode,he),he.ref=Sa(z,G,q),he.return=z,he)}function Y(z,G,q,he){return G===null||G.tag!==4||G.stateNode.containerInfo!==q.containerInfo||G.stateNode.implementation!==q.implementation?(G=df(q,z.mode,he),G.return=z,G):(G=E(G,q.children||[]),G.return=z,G)}function le(z,G,q,he,Le){return G===null||G.tag!==7?(G=ir(q,z.mode,he,Le),G.return=z,G):(G=E(G,q),G.return=z,G)}function ue(z,G,q){if(typeof G=="string"&&G!==""||typeof G=="number")return G=uf(""+G,z.mode,q),G.return=z,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case k:return q=Mc(G.type,G.key,G.props,null,z.mode,q),q.ref=Sa(z,null,G),q.return=z,q;case M:return G=df(G,z.mode,q),G.return=z,G;case X:var he=G._init;return ue(z,he(G._payload),q)}if(Ut(G)||ee(G))return G=ir(G,z.mode,q,null),G.return=z,G;hc(z,G)}return null}function ae(z,G,q,he){var Le=G!==null?G.key:null;if(typeof q=="string"&&q!==""||typeof q=="number")return Le!==null?null:N(z,G,""+q,he);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case k:return q.key===Le?$(z,G,q,he):null;case M:return q.key===Le?Y(z,G,q,he):null;case X:return Le=q._init,ae(z,G,Le(q._payload),he)}if(Ut(q)||ee(q))return Le!==null?null:le(z,G,q,he,null);hc(z,q)}return null}function me(z,G,q,he,Le){if(typeof he=="string"&&he!==""||typeof he=="number")return z=z.get(q)||null,N(G,z,""+he,Le);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case k:return z=z.get(he.key===null?q:he.key)||null,$(G,z,he,Le);case M:return z=z.get(he.key===null?q:he.key)||null,Y(G,z,he,Le);case X:var _e=he._init;return me(z,G,q,_e(he._payload),Le)}if(Ut(he)||ee(he))return z=z.get(q)||null,le(G,z,he,Le,null);hc(G,he)}return null}function Te(z,G,q,he){for(var Le=null,_e=null,ke=G,Oe=G=0,Nt=null;ke!==null&&Oe<q.length;Oe++){ke.index>Oe?(Nt=ke,ke=null):Nt=ke.sibling;var Ye=ae(z,ke,q[Oe],he);if(Ye===null){ke===null&&(ke=Nt);break}a&&ke&&Ye.alternate===null&&c(z,ke),G=T(Ye,G,Oe),_e===null?Le=Ye:_e.sibling=Ye,_e=Ye,ke=Nt}if(Oe===q.length)return f(z,ke),ct&&Qi(z,Oe),Le;if(ke===null){for(;Oe<q.length;Oe++)ke=ue(z,q[Oe],he),ke!==null&&(G=T(ke,G,Oe),_e===null?Le=ke:_e.sibling=ke,_e=ke);return ct&&Qi(z,Oe),Le}for(ke=g(z,ke);Oe<q.length;Oe++)Nt=me(ke,z,Oe,q[Oe],he),Nt!==null&&(a&&Nt.alternate!==null&&ke.delete(Nt.key===null?Oe:Nt.key),G=T(Nt,G,Oe),_e===null?Le=Nt:_e.sibling=Nt,_e=Nt);return a&&ke.forEach(function(xi){return c(z,xi)}),ct&&Qi(z,Oe),Le}function we(z,G,q,he){var Le=ee(q);if(typeof Le!="function")throw Error(t(150));if(q=Le.call(q),q==null)throw Error(t(151));for(var _e=Le=null,ke=G,Oe=G=0,Nt=null,Ye=q.next();ke!==null&&!Ye.done;Oe++,Ye=q.next()){ke.index>Oe?(Nt=ke,ke=null):Nt=ke.sibling;var xi=ae(z,ke,Ye.value,he);if(xi===null){ke===null&&(ke=Nt);break}a&&ke&&xi.alternate===null&&c(z,ke),G=T(xi,G,Oe),_e===null?Le=xi:_e.sibling=xi,_e=xi,ke=Nt}if(Ye.done)return f(z,ke),ct&&Qi(z,Oe),Le;if(ke===null){for(;!Ye.done;Oe++,Ye=q.next())Ye=ue(z,Ye.value,he),Ye!==null&&(G=T(Ye,G,Oe),_e===null?Le=Ye:_e.sibling=Ye,_e=Ye);return ct&&Qi(z,Oe),Le}for(ke=g(z,ke);!Ye.done;Oe++,Ye=q.next())Ye=me(ke,z,Oe,Ye.value,he),Ye!==null&&(a&&Ye.alternate!==null&&ke.delete(Ye.key===null?Oe:Ye.key),G=T(Ye,G,Oe),_e===null?Le=Ye:_e.sibling=Ye,_e=Ye);return a&&ke.forEach(function(PI){return c(z,PI)}),ct&&Qi(z,Oe),Le}function St(z,G,q,he){if(typeof q=="object"&&q!==null&&q.type===P&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case k:e:{for(var Le=q.key,_e=G;_e!==null;){if(_e.key===Le){if(Le=q.type,Le===P){if(_e.tag===7){f(z,_e.sibling),G=E(_e,q.props.children),G.return=z,z=G;break e}}else if(_e.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===X&&Sy(Le)===_e.type){f(z,_e.sibling),G=E(_e,q.props),G.ref=Sa(z,_e,q),G.return=z,z=G;break e}f(z,_e);break}else c(z,_e);_e=_e.sibling}q.type===P?(G=ir(q.props.children,z.mode,he,q.key),G.return=z,z=G):(he=Mc(q.type,q.key,q.props,null,z.mode,he),he.ref=Sa(z,G,q),he.return=z,z=he)}return _(z);case M:e:{for(_e=q.key;G!==null;){if(G.key===_e)if(G.tag===4&&G.stateNode.containerInfo===q.containerInfo&&G.stateNode.implementation===q.implementation){f(z,G.sibling),G=E(G,q.children||[]),G.return=z,z=G;break e}else{f(z,G);break}else c(z,G);G=G.sibling}G=df(q,z.mode,he),G.return=z,z=G}return _(z);case X:return _e=q._init,St(z,G,_e(q._payload),he)}if(Ut(q))return Te(z,G,q,he);if(ee(q))return we(z,G,q,he);hc(z,q)}return typeof q=="string"&&q!==""||typeof q=="number"?(q=""+q,G!==null&&G.tag===6?(f(z,G.sibling),G=E(G,q),G.return=z,z=G):(f(z,G),G=uf(q,z.mode,he),G.return=z,z=G),_(z)):f(z,G)}return St}var Qr=Ey(!0),Ty=Ey(!1),fc=li(null),pc=null,Xr=null,xh=null;function Sh(){xh=Xr=pc=null}function Eh(a){var c=fc.current;at(fc),a._currentValue=c}function Th(a,c,f){for(;a!==null;){var g=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,g!==null&&(g.childLanes|=c)):g!==null&&(g.childLanes&c)!==c&&(g.childLanes|=c),a===f)break;a=a.return}}function Jr(a,c){pc=a,xh=Xr=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&c)!==0&&(hn=!0),a.firstContext=null)}function Fn(a){var c=a._currentValue;if(xh!==a)if(a={context:a,memoizedValue:c,next:null},Xr===null){if(pc===null)throw Error(t(308));Xr=a,pc.dependencies={lanes:0,firstContext:a}}else Xr=Xr.next=a;return c}var Xi=null;function bh(a){Xi===null?Xi=[a]:Xi.push(a)}function by(a,c,f,g){var E=c.interleaved;return E===null?(f.next=f,bh(c)):(f.next=E.next,E.next=f),c.interleaved=f,Ms(a,g)}function Ms(a,c){a.lanes|=c;var f=a.alternate;for(f!==null&&(f.lanes|=c),f=a,a=a.return;a!==null;)a.childLanes|=c,f=a.alternate,f!==null&&(f.childLanes|=c),f=a,a=a.return;return f.tag===3?f.stateNode:null}var di=!1;function Ah(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ay(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Fs(a,c){return{eventTime:a,lane:c,tag:0,payload:null,callback:null,next:null}}function hi(a,c,f){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,(qe&2)!==0){var E=g.pending;return E===null?c.next=c:(c.next=E.next,E.next=c),g.pending=c,Ms(a,f)}return E=g.interleaved,E===null?(c.next=c,bh(g)):(c.next=E.next,E.next=c),g.interleaved=c,Ms(a,f)}function mc(a,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194240)!==0)){var g=c.lanes;g&=a.pendingLanes,f|=g,c.lanes=f,Bd(a,f)}}function wy(a,c){var f=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var E=null,T=null;if(f=f.firstBaseUpdate,f!==null){do{var _={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};T===null?E=T=_:T=T.next=_,f=f.next}while(f!==null);T===null?E=T=c:T=T.next=c}else E=T=c;f={baseState:g.baseState,firstBaseUpdate:E,lastBaseUpdate:T,shared:g.shared,effects:g.effects},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=c:a.next=c,f.lastBaseUpdate=c}function gc(a,c,f,g){var E=a.updateQueue;di=!1;var T=E.firstBaseUpdate,_=E.lastBaseUpdate,N=E.shared.pending;if(N!==null){E.shared.pending=null;var $=N,Y=$.next;$.next=null,_===null?T=Y:_.next=Y,_=$;var le=a.alternate;le!==null&&(le=le.updateQueue,N=le.lastBaseUpdate,N!==_&&(N===null?le.firstBaseUpdate=Y:N.next=Y,le.lastBaseUpdate=$))}if(T!==null){var ue=E.baseState;_=0,le=Y=$=null,N=T;do{var ae=N.lane,me=N.eventTime;if((g&ae)===ae){le!==null&&(le=le.next={eventTime:me,lane:0,tag:N.tag,payload:N.payload,callback:N.callback,next:null});e:{var Te=a,we=N;switch(ae=c,me=f,we.tag){case 1:if(Te=we.payload,typeof Te=="function"){ue=Te.call(me,ue,ae);break e}ue=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=we.payload,ae=typeof Te=="function"?Te.call(me,ue,ae):Te,ae==null)break e;ue=J({},ue,ae);break e;case 2:di=!0}}N.callback!==null&&N.lane!==0&&(a.flags|=64,ae=E.effects,ae===null?E.effects=[N]:ae.push(N))}else me={eventTime:me,lane:ae,tag:N.tag,payload:N.payload,callback:N.callback,next:null},le===null?(Y=le=me,$=ue):le=le.next=me,_|=ae;if(N=N.next,N===null){if(N=E.shared.pending,N===null)break;ae=N,N=ae.next,ae.next=null,E.lastBaseUpdate=ae,E.shared.pending=null}}while(!0);if(le===null&&($=ue),E.baseState=$,E.firstBaseUpdate=Y,E.lastBaseUpdate=le,c=E.shared.interleaved,c!==null){E=c;do _|=E.lane,E=E.next;while(E!==c)}else T===null&&(E.shared.lanes=0);er|=_,a.lanes=_,a.memoizedState=ue}}function Ry(a,c,f){if(a=c.effects,c.effects=null,a!==null)for(c=0;c<a.length;c++){var g=a[c],E=g.callback;if(E!==null){if(g.callback=null,g=f,typeof E!="function")throw Error(t(191,E));E.call(g)}}}var Ea={},fs=li(Ea),Ta=li(Ea),ba=li(Ea);function Ji(a){if(a===Ea)throw Error(t(174));return a}function wh(a,c){switch(rt(ba,c),rt(Ta,a),rt(fs,Ea),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Dr(null,"");break;default:a=a===8?c.parentNode:c,c=a.namespaceURI||null,a=a.tagName,c=Dr(c,a)}at(fs),rt(fs,c)}function Zr(){at(fs),at(Ta),at(ba)}function Ly(a){Ji(ba.current);var c=Ji(fs.current),f=Dr(c,a.type);c!==f&&(rt(Ta,a),rt(fs,f))}function Rh(a){Ta.current===a&&(at(fs),at(Ta))}var ut=li(0);function yc(a){for(var c=a;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var Lh=[];function Ih(){for(var a=0;a<Lh.length;a++)Lh[a]._workInProgressVersionPrimary=null;Lh.length=0}var vc=I.ReactCurrentDispatcher,_h=I.ReactCurrentBatchConfig,Zi=0,dt=null,It=null,Dt=null,xc=!1,Aa=!1,wa=0,eI=0;function Yt(){throw Error(t(321))}function kh(a,c){if(c===null)return!1;for(var f=0;f<c.length&&f<a.length;f++)if(!Jn(a[f],c[f]))return!1;return!0}function Ch(a,c,f,g,E,T){if(Zi=T,dt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,vc.current=a===null||a.memoizedState===null?iI:rI,a=f(g,E),Aa){T=0;do{if(Aa=!1,wa=0,25<=T)throw Error(t(301));T+=1,Dt=It=null,c.updateQueue=null,vc.current=oI,a=f(g,E)}while(Aa)}if(vc.current=Tc,c=It!==null&&It.next!==null,Zi=0,Dt=It=dt=null,xc=!1,c)throw Error(t(300));return a}function Ph(){var a=wa!==0;return wa=0,a}function ps(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?dt.memoizedState=Dt=a:Dt=Dt.next=a,Dt}function Bn(){if(It===null){var a=dt.alternate;a=a!==null?a.memoizedState:null}else a=It.next;var c=Dt===null?dt.memoizedState:Dt.next;if(c!==null)Dt=c,It=a;else{if(a===null)throw Error(t(310));It=a,a={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},Dt===null?dt.memoizedState=Dt=a:Dt=Dt.next=a}return Dt}function Ra(a,c){return typeof c=="function"?c(a):c}function Dh(a){var c=Bn(),f=c.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=a;var g=It,E=g.baseQueue,T=f.pending;if(T!==null){if(E!==null){var _=E.next;E.next=T.next,T.next=_}g.baseQueue=E=T,f.pending=null}if(E!==null){T=E.next,g=g.baseState;var N=_=null,$=null,Y=T;do{var le=Y.lane;if((Zi&le)===le)$!==null&&($=$.next={lane:0,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),g=Y.hasEagerState?Y.eagerState:a(g,Y.action);else{var ue={lane:le,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null};$===null?(N=$=ue,_=g):$=$.next=ue,dt.lanes|=le,er|=le}Y=Y.next}while(Y!==null&&Y!==T);$===null?_=g:$.next=N,Jn(g,c.memoizedState)||(hn=!0),c.memoizedState=g,c.baseState=_,c.baseQueue=$,f.lastRenderedState=g}if(a=f.interleaved,a!==null){E=a;do T=E.lane,dt.lanes|=T,er|=T,E=E.next;while(E!==a)}else E===null&&(f.lanes=0);return[c.memoizedState,f.dispatch]}function Oh(a){var c=Bn(),f=c.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=a;var g=f.dispatch,E=f.pending,T=c.memoizedState;if(E!==null){f.pending=null;var _=E=E.next;do T=a(T,_.action),_=_.next;while(_!==E);Jn(T,c.memoizedState)||(hn=!0),c.memoizedState=T,c.baseQueue===null&&(c.baseState=T),f.lastRenderedState=T}return[T,g]}function Iy(){}function _y(a,c){var f=dt,g=Bn(),E=c(),T=!Jn(g.memoizedState,E);if(T&&(g.memoizedState=E,hn=!0),g=g.queue,Nh(Py.bind(null,f,g,a),[a]),g.getSnapshot!==c||T||Dt!==null&&Dt.memoizedState.tag&1){if(f.flags|=2048,La(9,Cy.bind(null,f,g,E,c),void 0,null),Ot===null)throw Error(t(349));(Zi&30)!==0||ky(f,c,E)}return E}function ky(a,c,f){a.flags|=16384,a={getSnapshot:c,value:f},c=dt.updateQueue,c===null?(c={lastEffect:null,stores:null},dt.updateQueue=c,c.stores=[a]):(f=c.stores,f===null?c.stores=[a]:f.push(a))}function Cy(a,c,f,g){c.value=f,c.getSnapshot=g,Dy(c)&&Oy(a)}function Py(a,c,f){return f(function(){Dy(c)&&Oy(a)})}function Dy(a){var c=a.getSnapshot;a=a.value;try{var f=c();return!Jn(a,f)}catch{return!0}}function Oy(a){var c=Ms(a,1);c!==null&&ss(c,a,1,-1)}function Ny(a){var c=ps();return typeof a=="function"&&(a=a()),c.memoizedState=c.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ra,lastRenderedState:a},c.queue=a,a=a.dispatch=sI.bind(null,dt,a),[c.memoizedState,a]}function La(a,c,f,g){return a={tag:a,create:c,destroy:f,deps:g,next:null},c=dt.updateQueue,c===null?(c={lastEffect:null,stores:null},dt.updateQueue=c,c.lastEffect=a.next=a):(f=c.lastEffect,f===null?c.lastEffect=a.next=a:(g=f.next,f.next=a,a.next=g,c.lastEffect=a)),a}function My(){return Bn().memoizedState}function Sc(a,c,f,g){var E=ps();dt.flags|=a,E.memoizedState=La(1|c,f,void 0,g===void 0?null:g)}function Ec(a,c,f,g){var E=Bn();g=g===void 0?null:g;var T=void 0;if(It!==null){var _=It.memoizedState;if(T=_.destroy,g!==null&&kh(g,_.deps)){E.memoizedState=La(c,f,T,g);return}}dt.flags|=a,E.memoizedState=La(1|c,f,T,g)}function Fy(a,c){return Sc(8390656,8,a,c)}function Nh(a,c){return Ec(2048,8,a,c)}function By(a,c){return Ec(4,2,a,c)}function Uy(a,c){return Ec(4,4,a,c)}function $y(a,c){if(typeof c=="function")return a=a(),c(a),function(){c(null)};if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function jy(a,c,f){return f=f!=null?f.concat([a]):null,Ec(4,4,$y.bind(null,c,a),f)}function Mh(){}function Vy(a,c){var f=Bn();c=c===void 0?null:c;var g=f.memoizedState;return g!==null&&c!==null&&kh(c,g[1])?g[0]:(f.memoizedState=[a,c],a)}function Gy(a,c){var f=Bn();c=c===void 0?null:c;var g=f.memoizedState;return g!==null&&c!==null&&kh(c,g[1])?g[0]:(a=a(),f.memoizedState=[a,c],a)}function Ky(a,c,f){return(Zi&21)===0?(a.baseState&&(a.baseState=!1,hn=!0),a.memoizedState=f):(Jn(f,c)||(f=S0(),dt.lanes|=f,er|=f,a.baseState=!0),c)}function tI(a,c){var f=Je;Je=f!==0&&4>f?f:4,a(!0);var g=_h.transition;_h.transition={};try{a(!1),c()}finally{Je=f,_h.transition=g}}function Hy(){return Bn().memoizedState}function nI(a,c,f){var g=gi(a);if(f={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null},zy(a))Wy(c,f);else if(f=by(a,c,f,g),f!==null){var E=on();ss(f,a,g,E),qy(f,c,g)}}function sI(a,c,f){var g=gi(a),E={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null};if(zy(a))Wy(c,E);else{var T=a.alternate;if(a.lanes===0&&(T===null||T.lanes===0)&&(T=c.lastRenderedReducer,T!==null))try{var _=c.lastRenderedState,N=T(_,f);if(E.hasEagerState=!0,E.eagerState=N,Jn(N,_)){var $=c.interleaved;$===null?(E.next=E,bh(c)):(E.next=$.next,$.next=E),c.interleaved=E;return}}catch{}finally{}f=by(a,c,E,g),f!==null&&(E=on(),ss(f,a,g,E),qy(f,c,g))}}function zy(a){var c=a.alternate;return a===dt||c!==null&&c===dt}function Wy(a,c){Aa=xc=!0;var f=a.pending;f===null?c.next=c:(c.next=f.next,f.next=c),a.pending=c}function qy(a,c,f){if((f&4194240)!==0){var g=c.lanes;g&=a.pendingLanes,f|=g,c.lanes=f,Bd(a,f)}}var Tc={readContext:Fn,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},iI={readContext:Fn,useCallback:function(a,c){return ps().memoizedState=[a,c===void 0?null:c],a},useContext:Fn,useEffect:Fy,useImperativeHandle:function(a,c,f){return f=f!=null?f.concat([a]):null,Sc(4194308,4,$y.bind(null,c,a),f)},useLayoutEffect:function(a,c){return Sc(4194308,4,a,c)},useInsertionEffect:function(a,c){return Sc(4,2,a,c)},useMemo:function(a,c){var f=ps();return c=c===void 0?null:c,a=a(),f.memoizedState=[a,c],a},useReducer:function(a,c,f){var g=ps();return c=f!==void 0?f(c):c,g.memoizedState=g.baseState=c,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:c},g.queue=a,a=a.dispatch=nI.bind(null,dt,a),[g.memoizedState,a]},useRef:function(a){var c=ps();return a={current:a},c.memoizedState=a},useState:Ny,useDebugValue:Mh,useDeferredValue:function(a){return ps().memoizedState=a},useTransition:function(){var a=Ny(!1),c=a[0];return a=tI.bind(null,a[1]),ps().memoizedState=a,[c,a]},useMutableSource:function(){},useSyncExternalStore:function(a,c,f){var g=dt,E=ps();if(ct){if(f===void 0)throw Error(t(407));f=f()}else{if(f=c(),Ot===null)throw Error(t(349));(Zi&30)!==0||ky(g,c,f)}E.memoizedState=f;var T={value:f,getSnapshot:c};return E.queue=T,Fy(Py.bind(null,g,T,a),[a]),g.flags|=2048,La(9,Cy.bind(null,g,T,f,c),void 0,null),f},useId:function(){var a=ps(),c=Ot.identifierPrefix;if(ct){var f=Ns,g=Os;f=(g&~(1<<32-Xn(g)-1)).toString(32)+f,c=":"+c+"R"+f,f=wa++,0<f&&(c+="H"+f.toString(32)),c+=":"}else f=eI++,c=":"+c+"r"+f.toString(32)+":";return a.memoizedState=c},unstable_isNewReconciler:!1},rI={readContext:Fn,useCallback:Vy,useContext:Fn,useEffect:Nh,useImperativeHandle:jy,useInsertionEffect:By,useLayoutEffect:Uy,useMemo:Gy,useReducer:Dh,useRef:My,useState:function(){return Dh(Ra)},useDebugValue:Mh,useDeferredValue:function(a){var c=Bn();return Ky(c,It.memoizedState,a)},useTransition:function(){var a=Dh(Ra)[0],c=Bn().memoizedState;return[a,c]},useMutableSource:Iy,useSyncExternalStore:_y,useId:Hy,unstable_isNewReconciler:!1},oI={readContext:Fn,useCallback:Vy,useContext:Fn,useEffect:Nh,useImperativeHandle:jy,useInsertionEffect:By,useLayoutEffect:Uy,useMemo:Gy,useReducer:Oh,useRef:My,useState:function(){return Oh(Ra)},useDebugValue:Mh,useDeferredValue:function(a){var c=Bn();return It===null?c.memoizedState=a:Ky(c,It.memoizedState,a)},useTransition:function(){var a=Oh(Ra)[0],c=Bn().memoizedState;return[a,c]},useMutableSource:Iy,useSyncExternalStore:_y,useId:Hy,unstable_isNewReconciler:!1};function es(a,c){if(a&&a.defaultProps){c=J({},c),a=a.defaultProps;for(var f in a)c[f]===void 0&&(c[f]=a[f]);return c}return c}function Fh(a,c,f,g){c=a.memoizedState,f=f(g,c),f=f==null?c:J({},c,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var bc={isMounted:function(a){return(a=a._reactInternals)?zi(a)===a:!1},enqueueSetState:function(a,c,f){a=a._reactInternals;var g=on(),E=gi(a),T=Fs(g,E);T.payload=c,f!=null&&(T.callback=f),c=hi(a,T,E),c!==null&&(ss(c,a,E,g),mc(c,a,E))},enqueueReplaceState:function(a,c,f){a=a._reactInternals;var g=on(),E=gi(a),T=Fs(g,E);T.tag=1,T.payload=c,f!=null&&(T.callback=f),c=hi(a,T,E),c!==null&&(ss(c,a,E,g),mc(c,a,E))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var f=on(),g=gi(a),E=Fs(f,g);E.tag=2,c!=null&&(E.callback=c),c=hi(a,E,g),c!==null&&(ss(c,a,g,f),mc(c,a,g))}};function Yy(a,c,f,g,E,T,_){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,T,_):c.prototype&&c.prototype.isPureReactComponent?!fa(f,g)||!fa(E,T):!0}function Qy(a,c,f){var g=!1,E=ci,T=c.contextType;return typeof T=="object"&&T!==null?T=Fn(T):(E=dn(c)?qi:qt.current,g=c.contextTypes,T=(g=g!=null)?zr(a,E):ci),c=new c(f,T),a.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=bc,a.stateNode=c,c._reactInternals=a,g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=E,a.__reactInternalMemoizedMaskedChildContext=T),c}function Xy(a,c,f,g){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,g),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,g),c.state!==a&&bc.enqueueReplaceState(c,c.state,null)}function Bh(a,c,f,g){var E=a.stateNode;E.props=f,E.state=a.memoizedState,E.refs={},Ah(a);var T=c.contextType;typeof T=="object"&&T!==null?E.context=Fn(T):(T=dn(c)?qi:qt.current,E.context=zr(a,T)),E.state=a.memoizedState,T=c.getDerivedStateFromProps,typeof T=="function"&&(Fh(a,c,T,f),E.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(c=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),c!==E.state&&bc.enqueueReplaceState(E,E.state,null),gc(a,f,E,g),E.state=a.memoizedState),typeof E.componentDidMount=="function"&&(a.flags|=4194308)}function eo(a,c){try{var f="",g=c;do f+=de(g),g=g.return;while(g);var E=f}catch(T){E=`
Error generating stack: `+T.message+`
`+T.stack}return{value:a,source:c,stack:E,digest:null}}function Uh(a,c,f){return{value:a,source:null,stack:f??null,digest:c??null}}function $h(a,c){try{console.error(c.value)}catch(f){setTimeout(function(){throw f})}}var aI=typeof WeakMap=="function"?WeakMap:Map;function Jy(a,c,f){f=Fs(-1,f),f.tag=3,f.payload={element:null};var g=c.value;return f.callback=function(){kc||(kc=!0,tf=g),$h(a,c)},f}function Zy(a,c,f){f=Fs(-1,f),f.tag=3;var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var E=c.value;f.payload=function(){return g(E)},f.callback=function(){$h(a,c)}}var T=a.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(f.callback=function(){$h(a,c),typeof g!="function"&&(pi===null?pi=new Set([this]):pi.add(this));var _=c.stack;this.componentDidCatch(c.value,{componentStack:_!==null?_:""})}),f}function ev(a,c,f){var g=a.pingCache;if(g===null){g=a.pingCache=new aI;var E=new Set;g.set(c,E)}else E=g.get(c),E===void 0&&(E=new Set,g.set(c,E));E.has(f)||(E.add(f),a=EI.bind(null,a,c,f),c.then(a,a))}function tv(a){do{var c;if((c=a.tag===13)&&(c=a.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return a;a=a.return}while(a!==null);return null}function nv(a,c,f,g,E){return(a.mode&1)===0?(a===c?a.flags|=65536:(a.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(c=Fs(-1,1),c.tag=2,hi(f,c,1))),f.lanes|=1),a):(a.flags|=65536,a.lanes=E,a)}var lI=I.ReactCurrentOwner,hn=!1;function rn(a,c,f,g){c.child=a===null?Ty(c,null,f,g):Qr(c,a.child,f,g)}function sv(a,c,f,g,E){f=f.render;var T=c.ref;return Jr(c,E),g=Ch(a,c,f,g,T,E),f=Ph(),a!==null&&!hn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~E,Bs(a,c,E)):(ct&&f&&ph(c),c.flags|=1,rn(a,c,g,E),c.child)}function iv(a,c,f,g,E){if(a===null){var T=f.type;return typeof T=="function"&&!cf(T)&&T.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(c.tag=15,c.type=T,rv(a,c,T,g,E)):(a=Mc(f.type,null,g,c,c.mode,E),a.ref=c.ref,a.return=c,c.child=a)}if(T=a.child,(a.lanes&E)===0){var _=T.memoizedProps;if(f=f.compare,f=f!==null?f:fa,f(_,g)&&a.ref===c.ref)return Bs(a,c,E)}return c.flags|=1,a=vi(T,g),a.ref=c.ref,a.return=c,c.child=a}function rv(a,c,f,g,E){if(a!==null){var T=a.memoizedProps;if(fa(T,g)&&a.ref===c.ref)if(hn=!1,c.pendingProps=g=T,(a.lanes&E)!==0)(a.flags&131072)!==0&&(hn=!0);else return c.lanes=a.lanes,Bs(a,c,E)}return jh(a,c,f,g,E)}function ov(a,c,f){var g=c.pendingProps,E=g.children,T=a!==null?a.memoizedState:null;if(g.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},rt(no,Ln),Ln|=f;else{if((f&1073741824)===0)return a=T!==null?T.baseLanes|f:f,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:a,cachePool:null,transitions:null},c.updateQueue=null,rt(no,Ln),Ln|=a,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=T!==null?T.baseLanes:f,rt(no,Ln),Ln|=g}else T!==null?(g=T.baseLanes|f,c.memoizedState=null):g=f,rt(no,Ln),Ln|=g;return rn(a,c,E,f),c.child}function av(a,c){var f=c.ref;(a===null&&f!==null||a!==null&&a.ref!==f)&&(c.flags|=512,c.flags|=2097152)}function jh(a,c,f,g,E){var T=dn(f)?qi:qt.current;return T=zr(c,T),Jr(c,E),f=Ch(a,c,f,g,T,E),g=Ph(),a!==null&&!hn?(c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~E,Bs(a,c,E)):(ct&&g&&ph(c),c.flags|=1,rn(a,c,f,E),c.child)}function lv(a,c,f,g,E){if(dn(f)){var T=!0;ac(c)}else T=!1;if(Jr(c,E),c.stateNode===null)wc(a,c),Qy(c,f,g),Bh(c,f,g,E),g=!0;else if(a===null){var _=c.stateNode,N=c.memoizedProps;_.props=N;var $=_.context,Y=f.contextType;typeof Y=="object"&&Y!==null?Y=Fn(Y):(Y=dn(f)?qi:qt.current,Y=zr(c,Y));var le=f.getDerivedStateFromProps,ue=typeof le=="function"||typeof _.getSnapshotBeforeUpdate=="function";ue||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(N!==g||$!==Y)&&Xy(c,_,g,Y),di=!1;var ae=c.memoizedState;_.state=ae,gc(c,g,_,E),$=c.memoizedState,N!==g||ae!==$||un.current||di?(typeof le=="function"&&(Fh(c,f,le,g),$=c.memoizedState),(N=di||Yy(c,f,N,g,ae,$,Y))?(ue||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(c.flags|=4194308)):(typeof _.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=g,c.memoizedState=$),_.props=g,_.state=$,_.context=Y,g=N):(typeof _.componentDidMount=="function"&&(c.flags|=4194308),g=!1)}else{_=c.stateNode,Ay(a,c),N=c.memoizedProps,Y=c.type===c.elementType?N:es(c.type,N),_.props=Y,ue=c.pendingProps,ae=_.context,$=f.contextType,typeof $=="object"&&$!==null?$=Fn($):($=dn(f)?qi:qt.current,$=zr(c,$));var me=f.getDerivedStateFromProps;(le=typeof me=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(N!==ue||ae!==$)&&Xy(c,_,g,$),di=!1,ae=c.memoizedState,_.state=ae,gc(c,g,_,E);var Te=c.memoizedState;N!==ue||ae!==Te||un.current||di?(typeof me=="function"&&(Fh(c,f,me,g),Te=c.memoizedState),(Y=di||Yy(c,f,Y,g,ae,Te,$)||!1)?(le||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(g,Te,$),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(g,Te,$)),typeof _.componentDidUpdate=="function"&&(c.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof _.componentDidUpdate!="function"||N===a.memoizedProps&&ae===a.memoizedState||(c.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||N===a.memoizedProps&&ae===a.memoizedState||(c.flags|=1024),c.memoizedProps=g,c.memoizedState=Te),_.props=g,_.state=Te,_.context=$,g=Y):(typeof _.componentDidUpdate!="function"||N===a.memoizedProps&&ae===a.memoizedState||(c.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||N===a.memoizedProps&&ae===a.memoizedState||(c.flags|=1024),g=!1)}return Vh(a,c,f,g,T,E)}function Vh(a,c,f,g,E,T){av(a,c);var _=(c.flags&128)!==0;if(!g&&!_)return E&&fy(c,f,!1),Bs(a,c,T);g=c.stateNode,lI.current=c;var N=_&&typeof f.getDerivedStateFromError!="function"?null:g.render();return c.flags|=1,a!==null&&_?(c.child=Qr(c,a.child,null,T),c.child=Qr(c,null,N,T)):rn(a,c,N,T),c.memoizedState=g.state,E&&fy(c,f,!0),c.child}function cv(a){var c=a.stateNode;c.pendingContext?dy(a,c.pendingContext,c.pendingContext!==c.context):c.context&&dy(a,c.context,!1),wh(a,c.containerInfo)}function uv(a,c,f,g,E){return Yr(),vh(E),c.flags|=256,rn(a,c,f,g),c.child}var Gh={dehydrated:null,treeContext:null,retryLane:0};function Kh(a){return{baseLanes:a,cachePool:null,transitions:null}}function dv(a,c,f){var g=c.pendingProps,E=ut.current,T=!1,_=(c.flags&128)!==0,N;if((N=_)||(N=a!==null&&a.memoizedState===null?!1:(E&2)!==0),N?(T=!0,c.flags&=-129):(a===null||a.memoizedState!==null)&&(E|=1),rt(ut,E&1),a===null)return yh(c),a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((c.mode&1)===0?c.lanes=1:a.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(_=g.children,a=g.fallback,T?(g=c.mode,T=c.child,_={mode:"hidden",children:_},(g&1)===0&&T!==null?(T.childLanes=0,T.pendingProps=_):T=Fc(_,g,0,null),a=ir(a,g,f,null),T.return=c,a.return=c,T.sibling=a,c.child=T,c.child.memoizedState=Kh(f),c.memoizedState=Gh,a):Hh(c,_));if(E=a.memoizedState,E!==null&&(N=E.dehydrated,N!==null))return cI(a,c,_,g,N,E,f);if(T){T=g.fallback,_=c.mode,E=a.child,N=E.sibling;var $={mode:"hidden",children:g.children};return(_&1)===0&&c.child!==E?(g=c.child,g.childLanes=0,g.pendingProps=$,c.deletions=null):(g=vi(E,$),g.subtreeFlags=E.subtreeFlags&14680064),N!==null?T=vi(N,T):(T=ir(T,_,f,null),T.flags|=2),T.return=c,g.return=c,g.sibling=T,c.child=g,g=T,T=c.child,_=a.child.memoizedState,_=_===null?Kh(f):{baseLanes:_.baseLanes|f,cachePool:null,transitions:_.transitions},T.memoizedState=_,T.childLanes=a.childLanes&~f,c.memoizedState=Gh,g}return T=a.child,a=T.sibling,g=vi(T,{mode:"visible",children:g.children}),(c.mode&1)===0&&(g.lanes=f),g.return=c,g.sibling=null,a!==null&&(f=c.deletions,f===null?(c.deletions=[a],c.flags|=16):f.push(a)),c.child=g,c.memoizedState=null,g}function Hh(a,c){return c=Fc({mode:"visible",children:c},a.mode,0,null),c.return=a,a.child=c}function Ac(a,c,f,g){return g!==null&&vh(g),Qr(c,a.child,null,f),a=Hh(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function cI(a,c,f,g,E,T,_){if(f)return c.flags&256?(c.flags&=-257,g=Uh(Error(t(422))),Ac(a,c,_,g)):c.memoizedState!==null?(c.child=a.child,c.flags|=128,null):(T=g.fallback,E=c.mode,g=Fc({mode:"visible",children:g.children},E,0,null),T=ir(T,E,_,null),T.flags|=2,g.return=c,T.return=c,g.sibling=T,c.child=g,(c.mode&1)!==0&&Qr(c,a.child,null,_),c.child.memoizedState=Kh(_),c.memoizedState=Gh,T);if((c.mode&1)===0)return Ac(a,c,_,null);if(E.data==="$!"){if(g=E.nextSibling&&E.nextSibling.dataset,g)var N=g.dgst;return g=N,T=Error(t(419)),g=Uh(T,g,void 0),Ac(a,c,_,g)}if(N=(_&a.childLanes)!==0,hn||N){if(g=Ot,g!==null){switch(_&-_){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(g.suspendedLanes|_))!==0?0:E,E!==0&&E!==T.retryLane&&(T.retryLane=E,Ms(a,E),ss(g,a,E,-1))}return lf(),g=Uh(Error(t(421))),Ac(a,c,_,g)}return E.data==="$?"?(c.flags|=128,c.child=a.child,c=TI.bind(null,a),E._reactRetry=c,null):(a=T.treeContext,Rn=ai(E.nextSibling),wn=c,ct=!0,Zn=null,a!==null&&(Nn[Mn++]=Os,Nn[Mn++]=Ns,Nn[Mn++]=Yi,Os=a.id,Ns=a.overflow,Yi=c),c=Hh(c,g.children),c.flags|=4096,c)}function hv(a,c,f){a.lanes|=c;var g=a.alternate;g!==null&&(g.lanes|=c),Th(a.return,c,f)}function zh(a,c,f,g,E){var T=a.memoizedState;T===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:E}:(T.isBackwards=c,T.rendering=null,T.renderingStartTime=0,T.last=g,T.tail=f,T.tailMode=E)}function fv(a,c,f){var g=c.pendingProps,E=g.revealOrder,T=g.tail;if(rn(a,c,g.children,f),g=ut.current,(g&2)!==0)g=g&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&hv(a,f,c);else if(a.tag===19)hv(a,f,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}if(rt(ut,g),(c.mode&1)===0)c.memoizedState=null;else switch(E){case"forwards":for(f=c.child,E=null;f!==null;)a=f.alternate,a!==null&&yc(a)===null&&(E=f),f=f.sibling;f=E,f===null?(E=c.child,c.child=null):(E=f.sibling,f.sibling=null),zh(c,!1,E,f,T);break;case"backwards":for(f=null,E=c.child,c.child=null;E!==null;){if(a=E.alternate,a!==null&&yc(a)===null){c.child=E;break}a=E.sibling,E.sibling=f,f=E,E=a}zh(c,!0,f,null,T);break;case"together":zh(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function wc(a,c){(c.mode&1)===0&&a!==null&&(a.alternate=null,c.alternate=null,c.flags|=2)}function Bs(a,c,f){if(a!==null&&(c.dependencies=a.dependencies),er|=c.lanes,(f&c.childLanes)===0)return null;if(a!==null&&c.child!==a.child)throw Error(t(153));if(c.child!==null){for(a=c.child,f=vi(a,a.pendingProps),c.child=f,f.return=c;a.sibling!==null;)a=a.sibling,f=f.sibling=vi(a,a.pendingProps),f.return=c;f.sibling=null}return c.child}function uI(a,c,f){switch(c.tag){case 3:cv(c),Yr();break;case 5:Ly(c);break;case 1:dn(c.type)&&ac(c);break;case 4:wh(c,c.stateNode.containerInfo);break;case 10:var g=c.type._context,E=c.memoizedProps.value;rt(fc,g._currentValue),g._currentValue=E;break;case 13:if(g=c.memoizedState,g!==null)return g.dehydrated!==null?(rt(ut,ut.current&1),c.flags|=128,null):(f&c.child.childLanes)!==0?dv(a,c,f):(rt(ut,ut.current&1),a=Bs(a,c,f),a!==null?a.sibling:null);rt(ut,ut.current&1);break;case 19:if(g=(f&c.childLanes)!==0,(a.flags&128)!==0){if(g)return fv(a,c,f);c.flags|=128}if(E=c.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),rt(ut,ut.current),g)break;return null;case 22:case 23:return c.lanes=0,ov(a,c,f)}return Bs(a,c,f)}var pv,Wh,mv,gv;pv=function(a,c){for(var f=c.child;f!==null;){if(f.tag===5||f.tag===6)a.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===c)break;for(;f.sibling===null;){if(f.return===null||f.return===c)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Wh=function(){},mv=function(a,c,f,g){var E=a.memoizedProps;if(E!==g){a=c.stateNode,Ji(fs.current);var T=null;switch(f){case"input":E=Bt(a,E),g=Bt(a,g),T=[];break;case"select":E=J({},E,{value:void 0}),g=J({},g,{value:void 0}),T=[];break;case"textarea":E=Yn(a,E),g=Yn(a,g),T=[];break;default:typeof E.onClick!="function"&&typeof g.onClick=="function"&&(a.onclick=ic)}Ld(f,g);var _;f=null;for(Y in E)if(!g.hasOwnProperty(Y)&&E.hasOwnProperty(Y)&&E[Y]!=null)if(Y==="style"){var N=E[Y];for(_ in N)N.hasOwnProperty(_)&&(f||(f={}),f[_]="")}else Y!=="dangerouslySetInnerHTML"&&Y!=="children"&&Y!=="suppressContentEditableWarning"&&Y!=="suppressHydrationWarning"&&Y!=="autoFocus"&&(i.hasOwnProperty(Y)?T||(T=[]):(T=T||[]).push(Y,null));for(Y in g){var $=g[Y];if(N=E!=null?E[Y]:void 0,g.hasOwnProperty(Y)&&$!==N&&($!=null||N!=null))if(Y==="style")if(N){for(_ in N)!N.hasOwnProperty(_)||$&&$.hasOwnProperty(_)||(f||(f={}),f[_]="");for(_ in $)$.hasOwnProperty(_)&&N[_]!==$[_]&&(f||(f={}),f[_]=$[_])}else f||(T||(T=[]),T.push(Y,f)),f=$;else Y==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,N=N?N.__html:void 0,$!=null&&N!==$&&(T=T||[]).push(Y,$)):Y==="children"?typeof $!="string"&&typeof $!="number"||(T=T||[]).push(Y,""+$):Y!=="suppressContentEditableWarning"&&Y!=="suppressHydrationWarning"&&(i.hasOwnProperty(Y)?($!=null&&Y==="onScroll"&&ot("scroll",a),T||N===$||(T=[])):(T=T||[]).push(Y,$))}f&&(T=T||[]).push("style",f);var Y=T;(c.updateQueue=Y)&&(c.flags|=4)}},gv=function(a,c,f,g){f!==g&&(c.flags|=4)};function Ia(a,c){if(!ct)switch(a.tailMode){case"hidden":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function Qt(a){var c=a.alternate!==null&&a.alternate.child===a.child,f=0,g=0;if(c)for(var E=a.child;E!==null;)f|=E.lanes|E.childLanes,g|=E.subtreeFlags&14680064,g|=E.flags&14680064,E.return=a,E=E.sibling;else for(E=a.child;E!==null;)f|=E.lanes|E.childLanes,g|=E.subtreeFlags,g|=E.flags,E.return=a,E=E.sibling;return a.subtreeFlags|=g,a.childLanes=f,c}function dI(a,c,f){var g=c.pendingProps;switch(mh(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(c),null;case 1:return dn(c.type)&&oc(),Qt(c),null;case 3:return g=c.stateNode,Zr(),at(un),at(qt),Ih(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(a===null||a.child===null)&&(dc(c)?c.flags|=4:a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Zn!==null&&(rf(Zn),Zn=null))),Wh(a,c),Qt(c),null;case 5:Rh(c);var E=Ji(ba.current);if(f=c.type,a!==null&&c.stateNode!=null)mv(a,c,f,g,E),a.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!g){if(c.stateNode===null)throw Error(t(166));return Qt(c),null}if(a=Ji(fs.current),dc(c)){g=c.stateNode,f=c.type;var T=c.memoizedProps;switch(g[hs]=c,g[va]=T,a=(c.mode&1)!==0,f){case"dialog":ot("cancel",g),ot("close",g);break;case"iframe":case"object":case"embed":ot("load",g);break;case"video":case"audio":for(E=0;E<ma.length;E++)ot(ma[E],g);break;case"source":ot("error",g);break;case"img":case"image":case"link":ot("error",g),ot("load",g);break;case"details":ot("toggle",g);break;case"input":Ki(g,T),ot("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!T.multiple},ot("invalid",g);break;case"textarea":Yo(g,T),ot("invalid",g)}Ld(f,T),E=null;for(var _ in T)if(T.hasOwnProperty(_)){var N=T[_];_==="children"?typeof N=="string"?g.textContent!==N&&(T.suppressHydrationWarning!==!0&&sc(g.textContent,N,a),E=["children",N]):typeof N=="number"&&g.textContent!==""+N&&(T.suppressHydrationWarning!==!0&&sc(g.textContent,N,a),E=["children",""+N]):i.hasOwnProperty(_)&&N!=null&&_==="onScroll"&&ot("scroll",g)}switch(f){case"input":Lt(g),sn(g,T,!0);break;case"textarea":Lt(g),Qo(g);break;case"select":case"option":break;default:typeof T.onClick=="function"&&(g.onclick=ic)}g=E,c.updateQueue=g,g!==null&&(c.flags|=4)}else{_=E.nodeType===9?E:E.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Zs(f)),a==="http://www.w3.org/1999/xhtml"?f==="script"?(a=_.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof g.is=="string"?a=_.createElement(f,{is:g.is}):(a=_.createElement(f),f==="select"&&(_=a,g.multiple?_.multiple=!0:g.size&&(_.size=g.size))):a=_.createElementNS(a,f),a[hs]=c,a[va]=g,pv(a,c,!1,!1),c.stateNode=a;e:{switch(_=Id(f,g),f){case"dialog":ot("cancel",a),ot("close",a),E=g;break;case"iframe":case"object":case"embed":ot("load",a),E=g;break;case"video":case"audio":for(E=0;E<ma.length;E++)ot(ma[E],a);E=g;break;case"source":ot("error",a),E=g;break;case"img":case"image":case"link":ot("error",a),ot("load",a),E=g;break;case"details":ot("toggle",a),E=g;break;case"input":Ki(a,g),E=Bt(a,g),ot("invalid",a);break;case"option":E=g;break;case"select":a._wrapperState={wasMultiple:!!g.multiple},E=J({},g,{value:void 0}),ot("invalid",a);break;case"textarea":Yo(a,g),E=Yn(a,g),ot("invalid",a);break;default:E=g}Ld(f,E),N=E;for(T in N)if(N.hasOwnProperty(T)){var $=N[T];T==="style"?r0(a,$):T==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,$!=null&&Xo(a,$)):T==="children"?typeof $=="string"?(f!=="textarea"||$!=="")&&ei(a,$):typeof $=="number"&&ei(a,""+$):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(i.hasOwnProperty(T)?$!=null&&T==="onScroll"&&ot("scroll",a):$!=null&&L(a,T,$,_))}switch(f){case"input":Lt(a),sn(a,g,!1);break;case"textarea":Lt(a),Qo(a);break;case"option":g.value!=null&&a.setAttribute("value",""+Ie(g.value));break;case"select":a.multiple=!!g.multiple,T=g.value,T!=null?bn(a,!!g.multiple,T,!1):g.defaultValue!=null&&bn(a,!!g.multiple,g.defaultValue,!0);break;default:typeof E.onClick=="function"&&(a.onclick=ic)}switch(f){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Qt(c),null;case 6:if(a&&c.stateNode!=null)gv(a,c,a.memoizedProps,g);else{if(typeof g!="string"&&c.stateNode===null)throw Error(t(166));if(f=Ji(ba.current),Ji(fs.current),dc(c)){if(g=c.stateNode,f=c.memoizedProps,g[hs]=c,(T=g.nodeValue!==f)&&(a=wn,a!==null))switch(a.tag){case 3:sc(g.nodeValue,f,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&sc(g.nodeValue,f,(a.mode&1)!==0)}T&&(c.flags|=4)}else g=(f.nodeType===9?f:f.ownerDocument).createTextNode(g),g[hs]=c,c.stateNode=g}return Qt(c),null;case 13:if(at(ut),g=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(ct&&Rn!==null&&(c.mode&1)!==0&&(c.flags&128)===0)xy(),Yr(),c.flags|=98560,T=!1;else if(T=dc(c),g!==null&&g.dehydrated!==null){if(a===null){if(!T)throw Error(t(318));if(T=c.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(t(317));T[hs]=c}else Yr(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Qt(c),T=!1}else Zn!==null&&(rf(Zn),Zn=null),T=!0;if(!T)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=f,c):(g=g!==null,g!==(a!==null&&a.memoizedState!==null)&&g&&(c.child.flags|=8192,(c.mode&1)!==0&&(a===null||(ut.current&1)!==0?_t===0&&(_t=3):lf())),c.updateQueue!==null&&(c.flags|=4),Qt(c),null);case 4:return Zr(),Wh(a,c),a===null&&ga(c.stateNode.containerInfo),Qt(c),null;case 10:return Eh(c.type._context),Qt(c),null;case 17:return dn(c.type)&&oc(),Qt(c),null;case 19:if(at(ut),T=c.memoizedState,T===null)return Qt(c),null;if(g=(c.flags&128)!==0,_=T.rendering,_===null)if(g)Ia(T,!1);else{if(_t!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(_=yc(a),_!==null){for(c.flags|=128,Ia(T,!1),g=_.updateQueue,g!==null&&(c.updateQueue=g,c.flags|=4),c.subtreeFlags=0,g=f,f=c.child;f!==null;)T=f,a=g,T.flags&=14680066,_=T.alternate,_===null?(T.childLanes=0,T.lanes=a,T.child=null,T.subtreeFlags=0,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=_.childLanes,T.lanes=_.lanes,T.child=_.child,T.subtreeFlags=0,T.deletions=null,T.memoizedProps=_.memoizedProps,T.memoizedState=_.memoizedState,T.updateQueue=_.updateQueue,T.type=_.type,a=_.dependencies,T.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),f=f.sibling;return rt(ut,ut.current&1|2),c.child}a=a.sibling}T.tail!==null&&xt()>so&&(c.flags|=128,g=!0,Ia(T,!1),c.lanes=4194304)}else{if(!g)if(a=yc(_),a!==null){if(c.flags|=128,g=!0,f=a.updateQueue,f!==null&&(c.updateQueue=f,c.flags|=4),Ia(T,!0),T.tail===null&&T.tailMode==="hidden"&&!_.alternate&&!ct)return Qt(c),null}else 2*xt()-T.renderingStartTime>so&&f!==1073741824&&(c.flags|=128,g=!0,Ia(T,!1),c.lanes=4194304);T.isBackwards?(_.sibling=c.child,c.child=_):(f=T.last,f!==null?f.sibling=_:c.child=_,T.last=_)}return T.tail!==null?(c=T.tail,T.rendering=c,T.tail=c.sibling,T.renderingStartTime=xt(),c.sibling=null,f=ut.current,rt(ut,g?f&1|2:f&1),c):(Qt(c),null);case 22:case 23:return af(),g=c.memoizedState!==null,a!==null&&a.memoizedState!==null!==g&&(c.flags|=8192),g&&(c.mode&1)!==0?(Ln&1073741824)!==0&&(Qt(c),c.subtreeFlags&6&&(c.flags|=8192)):Qt(c),null;case 24:return null;case 25:return null}throw Error(t(156,c.tag))}function hI(a,c){switch(mh(c),c.tag){case 1:return dn(c.type)&&oc(),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return Zr(),at(un),at(qt),Ih(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 5:return Rh(c),null;case 13:if(at(ut),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(t(340));Yr()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return at(ut),null;case 4:return Zr(),null;case 10:return Eh(c.type._context),null;case 22:case 23:return af(),null;case 24:return null;default:return null}}var Rc=!1,Xt=!1,fI=typeof WeakSet=="function"?WeakSet:Set,Se=null;function to(a,c){var f=a.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(g){mt(a,c,g)}else f.current=null}function qh(a,c,f){try{f()}catch(g){mt(a,c,g)}}var yv=!1;function pI(a,c){if(oh=zl,a=Y0(),Jd(a)){if("selectionStart"in a)var f={start:a.selectionStart,end:a.selectionEnd};else e:{f=(f=a.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var E=g.anchorOffset,T=g.focusNode;g=g.focusOffset;try{f.nodeType,T.nodeType}catch{f=null;break e}var _=0,N=-1,$=-1,Y=0,le=0,ue=a,ae=null;t:for(;;){for(var me;ue!==f||E!==0&&ue.nodeType!==3||(N=_+E),ue!==T||g!==0&&ue.nodeType!==3||($=_+g),ue.nodeType===3&&(_+=ue.nodeValue.length),(me=ue.firstChild)!==null;)ae=ue,ue=me;for(;;){if(ue===a)break t;if(ae===f&&++Y===E&&(N=_),ae===T&&++le===g&&($=_),(me=ue.nextSibling)!==null)break;ue=ae,ae=ue.parentNode}ue=me}f=N===-1||$===-1?null:{start:N,end:$}}else f=null}f=f||{start:0,end:0}}else f=null;for(ah={focusedElem:a,selectionRange:f},zl=!1,Se=c;Se!==null;)if(c=Se,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,Se=a;else for(;Se!==null;){c=Se;try{var Te=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Te!==null){var we=Te.memoizedProps,St=Te.memoizedState,z=c.stateNode,G=z.getSnapshotBeforeUpdate(c.elementType===c.type?we:es(c.type,we),St);z.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var q=c.stateNode.containerInfo;q.nodeType===1?q.textContent="":q.nodeType===9&&q.documentElement&&q.removeChild(q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){mt(c,c.return,he)}if(a=c.sibling,a!==null){a.return=c.return,Se=a;break}Se=c.return}return Te=yv,yv=!1,Te}function _a(a,c,f){var g=c.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var E=g=g.next;do{if((E.tag&a)===a){var T=E.destroy;E.destroy=void 0,T!==void 0&&qh(c,f,T)}E=E.next}while(E!==g)}}function Lc(a,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var f=c=c.next;do{if((f.tag&a)===a){var g=f.create;f.destroy=g()}f=f.next}while(f!==c)}}function Yh(a){var c=a.ref;if(c!==null){var f=a.stateNode;switch(a.tag){case 5:a=f;break;default:a=f}typeof c=="function"?c(a):c.current=a}}function vv(a){var c=a.alternate;c!==null&&(a.alternate=null,vv(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&(delete c[hs],delete c[va],delete c[dh],delete c[QL],delete c[XL])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function xv(a){return a.tag===5||a.tag===3||a.tag===4}function Sv(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||xv(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Qh(a,c,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,c?f.nodeType===8?f.parentNode.insertBefore(a,c):f.insertBefore(a,c):(f.nodeType===8?(c=f.parentNode,c.insertBefore(a,f)):(c=f,c.appendChild(a)),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=ic));else if(g!==4&&(a=a.child,a!==null))for(Qh(a,c,f),a=a.sibling;a!==null;)Qh(a,c,f),a=a.sibling}function Xh(a,c,f){var g=a.tag;if(g===5||g===6)a=a.stateNode,c?f.insertBefore(a,c):f.appendChild(a);else if(g!==4&&(a=a.child,a!==null))for(Xh(a,c,f),a=a.sibling;a!==null;)Xh(a,c,f),a=a.sibling}var $t=null,ts=!1;function fi(a,c,f){for(f=f.child;f!==null;)Ev(a,c,f),f=f.sibling}function Ev(a,c,f){if(ds&&typeof ds.onCommitFiberUnmount=="function")try{ds.onCommitFiberUnmount($l,f)}catch{}switch(f.tag){case 5:Xt||to(f,c);case 6:var g=$t,E=ts;$t=null,fi(a,c,f),$t=g,ts=E,$t!==null&&(ts?(a=$t,f=f.stateNode,a.nodeType===8?a.parentNode.removeChild(f):a.removeChild(f)):$t.removeChild(f.stateNode));break;case 18:$t!==null&&(ts?(a=$t,f=f.stateNode,a.nodeType===8?uh(a.parentNode,f):a.nodeType===1&&uh(a,f),aa(a)):uh($t,f.stateNode));break;case 4:g=$t,E=ts,$t=f.stateNode.containerInfo,ts=!0,fi(a,c,f),$t=g,ts=E;break;case 0:case 11:case 14:case 15:if(!Xt&&(g=f.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){E=g=g.next;do{var T=E,_=T.destroy;T=T.tag,_!==void 0&&((T&2)!==0||(T&4)!==0)&&qh(f,c,_),E=E.next}while(E!==g)}fi(a,c,f);break;case 1:if(!Xt&&(to(f,c),g=f.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=f.memoizedProps,g.state=f.memoizedState,g.componentWillUnmount()}catch(N){mt(f,c,N)}fi(a,c,f);break;case 21:fi(a,c,f);break;case 22:f.mode&1?(Xt=(g=Xt)||f.memoizedState!==null,fi(a,c,f),Xt=g):fi(a,c,f);break;default:fi(a,c,f)}}function Tv(a){var c=a.updateQueue;if(c!==null){a.updateQueue=null;var f=a.stateNode;f===null&&(f=a.stateNode=new fI),c.forEach(function(g){var E=bI.bind(null,a,g);f.has(g)||(f.add(g),g.then(E,E))})}}function ns(a,c){var f=c.deletions;if(f!==null)for(var g=0;g<f.length;g++){var E=f[g];try{var T=a,_=c,N=_;e:for(;N!==null;){switch(N.tag){case 5:$t=N.stateNode,ts=!1;break e;case 3:$t=N.stateNode.containerInfo,ts=!0;break e;case 4:$t=N.stateNode.containerInfo,ts=!0;break e}N=N.return}if($t===null)throw Error(t(160));Ev(T,_,E),$t=null,ts=!1;var $=E.alternate;$!==null&&($.return=null),E.return=null}catch(Y){mt(E,c,Y)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)bv(c,a),c=c.sibling}function bv(a,c){var f=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(ns(c,a),ms(a),g&4){try{_a(3,a,a.return),Lc(3,a)}catch(we){mt(a,a.return,we)}try{_a(5,a,a.return)}catch(we){mt(a,a.return,we)}}break;case 1:ns(c,a),ms(a),g&512&&f!==null&&to(f,f.return);break;case 5:if(ns(c,a),ms(a),g&512&&f!==null&&to(f,f.return),a.flags&32){var E=a.stateNode;try{ei(E,"")}catch(we){mt(a,a.return,we)}}if(g&4&&(E=a.stateNode,E!=null)){var T=a.memoizedProps,_=f!==null?f.memoizedProps:T,N=a.type,$=a.updateQueue;if(a.updateQueue=null,$!==null)try{N==="input"&&T.type==="radio"&&T.name!=null&&Ue(E,T),Id(N,_);var Y=Id(N,T);for(_=0;_<$.length;_+=2){var le=$[_],ue=$[_+1];le==="style"?r0(E,ue):le==="dangerouslySetInnerHTML"?Xo(E,ue):le==="children"?ei(E,ue):L(E,le,ue,Y)}switch(N){case"input":At(E,T);break;case"textarea":Hi(E,T);break;case"select":var ae=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!T.multiple;var me=T.value;me!=null?bn(E,!!T.multiple,me,!1):ae!==!!T.multiple&&(T.defaultValue!=null?bn(E,!!T.multiple,T.defaultValue,!0):bn(E,!!T.multiple,T.multiple?[]:"",!1))}E[va]=T}catch(we){mt(a,a.return,we)}}break;case 6:if(ns(c,a),ms(a),g&4){if(a.stateNode===null)throw Error(t(162));E=a.stateNode,T=a.memoizedProps;try{E.nodeValue=T}catch(we){mt(a,a.return,we)}}break;case 3:if(ns(c,a),ms(a),g&4&&f!==null&&f.memoizedState.isDehydrated)try{aa(c.containerInfo)}catch(we){mt(a,a.return,we)}break;case 4:ns(c,a),ms(a);break;case 13:ns(c,a),ms(a),E=a.child,E.flags&8192&&(T=E.memoizedState!==null,E.stateNode.isHidden=T,!T||E.alternate!==null&&E.alternate.memoizedState!==null||(ef=xt())),g&4&&Tv(a);break;case 22:if(le=f!==null&&f.memoizedState!==null,a.mode&1?(Xt=(Y=Xt)||le,ns(c,a),Xt=Y):ns(c,a),ms(a),g&8192){if(Y=a.memoizedState!==null,(a.stateNode.isHidden=Y)&&!le&&(a.mode&1)!==0)for(Se=a,le=a.child;le!==null;){for(ue=Se=le;Se!==null;){switch(ae=Se,me=ae.child,ae.tag){case 0:case 11:case 14:case 15:_a(4,ae,ae.return);break;case 1:to(ae,ae.return);var Te=ae.stateNode;if(typeof Te.componentWillUnmount=="function"){g=ae,f=ae.return;try{c=g,Te.props=c.memoizedProps,Te.state=c.memoizedState,Te.componentWillUnmount()}catch(we){mt(g,f,we)}}break;case 5:to(ae,ae.return);break;case 22:if(ae.memoizedState!==null){Rv(ue);continue}}me!==null?(me.return=ae,Se=me):Rv(ue)}le=le.sibling}e:for(le=null,ue=a;;){if(ue.tag===5){if(le===null){le=ue;try{E=ue.stateNode,Y?(T=E.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none"):(N=ue.stateNode,$=ue.memoizedProps.style,_=$!=null&&$.hasOwnProperty("display")?$.display:null,N.style.display=i0("display",_))}catch(we){mt(a,a.return,we)}}}else if(ue.tag===6){if(le===null)try{ue.stateNode.nodeValue=Y?"":ue.memoizedProps}catch(we){mt(a,a.return,we)}}else if((ue.tag!==22&&ue.tag!==23||ue.memoizedState===null||ue===a)&&ue.child!==null){ue.child.return=ue,ue=ue.child;continue}if(ue===a)break e;for(;ue.sibling===null;){if(ue.return===null||ue.return===a)break e;le===ue&&(le=null),ue=ue.return}le===ue&&(le=null),ue.sibling.return=ue.return,ue=ue.sibling}}break;case 19:ns(c,a),ms(a),g&4&&Tv(a);break;case 21:break;default:ns(c,a),ms(a)}}function ms(a){var c=a.flags;if(c&2){try{e:{for(var f=a.return;f!==null;){if(xv(f)){var g=f;break e}f=f.return}throw Error(t(160))}switch(g.tag){case 5:var E=g.stateNode;g.flags&32&&(ei(E,""),g.flags&=-33);var T=Sv(a);Xh(a,T,E);break;case 3:case 4:var _=g.stateNode.containerInfo,N=Sv(a);Qh(a,N,_);break;default:throw Error(t(161))}}catch($){mt(a,a.return,$)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function mI(a,c,f){Se=a,Av(a)}function Av(a,c,f){for(var g=(a.mode&1)!==0;Se!==null;){var E=Se,T=E.child;if(E.tag===22&&g){var _=E.memoizedState!==null||Rc;if(!_){var N=E.alternate,$=N!==null&&N.memoizedState!==null||Xt;N=Rc;var Y=Xt;if(Rc=_,(Xt=$)&&!Y)for(Se=E;Se!==null;)_=Se,$=_.child,_.tag===22&&_.memoizedState!==null?Lv(E):$!==null?($.return=_,Se=$):Lv(E);for(;T!==null;)Se=T,Av(T),T=T.sibling;Se=E,Rc=N,Xt=Y}wv(a)}else(E.subtreeFlags&8772)!==0&&T!==null?(T.return=E,Se=T):wv(a)}}function wv(a){for(;Se!==null;){var c=Se;if((c.flags&8772)!==0){var f=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Xt||Lc(5,c);break;case 1:var g=c.stateNode;if(c.flags&4&&!Xt)if(f===null)g.componentDidMount();else{var E=c.elementType===c.type?f.memoizedProps:es(c.type,f.memoizedProps);g.componentDidUpdate(E,f.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var T=c.updateQueue;T!==null&&Ry(c,T,g);break;case 3:var _=c.updateQueue;if(_!==null){if(f=null,c.child!==null)switch(c.child.tag){case 5:f=c.child.stateNode;break;case 1:f=c.child.stateNode}Ry(c,_,f)}break;case 5:var N=c.stateNode;if(f===null&&c.flags&4){f=N;var $=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":$.autoFocus&&f.focus();break;case"img":$.src&&(f.src=$.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Y=c.alternate;if(Y!==null){var le=Y.memoizedState;if(le!==null){var ue=le.dehydrated;ue!==null&&aa(ue)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Xt||c.flags&512&&Yh(c)}catch(ae){mt(c,c.return,ae)}}if(c===a){Se=null;break}if(f=c.sibling,f!==null){f.return=c.return,Se=f;break}Se=c.return}}function Rv(a){for(;Se!==null;){var c=Se;if(c===a){Se=null;break}var f=c.sibling;if(f!==null){f.return=c.return,Se=f;break}Se=c.return}}function Lv(a){for(;Se!==null;){var c=Se;try{switch(c.tag){case 0:case 11:case 15:var f=c.return;try{Lc(4,c)}catch($){mt(c,f,$)}break;case 1:var g=c.stateNode;if(typeof g.componentDidMount=="function"){var E=c.return;try{g.componentDidMount()}catch($){mt(c,E,$)}}var T=c.return;try{Yh(c)}catch($){mt(c,T,$)}break;case 5:var _=c.return;try{Yh(c)}catch($){mt(c,_,$)}}}catch($){mt(c,c.return,$)}if(c===a){Se=null;break}var N=c.sibling;if(N!==null){N.return=c.return,Se=N;break}Se=c.return}}var gI=Math.ceil,Ic=I.ReactCurrentDispatcher,Jh=I.ReactCurrentOwner,Un=I.ReactCurrentBatchConfig,qe=0,Ot=null,wt=null,jt=0,Ln=0,no=li(0),_t=0,ka=null,er=0,_c=0,Zh=0,Ca=null,fn=null,ef=0,so=1/0,Us=null,kc=!1,tf=null,pi=null,Cc=!1,mi=null,Pc=0,Pa=0,nf=null,Dc=-1,Oc=0;function on(){return(qe&6)!==0?xt():Dc!==-1?Dc:Dc=xt()}function gi(a){return(a.mode&1)===0?1:(qe&2)!==0&&jt!==0?jt&-jt:ZL.transition!==null?(Oc===0&&(Oc=S0()),Oc):(a=Je,a!==0||(a=window.event,a=a===void 0?16:_0(a.type)),a)}function ss(a,c,f,g){if(50<Pa)throw Pa=0,nf=null,Error(t(185));na(a,f,g),((qe&2)===0||a!==Ot)&&(a===Ot&&((qe&2)===0&&(_c|=f),_t===4&&yi(a,jt)),pn(a,g),f===1&&qe===0&&(c.mode&1)===0&&(so=xt()+500,lc&&ui()))}function pn(a,c){var f=a.callbackNode;ZR(a,c);var g=Gl(a,a===Ot?jt:0);if(g===0)f!==null&&y0(f),a.callbackNode=null,a.callbackPriority=0;else if(c=g&-g,a.callbackPriority!==c){if(f!=null&&y0(f),c===1)a.tag===0?JL(_v.bind(null,a)):py(_v.bind(null,a)),qL(function(){(qe&6)===0&&ui()}),f=null;else{switch(E0(g)){case 1:f=Nd;break;case 4:f=v0;break;case 16:f=Ul;break;case 536870912:f=x0;break;default:f=Ul}f=Fv(f,Iv.bind(null,a))}a.callbackPriority=c,a.callbackNode=f}}function Iv(a,c){if(Dc=-1,Oc=0,(qe&6)!==0)throw Error(t(327));var f=a.callbackNode;if(io()&&a.callbackNode!==f)return null;var g=Gl(a,a===Ot?jt:0);if(g===0)return null;if((g&30)!==0||(g&a.expiredLanes)!==0||c)c=Nc(a,g);else{c=g;var E=qe;qe|=2;var T=Cv();(Ot!==a||jt!==c)&&(Us=null,so=xt()+500,nr(a,c));do try{xI();break}catch(N){kv(a,N)}while(!0);Sh(),Ic.current=T,qe=E,wt!==null?c=0:(Ot=null,jt=0,c=_t)}if(c!==0){if(c===2&&(E=Md(a),E!==0&&(g=E,c=sf(a,E))),c===1)throw f=ka,nr(a,0),yi(a,g),pn(a,xt()),f;if(c===6)yi(a,g);else{if(E=a.current.alternate,(g&30)===0&&!yI(E)&&(c=Nc(a,g),c===2&&(T=Md(a),T!==0&&(g=T,c=sf(a,T))),c===1))throw f=ka,nr(a,0),yi(a,g),pn(a,xt()),f;switch(a.finishedWork=E,a.finishedLanes=g,c){case 0:case 1:throw Error(t(345));case 2:sr(a,fn,Us);break;case 3:if(yi(a,g),(g&130023424)===g&&(c=ef+500-xt(),10<c)){if(Gl(a,0)!==0)break;if(E=a.suspendedLanes,(E&g)!==g){on(),a.pingedLanes|=a.suspendedLanes&E;break}a.timeoutHandle=ch(sr.bind(null,a,fn,Us),c);break}sr(a,fn,Us);break;case 4:if(yi(a,g),(g&4194240)===g)break;for(c=a.eventTimes,E=-1;0<g;){var _=31-Xn(g);T=1<<_,_=c[_],_>E&&(E=_),g&=~T}if(g=E,g=xt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*gI(g/1960))-g,10<g){a.timeoutHandle=ch(sr.bind(null,a,fn,Us),g);break}sr(a,fn,Us);break;case 5:sr(a,fn,Us);break;default:throw Error(t(329))}}}return pn(a,xt()),a.callbackNode===f?Iv.bind(null,a):null}function sf(a,c){var f=Ca;return a.current.memoizedState.isDehydrated&&(nr(a,c).flags|=256),a=Nc(a,c),a!==2&&(c=fn,fn=f,c!==null&&rf(c)),a}function rf(a){fn===null?fn=a:fn.push.apply(fn,a)}function yI(a){for(var c=a;;){if(c.flags&16384){var f=c.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var g=0;g<f.length;g++){var E=f[g],T=E.getSnapshot;E=E.value;try{if(!Jn(T(),E))return!1}catch{return!1}}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function yi(a,c){for(c&=~Zh,c&=~_c,a.suspendedLanes|=c,a.pingedLanes&=~c,a=a.expirationTimes;0<c;){var f=31-Xn(c),g=1<<f;a[f]=-1,c&=~g}}function _v(a){if((qe&6)!==0)throw Error(t(327));io();var c=Gl(a,0);if((c&1)===0)return pn(a,xt()),null;var f=Nc(a,c);if(a.tag!==0&&f===2){var g=Md(a);g!==0&&(c=g,f=sf(a,g))}if(f===1)throw f=ka,nr(a,0),yi(a,c),pn(a,xt()),f;if(f===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=c,sr(a,fn,Us),pn(a,xt()),null}function of(a,c){var f=qe;qe|=1;try{return a(c)}finally{qe=f,qe===0&&(so=xt()+500,lc&&ui())}}function tr(a){mi!==null&&mi.tag===0&&(qe&6)===0&&io();var c=qe;qe|=1;var f=Un.transition,g=Je;try{if(Un.transition=null,Je=1,a)return a()}finally{Je=g,Un.transition=f,qe=c,(qe&6)===0&&ui()}}function af(){Ln=no.current,at(no)}function nr(a,c){a.finishedWork=null,a.finishedLanes=0;var f=a.timeoutHandle;if(f!==-1&&(a.timeoutHandle=-1,WL(f)),wt!==null)for(f=wt.return;f!==null;){var g=f;switch(mh(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&oc();break;case 3:Zr(),at(un),at(qt),Ih();break;case 5:Rh(g);break;case 4:Zr();break;case 13:at(ut);break;case 19:at(ut);break;case 10:Eh(g.type._context);break;case 22:case 23:af()}f=f.return}if(Ot=a,wt=a=vi(a.current,null),jt=Ln=c,_t=0,ka=null,Zh=_c=er=0,fn=Ca=null,Xi!==null){for(c=0;c<Xi.length;c++)if(f=Xi[c],g=f.interleaved,g!==null){f.interleaved=null;var E=g.next,T=f.pending;if(T!==null){var _=T.next;T.next=E,g.next=_}f.pending=g}Xi=null}return a}function kv(a,c){do{var f=wt;try{if(Sh(),vc.current=Tc,xc){for(var g=dt.memoizedState;g!==null;){var E=g.queue;E!==null&&(E.pending=null),g=g.next}xc=!1}if(Zi=0,Dt=It=dt=null,Aa=!1,wa=0,Jh.current=null,f===null||f.return===null){_t=1,ka=c,wt=null;break}e:{var T=a,_=f.return,N=f,$=c;if(c=jt,N.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var Y=$,le=N,ue=le.tag;if((le.mode&1)===0&&(ue===0||ue===11||ue===15)){var ae=le.alternate;ae?(le.updateQueue=ae.updateQueue,le.memoizedState=ae.memoizedState,le.lanes=ae.lanes):(le.updateQueue=null,le.memoizedState=null)}var me=tv(_);if(me!==null){me.flags&=-257,nv(me,_,N,T,c),me.mode&1&&ev(T,Y,c),c=me,$=Y;var Te=c.updateQueue;if(Te===null){var we=new Set;we.add($),c.updateQueue=we}else Te.add($);break e}else{if((c&1)===0){ev(T,Y,c),lf();break e}$=Error(t(426))}}else if(ct&&N.mode&1){var St=tv(_);if(St!==null){(St.flags&65536)===0&&(St.flags|=256),nv(St,_,N,T,c),vh(eo($,N));break e}}T=$=eo($,N),_t!==4&&(_t=2),Ca===null?Ca=[T]:Ca.push(T),T=_;do{switch(T.tag){case 3:T.flags|=65536,c&=-c,T.lanes|=c;var z=Jy(T,$,c);wy(T,z);break e;case 1:N=$;var G=T.type,q=T.stateNode;if((T.flags&128)===0&&(typeof G.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(pi===null||!pi.has(q)))){T.flags|=65536,c&=-c,T.lanes|=c;var he=Zy(T,N,c);wy(T,he);break e}}T=T.return}while(T!==null)}Dv(f)}catch(Le){c=Le,wt===f&&f!==null&&(wt=f=f.return);continue}break}while(!0)}function Cv(){var a=Ic.current;return Ic.current=Tc,a===null?Tc:a}function lf(){(_t===0||_t===3||_t===2)&&(_t=4),Ot===null||(er&268435455)===0&&(_c&268435455)===0||yi(Ot,jt)}function Nc(a,c){var f=qe;qe|=2;var g=Cv();(Ot!==a||jt!==c)&&(Us=null,nr(a,c));do try{vI();break}catch(E){kv(a,E)}while(!0);if(Sh(),qe=f,Ic.current=g,wt!==null)throw Error(t(261));return Ot=null,jt=0,_t}function vI(){for(;wt!==null;)Pv(wt)}function xI(){for(;wt!==null&&!KR();)Pv(wt)}function Pv(a){var c=Mv(a.alternate,a,Ln);a.memoizedProps=a.pendingProps,c===null?Dv(a):wt=c,Jh.current=null}function Dv(a){var c=a;do{var f=c.alternate;if(a=c.return,(c.flags&32768)===0){if(f=dI(f,c,Ln),f!==null){wt=f;return}}else{if(f=hI(f,c),f!==null){f.flags&=32767,wt=f;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{_t=6,wt=null;return}}if(c=c.sibling,c!==null){wt=c;return}wt=c=a}while(c!==null);_t===0&&(_t=5)}function sr(a,c,f){var g=Je,E=Un.transition;try{Un.transition=null,Je=1,SI(a,c,f,g)}finally{Un.transition=E,Je=g}return null}function SI(a,c,f,g){do io();while(mi!==null);if((qe&6)!==0)throw Error(t(327));f=a.finishedWork;var E=a.finishedLanes;if(f===null)return null;if(a.finishedWork=null,a.finishedLanes=0,f===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var T=f.lanes|f.childLanes;if(eL(a,T),a===Ot&&(wt=Ot=null,jt=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||Cc||(Cc=!0,Fv(Ul,function(){return io(),null})),T=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||T){T=Un.transition,Un.transition=null;var _=Je;Je=1;var N=qe;qe|=4,Jh.current=null,pI(a,f),bv(f,a),$L(ah),zl=!!oh,ah=oh=null,a.current=f,mI(f),HR(),qe=N,Je=_,Un.transition=T}else a.current=f;if(Cc&&(Cc=!1,mi=a,Pc=E),T=a.pendingLanes,T===0&&(pi=null),qR(f.stateNode),pn(a,xt()),c!==null)for(g=a.onRecoverableError,f=0;f<c.length;f++)E=c[f],g(E.value,{componentStack:E.stack,digest:E.digest});if(kc)throw kc=!1,a=tf,tf=null,a;return(Pc&1)!==0&&a.tag!==0&&io(),T=a.pendingLanes,(T&1)!==0?a===nf?Pa++:(Pa=0,nf=a):Pa=0,ui(),null}function io(){if(mi!==null){var a=E0(Pc),c=Un.transition,f=Je;try{if(Un.transition=null,Je=16>a?16:a,mi===null)var g=!1;else{if(a=mi,mi=null,Pc=0,(qe&6)!==0)throw Error(t(331));var E=qe;for(qe|=4,Se=a.current;Se!==null;){var T=Se,_=T.child;if((Se.flags&16)!==0){var N=T.deletions;if(N!==null){for(var $=0;$<N.length;$++){var Y=N[$];for(Se=Y;Se!==null;){var le=Se;switch(le.tag){case 0:case 11:case 15:_a(8,le,T)}var ue=le.child;if(ue!==null)ue.return=le,Se=ue;else for(;Se!==null;){le=Se;var ae=le.sibling,me=le.return;if(vv(le),le===Y){Se=null;break}if(ae!==null){ae.return=me,Se=ae;break}Se=me}}}var Te=T.alternate;if(Te!==null){var we=Te.child;if(we!==null){Te.child=null;do{var St=we.sibling;we.sibling=null,we=St}while(we!==null)}}Se=T}}if((T.subtreeFlags&2064)!==0&&_!==null)_.return=T,Se=_;else e:for(;Se!==null;){if(T=Se,(T.flags&2048)!==0)switch(T.tag){case 0:case 11:case 15:_a(9,T,T.return)}var z=T.sibling;if(z!==null){z.return=T.return,Se=z;break e}Se=T.return}}var G=a.current;for(Se=G;Se!==null;){_=Se;var q=_.child;if((_.subtreeFlags&2064)!==0&&q!==null)q.return=_,Se=q;else e:for(_=G;Se!==null;){if(N=Se,(N.flags&2048)!==0)try{switch(N.tag){case 0:case 11:case 15:Lc(9,N)}}catch(Le){mt(N,N.return,Le)}if(N===_){Se=null;break e}var he=N.sibling;if(he!==null){he.return=N.return,Se=he;break e}Se=N.return}}if(qe=E,ui(),ds&&typeof ds.onPostCommitFiberRoot=="function")try{ds.onPostCommitFiberRoot($l,a)}catch{}g=!0}return g}finally{Je=f,Un.transition=c}}return!1}function Ov(a,c,f){c=eo(f,c),c=Jy(a,c,1),a=hi(a,c,1),c=on(),a!==null&&(na(a,1,c),pn(a,c))}function mt(a,c,f){if(a.tag===3)Ov(a,a,f);else for(;c!==null;){if(c.tag===3){Ov(c,a,f);break}else if(c.tag===1){var g=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(pi===null||!pi.has(g))){a=eo(f,a),a=Zy(c,a,1),c=hi(c,a,1),a=on(),c!==null&&(na(c,1,a),pn(c,a));break}}c=c.return}}function EI(a,c,f){var g=a.pingCache;g!==null&&g.delete(c),c=on(),a.pingedLanes|=a.suspendedLanes&f,Ot===a&&(jt&f)===f&&(_t===4||_t===3&&(jt&130023424)===jt&&500>xt()-ef?nr(a,0):Zh|=f),pn(a,c)}function Nv(a,c){c===0&&((a.mode&1)===0?c=1:(c=Vl,Vl<<=1,(Vl&130023424)===0&&(Vl=4194304)));var f=on();a=Ms(a,c),a!==null&&(na(a,c,f),pn(a,f))}function TI(a){var c=a.memoizedState,f=0;c!==null&&(f=c.retryLane),Nv(a,f)}function bI(a,c){var f=0;switch(a.tag){case 13:var g=a.stateNode,E=a.memoizedState;E!==null&&(f=E.retryLane);break;case 19:g=a.stateNode;break;default:throw Error(t(314))}g!==null&&g.delete(c),Nv(a,f)}var Mv;Mv=function(a,c,f){if(a!==null)if(a.memoizedProps!==c.pendingProps||un.current)hn=!0;else{if((a.lanes&f)===0&&(c.flags&128)===0)return hn=!1,uI(a,c,f);hn=(a.flags&131072)!==0}else hn=!1,ct&&(c.flags&1048576)!==0&&my(c,uc,c.index);switch(c.lanes=0,c.tag){case 2:var g=c.type;wc(a,c),a=c.pendingProps;var E=zr(c,qt.current);Jr(c,f),E=Ch(null,c,g,a,E,f);var T=Ph();return c.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,dn(g)?(T=!0,ac(c)):T=!1,c.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,Ah(c),E.updater=bc,c.stateNode=E,E._reactInternals=c,Bh(c,g,a,f),c=Vh(null,c,g,!0,T,f)):(c.tag=0,ct&&T&&ph(c),rn(null,c,E,f),c=c.child),c;case 16:g=c.elementType;e:{switch(wc(a,c),a=c.pendingProps,E=g._init,g=E(g._payload),c.type=g,E=c.tag=wI(g),a=es(g,a),E){case 0:c=jh(null,c,g,a,f);break e;case 1:c=lv(null,c,g,a,f);break e;case 11:c=sv(null,c,g,a,f);break e;case 14:c=iv(null,c,g,es(g.type,a),f);break e}throw Error(t(306,g,""))}return c;case 0:return g=c.type,E=c.pendingProps,E=c.elementType===g?E:es(g,E),jh(a,c,g,E,f);case 1:return g=c.type,E=c.pendingProps,E=c.elementType===g?E:es(g,E),lv(a,c,g,E,f);case 3:e:{if(cv(c),a===null)throw Error(t(387));g=c.pendingProps,T=c.memoizedState,E=T.element,Ay(a,c),gc(c,g,null,f);var _=c.memoizedState;if(g=_.element,T.isDehydrated)if(T={element:g,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},c.updateQueue.baseState=T,c.memoizedState=T,c.flags&256){E=eo(Error(t(423)),c),c=uv(a,c,g,f,E);break e}else if(g!==E){E=eo(Error(t(424)),c),c=uv(a,c,g,f,E);break e}else for(Rn=ai(c.stateNode.containerInfo.firstChild),wn=c,ct=!0,Zn=null,f=Ty(c,null,g,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Yr(),g===E){c=Bs(a,c,f);break e}rn(a,c,g,f)}c=c.child}return c;case 5:return Ly(c),a===null&&yh(c),g=c.type,E=c.pendingProps,T=a!==null?a.memoizedProps:null,_=E.children,lh(g,E)?_=null:T!==null&&lh(g,T)&&(c.flags|=32),av(a,c),rn(a,c,_,f),c.child;case 6:return a===null&&yh(c),null;case 13:return dv(a,c,f);case 4:return wh(c,c.stateNode.containerInfo),g=c.pendingProps,a===null?c.child=Qr(c,null,g,f):rn(a,c,g,f),c.child;case 11:return g=c.type,E=c.pendingProps,E=c.elementType===g?E:es(g,E),sv(a,c,g,E,f);case 7:return rn(a,c,c.pendingProps,f),c.child;case 8:return rn(a,c,c.pendingProps.children,f),c.child;case 12:return rn(a,c,c.pendingProps.children,f),c.child;case 10:e:{if(g=c.type._context,E=c.pendingProps,T=c.memoizedProps,_=E.value,rt(fc,g._currentValue),g._currentValue=_,T!==null)if(Jn(T.value,_)){if(T.children===E.children&&!un.current){c=Bs(a,c,f);break e}}else for(T=c.child,T!==null&&(T.return=c);T!==null;){var N=T.dependencies;if(N!==null){_=T.child;for(var $=N.firstContext;$!==null;){if($.context===g){if(T.tag===1){$=Fs(-1,f&-f),$.tag=2;var Y=T.updateQueue;if(Y!==null){Y=Y.shared;var le=Y.pending;le===null?$.next=$:($.next=le.next,le.next=$),Y.pending=$}}T.lanes|=f,$=T.alternate,$!==null&&($.lanes|=f),Th(T.return,f,c),N.lanes|=f;break}$=$.next}}else if(T.tag===10)_=T.type===c.type?null:T.child;else if(T.tag===18){if(_=T.return,_===null)throw Error(t(341));_.lanes|=f,N=_.alternate,N!==null&&(N.lanes|=f),Th(_,f,c),_=T.sibling}else _=T.child;if(_!==null)_.return=T;else for(_=T;_!==null;){if(_===c){_=null;break}if(T=_.sibling,T!==null){T.return=_.return,_=T;break}_=_.return}T=_}rn(a,c,E.children,f),c=c.child}return c;case 9:return E=c.type,g=c.pendingProps.children,Jr(c,f),E=Fn(E),g=g(E),c.flags|=1,rn(a,c,g,f),c.child;case 14:return g=c.type,E=es(g,c.pendingProps),E=es(g.type,E),iv(a,c,g,E,f);case 15:return rv(a,c,c.type,c.pendingProps,f);case 17:return g=c.type,E=c.pendingProps,E=c.elementType===g?E:es(g,E),wc(a,c),c.tag=1,dn(g)?(a=!0,ac(c)):a=!1,Jr(c,f),Qy(c,g,E),Bh(c,g,E,f),Vh(null,c,g,!0,a,f);case 19:return fv(a,c,f);case 22:return ov(a,c,f)}throw Error(t(156,c.tag))};function Fv(a,c){return g0(a,c)}function AI(a,c,f,g){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $n(a,c,f,g){return new AI(a,c,f,g)}function cf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function wI(a){if(typeof a=="function")return cf(a)?1:0;if(a!=null){if(a=a.$$typeof,a===ne)return 11;if(a===re)return 14}return 2}function vi(a,c){var f=a.alternate;return f===null?(f=$n(a.tag,c,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=c,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&14680064,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,c=a.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f}function Mc(a,c,f,g,E,T){var _=2;if(g=a,typeof a=="function")cf(a)&&(_=1);else if(typeof a=="string")_=5;else e:switch(a){case P:return ir(f.children,E,T,c);case C:_=8,E|=8;break;case U:return a=$n(12,f,c,E|2),a.elementType=U,a.lanes=T,a;case oe:return a=$n(13,f,c,E),a.elementType=oe,a.lanes=T,a;case se:return a=$n(19,f,c,E),a.elementType=se,a.lanes=T,a;case Z:return Fc(f,E,T,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case O:_=10;break e;case W:_=9;break e;case ne:_=11;break e;case re:_=14;break e;case X:_=16,g=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return c=$n(_,f,c,E),c.elementType=a,c.type=g,c.lanes=T,c}function ir(a,c,f,g){return a=$n(7,a,g,c),a.lanes=f,a}function Fc(a,c,f,g){return a=$n(22,a,g,c),a.elementType=Z,a.lanes=f,a.stateNode={isHidden:!1},a}function uf(a,c,f){return a=$n(6,a,null,c),a.lanes=f,a}function df(a,c,f){return c=$n(4,a.children!==null?a.children:[],a.key,c),c.lanes=f,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function RI(a,c,f,g,E){this.tag=c,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fd(0),this.expirationTimes=Fd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fd(0),this.identifierPrefix=g,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function hf(a,c,f,g,E,T,_,N,$){return a=new RI(a,c,f,N,$),c===1?(c=1,T===!0&&(c|=8)):c=0,T=$n(3,null,null,c),a.current=T,T.stateNode=a,T.memoizedState={element:g,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ah(T),a}function LI(a,c,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:g==null?null:""+g,children:a,containerInfo:c,implementation:f}}function Bv(a){if(!a)return ci;a=a._reactInternals;e:{if(zi(a)!==a||a.tag!==1)throw Error(t(170));var c=a;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(dn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(t(171))}if(a.tag===1){var f=a.type;if(dn(f))return hy(a,f,c)}return c}function Uv(a,c,f,g,E,T,_,N,$){return a=hf(f,g,!0,a,E,T,_,N,$),a.context=Bv(null),f=a.current,g=on(),E=gi(f),T=Fs(g,E),T.callback=c??null,hi(f,T,E),a.current.lanes=E,na(a,E,g),pn(a,g),a}function Bc(a,c,f,g){var E=c.current,T=on(),_=gi(E);return f=Bv(f),c.context===null?c.context=f:c.pendingContext=f,c=Fs(T,_),c.payload={element:a},g=g===void 0?null:g,g!==null&&(c.callback=g),a=hi(E,c,_),a!==null&&(ss(a,E,_,T),mc(a,E,_)),_}function Uc(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function $v(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<c?f:c}}function ff(a,c){$v(a,c),(a=a.alternate)&&$v(a,c)}function II(){return null}var jv=typeof reportError=="function"?reportError:function(a){console.error(a)};function pf(a){this._internalRoot=a}$c.prototype.render=pf.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(t(409));Bc(a,c,null,null)},$c.prototype.unmount=pf.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;tr(function(){Bc(null,a,null,null)}),c[Ps]=null}};function $c(a){this._internalRoot=a}$c.prototype.unstable_scheduleHydration=function(a){if(a){var c=A0();a={blockedOn:null,target:a,priority:c};for(var f=0;f<ii.length&&c!==0&&c<ii[f].priority;f++);ii.splice(f,0,a),f===0&&L0(a)}};function mf(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function jc(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function Vv(){}function _I(a,c,f,g,E){if(E){if(typeof g=="function"){var T=g;g=function(){var Y=Uc(_);T.call(Y)}}var _=Uv(c,g,a,0,null,!1,!1,"",Vv);return a._reactRootContainer=_,a[Ps]=_.current,ga(a.nodeType===8?a.parentNode:a),tr(),_}for(;E=a.lastChild;)a.removeChild(E);if(typeof g=="function"){var N=g;g=function(){var Y=Uc($);N.call(Y)}}var $=hf(a,0,!1,null,null,!1,!1,"",Vv);return a._reactRootContainer=$,a[Ps]=$.current,ga(a.nodeType===8?a.parentNode:a),tr(function(){Bc(c,$,f,g)}),$}function Vc(a,c,f,g,E){var T=f._reactRootContainer;if(T){var _=T;if(typeof E=="function"){var N=E;E=function(){var $=Uc(_);N.call($)}}Bc(c,_,a,E)}else _=_I(f,c,a,E,g);return Uc(_)}T0=function(a){switch(a.tag){case 3:var c=a.stateNode;if(c.current.memoizedState.isDehydrated){var f=ta(c.pendingLanes);f!==0&&(Bd(c,f|1),pn(c,xt()),(qe&6)===0&&(so=xt()+500,ui()))}break;case 13:tr(function(){var g=Ms(a,1);if(g!==null){var E=on();ss(g,a,1,E)}}),ff(a,1)}},Ud=function(a){if(a.tag===13){var c=Ms(a,134217728);if(c!==null){var f=on();ss(c,a,134217728,f)}ff(a,134217728)}},b0=function(a){if(a.tag===13){var c=gi(a),f=Ms(a,c);if(f!==null){var g=on();ss(f,a,c,g)}ff(a,c)}},A0=function(){return Je},w0=function(a,c){var f=Je;try{return Je=a,c()}finally{Je=f}},Cd=function(a,c,f){switch(c){case"input":if(At(a,f),c=f.name,f.type==="radio"&&c!=null){for(f=a;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<f.length;c++){var g=f[c];if(g!==a&&g.form===a.form){var E=rc(g);if(!E)throw Error(t(90));xe(g),At(g,E)}}}break;case"textarea":Hi(a,f);break;case"select":c=f.value,c!=null&&bn(a,!!f.multiple,c,!1)}},c0=of,u0=tr;var kI={usingClientEntryPoint:!1,Events:[xa,Kr,rc,a0,l0,of]},Da={findFiberByHostInstance:Wi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},CI={bundleType:Da.bundleType,version:Da.version,rendererPackageName:Da.rendererPackageName,rendererConfig:Da.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=p0(a),a===null?null:a.stateNode},findFiberByHostInstance:Da.findFiberByHostInstance||II,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gc.isDisabled&&Gc.supportsFiber)try{$l=Gc.inject(CI),ds=Gc}catch{}}return mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kI,mn.createPortal=function(a,c){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!mf(c))throw Error(t(200));return LI(a,c,null,f)},mn.createRoot=function(a,c){if(!mf(a))throw Error(t(299));var f=!1,g="",E=jv;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onRecoverableError!==void 0&&(E=c.onRecoverableError)),c=hf(a,1,!1,null,null,f,!1,g,E),a[Ps]=c.current,ga(a.nodeType===8?a.parentNode:a),new pf(c)},mn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=p0(c),a=a===null?null:a.stateNode,a},mn.flushSync=function(a){return tr(a)},mn.hydrate=function(a,c,f){if(!jc(c))throw Error(t(200));return Vc(null,a,c,!0,f)},mn.hydrateRoot=function(a,c,f){if(!mf(a))throw Error(t(405));var g=f!=null&&f.hydratedSources||null,E=!1,T="",_=jv;if(f!=null&&(f.unstable_strictMode===!0&&(E=!0),f.identifierPrefix!==void 0&&(T=f.identifierPrefix),f.onRecoverableError!==void 0&&(_=f.onRecoverableError)),c=Uv(c,null,a,1,f??null,E,!1,T,_),a[Ps]=c.current,ga(a),g)for(a=0;a<g.length;a++)f=g[a],E=f._getVersion,E=E(f._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[f,E]:c.mutableSourceEagerHydrationData.push(f,E);return new $c(c)},mn.render=function(a,c,f){if(!jc(c))throw Error(t(200));return Vc(null,a,c,!1,f)},mn.unmountComponentAtNode=function(a){if(!jc(a))throw Error(t(40));return a._reactRootContainer?(tr(function(){Vc(null,null,a,!1,function(){a._reactRootContainer=null,a[Ps]=null})}),!0):!1},mn.unstable_batchedUpdates=of,mn.unstable_renderSubtreeIntoContainer=function(a,c,f,g){if(!jc(f))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Vc(a,c,f,!1,g)},mn.version="18.3.1-next-f1338f8080-20240426",mn}var Xv;function JT(){if(Xv)return xf.exports;Xv=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),xf.exports=jI(),xf.exports}var Jv;function VI(){if(Jv)return Hc;Jv=1;var s=JT();return Hc.createRoot=s.createRoot,Hc.hydrateRoot=s.hydrateRoot,Hc}var GI=VI();const KI=XT(GI),HI=20,zI=1e6,qs={ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"};let Tf=0;function WI(){return Tf=(Tf+1)%Number.MAX_VALUE,Tf.toString()}const bf=new Map,Zv=s=>{if(bf.has(s))return;const e=setTimeout(()=>{bf.delete(s),Xa({type:qs.REMOVE_TOAST,toastId:s})},zI);bf.set(s,e)},qI=(s,e)=>{switch(e.type){case qs.ADD_TOAST:return{...s,toasts:[e.toast,...s.toasts].slice(0,HI)};case qs.UPDATE_TOAST:return{...s,toasts:s.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case qs.DISMISS_TOAST:{const{toastId:t}=e;return t?Zv(t):s.toasts.forEach(n=>{Zv(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===t||t===void 0?{...n,open:!1}:n)}}case qs.REMOVE_TOAST:return e.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(t=>t.id!==e.toastId)}}},yu=[];let vu={toasts:[]};function Xa(s){vu=qI(vu,s),yu.forEach(e=>{e(vu)})}function YI({...s}){const e=WI(),t=i=>Xa({type:qs.UPDATE_TOAST,toast:{...i,id:e}}),n=()=>Xa({type:qs.DISMISS_TOAST,toastId:e});return Xa({type:qs.ADD_TOAST,toast:{...s,id:e,open:!0,onOpenChange:i=>{i||n()}}}),{id:e,dismiss:n,update:t}}function QI(){const[s,e]=B.useState(vu);return B.useEffect(()=>(yu.push(e),()=>{const t=yu.indexOf(e);t>-1&&yu.splice(t,1)}),[s]),{...s,toast:YI,dismiss:t=>Xa({type:qs.DISMISS_TOAST,toastId:t})}}function ZT(s){var e,t,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s)){var i=s.length;for(e=0;e<i;e++)s[e]&&(t=ZT(s[e]))&&(n&&(n+=" "),n+=t)}else for(t in s)s[t]&&(n&&(n+=" "),n+=t);return n}function e1(){for(var s,e,t=0,n="",i=arguments.length;t<i;t++)(s=arguments[t])&&(e=ZT(s))&&(n&&(n+=" "),n+=e);return n}const ex=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,tx=e1,XI=(s,e)=>t=>{var n;if((e==null?void 0:e.variants)==null)return tx(s,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:i,defaultVariants:r}=e,o=Object.keys(i).map(d=>{const h=t==null?void 0:t[d],p=r==null?void 0:r[d];if(h===null)return null;const m=ex(h)||ex(p);return i[d][m]}),l=t&&Object.entries(t).reduce((d,h)=>{let[p,m]=h;return m===void 0||(d[p]=m),d},{}),u=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((d,h)=>{let{class:p,className:m,...v}=h;return Object.entries(v).every(y=>{let[S,x]=y;return Array.isArray(x)?x.includes({...r,...l}[S]):{...r,...l}[S]===x})?[...d,p,m]:d},[]);return tx(s,o,u,t==null?void 0:t.class,t==null?void 0:t.className)};/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),t1=(...s)=>s.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ZI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e_=B.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:r,iconNode:o,...l},u)=>B.createElement("svg",{ref:u,...ZI,width:e,height:e,stroke:s,strokeWidth:n?Number(t)*24/Number(e):t,className:t1("lucide",i),...l},[...o.map(([d,h])=>B.createElement(d,h)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=(s,e)=>{const t=B.forwardRef(({className:n,...i},r)=>B.createElement(e_,{ref:r,iconNode:e,className:t1(`lucide-${JI(s)}`,n),...i}));return t.displayName=`${s}`,t};/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t_=[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]],n_=De("Baby",t_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s_=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],i_=De("Check",s_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r_=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],o_=De("ChevronDown",r_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a_=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],l_=De("ChevronLeft",a_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c_=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Mm=De("ChevronRight",c_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],n1=De("CircleAlert",u_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d_=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],h_=De("CircleCheckBig",d_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],s1=De("Clock",f_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p_=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],m_=De("Film",p_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g_=[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]],y_=De("Fingerprint",g_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v_=[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]],x_=De("Gamepad2",v_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Fm=De("Globe",S_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E_=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],T_=De("GraduationCap",E_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b_=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],A_=De("History",b_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],R_=De("House",w_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],I_=De("Info",L_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],k_=De("Link",__);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],i1=De("LoaderCircle",C_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],D_=De("LockOpen",P_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],nx=De("Lock",O_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N_=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],xp=De("MapPin",N_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],F_=De("Maximize",M_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B_=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],U_=De("Minimize",B_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],j_=De("Monitor",$_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],G_=De("Moon",V_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],H_=De("Music",K_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]],W_=De("Newspaper",z_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],Y_=De("Palette",q_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],X_=De("Pause",Q_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J_=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],Sp=De("Play",J_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z_=[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]],r1=De("Radio",Z_);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ek=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],sx=De("RefreshCw",ek);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tk=[["path",{d:"M13 7 9 3 5 7l4 4",key:"vyckw6"}],["path",{d:"m17 11 4 4-4 4-4-4",key:"rchckc"}],["path",{d:"m8 12 4 4 6-6-4-4Z",key:"1sshf7"}],["path",{d:"m16 8 3-3",key:"x428zp"}],["path",{d:"M9 21a6 6 0 0 0-6-6",key:"1iajcf"}]],nk=De("Satellite",tk);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sk=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],ik=De("Scan",sk);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rk=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Ep=De("Search",rk);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ok=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],o1=De("Settings",ok);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ak=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],lk=De("Shield",ak);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],uk=De("Sparkles",ck);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dk=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],od=De("Star",dk);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],fk=De("Sun",hk);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pk=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],mk=De("Trash2",pk);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],a1=De("TrendingUp",gk);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yk=[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]],vk=De("Trophy",yk);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xk=[["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",ry:"2",key:"10ag99"}],["polyline",{points:"17 2 12 7 7 2",key:"11pgbg"}]],Cr=De("Tv",xk);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sk=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}]],Ek=De("Volume1",Sk);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],bk=De("Volume2",Tk);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ak=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],wk=De("VolumeX",Ak);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rk=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ad=De("X",Rk);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lk=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],ol=De("Zap",Lk),Bm="-",Ik=s=>{const e=kk(s),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=s;return{getClassGroupId:o=>{const l=o.split(Bm);return l[0]===""&&l.length!==1&&l.shift(),l1(l,e)||_k(o)},getConflictingClassGroupIds:(o,l)=>{const u=t[o]||[];return l&&n[o]?[...u,...n[o]]:u}}},l1=(s,e)=>{var o;if(s.length===0)return e.classGroupId;const t=s[0],n=e.nextPart.get(t),i=n?l1(s.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const r=s.join(Bm);return(o=e.validators.find(({validator:l})=>l(r)))==null?void 0:o.classGroupId},ix=/^\[(.+)\]$/,_k=s=>{if(ix.test(s)){const e=ix.exec(s)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},kk=s=>{const{theme:e,classGroups:t}=s,n={nextPart:new Map,validators:[]};for(const i in t)Tp(t[i],n,i,e);return n},Tp=(s,e,t,n)=>{s.forEach(i=>{if(typeof i=="string"){const r=i===""?e:rx(e,i);r.classGroupId=t;return}if(typeof i=="function"){if(Ck(i)){Tp(i(n),e,t,n);return}e.validators.push({validator:i,classGroupId:t});return}Object.entries(i).forEach(([r,o])=>{Tp(o,rx(e,r),t,n)})})},rx=(s,e)=>{let t=s;return e.split(Bm).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},Ck=s=>s.isThemeGetter,Pk=s=>{if(s<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const i=(r,o)=>{t.set(r,o),e++,e>s&&(e=0,n=t,t=new Map)};return{get(r){let o=t.get(r);if(o!==void 0)return o;if((o=n.get(r))!==void 0)return i(r,o),o},set(r,o){t.has(r)?t.set(r,o):i(r,o)}}},bp="!",Ap=":",Dk=Ap.length,Ok=s=>{const{prefix:e,experimentalParseClassName:t}=s;let n=i=>{const r=[];let o=0,l=0,u=0,d;for(let y=0;y<i.length;y++){let S=i[y];if(o===0&&l===0){if(S===Ap){r.push(i.slice(u,y)),u=y+Dk;continue}if(S==="/"){d=y;continue}}S==="["?o++:S==="]"?o--:S==="("?l++:S===")"&&l--}const h=r.length===0?i:i.substring(u),p=Nk(h),m=p!==h,v=d&&d>u?d-u:void 0;return{modifiers:r,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:v}};if(e){const i=e+Ap,r=n;n=o=>o.startsWith(i)?r(o.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(t){const i=n;n=r=>t({className:r,parseClassName:i})}return n},Nk=s=>s.endsWith(bp)?s.substring(0,s.length-1):s.startsWith(bp)?s.substring(1):s,Mk=s=>{const e=Object.fromEntries(s.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const i=[];let r=[];return n.forEach(o=>{o[0]==="["||e[o]?(i.push(...r.sort(),o),r=[]):r.push(o)}),i.push(...r.sort()),i}},Fk=s=>({cache:Pk(s.cacheSize),parseClassName:Ok(s),sortModifiers:Mk(s),...Ik(s)}),Bk=/\s+/,Uk=(s,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:i,sortModifiers:r}=e,o=[],l=s.trim().split(Bk);let u="";for(let d=l.length-1;d>=0;d-=1){const h=l[d],{isExternal:p,modifiers:m,hasImportantModifier:v,baseClassName:y,maybePostfixModifierPosition:S}=t(h);if(p){u=h+(u.length>0?" "+u:u);continue}let x=!!S,b=n(x?y.substring(0,S):y);if(!b){if(!x){u=h+(u.length>0?" "+u:u);continue}if(b=n(y),!b){u=h+(u.length>0?" "+u:u);continue}x=!1}const w=r(m).join(":"),L=v?w+bp:w,I=L+b;if(o.includes(I))continue;o.push(I);const k=i(b,x);for(let M=0;M<k.length;++M){const P=k[M];o.push(L+P)}u=h+(u.length>0?" "+u:u)}return u};function $k(){let s=0,e,t,n="";for(;s<arguments.length;)(e=arguments[s++])&&(t=c1(e))&&(n&&(n+=" "),n+=t);return n}const c1=s=>{if(typeof s=="string")return s;let e,t="";for(let n=0;n<s.length;n++)s[n]&&(e=c1(s[n]))&&(t&&(t+=" "),t+=e);return t};function jk(s,...e){let t,n,i,r=o;function o(u){const d=e.reduce((h,p)=>p(h),s());return t=Fk(d),n=t.cache.get,i=t.cache.set,r=l,l(u)}function l(u){const d=n(u);if(d)return d;const h=Uk(u,t);return i(u,h),h}return function(){return r($k.apply(null,arguments))}}const kt=s=>{const e=t=>t[s]||[];return e.isThemeGetter=!0,e},u1=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,d1=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Vk=/^\d+\/\d+$/,Gk=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Kk=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Hk=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,zk=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Wk=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ro=s=>Vk.test(s),$e=s=>!!s&&!Number.isNaN(Number(s)),Si=s=>!!s&&Number.isInteger(Number(s)),Af=s=>s.endsWith("%")&&$e(s.slice(0,-1)),$s=s=>Gk.test(s),qk=()=>!0,Yk=s=>Kk.test(s)&&!Hk.test(s),h1=()=>!1,Qk=s=>zk.test(s),Xk=s=>Wk.test(s),Jk=s=>!be(s)&&!Ae(s),Zk=s=>Go(s,m1,h1),be=s=>u1.test(s),rr=s=>Go(s,g1,Yk),wf=s=>Go(s,iC,$e),ox=s=>Go(s,f1,h1),eC=s=>Go(s,p1,Xk),zc=s=>Go(s,y1,Qk),Ae=s=>d1.test(s),Na=s=>Ko(s,g1),tC=s=>Ko(s,rC),ax=s=>Ko(s,f1),nC=s=>Ko(s,m1),sC=s=>Ko(s,p1),Wc=s=>Ko(s,y1,!0),Go=(s,e,t)=>{const n=u1.exec(s);return n?n[1]?e(n[1]):t(n[2]):!1},Ko=(s,e,t=!1)=>{const n=d1.exec(s);return n?n[1]?e(n[1]):t:!1},f1=s=>s==="position"||s==="percentage",p1=s=>s==="image"||s==="url",m1=s=>s==="length"||s==="size"||s==="bg-size",g1=s=>s==="length",iC=s=>s==="number",rC=s=>s==="family-name",y1=s=>s==="shadow",oC=()=>{const s=kt("color"),e=kt("font"),t=kt("text"),n=kt("font-weight"),i=kt("tracking"),r=kt("leading"),o=kt("breakpoint"),l=kt("container"),u=kt("spacing"),d=kt("radius"),h=kt("shadow"),p=kt("inset-shadow"),m=kt("text-shadow"),v=kt("drop-shadow"),y=kt("blur"),S=kt("perspective"),x=kt("aspect"),b=kt("ease"),w=kt("animate"),L=()=>["auto","avoid","all","avoid-page","page","left","right","column"],I=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],k=()=>[...I(),Ae,be],M=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto","contain","none"],C=()=>[Ae,be,u],U=()=>[ro,"full","auto",...C()],O=()=>[Si,"none","subgrid",Ae,be],W=()=>["auto",{span:["full",Si,Ae,be]},Si,Ae,be],ne=()=>[Si,"auto",Ae,be],oe=()=>["auto","min","max","fr",Ae,be],se=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],re=()=>["start","end","center","stretch","center-safe","end-safe"],X=()=>["auto",...C()],Z=()=>[ro,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...C()],F=()=>[s,Ae,be],ee=()=>[...I(),ax,ox,{position:[Ae,be]}],J=()=>["no-repeat",{repeat:["","x","y","space","round"]}],D=()=>["auto","cover","contain",nC,Zk,{size:[Ae,be]}],j=()=>[Af,Na,rr],ie=()=>["","none","full",d,Ae,be],ce=()=>["",$e,Na,rr],de=()=>["solid","dashed","dotted","double"],fe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ve=()=>[$e,Af,ax,ox],Ie=()=>["","none",y,Ae,be],Me=()=>["none",$e,Ae,be],Qe=()=>["none",$e,Ae,be],Lt=()=>[$e,Ae,be],xe=()=>[ro,"full",...C()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[$s],breakpoint:[$s],color:[qk],container:[$s],"drop-shadow":[$s],ease:["in","out","in-out"],font:[Jk],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[$s],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[$s],shadow:[$s],spacing:["px",$e],text:[$s],"text-shadow":[$s],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ro,be,Ae,x]}],container:["container"],columns:[{columns:[$e,be,Ae,l]}],"break-after":[{"break-after":L()}],"break-before":[{"break-before":L()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:k()}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:U()}],"inset-x":[{"inset-x":U()}],"inset-y":[{"inset-y":U()}],start:[{start:U()}],end:[{end:U()}],top:[{top:U()}],right:[{right:U()}],bottom:[{bottom:U()}],left:[{left:U()}],visibility:["visible","invisible","collapse"],z:[{z:[Si,"auto",Ae,be]}],basis:[{basis:[ro,"full","auto",l,...C()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[$e,ro,"auto","initial","none",be]}],grow:[{grow:["",$e,Ae,be]}],shrink:[{shrink:["",$e,Ae,be]}],order:[{order:[Si,"first","last","none",Ae,be]}],"grid-cols":[{"grid-cols":O()}],"col-start-end":[{col:W()}],"col-start":[{"col-start":ne()}],"col-end":[{"col-end":ne()}],"grid-rows":[{"grid-rows":O()}],"row-start-end":[{row:W()}],"row-start":[{"row-start":ne()}],"row-end":[{"row-end":ne()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":oe()}],"auto-rows":[{"auto-rows":oe()}],gap:[{gap:C()}],"gap-x":[{"gap-x":C()}],"gap-y":[{"gap-y":C()}],"justify-content":[{justify:[...se(),"normal"]}],"justify-items":[{"justify-items":[...re(),"normal"]}],"justify-self":[{"justify-self":["auto",...re()]}],"align-content":[{content:["normal",...se()]}],"align-items":[{items:[...re(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...re(),{baseline:["","last"]}]}],"place-content":[{"place-content":se()}],"place-items":[{"place-items":[...re(),"baseline"]}],"place-self":[{"place-self":["auto",...re()]}],p:[{p:C()}],px:[{px:C()}],py:[{py:C()}],ps:[{ps:C()}],pe:[{pe:C()}],pt:[{pt:C()}],pr:[{pr:C()}],pb:[{pb:C()}],pl:[{pl:C()}],m:[{m:X()}],mx:[{mx:X()}],my:[{my:X()}],ms:[{ms:X()}],me:[{me:X()}],mt:[{mt:X()}],mr:[{mr:X()}],mb:[{mb:X()}],ml:[{ml:X()}],"space-x":[{"space-x":C()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":C()}],"space-y-reverse":["space-y-reverse"],size:[{size:Z()}],w:[{w:[l,"screen",...Z()]}],"min-w":[{"min-w":[l,"screen","none",...Z()]}],"max-w":[{"max-w":[l,"screen","none","prose",{screen:[o]},...Z()]}],h:[{h:["screen","lh",...Z()]}],"min-h":[{"min-h":["screen","lh","none",...Z()]}],"max-h":[{"max-h":["screen","lh",...Z()]}],"font-size":[{text:["base",t,Na,rr]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,Ae,wf]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Af,be]}],"font-family":[{font:[tC,be,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,Ae,be]}],"line-clamp":[{"line-clamp":[$e,"none",Ae,wf]}],leading:[{leading:[r,...C()]}],"list-image":[{"list-image":["none",Ae,be]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ae,be]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:F()}],"text-color":[{text:F()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...de(),"wavy"]}],"text-decoration-thickness":[{decoration:[$e,"from-font","auto",Ae,rr]}],"text-decoration-color":[{decoration:F()}],"underline-offset":[{"underline-offset":[$e,"auto",Ae,be]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ae,be]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ae,be]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ee()}],"bg-repeat":[{bg:J()}],"bg-size":[{bg:D()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Si,Ae,be],radial:["",Ae,be],conic:[Si,Ae,be]},sC,eC]}],"bg-color":[{bg:F()}],"gradient-from-pos":[{from:j()}],"gradient-via-pos":[{via:j()}],"gradient-to-pos":[{to:j()}],"gradient-from":[{from:F()}],"gradient-via":[{via:F()}],"gradient-to":[{to:F()}],rounded:[{rounded:ie()}],"rounded-s":[{"rounded-s":ie()}],"rounded-e":[{"rounded-e":ie()}],"rounded-t":[{"rounded-t":ie()}],"rounded-r":[{"rounded-r":ie()}],"rounded-b":[{"rounded-b":ie()}],"rounded-l":[{"rounded-l":ie()}],"rounded-ss":[{"rounded-ss":ie()}],"rounded-se":[{"rounded-se":ie()}],"rounded-ee":[{"rounded-ee":ie()}],"rounded-es":[{"rounded-es":ie()}],"rounded-tl":[{"rounded-tl":ie()}],"rounded-tr":[{"rounded-tr":ie()}],"rounded-br":[{"rounded-br":ie()}],"rounded-bl":[{"rounded-bl":ie()}],"border-w":[{border:ce()}],"border-w-x":[{"border-x":ce()}],"border-w-y":[{"border-y":ce()}],"border-w-s":[{"border-s":ce()}],"border-w-e":[{"border-e":ce()}],"border-w-t":[{"border-t":ce()}],"border-w-r":[{"border-r":ce()}],"border-w-b":[{"border-b":ce()}],"border-w-l":[{"border-l":ce()}],"divide-x":[{"divide-x":ce()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ce()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...de(),"hidden","none"]}],"divide-style":[{divide:[...de(),"hidden","none"]}],"border-color":[{border:F()}],"border-color-x":[{"border-x":F()}],"border-color-y":[{"border-y":F()}],"border-color-s":[{"border-s":F()}],"border-color-e":[{"border-e":F()}],"border-color-t":[{"border-t":F()}],"border-color-r":[{"border-r":F()}],"border-color-b":[{"border-b":F()}],"border-color-l":[{"border-l":F()}],"divide-color":[{divide:F()}],"outline-style":[{outline:[...de(),"none","hidden"]}],"outline-offset":[{"outline-offset":[$e,Ae,be]}],"outline-w":[{outline:["",$e,Na,rr]}],"outline-color":[{outline:F()}],shadow:[{shadow:["","none",h,Wc,zc]}],"shadow-color":[{shadow:F()}],"inset-shadow":[{"inset-shadow":["none",p,Wc,zc]}],"inset-shadow-color":[{"inset-shadow":F()}],"ring-w":[{ring:ce()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:F()}],"ring-offset-w":[{"ring-offset":[$e,rr]}],"ring-offset-color":[{"ring-offset":F()}],"inset-ring-w":[{"inset-ring":ce()}],"inset-ring-color":[{"inset-ring":F()}],"text-shadow":[{"text-shadow":["none",m,Wc,zc]}],"text-shadow-color":[{"text-shadow":F()}],opacity:[{opacity:[$e,Ae,be]}],"mix-blend":[{"mix-blend":[...fe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":fe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[$e]}],"mask-image-linear-from-pos":[{"mask-linear-from":ve()}],"mask-image-linear-to-pos":[{"mask-linear-to":ve()}],"mask-image-linear-from-color":[{"mask-linear-from":F()}],"mask-image-linear-to-color":[{"mask-linear-to":F()}],"mask-image-t-from-pos":[{"mask-t-from":ve()}],"mask-image-t-to-pos":[{"mask-t-to":ve()}],"mask-image-t-from-color":[{"mask-t-from":F()}],"mask-image-t-to-color":[{"mask-t-to":F()}],"mask-image-r-from-pos":[{"mask-r-from":ve()}],"mask-image-r-to-pos":[{"mask-r-to":ve()}],"mask-image-r-from-color":[{"mask-r-from":F()}],"mask-image-r-to-color":[{"mask-r-to":F()}],"mask-image-b-from-pos":[{"mask-b-from":ve()}],"mask-image-b-to-pos":[{"mask-b-to":ve()}],"mask-image-b-from-color":[{"mask-b-from":F()}],"mask-image-b-to-color":[{"mask-b-to":F()}],"mask-image-l-from-pos":[{"mask-l-from":ve()}],"mask-image-l-to-pos":[{"mask-l-to":ve()}],"mask-image-l-from-color":[{"mask-l-from":F()}],"mask-image-l-to-color":[{"mask-l-to":F()}],"mask-image-x-from-pos":[{"mask-x-from":ve()}],"mask-image-x-to-pos":[{"mask-x-to":ve()}],"mask-image-x-from-color":[{"mask-x-from":F()}],"mask-image-x-to-color":[{"mask-x-to":F()}],"mask-image-y-from-pos":[{"mask-y-from":ve()}],"mask-image-y-to-pos":[{"mask-y-to":ve()}],"mask-image-y-from-color":[{"mask-y-from":F()}],"mask-image-y-to-color":[{"mask-y-to":F()}],"mask-image-radial":[{"mask-radial":[Ae,be]}],"mask-image-radial-from-pos":[{"mask-radial-from":ve()}],"mask-image-radial-to-pos":[{"mask-radial-to":ve()}],"mask-image-radial-from-color":[{"mask-radial-from":F()}],"mask-image-radial-to-color":[{"mask-radial-to":F()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":I()}],"mask-image-conic-pos":[{"mask-conic":[$e]}],"mask-image-conic-from-pos":[{"mask-conic-from":ve()}],"mask-image-conic-to-pos":[{"mask-conic-to":ve()}],"mask-image-conic-from-color":[{"mask-conic-from":F()}],"mask-image-conic-to-color":[{"mask-conic-to":F()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ee()}],"mask-repeat":[{mask:J()}],"mask-size":[{mask:D()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ae,be]}],filter:[{filter:["","none",Ae,be]}],blur:[{blur:Ie()}],brightness:[{brightness:[$e,Ae,be]}],contrast:[{contrast:[$e,Ae,be]}],"drop-shadow":[{"drop-shadow":["","none",v,Wc,zc]}],"drop-shadow-color":[{"drop-shadow":F()}],grayscale:[{grayscale:["",$e,Ae,be]}],"hue-rotate":[{"hue-rotate":[$e,Ae,be]}],invert:[{invert:["",$e,Ae,be]}],saturate:[{saturate:[$e,Ae,be]}],sepia:[{sepia:["",$e,Ae,be]}],"backdrop-filter":[{"backdrop-filter":["","none",Ae,be]}],"backdrop-blur":[{"backdrop-blur":Ie()}],"backdrop-brightness":[{"backdrop-brightness":[$e,Ae,be]}],"backdrop-contrast":[{"backdrop-contrast":[$e,Ae,be]}],"backdrop-grayscale":[{"backdrop-grayscale":["",$e,Ae,be]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[$e,Ae,be]}],"backdrop-invert":[{"backdrop-invert":["",$e,Ae,be]}],"backdrop-opacity":[{"backdrop-opacity":[$e,Ae,be]}],"backdrop-saturate":[{"backdrop-saturate":[$e,Ae,be]}],"backdrop-sepia":[{"backdrop-sepia":["",$e,Ae,be]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":C()}],"border-spacing-x":[{"border-spacing-x":C()}],"border-spacing-y":[{"border-spacing-y":C()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ae,be]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[$e,"initial",Ae,be]}],ease:[{ease:["linear","initial",b,Ae,be]}],delay:[{delay:[$e,Ae,be]}],animate:[{animate:["none",w,Ae,be]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[S,Ae,be]}],"perspective-origin":[{"perspective-origin":k()}],rotate:[{rotate:Me()}],"rotate-x":[{"rotate-x":Me()}],"rotate-y":[{"rotate-y":Me()}],"rotate-z":[{"rotate-z":Me()}],scale:[{scale:Qe()}],"scale-x":[{"scale-x":Qe()}],"scale-y":[{"scale-y":Qe()}],"scale-z":[{"scale-z":Qe()}],"scale-3d":["scale-3d"],skew:[{skew:Lt()}],"skew-x":[{"skew-x":Lt()}],"skew-y":[{"skew-y":Lt()}],transform:[{transform:[Ae,be,"","none","gpu","cpu"]}],"transform-origin":[{origin:k()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:xe()}],"translate-x":[{"translate-x":xe()}],"translate-y":[{"translate-y":xe()}],"translate-z":[{"translate-z":xe()}],"translate-none":["translate-none"],accent:[{accent:F()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:F()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ae,be]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ae,be]}],fill:[{fill:["none",...F()]}],"stroke-w":[{stroke:[$e,Na,rr,wf]}],stroke:[{stroke:["none",...F()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},aC=jk(oC);function Rl(...s){return aC(e1(s))}const v1=B.forwardRef(({...s},e)=>A.jsx("div",{ref:e,className:"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",...s}));v1.displayName="ToastProvider";const x1=B.forwardRef(({...s},e)=>A.jsx("div",{ref:e,className:"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",...s}));x1.displayName="ToastViewport";const lC=XI("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),S1=B.forwardRef(({className:s,variant:e,...t},n)=>A.jsx("div",{ref:n,className:Rl(lC({variant:e}),s),...t}));S1.displayName="Toast";const cC=B.forwardRef(({className:s,...e},t)=>A.jsx("div",{ref:t,className:Rl("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...e}));cC.displayName="ToastAction";const E1=B.forwardRef(({className:s,...e},t)=>A.jsx("button",{ref:t,className:Rl("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...e,children:A.jsx(ad,{className:"h-4 w-4"})}));E1.displayName="ToastClose";const T1=B.forwardRef(({className:s,...e},t)=>A.jsx("div",{ref:t,className:Rl("text-sm font-semibold",s),...e}));T1.displayName="ToastTitle";const b1=B.forwardRef(({className:s,...e},t)=>A.jsx("div",{ref:t,className:Rl("text-sm opacity-90",s),...e}));b1.displayName="ToastDescription";function uC(){const{toasts:s}=QI();return A.jsxs(v1,{children:[s.map(function({id:e,title:t,description:n,action:i,...r}){return A.jsxs(S1,{...r,children:[A.jsxs("div",{className:"grid gap-1",children:[t&&A.jsx(T1,{children:t}),n&&A.jsx(b1,{children:n})]}),i,A.jsx(E1,{})]},e)}),A.jsx(x1,{})]})}var Ll=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(s){return this.listeners.add(s),this.onSubscribe(),()=>{this.listeners.delete(s),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},dC={setTimeout:(s,e)=>setTimeout(s,e),clearTimeout:s=>clearTimeout(s),setInterval:(s,e)=>setInterval(s,e),clearInterval:s=>clearInterval(s)},Li,Om,jT,hC=(jT=class{constructor(){Ce(this,Li,dC);Ce(this,Om,!1)}setTimeoutProvider(s){ge(this,Li,s)}setTimeout(s,e){return V(this,Li).setTimeout(s,e)}clearTimeout(s){V(this,Li).clearTimeout(s)}setInterval(s,e){return V(this,Li).setInterval(s,e)}clearInterval(s){V(this,Li).clearInterval(s)}},Li=new WeakMap,Om=new WeakMap,jT),hr=new hC;function fC(s){setTimeout(s,0)}var Ir=typeof window>"u"||"Deno"in globalThis;function vn(){}function pC(s,e){return typeof s=="function"?s(e):s}function wp(s){return typeof s=="number"&&s>=0&&s!==1/0}function A1(s,e){return Math.max(s+(e||0)-Date.now(),0)}function Mi(s,e){return typeof s=="function"?s(e):s}function Kn(s,e){return typeof s=="function"?s(e):s}function lx(s,e){const{type:t="all",exact:n,fetchStatus:i,predicate:r,queryKey:o,stale:l}=s;if(o){if(n){if(e.queryHash!==Um(o,e.options))return!1}else if(!ll(e.queryKey,o))return!1}if(t!=="all"){const u=e.isActive();if(t==="active"&&!u||t==="inactive"&&u)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||i&&i!==e.state.fetchStatus||r&&!r(e))}function cx(s,e){const{exact:t,status:n,predicate:i,mutationKey:r}=s;if(r){if(!e.options.mutationKey)return!1;if(t){if(al(e.options.mutationKey)!==al(r))return!1}else if(!ll(e.options.mutationKey,r))return!1}return!(n&&e.state.status!==n||i&&!i(e))}function Um(s,e){return((e==null?void 0:e.queryKeyHashFn)||al)(s)}function al(s){return JSON.stringify(s,(e,t)=>Lp(t)?Object.keys(t).sort().reduce((n,i)=>(n[i]=t[i],n),{}):t)}function ll(s,e){return s===e?!0:typeof s!=typeof e?!1:s&&e&&typeof s=="object"&&typeof e=="object"?Object.keys(e).every(t=>ll(s[t],e[t])):!1}var mC=Object.prototype.hasOwnProperty;function w1(s,e){if(s===e)return s;const t=ux(s)&&ux(e);if(!t&&!(Lp(s)&&Lp(e)))return e;const i=(t?s:Object.keys(s)).length,r=t?e:Object.keys(e),o=r.length,l=t?new Array(o):{};let u=0;for(let d=0;d<o;d++){const h=t?d:r[d],p=s[h],m=e[h];if(p===m){l[h]=p,(t?d<i:mC.call(s,h))&&u++;continue}if(p===null||m===null||typeof p!="object"||typeof m!="object"){l[h]=m;continue}const v=w1(p,m);l[h]=v,v===p&&u++}return i===o&&u===i?s:l}function Rp(s,e){if(!e||Object.keys(s).length!==Object.keys(e).length)return!1;for(const t in s)if(s[t]!==e[t])return!1;return!0}function ux(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function Lp(s){if(!dx(s))return!1;const e=s.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!dx(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(s)!==Object.prototype)}function dx(s){return Object.prototype.toString.call(s)==="[object Object]"}function gC(s){return new Promise(e=>{hr.setTimeout(e,s)})}function Ip(s,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(s,e):t.structuralSharing!==!1?w1(s,e):e}function yC(s,e,t=0){const n=[...s,e];return t&&n.length>t?n.slice(1):n}function vC(s,e,t=0){const n=[e,...s];return t&&n.length>t?n.slice(0,-1):n}var $m=Symbol();function R1(s,e){return!s.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!s.queryFn||s.queryFn===$m?()=>Promise.reject(new Error(`Missing queryFn: '${s.queryHash}'`)):s.queryFn}function xC(s,e){return typeof s=="function"?s(...e):!!s}var gr,Ii,wo,VT,SC=(VT=class extends Ll{constructor(){super();Ce(this,gr);Ce(this,Ii);Ce(this,wo);ge(this,wo,e=>{if(!Ir&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){V(this,Ii)||this.setEventListener(V(this,wo))}onUnsubscribe(){var e;this.hasListeners()||((e=V(this,Ii))==null||e.call(this),ge(this,Ii,void 0))}setEventListener(e){var t;ge(this,wo,e),(t=V(this,Ii))==null||t.call(this),ge(this,Ii,e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(e){V(this,gr)!==e&&(ge(this,gr,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof V(this,gr)=="boolean"?V(this,gr):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},gr=new WeakMap,Ii=new WeakMap,wo=new WeakMap,VT),jm=new SC;function _p(){let s,e;const t=new Promise((i,r)=>{s=i,e=r});t.status="pending",t.catch(()=>{});function n(i){Object.assign(t,i),delete t.resolve,delete t.reject}return t.resolve=i=>{n({status:"fulfilled",value:i}),s(i)},t.reject=i=>{n({status:"rejected",reason:i}),e(i)},t}var EC=fC;function TC(){let s=[],e=0,t=l=>{l()},n=l=>{l()},i=EC;const r=l=>{e?s.push(l):i(()=>{t(l)})},o=()=>{const l=s;s=[],l.length&&i(()=>{n(()=>{l.forEach(u=>{t(u)})})})};return{batch:l=>{let u;e++;try{u=l()}finally{e--,e||o()}return u},batchCalls:l=>(...u)=>{r(()=>{l(...u)})},schedule:r,setNotifyFunction:l=>{t=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{i=l}}}var zt=TC(),Ro,_i,Lo,GT,bC=(GT=class extends Ll{constructor(){super();Ce(this,Ro,!0);Ce(this,_i);Ce(this,Lo);ge(this,Lo,e=>{if(!Ir&&window.addEventListener){const t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}})}onSubscribe(){V(this,_i)||this.setEventListener(V(this,Lo))}onUnsubscribe(){var e;this.hasListeners()||((e=V(this,_i))==null||e.call(this),ge(this,_i,void 0))}setEventListener(e){var t;ge(this,Lo,e),(t=V(this,_i))==null||t.call(this),ge(this,_i,e(this.setOnline.bind(this)))}setOnline(e){V(this,Ro)!==e&&(ge(this,Ro,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return V(this,Ro)}},Ro=new WeakMap,_i=new WeakMap,Lo=new WeakMap,GT),Bu=new bC;function AC(s){return Math.min(1e3*2**s,3e4)}function L1(s){return(s??"online")==="online"?Bu.isOnline():!0}var kp=class extends Error{constructor(s){super("CancelledError"),this.revert=s==null?void 0:s.revert,this.silent=s==null?void 0:s.silent}};function I1(s){let e=!1,t=0,n;const i=_p(),r=()=>i.status!=="pending",o=S=>{var x;if(!r()){const b=new kp(S);m(b),(x=s.onCancel)==null||x.call(s,b)}},l=()=>{e=!0},u=()=>{e=!1},d=()=>jm.isFocused()&&(s.networkMode==="always"||Bu.isOnline())&&s.canRun(),h=()=>L1(s.networkMode)&&s.canRun(),p=S=>{r()||(n==null||n(),i.resolve(S))},m=S=>{r()||(n==null||n(),i.reject(S))},v=()=>new Promise(S=>{var x;n=b=>{(r()||d())&&S(b)},(x=s.onPause)==null||x.call(s)}).then(()=>{var S;n=void 0,r()||(S=s.onContinue)==null||S.call(s)}),y=()=>{if(r())return;let S;const x=t===0?s.initialPromise:void 0;try{S=x??s.fn()}catch(b){S=Promise.reject(b)}Promise.resolve(S).then(p).catch(b=>{var M;if(r())return;const w=s.retry??(Ir?0:3),L=s.retryDelay??AC,I=typeof L=="function"?L(t,b):L,k=w===!0||typeof w=="number"&&t<w||typeof w=="function"&&w(t,b);if(e||!k){m(b);return}t++,(M=s.onFail)==null||M.call(s,t,b),gC(I).then(()=>d()?void 0:v()).then(()=>{e?m(b):y()})})};return{promise:i,status:()=>i.status,cancel:o,continue:()=>(n==null||n(),i),cancelRetry:l,continueRetry:u,canStart:h,start:()=>(h()?y():v().then(y),i)}}var yr,KT,_1=(KT=class{constructor(){Ce(this,yr)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),wp(this.gcTime)&&ge(this,yr,hr.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(s){this.gcTime=Math.max(this.gcTime||0,s??(Ir?1/0:300*1e3))}clearGcTimeout(){V(this,yr)&&(hr.clearTimeout(V(this,yr)),ge(this,yr,void 0))}},yr=new WeakMap,KT),vr,Io,Gn,xr,Ft,El,Sr,as,Gs,HT,wC=(HT=class extends _1{constructor(e){super();Ce(this,as);Ce(this,vr);Ce(this,Io);Ce(this,Gn);Ce(this,xr);Ce(this,Ft);Ce(this,El);Ce(this,Sr);ge(this,Sr,!1),ge(this,El,e.defaultOptions),this.setOptions(e.options),this.observers=[],ge(this,xr,e.client),ge(this,Gn,V(this,xr).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,ge(this,vr,hx(this.options)),this.state=e.state??V(this,vr),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=V(this,Ft))==null?void 0:e.promise}setOptions(e){if(this.options={...V(this,El),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=hx(this.options);t.data!==void 0&&(this.setData(t.data,{updatedAt:t.dataUpdatedAt,manual:!0}),ge(this,vr,t))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&V(this,Gn).remove(this)}setData(e,t){const n=Ip(this.state.data,e,this.options);return Ke(this,as,Gs).call(this,{data:n,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),n}setState(e,t){Ke(this,as,Gs).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var n,i;const t=(n=V(this,Ft))==null?void 0:n.promise;return(i=V(this,Ft))==null||i.cancel(e),t?t.then(vn).catch(vn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(V(this,vr))}isActive(){return this.observers.some(e=>Kn(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===$m||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Mi(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!A1(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=V(this,Ft))==null||t.continue()}onOnline(){var t;const e=this.observers.find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=V(this,Ft))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),V(this,Gn).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(V(this,Ft)&&(V(this,Sr)?V(this,Ft).cancel({revert:!0}):V(this,Ft).cancelRetry()),this.scheduleGc()),V(this,Gn).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ke(this,as,Gs).call(this,{type:"invalidate"})}async fetch(e,t){var u,d,h,p,m,v,y,S,x,b,w,L;if(this.state.fetchStatus!=="idle"&&((u=V(this,Ft))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(V(this,Ft))return V(this,Ft).continueRetry(),V(this,Ft).promise}if(e&&this.setOptions(e),!this.options.queryFn){const I=this.observers.find(k=>k.options.queryFn);I&&this.setOptions(I.options)}const n=new AbortController,i=I=>{Object.defineProperty(I,"signal",{enumerable:!0,get:()=>(ge(this,Sr,!0),n.signal)})},r=()=>{const I=R1(this.options,t),M=(()=>{const P={client:V(this,xr),queryKey:this.queryKey,meta:this.meta};return i(P),P})();return ge(this,Sr,!1),this.options.persister?this.options.persister(I,M,this):I(M)},l=(()=>{const I={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:V(this,xr),state:this.state,fetchFn:r};return i(I),I})();(d=this.options.behavior)==null||d.onFetch(l,this),ge(this,Io,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=l.fetchOptions)==null?void 0:h.meta))&&Ke(this,as,Gs).call(this,{type:"fetch",meta:(p=l.fetchOptions)==null?void 0:p.meta}),ge(this,Ft,I1({initialPromise:t==null?void 0:t.initialPromise,fn:l.fetchFn,onCancel:I=>{I instanceof kp&&I.revert&&this.setState({...V(this,Io),fetchStatus:"idle"}),n.abort()},onFail:(I,k)=>{Ke(this,as,Gs).call(this,{type:"failed",failureCount:I,error:k})},onPause:()=>{Ke(this,as,Gs).call(this,{type:"pause"})},onContinue:()=>{Ke(this,as,Gs).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const I=await V(this,Ft).start();if(I===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(I),(v=(m=V(this,Gn).config).onSuccess)==null||v.call(m,I,this),(S=(y=V(this,Gn).config).onSettled)==null||S.call(y,I,this.state.error,this),I}catch(I){if(I instanceof kp){if(I.silent)return V(this,Ft).promise;if(I.revert){if(this.state.data===void 0)throw I;return this.state.data}}throw Ke(this,as,Gs).call(this,{type:"error",error:I}),(b=(x=V(this,Gn).config).onError)==null||b.call(x,I,this),(L=(w=V(this,Gn).config).onSettled)==null||L.call(w,this.state.data,I,this),I}finally{this.scheduleGc()}}},vr=new WeakMap,Io=new WeakMap,Gn=new WeakMap,xr=new WeakMap,Ft=new WeakMap,El=new WeakMap,Sr=new WeakMap,as=new WeakSet,Gs=function(e){const t=n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...k1(n.data,this.options),fetchMeta:e.meta??null};case"success":const i={...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ge(this,Io,e.manual?i:void 0),i;case"error":const r=e.error;return{...n,error:r,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=t(this.state),zt.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),V(this,Gn).notify({query:this,type:"updated",action:e})})},HT);function k1(s,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:L1(e.networkMode)?"fetching":"paused",...s===void 0&&{error:null,status:"pending"}}}function hx(s){const e=typeof s.initialData=="function"?s.initialData():s.initialData,t=e!==void 0,n=t?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var yn,He,Tl,an,Er,_o,zs,ki,bl,ko,Co,Tr,br,Ci,Po,Xe,Ga,Cp,Pp,Dp,Op,Np,Mp,Fp,C1,zT,RC=(zT=class extends Ll{constructor(e,t){super();Ce(this,Xe);Ce(this,yn);Ce(this,He);Ce(this,Tl);Ce(this,an);Ce(this,Er);Ce(this,_o);Ce(this,zs);Ce(this,ki);Ce(this,bl);Ce(this,ko);Ce(this,Co);Ce(this,Tr);Ce(this,br);Ce(this,Ci);Ce(this,Po,new Set);this.options=t,ge(this,yn,e),ge(this,ki,null),ge(this,zs,_p()),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(V(this,He).addObserver(this),fx(V(this,He),this.options)?Ke(this,Xe,Ga).call(this):this.updateResult(),Ke(this,Xe,Op).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Bp(V(this,He),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Bp(V(this,He),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ke(this,Xe,Np).call(this),Ke(this,Xe,Mp).call(this),V(this,He).removeObserver(this)}setOptions(e){const t=this.options,n=V(this,He);if(this.options=V(this,yn).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Kn(this.options.enabled,V(this,He))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ke(this,Xe,Fp).call(this),V(this,He).setOptions(this.options),t._defaulted&&!Rp(this.options,t)&&V(this,yn).getQueryCache().notify({type:"observerOptionsUpdated",query:V(this,He),observer:this});const i=this.hasListeners();i&&px(V(this,He),n,this.options,t)&&Ke(this,Xe,Ga).call(this),this.updateResult(),i&&(V(this,He)!==n||Kn(this.options.enabled,V(this,He))!==Kn(t.enabled,V(this,He))||Mi(this.options.staleTime,V(this,He))!==Mi(t.staleTime,V(this,He)))&&Ke(this,Xe,Cp).call(this);const r=Ke(this,Xe,Pp).call(this);i&&(V(this,He)!==n||Kn(this.options.enabled,V(this,He))!==Kn(t.enabled,V(this,He))||r!==V(this,Ci))&&Ke(this,Xe,Dp).call(this,r)}getOptimisticResult(e){const t=V(this,yn).getQueryCache().build(V(this,yn),e),n=this.createResult(t,e);return IC(this,n)&&(ge(this,an,n),ge(this,_o,this.options),ge(this,Er,V(this,He).state)),n}getCurrentResult(){return V(this,an)}trackResult(e,t){return new Proxy(e,{get:(n,i)=>(this.trackProp(i),t==null||t(i),i==="promise"&&!this.options.experimental_prefetchInRender&&V(this,zs).status==="pending"&&V(this,zs).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(n,i))})}trackProp(e){V(this,Po).add(e)}getCurrentQuery(){return V(this,He)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=V(this,yn).defaultQueryOptions(e),n=V(this,yn).getQueryCache().build(V(this,yn),t);return n.fetch().then(()=>this.createResult(n,t))}fetch(e){return Ke(this,Xe,Ga).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),V(this,an)))}createResult(e,t){var U;const n=V(this,He),i=this.options,r=V(this,an),o=V(this,Er),l=V(this,_o),d=e!==n?e.state:V(this,Tl),{state:h}=e;let p={...h},m=!1,v;if(t._optimisticResults){const O=this.hasListeners(),W=!O&&fx(e,t),ne=O&&px(e,n,t,i);(W||ne)&&(p={...p,...k1(h.data,e.options)}),t._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:y,errorUpdatedAt:S,status:x}=p;v=p.data;let b=!1;if(t.placeholderData!==void 0&&v===void 0&&x==="pending"){let O;r!=null&&r.isPlaceholderData&&t.placeholderData===(l==null?void 0:l.placeholderData)?(O=r.data,b=!0):O=typeof t.placeholderData=="function"?t.placeholderData((U=V(this,Co))==null?void 0:U.state.data,V(this,Co)):t.placeholderData,O!==void 0&&(x="success",v=Ip(r==null?void 0:r.data,O,t),m=!0)}if(t.select&&v!==void 0&&!b)if(r&&v===(o==null?void 0:o.data)&&t.select===V(this,bl))v=V(this,ko);else try{ge(this,bl,t.select),v=t.select(v),v=Ip(r==null?void 0:r.data,v,t),ge(this,ko,v),ge(this,ki,null)}catch(O){ge(this,ki,O)}V(this,ki)&&(y=V(this,ki),v=V(this,ko),S=Date.now(),x="error");const w=p.fetchStatus==="fetching",L=x==="pending",I=x==="error",k=L&&w,M=v!==void 0,C={status:x,fetchStatus:p.fetchStatus,isPending:L,isSuccess:x==="success",isError:I,isInitialLoading:k,isLoading:k,data:v,dataUpdatedAt:p.dataUpdatedAt,error:y,errorUpdatedAt:S,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:w,isRefetching:w&&!L,isLoadingError:I&&!M,isPaused:p.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:I&&M,isStale:Vm(e,t),refetch:this.refetch,promise:V(this,zs),isEnabled:Kn(t.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const O=oe=>{C.status==="error"?oe.reject(C.error):C.data!==void 0&&oe.resolve(C.data)},W=()=>{const oe=ge(this,zs,C.promise=_p());O(oe)},ne=V(this,zs);switch(ne.status){case"pending":e.queryHash===n.queryHash&&O(ne);break;case"fulfilled":(C.status==="error"||C.data!==ne.value)&&W();break;case"rejected":(C.status!=="error"||C.error!==ne.reason)&&W();break}}return C}updateResult(){const e=V(this,an),t=this.createResult(V(this,He),this.options);if(ge(this,Er,V(this,He).state),ge(this,_o,this.options),V(this,Er).data!==void 0&&ge(this,Co,V(this,He)),Rp(t,e))return;ge(this,an,t);const n=()=>{if(!e)return!0;const{notifyOnChangeProps:i}=this.options,r=typeof i=="function"?i():i;if(r==="all"||!r&&!V(this,Po).size)return!0;const o=new Set(r??V(this,Po));return this.options.throwOnError&&o.add("error"),Object.keys(V(this,an)).some(l=>{const u=l;return V(this,an)[u]!==e[u]&&o.has(u)})};Ke(this,Xe,C1).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ke(this,Xe,Op).call(this)}},yn=new WeakMap,He=new WeakMap,Tl=new WeakMap,an=new WeakMap,Er=new WeakMap,_o=new WeakMap,zs=new WeakMap,ki=new WeakMap,bl=new WeakMap,ko=new WeakMap,Co=new WeakMap,Tr=new WeakMap,br=new WeakMap,Ci=new WeakMap,Po=new WeakMap,Xe=new WeakSet,Ga=function(e){Ke(this,Xe,Fp).call(this);let t=V(this,He).fetch(this.options,e);return e!=null&&e.throwOnError||(t=t.catch(vn)),t},Cp=function(){Ke(this,Xe,Np).call(this);const e=Mi(this.options.staleTime,V(this,He));if(Ir||V(this,an).isStale||!wp(e))return;const n=A1(V(this,an).dataUpdatedAt,e)+1;ge(this,Tr,hr.setTimeout(()=>{V(this,an).isStale||this.updateResult()},n))},Pp=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(V(this,He)):this.options.refetchInterval)??!1},Dp=function(e){Ke(this,Xe,Mp).call(this),ge(this,Ci,e),!(Ir||Kn(this.options.enabled,V(this,He))===!1||!wp(V(this,Ci))||V(this,Ci)===0)&&ge(this,br,hr.setInterval(()=>{(this.options.refetchIntervalInBackground||jm.isFocused())&&Ke(this,Xe,Ga).call(this)},V(this,Ci)))},Op=function(){Ke(this,Xe,Cp).call(this),Ke(this,Xe,Dp).call(this,Ke(this,Xe,Pp).call(this))},Np=function(){V(this,Tr)&&(hr.clearTimeout(V(this,Tr)),ge(this,Tr,void 0))},Mp=function(){V(this,br)&&(hr.clearInterval(V(this,br)),ge(this,br,void 0))},Fp=function(){const e=V(this,yn).getQueryCache().build(V(this,yn),this.options);if(e===V(this,He))return;const t=V(this,He);ge(this,He,e),ge(this,Tl,e.state),this.hasListeners()&&(t==null||t.removeObserver(this),e.addObserver(this))},C1=function(e){zt.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(V(this,an))}),V(this,yn).getQueryCache().notify({query:V(this,He),type:"observerResultsUpdated"})})},zT);function LC(s,e){return Kn(e.enabled,s)!==!1&&s.state.data===void 0&&!(s.state.status==="error"&&e.retryOnMount===!1)}function fx(s,e){return LC(s,e)||s.state.data!==void 0&&Bp(s,e,e.refetchOnMount)}function Bp(s,e,t){if(Kn(e.enabled,s)!==!1&&Mi(e.staleTime,s)!=="static"){const n=typeof t=="function"?t(s):t;return n==="always"||n!==!1&&Vm(s,e)}return!1}function px(s,e,t,n){return(s!==e||Kn(n.enabled,s)===!1)&&(!t.suspense||s.state.status!=="error")&&Vm(s,t)}function Vm(s,e){return Kn(e.enabled,s)!==!1&&s.isStaleByTime(Mi(e.staleTime,s))}function IC(s,e){return!Rp(s.getCurrentResult(),e)}function mx(s){return{onFetch:(e,t)=>{var h,p,m,v,y;const n=e.options,i=(m=(p=(h=e.fetchOptions)==null?void 0:h.meta)==null?void 0:p.fetchMore)==null?void 0:m.direction,r=((v=e.state.data)==null?void 0:v.pages)||[],o=((y=e.state.data)==null?void 0:y.pageParams)||[];let l={pages:[],pageParams:[]},u=0;const d=async()=>{let S=!1;const x=L=>{Object.defineProperty(L,"signal",{enumerable:!0,get:()=>(e.signal.aborted?S=!0:e.signal.addEventListener("abort",()=>{S=!0}),e.signal)})},b=R1(e.options,e.fetchOptions),w=async(L,I,k)=>{if(S)return Promise.reject();if(I==null&&L.pages.length)return Promise.resolve(L);const P=(()=>{const W={client:e.client,queryKey:e.queryKey,pageParam:I,direction:k?"backward":"forward",meta:e.options.meta};return x(W),W})(),C=await b(P),{maxPages:U}=e.options,O=k?vC:yC;return{pages:O(L.pages,C,U),pageParams:O(L.pageParams,I,U)}};if(i&&r.length){const L=i==="backward",I=L?_C:gx,k={pages:r,pageParams:o},M=I(n,k);l=await w(k,M,L)}else{const L=s??r.length;do{const I=u===0?o[0]??n.initialPageParam:gx(n,l);if(u>0&&I==null)break;l=await w(l,I),u++}while(u<L)}return l};e.options.persister?e.fetchFn=()=>{var S,x;return(x=(S=e.options).persister)==null?void 0:x.call(S,d,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=d}}}function gx(s,{pages:e,pageParams:t}){const n=e.length-1;return e.length>0?s.getNextPageParam(e[n],e,t[n],t):void 0}function _C(s,{pages:e,pageParams:t}){var n;return e.length>0?(n=s.getPreviousPageParam)==null?void 0:n.call(s,e[0],e,t[0],t):void 0}var Al,Ss,ln,Ar,Es,bi,WT,kC=(WT=class extends _1{constructor(e){super();Ce(this,Es);Ce(this,Al);Ce(this,Ss);Ce(this,ln);Ce(this,Ar);ge(this,Al,e.client),this.mutationId=e.mutationId,ge(this,ln,e.mutationCache),ge(this,Ss,[]),this.state=e.state||CC(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){V(this,Ss).includes(e)||(V(this,Ss).push(e),this.clearGcTimeout(),V(this,ln).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){ge(this,Ss,V(this,Ss).filter(t=>t!==e)),this.scheduleGc(),V(this,ln).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){V(this,Ss).length||(this.state.status==="pending"?this.scheduleGc():V(this,ln).remove(this))}continue(){var e;return((e=V(this,Ar))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var o,l,u,d,h,p,m,v,y,S,x,b,w,L,I,k,M,P,C,U;const t=()=>{Ke(this,Es,bi).call(this,{type:"continue"})},n={client:V(this,Al),meta:this.options.meta,mutationKey:this.options.mutationKey};ge(this,Ar,I1({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(new Error("No mutationFn found")),onFail:(O,W)=>{Ke(this,Es,bi).call(this,{type:"failed",failureCount:O,error:W})},onPause:()=>{Ke(this,Es,bi).call(this,{type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>V(this,ln).canRun(this)}));const i=this.state.status==="pending",r=!V(this,Ar).canStart();try{if(i)t();else{Ke(this,Es,bi).call(this,{type:"pending",variables:e,isPaused:r}),await((l=(o=V(this,ln).config).onMutate)==null?void 0:l.call(o,e,this,n));const W=await((d=(u=this.options).onMutate)==null?void 0:d.call(u,e,n));W!==this.state.context&&Ke(this,Es,bi).call(this,{type:"pending",context:W,variables:e,isPaused:r})}const O=await V(this,Ar).start();return await((p=(h=V(this,ln).config).onSuccess)==null?void 0:p.call(h,O,e,this.state.context,this,n)),await((v=(m=this.options).onSuccess)==null?void 0:v.call(m,O,e,this.state.context,n)),await((S=(y=V(this,ln).config).onSettled)==null?void 0:S.call(y,O,null,this.state.variables,this.state.context,this,n)),await((b=(x=this.options).onSettled)==null?void 0:b.call(x,O,null,e,this.state.context,n)),Ke(this,Es,bi).call(this,{type:"success",data:O}),O}catch(O){try{throw await((L=(w=V(this,ln).config).onError)==null?void 0:L.call(w,O,e,this.state.context,this,n)),await((k=(I=this.options).onError)==null?void 0:k.call(I,O,e,this.state.context,n)),await((P=(M=V(this,ln).config).onSettled)==null?void 0:P.call(M,void 0,O,this.state.variables,this.state.context,this,n)),await((U=(C=this.options).onSettled)==null?void 0:U.call(C,void 0,O,e,this.state.context,n)),O}finally{Ke(this,Es,bi).call(this,{type:"error",error:O})}}finally{V(this,ln).runNext(this)}}},Al=new WeakMap,Ss=new WeakMap,ln=new WeakMap,Ar=new WeakMap,Es=new WeakSet,bi=function(e){const t=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),zt.batch(()=>{V(this,Ss).forEach(n=>{n.onMutationUpdate(e)}),V(this,ln).notify({mutation:this,type:"updated",action:e})})},WT);function CC(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ws,ls,wl,qT,PC=(qT=class extends Ll{constructor(e={}){super();Ce(this,Ws);Ce(this,ls);Ce(this,wl);this.config=e,ge(this,Ws,new Set),ge(this,ls,new Map),ge(this,wl,0)}build(e,t,n){const i=new kC({client:e,mutationCache:this,mutationId:++Kc(this,wl)._,options:e.defaultMutationOptions(t),state:n});return this.add(i),i}add(e){V(this,Ws).add(e);const t=qc(e);if(typeof t=="string"){const n=V(this,ls).get(t);n?n.push(e):V(this,ls).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(V(this,Ws).delete(e)){const t=qc(e);if(typeof t=="string"){const n=V(this,ls).get(t);if(n)if(n.length>1){const i=n.indexOf(e);i!==-1&&n.splice(i,1)}else n[0]===e&&V(this,ls).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=qc(e);if(typeof t=="string"){const n=V(this,ls).get(t),i=n==null?void 0:n.find(r=>r.state.status==="pending");return!i||i===e}else return!0}runNext(e){var n;const t=qc(e);if(typeof t=="string"){const i=(n=V(this,ls).get(t))==null?void 0:n.find(r=>r!==e&&r.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){zt.batch(()=>{V(this,Ws).forEach(e=>{this.notify({type:"removed",mutation:e})}),V(this,Ws).clear(),V(this,ls).clear()})}getAll(){return Array.from(V(this,Ws))}find(e){const t={exact:!0,...e};return this.getAll().find(n=>cx(t,n))}findAll(e={}){return this.getAll().filter(t=>cx(e,t))}notify(e){zt.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return zt.batch(()=>Promise.all(e.map(t=>t.continue().catch(vn))))}},Ws=new WeakMap,ls=new WeakMap,wl=new WeakMap,qT);function qc(s){var e;return(e=s.options.scope)==null?void 0:e.id}var Ts,YT,DC=(YT=class extends Ll{constructor(e={}){super();Ce(this,Ts);this.config=e,ge(this,Ts,new Map)}build(e,t,n){const i=t.queryKey,r=t.queryHash??Um(i,t);let o=this.get(r);return o||(o=new wC({client:e,queryKey:i,queryHash:r,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(i)}),this.add(o)),o}add(e){V(this,Ts).has(e.queryHash)||(V(this,Ts).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=V(this,Ts).get(e.queryHash);t&&(e.destroy(),t===e&&V(this,Ts).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){zt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return V(this,Ts).get(e)}getAll(){return[...V(this,Ts).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(n=>lx(t,n))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(n=>lx(e,n)):t}notify(e){zt.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){zt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){zt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Ts=new WeakMap,YT),yt,Pi,Di,Do,Oo,Oi,No,Mo,QT,OC=(QT=class{constructor(s={}){Ce(this,yt);Ce(this,Pi);Ce(this,Di);Ce(this,Do);Ce(this,Oo);Ce(this,Oi);Ce(this,No);Ce(this,Mo);ge(this,yt,s.queryCache||new DC),ge(this,Pi,s.mutationCache||new PC),ge(this,Di,s.defaultOptions||{}),ge(this,Do,new Map),ge(this,Oo,new Map),ge(this,Oi,0)}mount(){Kc(this,Oi)._++,V(this,Oi)===1&&(ge(this,No,jm.subscribe(async s=>{s&&(await this.resumePausedMutations(),V(this,yt).onFocus())})),ge(this,Mo,Bu.subscribe(async s=>{s&&(await this.resumePausedMutations(),V(this,yt).onOnline())})))}unmount(){var s,e;Kc(this,Oi)._--,V(this,Oi)===0&&((s=V(this,No))==null||s.call(this),ge(this,No,void 0),(e=V(this,Mo))==null||e.call(this),ge(this,Mo,void 0))}isFetching(s){return V(this,yt).findAll({...s,fetchStatus:"fetching"}).length}isMutating(s){return V(this,Pi).findAll({...s,status:"pending"}).length}getQueryData(s){var t;const e=this.defaultQueryOptions({queryKey:s});return(t=V(this,yt).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(s){const e=this.defaultQueryOptions(s),t=V(this,yt).build(this,e),n=t.state.data;return n===void 0?this.fetchQuery(s):(s.revalidateIfStale&&t.isStaleByTime(Mi(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(s){return V(this,yt).findAll(s).map(({queryKey:e,state:t})=>{const n=t.data;return[e,n]})}setQueryData(s,e,t){const n=this.defaultQueryOptions({queryKey:s}),i=V(this,yt).get(n.queryHash),r=i==null?void 0:i.state.data,o=pC(e,r);if(o!==void 0)return V(this,yt).build(this,n).setData(o,{...t,manual:!0})}setQueriesData(s,e,t){return zt.batch(()=>V(this,yt).findAll(s).map(({queryKey:n})=>[n,this.setQueryData(n,e,t)]))}getQueryState(s){var t;const e=this.defaultQueryOptions({queryKey:s});return(t=V(this,yt).get(e.queryHash))==null?void 0:t.state}removeQueries(s){const e=V(this,yt);zt.batch(()=>{e.findAll(s).forEach(t=>{e.remove(t)})})}resetQueries(s,e){const t=V(this,yt);return zt.batch(()=>(t.findAll(s).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...s},e)))}cancelQueries(s,e={}){const t={revert:!0,...e},n=zt.batch(()=>V(this,yt).findAll(s).map(i=>i.cancel(t)));return Promise.all(n).then(vn).catch(vn)}invalidateQueries(s,e={}){return zt.batch(()=>(V(this,yt).findAll(s).forEach(t=>{t.invalidate()}),(s==null?void 0:s.refetchType)==="none"?Promise.resolve():this.refetchQueries({...s,type:(s==null?void 0:s.refetchType)??(s==null?void 0:s.type)??"active"},e)))}refetchQueries(s,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},n=zt.batch(()=>V(this,yt).findAll(s).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let r=i.fetch(void 0,t);return t.throwOnError||(r=r.catch(vn)),i.state.fetchStatus==="paused"?Promise.resolve():r}));return Promise.all(n).then(vn)}fetchQuery(s){const e=this.defaultQueryOptions(s);e.retry===void 0&&(e.retry=!1);const t=V(this,yt).build(this,e);return t.isStaleByTime(Mi(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(s){return this.fetchQuery(s).then(vn).catch(vn)}fetchInfiniteQuery(s){return s.behavior=mx(s.pages),this.fetchQuery(s)}prefetchInfiniteQuery(s){return this.fetchInfiniteQuery(s).then(vn).catch(vn)}ensureInfiniteQueryData(s){return s.behavior=mx(s.pages),this.ensureQueryData(s)}resumePausedMutations(){return Bu.isOnline()?V(this,Pi).resumePausedMutations():Promise.resolve()}getQueryCache(){return V(this,yt)}getMutationCache(){return V(this,Pi)}getDefaultOptions(){return V(this,Di)}setDefaultOptions(s){ge(this,Di,s)}setQueryDefaults(s,e){V(this,Do).set(al(s),{queryKey:s,defaultOptions:e})}getQueryDefaults(s){const e=[...V(this,Do).values()],t={};return e.forEach(n=>{ll(s,n.queryKey)&&Object.assign(t,n.defaultOptions)}),t}setMutationDefaults(s,e){V(this,Oo).set(al(s),{mutationKey:s,defaultOptions:e})}getMutationDefaults(s){const e=[...V(this,Oo).values()],t={};return e.forEach(n=>{ll(s,n.mutationKey)&&Object.assign(t,n.defaultOptions)}),t}defaultQueryOptions(s){if(s._defaulted)return s;const e={...V(this,Di).queries,...this.getQueryDefaults(s.queryKey),...s,_defaulted:!0};return e.queryHash||(e.queryHash=Um(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===$m&&(e.enabled=!1),e}defaultMutationOptions(s){return s!=null&&s._defaulted?s:{...V(this,Di).mutations,...(s==null?void 0:s.mutationKey)&&this.getMutationDefaults(s.mutationKey),...s,_defaulted:!0}}clear(){V(this,yt).clear(),V(this,Pi).clear()}},yt=new WeakMap,Pi=new WeakMap,Di=new WeakMap,Do=new WeakMap,Oo=new WeakMap,Oi=new WeakMap,No=new WeakMap,Mo=new WeakMap,QT),P1=B.createContext(void 0),NC=s=>{const e=B.useContext(P1);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},MC=({client:s,children:e})=>(B.useEffect(()=>(s.mount(),()=>{s.unmount()}),[s]),A.jsx(P1.Provider,{value:s,children:e})),D1=B.createContext(!1),FC=()=>B.useContext(D1);D1.Provider;function BC(){let s=!1;return{clearReset:()=>{s=!1},reset:()=>{s=!0},isReset:()=>s}}var UC=B.createContext(BC()),$C=()=>B.useContext(UC),jC=(s,e)=>{(s.suspense||s.throwOnError||s.experimental_prefetchInRender)&&(e.isReset()||(s.retryOnMount=!1))},VC=s=>{B.useEffect(()=>{s.clearReset()},[s])},GC=({result:s,errorResetBoundary:e,throwOnError:t,query:n,suspense:i})=>s.isError&&!e.isReset()&&!s.isFetching&&n&&(i&&s.data===void 0||xC(t,[s.error,n])),KC=s=>{if(s.suspense){const t=i=>i==="static"?i:Math.max(i??1e3,1e3),n=s.staleTime;s.staleTime=typeof n=="function"?(...i)=>t(n(...i)):t(n),typeof s.gcTime=="number"&&(s.gcTime=Math.max(s.gcTime,1e3))}},HC=(s,e)=>s.isLoading&&s.isFetching&&!e,zC=(s,e)=>(s==null?void 0:s.suspense)&&e.isPending,yx=(s,e,t)=>e.fetchOptimistic(s).catch(()=>{t.clearReset()});function WC(s,e,t){var p,m,v,y,S;const n=FC(),i=$C(),r=NC(),o=r.defaultQueryOptions(s);(m=(p=r.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||m.call(p,o),o._optimisticResults=n?"isRestoring":"optimistic",KC(o),jC(o,i),VC(i);const l=!r.getQueryCache().get(o.queryHash),[u]=B.useState(()=>new e(r,o)),d=u.getOptimisticResult(o),h=!n&&s.subscribed!==!1;if(B.useSyncExternalStore(B.useCallback(x=>{const b=h?u.subscribe(zt.batchCalls(x)):vn;return u.updateResult(),b},[u,h]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),B.useEffect(()=>{u.setOptions(o)},[o,u]),zC(o,d))throw yx(o,u,i);if(GC({result:d,errorResetBoundary:i,throwOnError:o.throwOnError,query:r.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((y=(v=r.getDefaultOptions().queries)==null?void 0:v._experimental_afterQuery)==null||y.call(v,o,d),o.experimental_prefetchInRender&&!Ir&&HC(d,n)){const x=l?yx(o,u,i):(S=r.getQueryCache().get(o.queryHash))==null?void 0:S.promise;x==null||x.catch(vn).finally(()=>{u.updateResult()})}return o.notifyOnChangeProps?d:u.trackResult(d)}function qC(s,e){return WC(s,RC)}const YC=new OC({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});JT();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Uu(){return Uu=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},Uu.apply(this,arguments)}var Ni;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(Ni||(Ni={}));const vx="popstate";function QC(s){s===void 0&&(s={});function e(n,i){let{pathname:r,search:o,hash:l}=n.location;return Up("",{pathname:r,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(n,i){return typeof i=="string"?i:N1(i)}return JC(e,t,null,s)}function Tn(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function O1(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function XC(){return Math.random().toString(36).substr(2,8)}function xx(s,e){return{usr:s.state,key:s.key,idx:e}}function Up(s,e,t,n){return t===void 0&&(t=null),Uu({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof e=="string"?ld(e):e,{state:t,key:e&&e.key||n||XC()})}function N1(s){let{pathname:e="/",search:t="",hash:n=""}=s;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ld(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substr(t),s=s.substr(0,t));let n=s.indexOf("?");n>=0&&(e.search=s.substr(n),s=s.substr(0,n)),s&&(e.pathname=s)}return e}function JC(s,e,t,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:r=!1}=n,o=i.history,l=Ni.Pop,u=null,d=h();d==null&&(d=0,o.replaceState(Uu({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function p(){l=Ni.Pop;let x=h(),b=x==null?null:x-d;d=x,u&&u({action:l,location:S.location,delta:b})}function m(x,b){l=Ni.Push;let w=Up(S.location,x,b);d=h()+1;let L=xx(w,d),I=S.createHref(w);try{o.pushState(L,"",I)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;i.location.assign(I)}r&&u&&u({action:l,location:S.location,delta:1})}function v(x,b){l=Ni.Replace;let w=Up(S.location,x,b);d=h();let L=xx(w,d),I=S.createHref(w);o.replaceState(L,"",I),r&&u&&u({action:l,location:S.location,delta:0})}function y(x){let b=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof x=="string"?x:N1(x);return w=w.replace(/ $/,"%20"),Tn(b,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,b)}let S={get action(){return l},get location(){return s(i,o)},listen(x){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(vx,p),u=x,()=>{i.removeEventListener(vx,p),u=null}},createHref(x){return e(i,x)},createURL:y,encodeLocation(x){let b=y(x);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:m,replace:v,go(x){return o.go(x)}};return S}var Sx;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(Sx||(Sx={}));function ZC(s,e,t){return t===void 0&&(t="/"),eP(s,e,t)}function eP(s,e,t,n){let i=typeof e=="string"?ld(e):e,r=B1(i.pathname||"/",t);if(r==null)return null;let o=M1(s);tP(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let d=fP(r);l=uP(o[u],d)}return l}function M1(s,e,t,n){e===void 0&&(e=[]),t===void 0&&(t=[]),n===void 0&&(n="");let i=(r,o,l)=>{let u={relativePath:l===void 0?r.path||"":l,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};u.relativePath.startsWith("/")&&(Tn(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let d=So([n,u.relativePath]),h=t.concat(u);r.children&&r.children.length>0&&(Tn(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),M1(r.children,e,h,d)),!(r.path==null&&!r.index)&&e.push({path:d,score:lP(d,r.index),routesMeta:h})};return s.forEach((r,o)=>{var l;if(r.path===""||!((l=r.path)!=null&&l.includes("?")))i(r,o);else for(let u of F1(r.path))i(r,o,u)}),e}function F1(s){let e=s.split("/");if(e.length===0)return[];let[t,...n]=e,i=t.endsWith("?"),r=t.replace(/\?$/,"");if(n.length===0)return i?[r,""]:[r];let o=F1(n.join("/")),l=[];return l.push(...o.map(u=>u===""?r:[r,u].join("/"))),i&&l.push(...o),l.map(u=>s.startsWith("/")&&u===""?"/":u)}function tP(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:cP(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}const nP=/^:[\w-]+$/,sP=3,iP=2,rP=1,oP=10,aP=-2,Ex=s=>s==="*";function lP(s,e){let t=s.split("/"),n=t.length;return t.some(Ex)&&(n+=aP),e&&(n+=iP),t.filter(i=>!Ex(i)).reduce((i,r)=>i+(nP.test(r)?sP:r===""?rP:oP),n)}function cP(s,e){return s.length===e.length&&s.slice(0,-1).every((n,i)=>n===e[i])?s[s.length-1]-e[e.length-1]:0}function uP(s,e,t){let{routesMeta:n}=s,i={},r="/",o=[];for(let l=0;l<n.length;++l){let u=n[l],d=l===n.length-1,h=r==="/"?e:e.slice(r.length)||"/",p=dP({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:So([r,p.pathname]),pathnameBase:pP(So([r,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(r=So([r,p.pathnameBase]))}return o}function dP(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,n]=hP(s.path,s.caseSensitive,s.end),i=e.match(t);if(!i)return null;let r=i[0],o=r.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((d,h,p)=>{let{paramName:m,isOptional:v}=h;if(m==="*"){let S=l[p]||"";o=r.slice(0,r.length-S.length).replace(/(.)\/+$/,"$1")}const y=l[p];return v&&!y?d[m]=void 0:d[m]=(y||"").replace(/%2F/g,"/"),d},{}),pathname:r,pathnameBase:o,pattern:s}}function hP(s,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),O1(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let n=[],i="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(n.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(n.push({paramName:"*"}),i+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":s!==""&&s!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function fP(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return O1(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),s}}function B1(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=s.charAt(t);return n&&n!=="/"?null:s.slice(t)||"/"}const So=s=>s.join("/").replace(/\/\/+/g,"/"),pP=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/");function mP(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const U1=["post","put","patch","delete"];new Set(U1);const gP=["get",...U1];new Set(gP);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $u(){return $u=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},$u.apply(this,arguments)}const yP=B.createContext(null),vP=B.createContext(null),$1=B.createContext(null),cd=B.createContext(null),ud=B.createContext({outlet:null,matches:[],isDataRoute:!1}),j1=B.createContext(null);function Gm(){return B.useContext(cd)!=null}function Km(){return Gm()||Tn(!1),B.useContext(cd).location}function xP(s,e){return SP(s,e)}function SP(s,e,t,n){Gm()||Tn(!1);let{navigator:i}=B.useContext($1),{matches:r}=B.useContext(ud),o=r[r.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let d=Km(),h;if(e){var p;let x=typeof e=="string"?ld(e):e;u==="/"||(p=x.pathname)!=null&&p.startsWith(u)||Tn(!1),h=x}else h=d;let m=h.pathname||"/",v=m;if(u!=="/"){let x=u.replace(/^\//,"").split("/");v="/"+m.replace(/^\//,"").split("/").slice(x.length).join("/")}let y=ZC(s,{pathname:v}),S=wP(y&&y.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:So([u,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?u:So([u,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),r,t,n);return e&&S?B.createElement(cd.Provider,{value:{location:$u({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Ni.Pop}},S):S}function EP(){let s=_P(),e=mP(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},e),t?B.createElement("pre",{style:i},t):null,null)}const TP=B.createElement(EP,null);class bP extends B.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?B.createElement(ud.Provider,{value:this.props.routeContext},B.createElement(j1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function AP(s){let{routeContext:e,match:t,children:n}=s,i=B.useContext(yP);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),B.createElement(ud.Provider,{value:e},n)}function wP(s,e,t,n){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),n===void 0&&(n=null),s==null){var r;if(!t)return null;if(t.errors)s=t.matches;else if((r=n)!=null&&r.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let o=s,l=(i=t)==null?void 0:i.errors;if(l!=null){let h=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);h>=0||Tn(!1),o=o.slice(0,Math.min(o.length,h+1))}let u=!1,d=-1;if(t&&n&&n.v7_partialHydration)for(let h=0;h<o.length;h++){let p=o[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=h),p.route.id){let{loaderData:m,errors:v}=t,y=p.route.loader&&m[p.route.id]===void 0&&(!v||v[p.route.id]===void 0);if(p.route.lazy||y){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,p,m)=>{let v,y=!1,S=null,x=null;t&&(v=l&&p.route.id?l[p.route.id]:void 0,S=p.route.errorElement||TP,u&&(d<0&&m===0?(kP("route-fallback"),y=!0,x=null):d===m&&(y=!0,x=p.route.hydrateFallbackElement||null)));let b=e.concat(o.slice(0,m+1)),w=()=>{let L;return v?L=S:y?L=x:p.route.Component?L=B.createElement(p.route.Component,null):p.route.element?L=p.route.element:L=h,B.createElement(AP,{match:p,routeContext:{outlet:h,matches:b,isDataRoute:t!=null},children:L})};return t&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?B.createElement(bP,{location:t.location,revalidation:t.revalidation,component:S,error:v,children:w(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):w()},null)}var V1=(function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s})(V1||{});function RP(s){let e=B.useContext(vP);return e||Tn(!1),e}function LP(s){let e=B.useContext(ud);return e||Tn(!1),e}function IP(s){let e=LP(),t=e.matches[e.matches.length-1];return t.route.id||Tn(!1),t.route.id}function _P(){var s;let e=B.useContext(j1),t=RP(V1.UseRouteError),n=IP();return e!==void 0?e:(s=t.errors)==null?void 0:s[n]}const Tx={};function kP(s,e,t){Tx[s]||(Tx[s]=!0)}function CP(s,e){s==null||s.v7_startTransition,s==null||s.v7_relativeSplatPath}function xu(s){Tn(!1)}function PP(s){let{basename:e="/",children:t=null,location:n,navigationType:i=Ni.Pop,navigator:r,static:o=!1,future:l}=s;Gm()&&Tn(!1);let u=e.replace(/^\/*/,"/"),d=B.useMemo(()=>({basename:u,navigator:r,static:o,future:$u({v7_relativeSplatPath:!1},l)}),[u,l,r,o]);typeof n=="string"&&(n=ld(n));let{pathname:h="/",search:p="",hash:m="",state:v=null,key:y="default"}=n,S=B.useMemo(()=>{let x=B1(h,u);return x==null?null:{location:{pathname:x,search:p,hash:m,state:v,key:y},navigationType:i}},[u,h,p,m,v,y,i]);return S==null?null:B.createElement($1.Provider,{value:d},B.createElement(cd.Provider,{children:t,value:S}))}function DP(s){let{children:e,location:t}=s;return xP($p(e),t)}new Promise(()=>{});function $p(s,e){e===void 0&&(e=[]);let t=[];return B.Children.forEach(s,(n,i)=>{if(!B.isValidElement(n))return;let r=[...e,i];if(n.type===B.Fragment){t.push.apply(t,$p(n.props.children,r));return}n.type!==xu&&Tn(!1),!n.props.index||!n.props.children||Tn(!1);let o={id:n.props.id||r.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=$p(n.props.children,r)),t.push(o)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const OP="6";try{window.__reactRouterVersion=OP}catch{}const NP="startTransition",bx=BI[NP];function MP(s){let{basename:e,children:t,future:n,window:i}=s,r=B.useRef();r.current==null&&(r.current=QC({window:i,v5Compat:!0}));let o=r.current,[l,u]=B.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},h=B.useCallback(p=>{d&&bx?bx(()=>u(p)):u(p)},[u,d]);return B.useLayoutEffect(()=>o.listen(h),[o,h]),B.useEffect(()=>CP(n),[n]),B.createElement(PP,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,future:n})}var Ax;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(Ax||(Ax={}));var wx;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(wx||(wx={}));function G1(s,e){return function(){return s.apply(e,arguments)}}const{toString:FP}=Object.prototype,{getPrototypeOf:Hm}=Object,{iterator:dd,toStringTag:K1}=Symbol,hd=(s=>e=>{const t=FP.call(e);return s[t]||(s[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),us=s=>(s=s.toLowerCase(),e=>hd(e)===s),fd=s=>e=>typeof e===s,{isArray:Ho}=Array,Fo=fd("undefined");function Il(s){return s!==null&&!Fo(s)&&s.constructor!==null&&!Fo(s.constructor)&&Sn(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const H1=us("ArrayBuffer");function BP(s){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(s):e=s&&s.buffer&&H1(s.buffer),e}const UP=fd("string"),Sn=fd("function"),z1=fd("number"),_l=s=>s!==null&&typeof s=="object",$P=s=>s===!0||s===!1,Su=s=>{if(hd(s)!=="object")return!1;const e=Hm(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(K1 in s)&&!(dd in s)},jP=s=>{if(!_l(s)||Il(s))return!1;try{return Object.keys(s).length===0&&Object.getPrototypeOf(s)===Object.prototype}catch{return!1}},VP=us("Date"),GP=us("File"),KP=us("Blob"),HP=us("FileList"),zP=s=>_l(s)&&Sn(s.pipe),WP=s=>{let e;return s&&(typeof FormData=="function"&&s instanceof FormData||Sn(s.append)&&((e=hd(s))==="formdata"||e==="object"&&Sn(s.toString)&&s.toString()==="[object FormData]"))},qP=us("URLSearchParams"),[YP,QP,XP,JP]=["ReadableStream","Request","Response","Headers"].map(us),ZP=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function kl(s,e,{allOwnKeys:t=!1}={}){if(s===null||typeof s>"u")return;let n,i;if(typeof s!="object"&&(s=[s]),Ho(s))for(n=0,i=s.length;n<i;n++)e.call(null,s[n],n,s);else{if(Il(s))return;const r=t?Object.getOwnPropertyNames(s):Object.keys(s),o=r.length;let l;for(n=0;n<o;n++)l=r[n],e.call(null,s[l],l,s)}}function W1(s,e){if(Il(s))return null;e=e.toLowerCase();const t=Object.keys(s);let n=t.length,i;for(;n-- >0;)if(i=t[n],e===i.toLowerCase())return i;return null}const fr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,q1=s=>!Fo(s)&&s!==fr;function jp(){const{caseless:s,skipUndefined:e}=q1(this)&&this||{},t={},n=(i,r)=>{const o=s&&W1(t,r)||r;Su(t[o])&&Su(i)?t[o]=jp(t[o],i):Su(i)?t[o]=jp({},i):Ho(i)?t[o]=i.slice():(!e||!Fo(i))&&(t[o]=i)};for(let i=0,r=arguments.length;i<r;i++)arguments[i]&&kl(arguments[i],n);return t}const eD=(s,e,t,{allOwnKeys:n}={})=>(kl(e,(i,r)=>{t&&Sn(i)?s[r]=G1(i,t):s[r]=i},{allOwnKeys:n}),s),tD=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),nD=(s,e,t,n)=>{s.prototype=Object.create(e.prototype,n),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:e.prototype}),t&&Object.assign(s.prototype,t)},sD=(s,e,t,n)=>{let i,r,o;const l={};if(e=e||{},s==null)return e;do{for(i=Object.getOwnPropertyNames(s),r=i.length;r-- >0;)o=i[r],(!n||n(o,s,e))&&!l[o]&&(e[o]=s[o],l[o]=!0);s=t!==!1&&Hm(s)}while(s&&(!t||t(s,e))&&s!==Object.prototype);return e},iD=(s,e,t)=>{s=String(s),(t===void 0||t>s.length)&&(t=s.length),t-=e.length;const n=s.indexOf(e,t);return n!==-1&&n===t},rD=s=>{if(!s)return null;if(Ho(s))return s;let e=s.length;if(!z1(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=s[e];return t},oD=(s=>e=>s&&e instanceof s)(typeof Uint8Array<"u"&&Hm(Uint8Array)),aD=(s,e)=>{const n=(s&&s[dd]).call(s);let i;for(;(i=n.next())&&!i.done;){const r=i.value;e.call(s,r[0],r[1])}},lD=(s,e)=>{let t;const n=[];for(;(t=s.exec(e))!==null;)n.push(t);return n},cD=us("HTMLFormElement"),uD=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,i){return n.toUpperCase()+i}),Rx=(({hasOwnProperty:s})=>(e,t)=>s.call(e,t))(Object.prototype),dD=us("RegExp"),Y1=(s,e)=>{const t=Object.getOwnPropertyDescriptors(s),n={};kl(t,(i,r)=>{let o;(o=e(i,r,s))!==!1&&(n[r]=o||i)}),Object.defineProperties(s,n)},hD=s=>{Y1(s,(e,t)=>{if(Sn(s)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const n=s[t];if(Sn(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},fD=(s,e)=>{const t={},n=i=>{i.forEach(r=>{t[r]=!0})};return Ho(s)?n(s):n(String(s).split(e)),t},pD=()=>{},mD=(s,e)=>s!=null&&Number.isFinite(s=+s)?s:e;function gD(s){return!!(s&&Sn(s.append)&&s[K1]==="FormData"&&s[dd])}const yD=s=>{const e=new Array(10),t=(n,i)=>{if(_l(n)){if(e.indexOf(n)>=0)return;if(Il(n))return n;if(!("toJSON"in n)){e[i]=n;const r=Ho(n)?[]:{};return kl(n,(o,l)=>{const u=t(o,i+1);!Fo(u)&&(r[l]=u)}),e[i]=void 0,r}}return n};return t(s,0)},vD=us("AsyncFunction"),xD=s=>s&&(_l(s)||Sn(s))&&Sn(s.then)&&Sn(s.catch),Q1=((s,e)=>s?setImmediate:e?((t,n)=>(fr.addEventListener("message",({source:i,data:r})=>{i===fr&&r===t&&n.length&&n.shift()()},!1),i=>{n.push(i),fr.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Sn(fr.postMessage)),SD=typeof queueMicrotask<"u"?queueMicrotask.bind(fr):typeof process<"u"&&process.nextTick||Q1,ED=s=>s!=null&&Sn(s[dd]),Q={isArray:Ho,isArrayBuffer:H1,isBuffer:Il,isFormData:WP,isArrayBufferView:BP,isString:UP,isNumber:z1,isBoolean:$P,isObject:_l,isPlainObject:Su,isEmptyObject:jP,isReadableStream:YP,isRequest:QP,isResponse:XP,isHeaders:JP,isUndefined:Fo,isDate:VP,isFile:GP,isBlob:KP,isRegExp:dD,isFunction:Sn,isStream:zP,isURLSearchParams:qP,isTypedArray:oD,isFileList:HP,forEach:kl,merge:jp,extend:eD,trim:ZP,stripBOM:tD,inherits:nD,toFlatObject:sD,kindOf:hd,kindOfTest:us,endsWith:iD,toArray:rD,forEachEntry:aD,matchAll:lD,isHTMLForm:cD,hasOwnProperty:Rx,hasOwnProp:Rx,reduceDescriptors:Y1,freezeMethods:hD,toObjectSet:fD,toCamelCase:uD,noop:pD,toFiniteNumber:mD,findKey:W1,global:fr,isContextDefined:q1,isSpecCompliantForm:gD,toJSONObject:yD,isAsyncFn:vD,isThenable:xD,setImmediate:Q1,asap:SD,isIterable:ED};function Be(s,e,t,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}Q.inherits(Be,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Q.toJSONObject(this.config),code:this.code,status:this.status}}});const X1=Be.prototype,J1={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{J1[s]={value:s}});Object.defineProperties(Be,J1);Object.defineProperty(X1,"isAxiosError",{value:!0});Be.from=(s,e,t,n,i,r)=>{const o=Object.create(X1);Q.toFlatObject(s,o,function(h){return h!==Error.prototype},d=>d!=="isAxiosError");const l=s&&s.message?s.message:"Error",u=e==null&&s?s.code:e;return Be.call(o,l,u,t,n,i),s&&o.cause==null&&Object.defineProperty(o,"cause",{value:s,configurable:!0}),o.name=s&&s.name||"Error",r&&Object.assign(o,r),o};const TD=null;function Vp(s){return Q.isPlainObject(s)||Q.isArray(s)}function Z1(s){return Q.endsWith(s,"[]")?s.slice(0,-2):s}function Lx(s,e,t){return s?s.concat(e).map(function(i,r){return i=Z1(i),!t&&r?"["+i+"]":i}).join(t?".":""):e}function bD(s){return Q.isArray(s)&&!s.some(Vp)}const AD=Q.toFlatObject(Q,{},null,function(e){return/^is[A-Z]/.test(e)});function pd(s,e,t){if(!Q.isObject(s))throw new TypeError("target must be an object");e=e||new FormData,t=Q.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,x){return!Q.isUndefined(x[S])});const n=t.metaTokens,i=t.visitor||h,r=t.dots,o=t.indexes,u=(t.Blob||typeof Blob<"u"&&Blob)&&Q.isSpecCompliantForm(e);if(!Q.isFunction(i))throw new TypeError("visitor must be a function");function d(y){if(y===null)return"";if(Q.isDate(y))return y.toISOString();if(Q.isBoolean(y))return y.toString();if(!u&&Q.isBlob(y))throw new Be("Blob is not supported. Use a Buffer instead.");return Q.isArrayBuffer(y)||Q.isTypedArray(y)?u&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function h(y,S,x){let b=y;if(y&&!x&&typeof y=="object"){if(Q.endsWith(S,"{}"))S=n?S:S.slice(0,-2),y=JSON.stringify(y);else if(Q.isArray(y)&&bD(y)||(Q.isFileList(y)||Q.endsWith(S,"[]"))&&(b=Q.toArray(y)))return S=Z1(S),b.forEach(function(L,I){!(Q.isUndefined(L)||L===null)&&e.append(o===!0?Lx([S],I,r):o===null?S:S+"[]",d(L))}),!1}return Vp(y)?!0:(e.append(Lx(x,S,r),d(y)),!1)}const p=[],m=Object.assign(AD,{defaultVisitor:h,convertValue:d,isVisitable:Vp});function v(y,S){if(!Q.isUndefined(y)){if(p.indexOf(y)!==-1)throw Error("Circular reference detected in "+S.join("."));p.push(y),Q.forEach(y,function(b,w){(!(Q.isUndefined(b)||b===null)&&i.call(e,b,Q.isString(w)?w.trim():w,S,m))===!0&&v(b,S?S.concat(w):[w])}),p.pop()}}if(!Q.isObject(s))throw new TypeError("data must be an object");return v(s),e}function Ix(s){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function zm(s,e){this._pairs=[],s&&pd(s,this,e)}const eb=zm.prototype;eb.append=function(e,t){this._pairs.push([e,t])};eb.toString=function(e){const t=e?function(n){return e.call(this,n,Ix)}:Ix;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function wD(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function tb(s,e,t){if(!e)return s;const n=t&&t.encode||wD;Q.isFunction(t)&&(t={serialize:t});const i=t&&t.serialize;let r;if(i?r=i(e,t):r=Q.isURLSearchParams(e)?e.toString():new zm(e,t).toString(n),r){const o=s.indexOf("#");o!==-1&&(s=s.slice(0,o)),s+=(s.indexOf("?")===-1?"?":"&")+r}return s}class _x{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Q.forEach(this.handlers,function(n){n!==null&&e(n)})}}const nb={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},RD=typeof URLSearchParams<"u"?URLSearchParams:zm,LD=typeof FormData<"u"?FormData:null,ID=typeof Blob<"u"?Blob:null,_D={isBrowser:!0,classes:{URLSearchParams:RD,FormData:LD,Blob:ID},protocols:["http","https","file","blob","url","data"]},Wm=typeof window<"u"&&typeof document<"u",Gp=typeof navigator=="object"&&navigator||void 0,kD=Wm&&(!Gp||["ReactNative","NativeScript","NS"].indexOf(Gp.product)<0),CD=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",PD=Wm&&window.location.href||"http://localhost",DD=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Wm,hasStandardBrowserEnv:kD,hasStandardBrowserWebWorkerEnv:CD,navigator:Gp,origin:PD},Symbol.toStringTag,{value:"Module"})),en={...DD,..._D};function OD(s,e){return pd(s,new en.classes.URLSearchParams,{visitor:function(t,n,i,r){return en.isNode&&Q.isBuffer(t)?(this.append(n,t.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)},...e})}function ND(s){return Q.matchAll(/\w+|\[(\w*)]/g,s).map(e=>e[0]==="[]"?"":e[1]||e[0])}function MD(s){const e={},t=Object.keys(s);let n;const i=t.length;let r;for(n=0;n<i;n++)r=t[n],e[r]=s[r];return e}function sb(s){function e(t,n,i,r){let o=t[r++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),u=r>=t.length;return o=!o&&Q.isArray(i)?i.length:o,u?(Q.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!l):((!i[o]||!Q.isObject(i[o]))&&(i[o]=[]),e(t,n,i[o],r)&&Q.isArray(i[o])&&(i[o]=MD(i[o])),!l)}if(Q.isFormData(s)&&Q.isFunction(s.entries)){const t={};return Q.forEachEntry(s,(n,i)=>{e(ND(n),i,t,0)}),t}return null}function FD(s,e,t){if(Q.isString(s))try{return(e||JSON.parse)(s),Q.trim(s)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(s)}const Cl={transitional:nb,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,r=Q.isObject(e);if(r&&Q.isHTMLForm(e)&&(e=new FormData(e)),Q.isFormData(e))return i?JSON.stringify(sb(e)):e;if(Q.isArrayBuffer(e)||Q.isBuffer(e)||Q.isStream(e)||Q.isFile(e)||Q.isBlob(e)||Q.isReadableStream(e))return e;if(Q.isArrayBufferView(e))return e.buffer;if(Q.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return OD(e,this.formSerializer).toString();if((l=Q.isFileList(e))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return pd(l?{"files[]":e}:e,u&&new u,this.formSerializer)}}return r||i?(t.setContentType("application/json",!1),FD(e)):e}],transformResponse:[function(e){const t=this.transitional||Cl.transitional,n=t&&t.forcedJSONParsing,i=this.responseType==="json";if(Q.isResponse(e)||Q.isReadableStream(e))return e;if(e&&Q.isString(e)&&(n&&!this.responseType||i)){const o=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?Be.from(l,Be.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:en.classes.FormData,Blob:en.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Q.forEach(["delete","get","head","post","put","patch"],s=>{Cl.headers[s]={}});const BD=Q.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),UD=s=>{const e={};let t,n,i;return s&&s.split(`
`).forEach(function(o){i=o.indexOf(":"),t=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!t||e[t]&&BD[t])&&(t==="set-cookie"?e[t]?e[t].push(n):e[t]=[n]:e[t]=e[t]?e[t]+", "+n:n)}),e},kx=Symbol("internals");function Ma(s){return s&&String(s).trim().toLowerCase()}function Eu(s){return s===!1||s==null?s:Q.isArray(s)?s.map(Eu):String(s)}function $D(s){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=t.exec(s);)e[n[1]]=n[2];return e}const jD=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function Rf(s,e,t,n,i){if(Q.isFunction(n))return n.call(this,e,t);if(i&&(e=t),!!Q.isString(e)){if(Q.isString(n))return e.indexOf(n)!==-1;if(Q.isRegExp(n))return n.test(e)}}function VD(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}function GD(s,e){const t=Q.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(s,n+t,{value:function(i,r,o){return this[n].call(this,e,i,r,o)},configurable:!0})})}let En=class{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function r(l,u,d){const h=Ma(u);if(!h)throw new Error("header name must be a non-empty string");const p=Q.findKey(i,h);(!p||i[p]===void 0||d===!0||d===void 0&&i[p]!==!1)&&(i[p||u]=Eu(l))}const o=(l,u)=>Q.forEach(l,(d,h)=>r(d,h,u));if(Q.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(Q.isString(e)&&(e=e.trim())&&!jD(e))o(UD(e),t);else if(Q.isObject(e)&&Q.isIterable(e)){let l={},u,d;for(const h of e){if(!Q.isArray(h))throw TypeError("Object iterator must return a key-value pair");l[d=h[0]]=(u=l[d])?Q.isArray(u)?[...u,h[1]]:[u,h[1]]:h[1]}o(l,t)}else e!=null&&r(t,e,n);return this}get(e,t){if(e=Ma(e),e){const n=Q.findKey(this,e);if(n){const i=this[n];if(!t)return i;if(t===!0)return $D(i);if(Q.isFunction(t))return t.call(this,i,n);if(Q.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Ma(e),e){const n=Q.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||Rf(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let i=!1;function r(o){if(o=Ma(o),o){const l=Q.findKey(n,o);l&&(!t||Rf(n,n[l],l,t))&&(delete n[l],i=!0)}}return Q.isArray(e)?e.forEach(r):r(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;for(;n--;){const r=t[n];(!e||Rf(this,this[r],r,e,!0))&&(delete this[r],i=!0)}return i}normalize(e){const t=this,n={};return Q.forEach(this,(i,r)=>{const o=Q.findKey(n,r);if(o){t[o]=Eu(i),delete t[r];return}const l=e?VD(r):String(r).trim();l!==r&&delete t[r],t[l]=Eu(i),n[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Q.forEach(this,(n,i)=>{n!=null&&n!==!1&&(t[i]=e&&Q.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(i=>n.set(i)),n}static accessor(e){const n=(this[kx]=this[kx]={accessors:{}}).accessors,i=this.prototype;function r(o){const l=Ma(o);n[l]||(GD(i,o),n[l]=!0)}return Q.isArray(e)?e.forEach(r):r(e),this}};En.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Q.reduceDescriptors(En.prototype,({value:s},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>s,set(n){this[t]=n}}});Q.freezeMethods(En);function Lf(s,e){const t=this||Cl,n=e||t,i=En.from(n.headers);let r=n.data;return Q.forEach(s,function(l){r=l.call(t,r,i.normalize(),e?e.status:void 0)}),i.normalize(),r}function ib(s){return!!(s&&s.__CANCEL__)}function zo(s,e,t){Be.call(this,s??"canceled",Be.ERR_CANCELED,e,t),this.name="CanceledError"}Q.inherits(zo,Be,{__CANCEL__:!0});function rb(s,e,t){const n=t.config.validateStatus;!t.status||!n||n(t.status)?s(t):e(new Be("Request failed with status code "+t.status,[Be.ERR_BAD_REQUEST,Be.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function KD(s){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return e&&e[1]||""}function HD(s,e){s=s||10;const t=new Array(s),n=new Array(s);let i=0,r=0,o;return e=e!==void 0?e:1e3,function(u){const d=Date.now(),h=n[r];o||(o=d),t[i]=u,n[i]=d;let p=r,m=0;for(;p!==i;)m+=t[p++],p=p%s;if(i=(i+1)%s,i===r&&(r=(r+1)%s),d-o<e)return;const v=h&&d-h;return v?Math.round(m*1e3/v):void 0}}function zD(s,e){let t=0,n=1e3/e,i,r;const o=(d,h=Date.now())=>{t=h,i=null,r&&(clearTimeout(r),r=null),s(...d)};return[(...d)=>{const h=Date.now(),p=h-t;p>=n?o(d,h):(i=d,r||(r=setTimeout(()=>{r=null,o(i)},n-p)))},()=>i&&o(i)]}const ju=(s,e,t=3)=>{let n=0;const i=HD(50,250);return zD(r=>{const o=r.loaded,l=r.lengthComputable?r.total:void 0,u=o-n,d=i(u),h=o<=l;n=o;const p={loaded:o,total:l,progress:l?o/l:void 0,bytes:u,rate:d||void 0,estimated:d&&l&&h?(l-o)/d:void 0,event:r,lengthComputable:l!=null,[e?"download":"upload"]:!0};s(p)},t)},Cx=(s,e)=>{const t=s!=null;return[n=>e[0]({lengthComputable:t,total:s,loaded:n}),e[1]]},Px=s=>(...e)=>Q.asap(()=>s(...e)),WD=en.hasStandardBrowserEnv?((s,e)=>t=>(t=new URL(t,en.origin),s.protocol===t.protocol&&s.host===t.host&&(e||s.port===t.port)))(new URL(en.origin),en.navigator&&/(msie|trident)/i.test(en.navigator.userAgent)):()=>!0,qD=en.hasStandardBrowserEnv?{write(s,e,t,n,i,r){const o=[s+"="+encodeURIComponent(e)];Q.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),Q.isString(n)&&o.push("path="+n),Q.isString(i)&&o.push("domain="+i),r===!0&&o.push("secure"),document.cookie=o.join("; ")},read(s){const e=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function YD(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function QD(s,e){return e?s.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):s}function ob(s,e,t){let n=!YD(e);return s&&(n||t==!1)?QD(s,e):e}const Dx=s=>s instanceof En?{...s}:s;function _r(s,e){e=e||{};const t={};function n(d,h,p,m){return Q.isPlainObject(d)&&Q.isPlainObject(h)?Q.merge.call({caseless:m},d,h):Q.isPlainObject(h)?Q.merge({},h):Q.isArray(h)?h.slice():h}function i(d,h,p,m){if(Q.isUndefined(h)){if(!Q.isUndefined(d))return n(void 0,d,p,m)}else return n(d,h,p,m)}function r(d,h){if(!Q.isUndefined(h))return n(void 0,h)}function o(d,h){if(Q.isUndefined(h)){if(!Q.isUndefined(d))return n(void 0,d)}else return n(void 0,h)}function l(d,h,p){if(p in e)return n(d,h);if(p in s)return n(void 0,d)}const u={url:r,method:r,data:r,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,h,p)=>i(Dx(d),Dx(h),p,!0)};return Q.forEach(Object.keys({...s,...e}),function(h){const p=u[h]||i,m=p(s[h],e[h],h);Q.isUndefined(m)&&p!==l||(t[h]=m)}),t}const ab=s=>{const e=_r({},s);let{data:t,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:r,headers:o,auth:l}=e;if(e.headers=o=En.from(o),e.url=tb(ob(e.baseURL,e.url,e.allowAbsoluteUrls),s.params,s.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),Q.isFormData(t)){if(en.hasStandardBrowserEnv||en.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Q.isFunction(t.getHeaders)){const u=t.getHeaders(),d=["content-type","content-length"];Object.entries(u).forEach(([h,p])=>{d.includes(h.toLowerCase())&&o.set(h,p)})}}if(en.hasStandardBrowserEnv&&(n&&Q.isFunction(n)&&(n=n(e)),n||n!==!1&&WD(e.url))){const u=i&&r&&qD.read(r);u&&o.set(i,u)}return e},XD=typeof XMLHttpRequest<"u",JD=XD&&function(s){return new Promise(function(t,n){const i=ab(s);let r=i.data;const o=En.from(i.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:d}=i,h,p,m,v,y;function S(){v&&v(),y&&y(),i.cancelToken&&i.cancelToken.unsubscribe(h),i.signal&&i.signal.removeEventListener("abort",h)}let x=new XMLHttpRequest;x.open(i.method.toUpperCase(),i.url,!0),x.timeout=i.timeout;function b(){if(!x)return;const L=En.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),k={data:!l||l==="text"||l==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:L,config:s,request:x};rb(function(P){t(P),S()},function(P){n(P),S()},k),x=null}"onloadend"in x?x.onloadend=b:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(b)},x.onabort=function(){x&&(n(new Be("Request aborted",Be.ECONNABORTED,s,x)),x=null)},x.onerror=function(I){const k=I&&I.message?I.message:"Network Error",M=new Be(k,Be.ERR_NETWORK,s,x);M.event=I||null,n(M),x=null},x.ontimeout=function(){let I=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const k=i.transitional||nb;i.timeoutErrorMessage&&(I=i.timeoutErrorMessage),n(new Be(I,k.clarifyTimeoutError?Be.ETIMEDOUT:Be.ECONNABORTED,s,x)),x=null},r===void 0&&o.setContentType(null),"setRequestHeader"in x&&Q.forEach(o.toJSON(),function(I,k){x.setRequestHeader(k,I)}),Q.isUndefined(i.withCredentials)||(x.withCredentials=!!i.withCredentials),l&&l!=="json"&&(x.responseType=i.responseType),d&&([m,y]=ju(d,!0),x.addEventListener("progress",m)),u&&x.upload&&([p,v]=ju(u),x.upload.addEventListener("progress",p),x.upload.addEventListener("loadend",v)),(i.cancelToken||i.signal)&&(h=L=>{x&&(n(!L||L.type?new zo(null,s,x):L),x.abort(),x=null)},i.cancelToken&&i.cancelToken.subscribe(h),i.signal&&(i.signal.aborted?h():i.signal.addEventListener("abort",h)));const w=KD(i.url);if(w&&en.protocols.indexOf(w)===-1){n(new Be("Unsupported protocol "+w+":",Be.ERR_BAD_REQUEST,s));return}x.send(r||null)})},ZD=(s,e)=>{const{length:t}=s=s?s.filter(Boolean):[];if(e||t){let n=new AbortController,i;const r=function(d){if(!i){i=!0,l();const h=d instanceof Error?d:this.reason;n.abort(h instanceof Be?h:new zo(h instanceof Error?h.message:h))}};let o=e&&setTimeout(()=>{o=null,r(new Be(`timeout ${e} of ms exceeded`,Be.ETIMEDOUT))},e);const l=()=>{s&&(o&&clearTimeout(o),o=null,s.forEach(d=>{d.unsubscribe?d.unsubscribe(r):d.removeEventListener("abort",r)}),s=null)};s.forEach(d=>d.addEventListener("abort",r));const{signal:u}=n;return u.unsubscribe=()=>Q.asap(l),u}},eO=function*(s,e){let t=s.byteLength;if(t<e){yield s;return}let n=0,i;for(;n<t;)i=n+e,yield s.slice(n,i),n=i},tO=async function*(s,e){for await(const t of nO(s))yield*eO(t,e)},nO=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const e=s.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)break;yield n}}finally{await e.cancel()}},Ox=(s,e,t,n)=>{const i=tO(s,e);let r=0,o,l=u=>{o||(o=!0,n&&n(u))};return new ReadableStream({async pull(u){try{const{done:d,value:h}=await i.next();if(d){l(),u.close();return}let p=h.byteLength;if(t){let m=r+=p;t(m)}u.enqueue(new Uint8Array(h))}catch(d){throw l(d),d}},cancel(u){return l(u),i.return()}},{highWaterMark:2})},Nx=64*1024,{isFunction:Yc}=Q,sO=(({Request:s,Response:e})=>({Request:s,Response:e}))(Q.global),{ReadableStream:Mx,TextEncoder:Fx}=Q.global,Bx=(s,...e)=>{try{return!!s(...e)}catch{return!1}},iO=s=>{s=Q.merge.call({skipUndefined:!0},sO,s);const{fetch:e,Request:t,Response:n}=s,i=e?Yc(e):typeof fetch=="function",r=Yc(t),o=Yc(n);if(!i)return!1;const l=i&&Yc(Mx),u=i&&(typeof Fx=="function"?(y=>S=>y.encode(S))(new Fx):async y=>new Uint8Array(await new t(y).arrayBuffer())),d=r&&l&&Bx(()=>{let y=!1;const S=new t(en.origin,{body:new Mx,method:"POST",get duplex(){return y=!0,"half"}}).headers.has("Content-Type");return y&&!S}),h=o&&l&&Bx(()=>Q.isReadableStream(new n("").body)),p={stream:h&&(y=>y.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(y=>{!p[y]&&(p[y]=(S,x)=>{let b=S&&S[y];if(b)return b.call(S);throw new Be(`Response type '${y}' is not supported`,Be.ERR_NOT_SUPPORT,x)})});const m=async y=>{if(y==null)return 0;if(Q.isBlob(y))return y.size;if(Q.isSpecCompliantForm(y))return(await new t(en.origin,{method:"POST",body:y}).arrayBuffer()).byteLength;if(Q.isArrayBufferView(y)||Q.isArrayBuffer(y))return y.byteLength;if(Q.isURLSearchParams(y)&&(y=y+""),Q.isString(y))return(await u(y)).byteLength},v=async(y,S)=>{const x=Q.toFiniteNumber(y.getContentLength());return x??m(S)};return async y=>{let{url:S,method:x,data:b,signal:w,cancelToken:L,timeout:I,onDownloadProgress:k,onUploadProgress:M,responseType:P,headers:C,withCredentials:U="same-origin",fetchOptions:O}=ab(y),W=e||fetch;P=P?(P+"").toLowerCase():"text";let ne=ZD([w,L&&L.toAbortSignal()],I),oe=null;const se=ne&&ne.unsubscribe&&(()=>{ne.unsubscribe()});let re;try{if(M&&d&&x!=="get"&&x!=="head"&&(re=await v(C,b))!==0){let D=new t(S,{method:"POST",body:b,duplex:"half"}),j;if(Q.isFormData(b)&&(j=D.headers.get("content-type"))&&C.setContentType(j),D.body){const[ie,ce]=Cx(re,ju(Px(M)));b=Ox(D.body,Nx,ie,ce)}}Q.isString(U)||(U=U?"include":"omit");const X=r&&"credentials"in t.prototype,Z={...O,signal:ne,method:x.toUpperCase(),headers:C.normalize().toJSON(),body:b,duplex:"half",credentials:X?U:void 0};oe=r&&new t(S,Z);let F=await(r?W(oe,O):W(S,Z));const ee=h&&(P==="stream"||P==="response");if(h&&(k||ee&&se)){const D={};["status","statusText","headers"].forEach(de=>{D[de]=F[de]});const j=Q.toFiniteNumber(F.headers.get("content-length")),[ie,ce]=k&&Cx(j,ju(Px(k),!0))||[];F=new n(Ox(F.body,Nx,ie,()=>{ce&&ce(),se&&se()}),D)}P=P||"text";let J=await p[Q.findKey(p,P)||"text"](F,y);return!ee&&se&&se(),await new Promise((D,j)=>{rb(D,j,{data:J,headers:En.from(F.headers),status:F.status,statusText:F.statusText,config:y,request:oe})})}catch(X){throw se&&se(),X&&X.name==="TypeError"&&/Load failed|fetch/i.test(X.message)?Object.assign(new Be("Network Error",Be.ERR_NETWORK,y,oe),{cause:X.cause||X}):Be.from(X,X&&X.code,y,oe)}}},rO=new Map,lb=s=>{let e=s?s.env:{};const{fetch:t,Request:n,Response:i}=e,r=[n,i,t];let o=r.length,l=o,u,d,h=rO;for(;l--;)u=r[l],d=h.get(u),d===void 0&&h.set(u,d=l?new Map:iO(e)),h=d;return d};lb();const Kp={http:TD,xhr:JD,fetch:{get:lb}};Q.forEach(Kp,(s,e)=>{if(s){try{Object.defineProperty(s,"name",{value:e})}catch{}Object.defineProperty(s,"adapterName",{value:e})}});const Ux=s=>`- ${s}`,oO=s=>Q.isFunction(s)||s===null||s===!1,cb={getAdapter:(s,e)=>{s=Q.isArray(s)?s:[s];const{length:t}=s;let n,i;const r={};for(let o=0;o<t;o++){n=s[o];let l;if(i=n,!oO(n)&&(i=Kp[(l=String(n)).toLowerCase()],i===void 0))throw new Be(`Unknown adapter '${l}'`);if(i&&(Q.isFunction(i)||(i=i.get(e))))break;r[l||"#"+o]=i}if(!i){const o=Object.entries(r).map(([u,d])=>`adapter ${u} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=t?o.length>1?`since :
`+o.map(Ux).join(`
`):" "+Ux(o[0]):"as no adapter specified";throw new Be("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i},adapters:Kp};function If(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new zo(null,s)}function $x(s){return If(s),s.headers=En.from(s.headers),s.data=Lf.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),cb.getAdapter(s.adapter||Cl.adapter,s)(s).then(function(n){return If(s),n.data=Lf.call(s,s.transformResponse,n),n.headers=En.from(n.headers),n},function(n){return ib(n)||(If(s),n&&n.response&&(n.response.data=Lf.call(s,s.transformResponse,n.response),n.response.headers=En.from(n.response.headers))),Promise.reject(n)})}const ub="1.12.2",md={};["object","boolean","number","function","string","symbol"].forEach((s,e)=>{md[s]=function(n){return typeof n===s||"a"+(e<1?"n ":" ")+s}});const jx={};md.transitional=function(e,t,n){function i(r,o){return"[Axios v"+ub+"] Transitional option '"+r+"'"+o+(n?". "+n:"")}return(r,o,l)=>{if(e===!1)throw new Be(i(o," has been removed"+(t?" in "+t:"")),Be.ERR_DEPRECATED);return t&&!jx[o]&&(jx[o]=!0,console.warn(i(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(r,o,l):!0}};md.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function aO(s,e,t){if(typeof s!="object")throw new Be("options must be an object",Be.ERR_BAD_OPTION_VALUE);const n=Object.keys(s);let i=n.length;for(;i-- >0;){const r=n[i],o=e[r];if(o){const l=s[r],u=l===void 0||o(l,r,s);if(u!==!0)throw new Be("option "+r+" must be "+u,Be.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Be("Unknown option "+r,Be.ERR_BAD_OPTION)}}const Tu={assertOptions:aO,validators:md},gs=Tu.validators;let wr=class{constructor(e){this.defaults=e||{},this.interceptors={request:new _x,response:new _x}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const r=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?r&&!String(n.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+r):n.stack=r}catch{}}throw n}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=_r(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:r}=t;n!==void 0&&Tu.assertOptions(n,{silentJSONParsing:gs.transitional(gs.boolean),forcedJSONParsing:gs.transitional(gs.boolean),clarifyTimeoutError:gs.transitional(gs.boolean)},!1),i!=null&&(Q.isFunction(i)?t.paramsSerializer={serialize:i}:Tu.assertOptions(i,{encode:gs.function,serialize:gs.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Tu.assertOptions(t,{baseUrl:gs.spelling("baseURL"),withXsrfToken:gs.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=r&&Q.merge(r.common,r[t.method]);r&&Q.forEach(["delete","get","head","post","put","patch","common"],y=>{delete r[y]}),t.headers=En.concat(o,r);const l=[];let u=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(t)===!1||(u=u&&S.synchronous,l.unshift(S.fulfilled,S.rejected))});const d=[];this.interceptors.response.forEach(function(S){d.push(S.fulfilled,S.rejected)});let h,p=0,m;if(!u){const y=[$x.bind(this),void 0];for(y.unshift(...l),y.push(...d),m=y.length,h=Promise.resolve(t);p<m;)h=h.then(y[p++],y[p++]);return h}m=l.length;let v=t;for(;p<m;){const y=l[p++],S=l[p++];try{v=y(v)}catch(x){S.call(this,x);break}}try{h=$x.call(this,v)}catch(y){return Promise.reject(y)}for(p=0,m=d.length;p<m;)h=h.then(d[p++],d[p++]);return h}getUri(e){e=_r(this.defaults,e);const t=ob(e.baseURL,e.url,e.allowAbsoluteUrls);return tb(t,e.params,e.paramsSerializer)}};Q.forEach(["delete","get","head","options"],function(e){wr.prototype[e]=function(t,n){return this.request(_r(n||{},{method:e,url:t,data:(n||{}).data}))}});Q.forEach(["post","put","patch"],function(e){function t(n){return function(r,o,l){return this.request(_r(l||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:r,data:o}))}}wr.prototype[e]=t(),wr.prototype[e+"Form"]=t(!0)});let lO=class db{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(r){t=r});const n=this;this.promise.then(i=>{if(!n._listeners)return;let r=n._listeners.length;for(;r-- >0;)n._listeners[r](i);n._listeners=null}),this.promise.then=i=>{let r;const o=new Promise(l=>{n.subscribe(l),r=l}).then(i);return o.cancel=function(){n.unsubscribe(r)},o},e(function(r,o,l){n.reason||(n.reason=new zo(r,o,l),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=n=>{e.abort(n)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new db(function(i){e=i}),cancel:e}}};function cO(s){return function(t){return s.apply(null,t)}}function uO(s){return Q.isObject(s)&&s.isAxiosError===!0}const Hp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Hp).forEach(([s,e])=>{Hp[e]=s});function hb(s){const e=new wr(s),t=G1(wr.prototype.request,e);return Q.extend(t,wr.prototype,e,{allOwnKeys:!0}),Q.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return hb(_r(s,i))},t}const bt=hb(Cl);bt.Axios=wr;bt.CanceledError=zo;bt.CancelToken=lO;bt.isCancel=ib;bt.VERSION=ub;bt.toFormData=pd;bt.AxiosError=Be;bt.Cancel=bt.CanceledError;bt.all=function(e){return Promise.all(e)};bt.spread=cO;bt.isAxiosError=uO;bt.mergeConfig=_r;bt.AxiosHeaders=En;bt.formToJSON=s=>sb(Q.isHTMLForm(s)?new FormData(s):s);bt.getAdapter=cb.getAdapter;bt.HttpStatusCode=Hp;bt.default=bt;const{Axios:Qj,AxiosError:Xj,CanceledError:Jj,isCancel:Zj,CancelToken:eV,VERSION:tV,all:nV,Cancel:sV,isAxiosError:iV,spread:rV,toFormData:oV,AxiosHeaders:aV,HttpStatusCode:lV,formToJSON:cV,getAdapter:uV,mergeConfig:dV}=bt,dO=typeof window>"u",Vx=!dO&&window.self!==window.top,_f=()=>Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),Vt=[];for(let s=0;s<256;++s)Vt.push((s+256).toString(16).slice(1));function hO(s,e=0){return(Vt[s[e+0]]+Vt[s[e+1]]+Vt[s[e+2]]+Vt[s[e+3]]+"-"+Vt[s[e+4]]+Vt[s[e+5]]+"-"+Vt[s[e+6]]+Vt[s[e+7]]+"-"+Vt[s[e+8]]+Vt[s[e+9]]+"-"+Vt[s[e+10]]+Vt[s[e+11]]+Vt[s[e+12]]+Vt[s[e+13]]+Vt[s[e+14]]+Vt[s[e+15]]).toLowerCase()}let kf;const fO=new Uint8Array(16);function pO(){if(!kf){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");kf=crypto.getRandomValues.bind(crypto)}return kf(fO)}const mO=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Gx={randomUUID:mO};function gO(s,e,t){var i;s=s||{};const n=s.random??((i=s.rng)==null?void 0:i.call(s))??pO();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,hO(n)}function yO(s,e,t){return Gx.randomUUID&&!s?Gx.randomUUID():gO(s)}class vO extends Error{constructor(e,t,n,i,r){super(e),this.name="Base44Error",this.status=t,this.code=n,this.data=i,this.originalError=r}toJSON(){return{name:this.name,message:this.message,status:this.status,code:this.code,data:this.data}}}function Ka({baseURL:s,headers:e={},token:t,interceptResponses:n=!0,onError:i}){const r=bt.create({baseURL:s,headers:{"Content-Type":"application/json",Accept:"application/json",...e}});return t&&(r.defaults.headers.common.Authorization=`Bearer ${t}`),r.interceptors.request.use(o=>{typeof window<"u"&&o.headers.set("X-Origin-URL",window.location.href);const l=yO();if(o.requestId=l,Vx)try{window.parent.postMessage({type:"api-request-start",requestId:l,data:{url:s+o.url,method:o.method,body:o.data instanceof FormData?"[FormData object]":o.data}},"*")}catch{}return o}),n&&r.interceptors.response.use(o=>{var l;const u=(l=o.config)===null||l===void 0?void 0:l.requestId;try{Vx&&u&&window.parent.postMessage({type:"api-request-end",requestId:u,data:{statusCode:o.status,response:o.data}},"*")}catch{}return o.data},o=>{var l,u,d,h,p,m,v,y;const S=((u=(l=o.response)===null||l===void 0?void 0:l.data)===null||u===void 0?void 0:u.message)||((h=(d=o.response)===null||d===void 0?void 0:d.data)===null||h===void 0?void 0:h.detail)||o.message,x=new vO(S,(p=o.response)===null||p===void 0?void 0:p.status,(v=(m=o.response)===null||m===void 0?void 0:m.data)===null||v===void 0?void 0:v.code,(y=o.response)===null||y===void 0?void 0:y.data,o);return i==null||i(x),Promise.reject(x)}),r}function Kx(s){const{axios:e,appId:t,getSocket:n}=s;return new Proxy({},{get(i,r){if(!(typeof r!="string"||r==="then"||r.startsWith("_")))return SO(e,t,r,n)}})}function xO(s){var e;try{const t=JSON.parse(s);return{type:t.type,data:t.data,id:t.id||((e=t.data)===null||e===void 0?void 0:e.id),timestamp:t.timestamp||new Date().toISOString()}}catch(t){return console.warn("[Base44 SDK] Failed to parse realtime message:",t),null}}function SO(s,e,t,n){const i=`/apps/${e}/entities/${t}`;return{async list(r,o,l,u){const d={};return r&&(d.sort=r),o&&(d.limit=o),l&&(d.skip=l),u&&(d.fields=Array.isArray(u)?u.join(","):u),s.get(i,{params:d})},async filter(r,o,l,u,d){const h={q:JSON.stringify(r)};return o&&(h.sort=o),l&&(h.limit=l),u&&(h.skip=u),d&&(h.fields=Array.isArray(d)?d.join(","):d),s.get(i,{params:h})},async get(r){return s.get(`${i}/${r}`)},async create(r){return s.post(i,r)},async update(r,o){return s.put(`${i}/${r}`,o)},async delete(r){return s.delete(`${i}/${r}`)},async deleteMany(r){return s.delete(i,{data:r})},async bulkCreate(r){return s.post(`${i}/bulk`,r)},async importEntities(r){const o=new FormData;return o.append("file",r,r.name),s.post(`${i}/import`,o,{headers:{"Content-Type":"multipart/form-data"}})},subscribe(r){const o=`entities:${e}:${t}`;return n().subscribeToRoom(o,{update_model:d=>{const h=xO(d.data);if(h)try{r(h)}catch(p){console.error("[Base44 SDK] Subscription callback error:",p)}}})}}}function EO(s,e){return{async call(t,n,i){if(!(t!=null&&t.trim()))throw new Error("Integration slug is required and cannot be empty");if(!(n!=null&&n.trim()))throw new Error("Operation ID is required and cannot be empty");const{pathParams:r,queryParams:o,...l}=i??{},u={...l,...r&&{path_params:r},...o&&{query_params:o}};return await s.post(`/apps/${e}/integrations/custom/${t}/${n}`,u)}}}function Hx(s,e){const t=EO(s,e);return new Proxy({},{get(n,i){if(!(typeof i!="string"||i==="then"||i.startsWith("_")))return i==="custom"?t:new Proxy({},{get(r,o){if(!(typeof o!="string"||o==="then"||o.startsWith("_")))return async l=>{if(typeof l=="string")throw new Error(`Integration ${o} must receive an object with named parameters, received: ${l}`);let u,d;return l instanceof FormData||l&&Object.values(l).some(h=>h instanceof File)?(u=new FormData,Object.keys(l).forEach(h=>{l[h]instanceof File?u.append(h,l[h],l[h].name):typeof l[h]=="object"&&l[h]!==null?u.append(h,JSON.stringify(l[h])):u.append(h,l[h])}),d="multipart/form-data"):(u=l,d="application/json"),i==="Core"?s.post(`/apps/${e}/integration-endpoints/Core/${o}`,u||l,{headers:{"Content-Type":d}}):s.post(`/apps/${e}/integration-endpoints/installable/${i}/integration-endpoints/${o}`,u||l,{headers:{"Content-Type":d}})}}})}})}function TO(s,e,t,n){return{async me(){return s.get(`/apps/${t}/entities/User/me`)},async updateMe(i){return s.put(`/apps/${t}/entities/User/me`,i)},redirectToLogin(i){var r;if(typeof window>"u")throw new Error("Login method can only be used in a browser environment");const o=i?new URL(i,window.location.origin).toString():window.location.href,l=`${(r=n.appBaseUrl)!==null&&r!==void 0?r:""}/login?from_url=${encodeURIComponent(o)}`;window.location.href=l},logout(i){if(delete s.defaults.headers.common.Authorization,typeof window<"u"&&window.localStorage)try{window.localStorage.removeItem("base44_access_token"),window.localStorage.removeItem("token")}catch(r){console.error("Failed to remove token from localStorage:",r)}typeof window<"u"&&(i?window.location.href=i:window.location.reload())},setToken(i,r=!0){if(i&&(s.defaults.headers.common.Authorization=`Bearer ${i}`,e.defaults.headers.common.Authorization=`Bearer ${i}`,r&&typeof window<"u"&&window.localStorage))try{window.localStorage.setItem("base44_access_token",i),window.localStorage.setItem("token",i)}catch(o){console.error("Failed to save token to localStorage:",o)}},async loginViaEmailPassword(i,r,o){var l;try{const u=await s.post(`/apps/${t}/auth/login`,{email:i,password:r,...o&&{turnstile_token:o}}),{access_token:d,user:h}=u;return d&&this.setToken(d),{access_token:d,user:h}}catch(u){throw((l=u.response)===null||l===void 0?void 0:l.status)===401&&await this.logout(),u}},async isAuthenticated(){try{return await this.me(),!0}catch{return!1}},inviteUser(i,r){return s.post(`/apps/${t}/users/invite-user`,{user_email:i,role:r})},register(i){return s.post(`/apps/${t}/auth/register`,i)},verifyOtp({email:i,otpCode:r}){return s.post(`/apps/${t}/auth/verify-otp`,{email:i,otp_code:r})},resendOtp(i){return s.post(`/apps/${t}/auth/resend-otp`,{email:i})},resetPasswordRequest(i){return s.post(`/apps/${t}/auth/reset-password-request`,{email:i})},resetPassword({resetToken:i,newPassword:r}){return s.post(`/apps/${t}/auth/reset-password`,{reset_token:i,new_password:r})},changePassword({userId:i,currentPassword:r,newPassword:o}){return s.post(`/apps/${t}/auth/change-password`,{user_id:i,current_password:r,new_password:o})}}}function bO(s,e,t){return{async getAccessToken(n){const i=`/apps/${e}/auth/sso/accesstoken/${n}`,r={};return t&&(r["on-behalf-of"]=`Bearer ${t}`),s.get(i,{headers:r})}}}function AO(s,e){return{async getAccessToken(t){if(!t||typeof t!="string")throw new Error("Integration type is required and must be a string");return(await s.get(`/apps/${e}/external-auth/tokens/${t}`)).access_token}}}function qm(s={}){const{storageKey:e="base44_access_token",paramName:t="access_token",saveToStorage:n=!0,removeFromUrl:i=!0}=s;let r=null;if(typeof window<"u"&&window.location)try{const o=new URLSearchParams(window.location.search);if(r=o.get(t),r){if(n&&wO(r,{storageKey:e}),i){o.delete(t);const l=`${window.location.pathname}${o.toString()?`?${o.toString()}`:""}${window.location.hash}`;window.history.replaceState({},document.title,l)}return r}}catch(o){console.error("Error retrieving token from URL:",o)}if(typeof window<"u"&&window.localStorage)try{return r=window.localStorage.getItem(e),r}catch(o){console.error("Error retrieving token from local storage:",o)}return null}function wO(s,e){const{storageKey:t="base44_access_token"}=e;if(typeof window>"u"||!window.localStorage||!s)return!1;try{return window.localStorage.setItem(t,s),window.localStorage.setItem("token",s),!0}catch(n){return console.error("Error saving token to local storage:",n),!1}}function zx(s,e){return{async invoke(t,n){if(typeof n=="string")throw new Error(`Function ${t} must receive an object with named parameters, received: ${n}`);let i,r;return n instanceof FormData||n&&Object.values(n).some(o=>o instanceof File)?(i=new FormData,Object.keys(n).forEach(o=>{n[o]instanceof File?i.append(o,n[o],n[o].name):typeof n[o]=="object"&&n[o]!==null?i.append(o,JSON.stringify(n[o])):i.append(o,n[o])}),r="multipart/form-data"):(i=n,r="application/json"),s.post(`/apps/${e}/functions/${t}`,i||n,{headers:{"Content-Type":r}})}}}function Wx({axios:s,getSocket:e,appId:t,serverUrl:n,token:i}){const r=`/apps/${t}/agents`;return{getConversations:()=>s.get(`${r}/conversations`),getConversation:v=>s.get(`${r}/conversations/${v}`),listConversations:v=>s.get(`${r}/conversations`,{params:v}),createConversation:v=>s.post(`${r}/conversations`,v),addMessage:async(v,y)=>{const S=`/agent-conversations/${v.id}`;return await e().updateModel(S,{...v,messages:[...v.messages||[],y]}),s.post(`${r}/conversations/${v.id}/messages`,y)},subscribeToConversation:(v,y)=>{const S=`/agent-conversations/${v}`;return e().subscribeToRoom(S,{connect:()=>{},update_model:({data:b})=>{const w=JSON.parse(b);y==null||y(w)}})},getWhatsAppConnectURL:v=>{const y=`${n}/api/apps/${t}/agents/${encodeURIComponent(v)}/whatsapp`,S=i??qm();return S?`${y}?token=${S}`:y}}}function qx(s,e){const t=`/app-logs/${e}`;return{async logUserInApp(n){await s.post(`${t}/log-user-in-app/${n}`)},async fetchLogs(n={}){return await s.get(t,{params:n})},async getStats(n={}){return await s.get(`${t}/stats`,{params:n})}}}function RO(s,e){return{async inviteUser(t,n){if(n!=="user"&&n!=="admin")throw new Error(`Invalid role: "${n}". Role must be either "user" or "admin".`);return await s.post(`/apps/${e}/runtime/users/invite-user`,{user_email:t,role:n})}}}const _s=Object.create(null);_s.open="0";_s.close="1";_s.ping="2";_s.pong="3";_s.message="4";_s.upgrade="5";_s.noop="6";const bu=Object.create(null);Object.keys(_s).forEach(s=>{bu[_s[s]]=s});const zp={type:"error",data:"parser error"},fb=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",pb=typeof ArrayBuffer=="function",mb=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer,Ym=({type:s,data:e},t,n)=>fb&&e instanceof Blob?t?n(e):Yx(e,n):pb&&(e instanceof ArrayBuffer||mb(e))?t?n(e):Yx(new Blob([e]),n):n(_s[s]+(e||"")),Yx=(s,e)=>{const t=new FileReader;return t.onload=function(){const n=t.result.split(",")[1];e("b"+(n||""))},t.readAsDataURL(s)};function Qx(s){return s instanceof Uint8Array?s:s instanceof ArrayBuffer?new Uint8Array(s):new Uint8Array(s.buffer,s.byteOffset,s.byteLength)}let Cf;function LO(s,e){if(fb&&s.data instanceof Blob)return s.data.arrayBuffer().then(Qx).then(e);if(pb&&(s.data instanceof ArrayBuffer||mb(s.data)))return e(Qx(s.data));Ym(s,!1,t=>{Cf||(Cf=new TextEncoder),e(Cf.encode(t))})}const Xx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ha=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let s=0;s<Xx.length;s++)Ha[Xx.charCodeAt(s)]=s;const IO=s=>{let e=s.length*.75,t=s.length,n,i=0,r,o,l,u;s[s.length-1]==="="&&(e--,s[s.length-2]==="="&&e--);const d=new ArrayBuffer(e),h=new Uint8Array(d);for(n=0;n<t;n+=4)r=Ha[s.charCodeAt(n)],o=Ha[s.charCodeAt(n+1)],l=Ha[s.charCodeAt(n+2)],u=Ha[s.charCodeAt(n+3)],h[i++]=r<<2|o>>4,h[i++]=(o&15)<<4|l>>2,h[i++]=(l&3)<<6|u&63;return d},_O=typeof ArrayBuffer=="function",Qm=(s,e)=>{if(typeof s!="string")return{type:"message",data:gb(s,e)};const t=s.charAt(0);return t==="b"?{type:"message",data:kO(s.substring(1),e)}:bu[t]?s.length>1?{type:bu[t],data:s.substring(1)}:{type:bu[t]}:zp},kO=(s,e)=>{if(_O){const t=IO(s);return gb(t,e)}else return{base64:!0,data:s}},gb=(s,e)=>{switch(e){case"blob":return s instanceof Blob?s:new Blob([s]);case"arraybuffer":default:return s instanceof ArrayBuffer?s:s.buffer}},yb="",CO=(s,e)=>{const t=s.length,n=new Array(t);let i=0;s.forEach((r,o)=>{Ym(r,!1,l=>{n[o]=l,++i===t&&e(n.join(yb))})})},PO=(s,e)=>{const t=s.split(yb),n=[];for(let i=0;i<t.length;i++){const r=Qm(t[i],e);if(n.push(r),r.type==="error")break}return n};function DO(){return new TransformStream({transform(s,e){LO(s,t=>{const n=t.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const r=new DataView(i.buffer);r.setUint8(0,126),r.setUint16(1,n)}else{i=new Uint8Array(9);const r=new DataView(i.buffer);r.setUint8(0,127),r.setBigUint64(1,BigInt(n))}s.data&&typeof s.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(t)})}})}let Pf;function Qc(s){return s.reduce((e,t)=>e+t.length,0)}function Xc(s,e){if(s[0].length===e)return s.shift();const t=new Uint8Array(e);let n=0;for(let i=0;i<e;i++)t[i]=s[0][n++],n===s[0].length&&(s.shift(),n=0);return s.length&&n<s[0].length&&(s[0]=s[0].slice(n)),t}function OO(s,e){Pf||(Pf=new TextDecoder);const t=[];let n=0,i=-1,r=!1;return new TransformStream({transform(o,l){for(t.push(o);;){if(n===0){if(Qc(t)<1)break;const u=Xc(t,1);r=(u[0]&128)===128,i=u[0]&127,i<126?n=3:i===126?n=1:n=2}else if(n===1){if(Qc(t)<2)break;const u=Xc(t,2);i=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),n=3}else if(n===2){if(Qc(t)<8)break;const u=Xc(t,8),d=new DataView(u.buffer,u.byteOffset,u.length),h=d.getUint32(0);if(h>Math.pow(2,21)-1){l.enqueue(zp);break}i=h*Math.pow(2,32)+d.getUint32(4),n=3}else{if(Qc(t)<i)break;const u=Xc(t,i);l.enqueue(Qm(r?u:Pf.decode(u),e)),n=0}if(i===0||i>s){l.enqueue(zp);break}}}})}const vb=4;function Rt(s){if(s)return NO(s)}function NO(s){for(var e in Rt.prototype)s[e]=Rt.prototype[e];return s}Rt.prototype.on=Rt.prototype.addEventListener=function(s,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(e),this};Rt.prototype.once=function(s,e){function t(){this.off(s,t),e.apply(this,arguments)}return t.fn=e,this.on(s,t),this};Rt.prototype.off=Rt.prototype.removeListener=Rt.prototype.removeAllListeners=Rt.prototype.removeEventListener=function(s,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+s];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+s],this;for(var n,i=0;i<t.length;i++)if(n=t[i],n===e||n.fn===e){t.splice(i,1);break}return t.length===0&&delete this._callbacks["$"+s],this};Rt.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+s],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t){t=t.slice(0);for(var n=0,i=t.length;n<i;++n)t[n].apply(this,e)}return this};Rt.prototype.emitReserved=Rt.prototype.emit;Rt.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]};Rt.prototype.hasListeners=function(s){return!!this.listeners(s).length};const gd=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Hn=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),MO="arraybuffer";function xb(s,...e){return e.reduce((t,n)=>(s.hasOwnProperty(n)&&(t[n]=s[n]),t),{})}const FO=Hn.setTimeout,BO=Hn.clearTimeout;function yd(s,e){e.useNativeTimers?(s.setTimeoutFn=FO.bind(Hn),s.clearTimeoutFn=BO.bind(Hn)):(s.setTimeoutFn=Hn.setTimeout.bind(Hn),s.clearTimeoutFn=Hn.clearTimeout.bind(Hn))}const UO=1.33;function $O(s){return typeof s=="string"?jO(s):Math.ceil((s.byteLength||s.size)*UO)}function jO(s){let e=0,t=0;for(let n=0,i=s.length;n<i;n++)e=s.charCodeAt(n),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(n++,t+=4);return t}function Sb(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function VO(s){let e="";for(let t in s)s.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(s[t]));return e}function GO(s){let e={},t=s.split("&");for(let n=0,i=t.length;n<i;n++){let r=t[n].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}class KO extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class Xm extends Rt{constructor(e){super(),this.writable=!1,yd(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new KO(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Qm(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=VO(e);return t.length?"?"+t:""}}class HO extends Xm{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||t()})),this.writable||(n++,this.once("drain",function(){--n||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};PO(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,CO(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Sb()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Eb=!1;try{Eb=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const zO=Eb;function WO(){}class qO extends HO{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let n=location.port;n||(n=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(i,r)=>{this.onError("xhr post error",i,r)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,n)=>{this.onError("xhr poll error",t,n)}),this.pollXhr=e}}class Rs extends Rt{constructor(e,t,n){super(),this.createRequest=e,yd(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const t=xb(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var i;n.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=Rs.requestsCount++,Rs.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=WO,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Rs.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Rs.requestsCount=0;Rs.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Jx);else if(typeof addEventListener=="function"){const s="onpagehide"in Hn?"pagehide":"unload";addEventListener(s,Jx,!1)}}function Jx(){for(let s in Rs.requests)Rs.requests.hasOwnProperty(s)&&Rs.requests[s].abort()}const YO=(function(){const s=Tb({xdomain:!1});return s&&s.responseType!==null})();class QO extends qO{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=YO&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Rs(Tb,this.uri(),e)}}function Tb(s){const e=s.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||zO))return new XMLHttpRequest}catch{}if(!e)try{return new Hn[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const bb=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class XO extends Xm{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=bb?{}:xb(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],i=t===e.length-1;Ym(n,this.supportsBinary,r=>{try{this.doWrite(n,r)}catch{}i&&gd(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Sb()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Df=Hn.WebSocket||Hn.MozWebSocket;class JO extends XO{createSocket(e,t,n){return bb?new Df(e,t,n):t?new Df(e,t):new Df(e)}doWrite(e,t){this.ws.send(t)}}class ZO extends Xm{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=OO(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),i=DO();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const r=()=>{n.read().then(({done:l,value:u})=>{l||(this.onPacket(u),r())}).catch(l=>{})};r();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],i=t===e.length-1;this._writer.write(n).then(()=>{i&&gd(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const eN={websocket:JO,webtransport:ZO,polling:QO},tN=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,nN=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Wp(s){if(s.length>8e3)throw"URI too long";const e=s,t=s.indexOf("["),n=s.indexOf("]");t!=-1&&n!=-1&&(s=s.substring(0,t)+s.substring(t,n).replace(/:/g,";")+s.substring(n,s.length));let i=tN.exec(s||""),r={},o=14;for(;o--;)r[nN[o]]=i[o]||"";return t!=-1&&n!=-1&&(r.source=e,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=sN(r,r.path),r.queryKey=iN(r,r.query),r}function sN(s,e){const t=/\/{2,9}/g,n=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function iN(s,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,r){i&&(t[i]=r)}),t}const qp=typeof addEventListener=="function"&&typeof removeEventListener=="function",Au=[];qp&&addEventListener("offline",()=>{Au.forEach(s=>s())},!1);class Fi extends Rt{constructor(e,t){if(super(),this.binaryType=MO,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const n=Wp(e);t.hostname=n.host,t.secure=n.protocol==="https"||n.protocol==="wss",t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=Wp(t.host).host);yd(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(n=>{const i=n.prototype.name;this.transports.push(i),this._transportsByName[i]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=GO(this.opts.query)),qp&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Au.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=vb,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Fi.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Fi.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const i=this.writeBuffer[n].data;if(i&&(t+=$O(i)),n>0&&t>this._maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,gd(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,i){if(typeof t=="function"&&(i=t,t=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const r={type:e,data:t,options:n};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(Fi.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),qp&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=Au.indexOf(this._offlineEventListener);n!==-1&&Au.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Fi.protocol=vb;class rN extends Fi{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;Fi.priorWebsocketSuccess=!1;const i=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",p=>{if(!n)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Fi.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(h(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const m=new Error("probe error");m.transport=t.name,this.emitReserved("upgradeError",m)}}))};function r(){n||(n=!0,h(),t.close(),t=null)}const o=p=>{const m=new Error("probe error: "+p);m.transport=t.name,r(),this.emitReserved("upgradeError",m)};function l(){o("transport closed")}function u(){o("socket closed")}function d(p){t&&p.name!==t.name&&r()}const h=()=>{t.removeListener("open",i),t.removeListener("error",o),t.removeListener("close",l),this.off("close",u),this.off("upgrading",d)};t.once("open",i),t.once("error",o),t.once("close",l),this.once("close",u),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}let oN=class extends rN{constructor(e,t={}){const n=typeof e=="object"?e:t;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(i=>eN[i]).filter(i=>!!i)),super(e,n)}};function aN(s,e="",t){let n=s;t=t||typeof location<"u"&&location,s==null&&(s=t.protocol+"//"+t.host),typeof s=="string"&&(s.charAt(0)==="/"&&(s.charAt(1)==="/"?s=t.protocol+s:s=t.host+s),/^(https?|wss?):\/\//.test(s)||(typeof t<"u"?s=t.protocol+"//"+s:s="https://"+s),n=Wp(s)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const r=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+r+":"+n.port+e,n.href=n.protocol+"://"+r+(t&&t.port===n.port?"":":"+n.port),n}const lN=typeof ArrayBuffer=="function",cN=s=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer,Ab=Object.prototype.toString,uN=typeof Blob=="function"||typeof Blob<"u"&&Ab.call(Blob)==="[object BlobConstructor]",dN=typeof File=="function"||typeof File<"u"&&Ab.call(File)==="[object FileConstructor]";function Jm(s){return lN&&(s instanceof ArrayBuffer||cN(s))||uN&&s instanceof Blob||dN&&s instanceof File}function wu(s,e){if(!s||typeof s!="object")return!1;if(Array.isArray(s)){for(let t=0,n=s.length;t<n;t++)if(wu(s[t]))return!0;return!1}if(Jm(s))return!0;if(s.toJSON&&typeof s.toJSON=="function"&&arguments.length===1)return wu(s.toJSON(),!0);for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&wu(s[t]))return!0;return!1}function hN(s){const e=[],t=s.data,n=s;return n.data=Yp(t,e),n.attachments=e.length,{packet:n,buffers:e}}function Yp(s,e){if(!s)return s;if(Jm(s)){const t={_placeholder:!0,num:e.length};return e.push(s),t}else if(Array.isArray(s)){const t=new Array(s.length);for(let n=0;n<s.length;n++)t[n]=Yp(s[n],e);return t}else if(typeof s=="object"&&!(s instanceof Date)){const t={};for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=Yp(s[n],e));return t}return s}function fN(s,e){return s.data=Qp(s.data,e),delete s.attachments,s}function Qp(s,e){if(!s)return s;if(s&&s._placeholder===!0){if(typeof s.num=="number"&&s.num>=0&&s.num<e.length)return e[s.num];throw new Error("illegal attachments")}else if(Array.isArray(s))for(let t=0;t<s.length;t++)s[t]=Qp(s[t],e);else if(typeof s=="object")for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(s[t]=Qp(s[t],e));return s}const pN=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],mN=5;var ze;(function(s){s[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK"})(ze||(ze={}));class gN{constructor(e){this.replacer=e}encode(e){return(e.type===ze.EVENT||e.type===ze.ACK)&&wu(e)?this.encodeAsBinary({type:e.type===ze.EVENT?ze.BINARY_EVENT:ze.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===ze.BINARY_EVENT||e.type===ze.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=hN(e),n=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(n),i}}function Zx(s){return Object.prototype.toString.call(s)==="[object Object]"}class Zm extends Rt{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===ze.BINARY_EVENT;n||t.type===ze.BINARY_ACK?(t.type=n?ze.EVENT:ze.ACK,this.reconstructor=new yN(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Jm(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(ze[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===ze.BINARY_EVENT||n.type===ze.BINARY_ACK){const r=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(r,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(t+1)==="/"){const r=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););n.nsp=e.substring(r,t)}else n.nsp="/";const i=e.charAt(t+1);if(i!==""&&Number(i)==i){const r=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(Zm.isPayloadValid(n.type,r))n.data=r;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case ze.CONNECT:return Zx(t);case ze.DISCONNECT:return t===void 0;case ze.CONNECT_ERROR:return typeof t=="string"||Zx(t);case ze.EVENT:case ze.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&pN.indexOf(t[0])===-1);case ze.ACK:case ze.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class yN{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=fN(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const vN=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Zm,Encoder:gN,get PacketType(){return ze},protocol:mN},Symbol.toStringTag,{value:"Module"}));function cs(s,e,t){return s.on(e,t),function(){s.off(e,t)}}const xN=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class wb extends Rt{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[cs(e,"open",this.onopen.bind(this)),cs(e,"packet",this.onpacket.bind(this)),cs(e,"error",this.onerror.bind(this)),cs(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var n,i,r;if(xN.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:ze.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const h=this.ids++,p=t.pop();this._registerAckCallback(h,p),o.id=h}const l=(i=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||i===void 0?void 0:i.writable,u=this.connected&&!(!((r=this.io.engine)===null||r===void 0)&&r._hasPingExpired());return this.flags.volatile&&!l||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var n;const i=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(i===void 0){this.acks[e]=t;return}const r=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},i),o=(...l)=>{this.io.clearTimeoutFn(r),t.apply(this,l)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((n,i)=>{const r=(o,l)=>o?i(o):n(l);r.withError=!0,t.push(r),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...r)=>n!==this._queue[0]?void 0:(i!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(i)):(this._queue.shift(),t&&t(null,...r)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:ze.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case ze.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ze.EVENT:case ze.BINARY_EVENT:this.onevent(e);break;case ze.ACK:case ze.BINARY_ACK:this.onack(e);break;case ze.DISCONNECT:this.ondisconnect();break;case ze.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...i){n||(n=!0,t.packet({type:ze.ACK,id:e,data:i}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ze.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function Wo(s){s=s||{},this.ms=s.min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}Wo.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*s);s=(Math.floor(e*10)&1)==0?s-t:s+t}return Math.min(s,this.max)|0};Wo.prototype.reset=function(){this.attempts=0};Wo.prototype.setMin=function(s){this.ms=s};Wo.prototype.setMax=function(s){this.max=s};Wo.prototype.setJitter=function(s){this.jitter=s};class Xp extends Rt{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,yd(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((n=t.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Wo({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||vN;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new oN(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=cs(t,"open",function(){n.onopen(),e&&e()}),r=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},o=cs(t,"error",r);if(this._timeout!==!1){const l=this._timeout,u=this.setTimeoutFn(()=>{i(),r(new Error("timeout")),t.close()},l);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(cs(e,"ping",this.onping.bind(this)),cs(e,"data",this.ondata.bind(this)),cs(e,"error",this.onerror.bind(this)),cs(e,"close",this.onclose.bind(this)),cs(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){gd(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new wb(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t)if(this.nsps[n].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Fa={};function Ru(s,e){typeof s=="object"&&(e=s,s=void 0),e=e||{};const t=aN(s,e.path||"/socket.io"),n=t.source,i=t.id,r=t.path,o=Fa[i]&&r in Fa[i].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let u;return l?u=new Xp(n,e):(Fa[i]||(Fa[i]=new Xp(n,e)),u=Fa[i]),t.query&&!e.query&&(e.query=t.queryKey),u.socket(t.path,e)}Object.assign(Ru,{Manager:Xp,Socket:wb,io:Ru,connect:Ru});function eS(s,e){var t;const n=Ru(s.serverUrl,{path:s.mountPath,transports:s.transports,query:{app_id:s.appId,token:(t=s.token)!==null&&t!==void 0?t:qm()}});return n.on("connect",async()=>{var i;return console.log("connect",n.id),(i=e.connect)===null||i===void 0?void 0:i.call(e)}),n.on("update_model",async i=>{var r;return(r=e.update_model)===null||r===void 0?void 0:r.call(e,i)}),n.on("error",async i=>{var r;return(r=e.error)===null||r===void 0?void 0:r.call(e,i)}),n.on("connect_error",async i=>{var r;return console.error("connect_error",i),(r=e.error)===null||r===void 0?void 0:r.call(e,i)}),n}function SN({config:s}){let e={...s};const t={},n={connect:async()=>{const v=[];Object.keys(t).forEach(y=>{u(y);const S=p(y);S==null||S.forEach(({connect:x})=>{const b=async()=>x==null?void 0:x();v.push(b())})}),await Promise.all(v)},update_model:async v=>{const S=p(v.room).map(x=>{var b;return(b=x.update_model)===null||b===void 0?void 0:b.call(x,v)});await Promise.all(S)},error:async v=>{console.error("error",v);const y=Object.values(t).flat().map(S=>{var x;return(x=S.error)===null||x===void 0?void 0:x.call(S,v)});await Promise.all(y)}};let i=eS(s,n);function r(){o()}function o(){i&&i.disconnect()}function l(v){r(),e={...e,...v},i=eS(e,n)}function u(v){i.emit("join",v)}function d(v){i.emit("leave",v)}async function h(v,y){var S;const x=JSON.stringify(y);return(S=n.update_model)===null||S===void 0?void 0:S.call(n,{room:v,data:x})}function p(v){return t[v]}return{socket:i,subscribeToRoom:(v,y)=>(t[v]||(u(v),t[v]=[]),t[v].push(y),()=>{var S,x;t[v]=(x=(S=t[v])===null||S===void 0?void 0:S.filter(b=>b!==y))!==null&&x!==void 0?x:[],t[v].length===0&&d(v)}),updateConfig:l,updateModel:h,disconnect:o}}const Ba=typeof window<"u"?window:{base44SharedInstances:{}};function EN(s,e){return Ba.base44SharedInstances||(Ba.base44SharedInstances={}),Ba.base44SharedInstances[s]||(Ba.base44SharedInstances[s]={instance:e()}),Ba.base44SharedInstances[s].instance}const TN="__user_heartbeat_event__",bN="__initialization_event__",AN="__session_duration_event__",tS="analytics-enable",nS="base44_analytics_session_id",wN={enabled:!0,maxQueueSize:1e3,throttleTime:1e3,batchSize:30,heartBeatInterval:60*1e3},RN="analytics",st=EN(RN,()=>({requestsQueue:[],isProcessing:!1,isHeartBeatProcessing:!1,wasInitializationTracked:!1,sessionContext:null,sessionStartTime:null,config:{...wN,...ON()}})),LN=({axiosClient:s,serverUrl:e,appId:t,userAuthModule:n})=>{var i;const{maxQueueSize:r,throttleTime:o,batchSize:l}=st.config;if(!(!((i=st.config)===null||i===void 0)&&i.enabled))return{track:()=>{},cleanup:()=>{}};let u;const d=`${e}/api/apps/${t}/analytics/track/batch`,h=async L=>{await s.request({method:"POST",url:`/apps/${t}/analytics/track/batch`,data:{events:L}})},p=L=>{try{const I=JSON.stringify({events:L}),k=new Blob([I],{type:"application/json"});return typeof navigator>"u"||I.length>6e4||!navigator.sendBeacon(d,k)}catch{return!1}},m=async(L,I={})=>{if(L.length===0)return;const k=await DN(n),M=L.map(PN(k));try{(!I.isBeacon||!p(M))&&await h(M)}catch{}},v=()=>{iS(m,{throttleTime:o,batchSize:l})},y=L=>{if(st.requestsQueue.length>=r)return;const I=CN();st.requestsQueue.push({...L,...I}),v()},S=()=>{iS(m,{throttleTime:o,batchSize:l}),u=rS(y),_N()},x=()=>{sS(),u==null||u(),kN(y);const L=st.requestsQueue.splice(0);m(L,{isBeacon:!0})},b=()=>{typeof window>"u"||(document.visibilityState==="hidden"?x():document.visibilityState==="visible"&&S())},w=()=>{sS(),u==null||u(),typeof window<"u"&&window.removeEventListener("visibilitychange",b)};return v(),u=rS(y),IN(y),typeof window<"u"&&window.addEventListener("visibilitychange",b),{track:y,cleanup:w}};function sS(){st.isProcessing=!1}async function iS(s,e){if(st.isProcessing)return;st.isProcessing=!0;const{throttleTime:t=1e3,batchSize:n=30}=e??{};for(;st.isProcessing&&st.requestsQueue.length>0;){const i=st.requestsQueue.splice(0,n);i.length&&await s(i),await new Promise(r=>setTimeout(r,t))}st.isProcessing=!1}function rS(s){var e;if(st.isHeartBeatProcessing||((e=st.config.heartBeatInterval)!==null&&e!==void 0?e:0)<10)return()=>{};st.isHeartBeatProcessing=!0;const t=setInterval(()=>{s({eventName:TN})},st.config.heartBeatInterval);return()=>{clearInterval(t),st.isHeartBeatProcessing=!1}}function IN(s){typeof window>"u"||st.wasInitializationTracked||(st.wasInitializationTracked=!0,s({eventName:bN,properties:{referrer:document==null?void 0:document.referrer}}))}function _N(){typeof window>"u"||st.sessionStartTime!==null||(st.sessionStartTime=new Date().toISOString())}function kN(s){if(typeof window>"u"||st.sessionStartTime===null)return;const e=new Date().getTime()-new Date(st.sessionStartTime).getTime();st.sessionStartTime=null,s({eventName:AN,properties:{sessionDuration:e}})}function CN(){return{timestamp:new Date().toISOString(),pageUrl:typeof window<"u"?window.location.pathname:null}}function PN(s){return e=>({event_name:e.eventName,properties:e.properties,timestamp:e.timestamp,page_url:e.pageUrl,...s})}let Of=null;async function DN(s){if(!st.sessionContext){if(!Of){const e=NN();Of=s.me().then(t=>({user_id:t.id,session_id:e})).catch(()=>({user_id:null,session_id:e}))}st.sessionContext=await Of}return st.sessionContext}function ON(){if(typeof window>"u")return;const e=new URLSearchParams(window.location.search).get(tS);if(e==null||!e.length)return;const t=new URLSearchParams(window.location.search);t.delete(tS);const n=window.location.pathname+(t.toString()?"?"+t.toString():"");return window.history.replaceState({},"",n),{enabled:e==="true"}}function NN(){if(typeof window>"u")return _f();try{const s=localStorage.getItem(nS);if(!s){const e=_f();return localStorage.setItem(nS,e),e}return s}catch{return _f()}}function MN(s){const{serverUrl:e="https://base44.app",appId:t,token:n,serviceToken:i,requiresAuth:r=!1,appBaseUrl:o,options:l,functionsVersion:u,headers:d}=s,h={serverUrl:e,mountPath:"/ws-user-apps/socket.io/",transports:["websocket"],appId:t,token:n};let p=null;const m=()=>(p||(p=SN({config:h})),p),v={...d,"X-App-Id":String(t)},y=u?{...v,"Base44-Functions-Version":u}:v,S=Ka({baseURL:`${e}/api`,headers:v,token:n,onError:l==null?void 0:l.onError}),x=Ka({baseURL:`${e}/api`,headers:y,token:n,interceptResponses:!1,onError:l==null?void 0:l.onError}),b=Ka({baseURL:`${e}/api`,headers:v,token:i,onError:l==null?void 0:l.onError}),w=Ka({baseURL:`${e}/api`,headers:y,token:i,interceptResponses:!1}),L=TO(S,x,t,{appBaseUrl:o}),I={entities:Kx({axios:S,appId:t,getSocket:m}),integrations:Hx(S,t),auth:L,functions:zx(x,t),agents:Wx({axios:S,getSocket:m,appId:t,serverUrl:e,token:n}),appLogs:qx(S,t),users:RO(S,t),analytics:LN({axiosClient:S,serverUrl:e,appId:t,userAuthModule:L}),cleanup:()=>{I.analytics.cleanup(),p&&p.disconnect()}},k={entities:Kx({axios:b,appId:t,getSocket:m}),integrations:Hx(b,t),sso:bO(b,t,n),connectors:AO(b,t),functions:zx(w,t),agents:Wx({axios:b,getSocket:m,appId:t,serverUrl:e,token:n}),appLogs:qx(b,t),cleanup:()=>{p&&p.disconnect()}};if(typeof window<"u"){const P=n||qm();P&&I.auth.setToken(P)}return r&&typeof window<"u"&&setTimeout(async()=>{try{await I.auth.isAuthenticated()||I.auth.redirectToLogin(window.location.href)}catch(P){console.error("Authentication check failed:",P),I.auth.redirectToLogin(window.location.href)}},0),{...I,setToken(P){I.auth.setToken(P),p&&p.updateConfig({token:P}),h.token=P},getConfig(){return{serverUrl:e,appId:t,requiresAuth:r}},get asServiceRole(){if(!i)throw new Error("Service token is required to use asServiceRole. Please provide a serviceToken when creating the client.");return k}}}const Rb=typeof window>"u",FN=Rb?{localStorage:new Map}:window,Ja=FN.localStorage,BN=s=>s.replace(/([A-Z])/g,"_$1").toLowerCase(),oo=(s,{defaultValue:e=void 0,removeFromUrl:t=!1}={})=>{if(Rb)return e;const n=`base44_${BN(s)}`,i=new URLSearchParams(window.location.search),r=i.get(s);if(t){i.delete(s);const l=`${window.location.pathname}${i.toString()?`?${i.toString()}`:""}${window.location.hash}`;window.history.replaceState({},document.title,l)}if(r)return Ja.setItem(n,r),r;if(e)return Ja.setItem(n,e),e;const o=Ja.getItem(n);return o||null},UN=()=>(oo("clear_access_token")==="true"&&(Ja.removeItem("base44_access_token"),Ja.removeItem("token")),{appId:oo("app_id",{defaultValue:"696633135c7378350f6b4b47"}),token:oo("access_token",{removeFromUrl:!0}),fromUrl:oo("from_url",{defaultValue:window.location.href}),functionsVersion:oo("functions_version",{defaultValue:"prod"}),appBaseUrl:oo("app_base_url",{defaultValue:void 0})}),za={...UN()},{appId:$N,token:jN,functionsVersion:VN,appBaseUrl:GN}=za,pr=MN({appId:$N,token:jN,functionsVersion:VN,serverUrl:"",requiresAuth:!1,appBaseUrl:GN}),Lb=B.createContext(),KN=({children:s})=>{const[e,t]=B.useState(null),[n,i]=B.useState(!1),[r,o]=B.useState(!0),[l,u]=B.useState(!0),[d,h]=B.useState(null),[p,m]=B.useState(null);B.useEffect(()=>{v()},[]);const v=async()=>{var b,w;try{u(!0),h(null);const L=Ka({baseURL:"/api/apps/public",headers:{"X-App-Id":za.appId},token:za.token,interceptResponses:!0});try{const I=await L.get(`/prod/public-settings/by-id/${za.appId}`);m(I),za.token?await y():(o(!1),i(!1)),u(!1)}catch(I){if(console.error("App state check failed:",I),I.status===403&&((w=(b=I.data)==null?void 0:b.extra_data)!=null&&w.reason)){const k=I.data.extra_data.reason;h(k==="auth_required"?{type:"auth_required",message:"Authentication required"}:k==="user_not_registered"?{type:"user_not_registered",message:"User not registered for this app"}:{type:k,message:I.message})}else h({type:"unknown",message:I.message||"Failed to load app"});u(!1),o(!1)}}catch(L){console.error("Unexpected error:",L),h({type:"unknown",message:L.message||"An unexpected error occurred"}),u(!1),o(!1)}},y=async()=>{try{o(!0);const b=await pr.auth.me();t(b),i(!0),o(!1)}catch(b){console.error("User auth check failed:",b),o(!1),i(!1),(b.status===401||b.status===403)&&h({type:"auth_required",message:"Authentication required"})}},S=(b=!0)=>{t(null),i(!1),b?pr.auth.logout(window.location.href):pr.auth.logout()},x=()=>{pr.auth.redirectToLogin(window.location.href)};return A.jsx(Lb.Provider,{value:{user:e,isAuthenticated:n,isLoadingAuth:r,isLoadingPublicSettings:l,authError:d,appPublicSettings:p,logout:S,navigateToLogin:x,checkAppState:v},children:s})},Ib=()=>{const s=B.useContext(Lb);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s},vd=B.createContext(null);function eg(s){const e=B.useRef(null);return e.current===null&&(e.current=s()),e.current}const tg=B.createContext({transformPagePoint:s=>s,isStatic:!1,reducedMotion:"never"});class HN extends B.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function zN({children:s,isPresent:e}){const t=B.useId(),n=B.useRef(null),i=B.useRef({width:0,height:0,top:0,left:0}),{nonce:r}=B.useContext(tg);return B.useInsertionEffect(()=>{const{width:o,height:l,top:u,left:d}=i.current;if(e||!n.current||!o||!l)return;n.current.dataset.motionPopId=t;const h=document.createElement("style");return r&&(h.nonce=r),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            top: ${u}px !important;
            left: ${d}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[e]),A.jsx(HN,{isPresent:e,childRef:n,sizeRef:i,children:B.cloneElement(s,{ref:n})})}const WN=({children:s,initial:e,isPresent:t,onExitComplete:n,custom:i,presenceAffectsLayout:r,mode:o})=>{const l=eg(qN),u=B.useId(),d=B.useCallback(p=>{l.set(p,!0);for(const m of l.values())if(!m)return;n&&n()},[l,n]),h=B.useMemo(()=>({id:u,initial:e,isPresent:t,custom:i,onExitComplete:d,register:p=>(l.set(p,!1),()=>l.delete(p))}),r?[Math.random(),d]:[t,d]);return B.useMemo(()=>{l.forEach((p,m)=>l.set(m,!1))},[t]),B.useEffect(()=>{!t&&!l.size&&n&&n()},[t]),o==="popLayout"&&(s=A.jsx(zN,{isPresent:t,children:s})),A.jsx(vd.Provider,{value:h,children:s})};function qN(){return new Map}const ng=B.createContext({}),Pn=s=>s;let _b=Pn;function sg(s){let e;return()=>(e===void 0&&(e=s()),e)}const Bo=(s,e,t)=>{const n=e-s;return n===0?1:(t-s)/n},Ys=s=>s*1e3,Qs=s=>s/1e3,Jc=s=>s.key||"";function oS(s){const e=[];return B.Children.forEach(s,t=>{B.isValidElement(t)&&e.push(t)}),e}const ig=typeof window<"u",kb=ig?B.useLayoutEffect:B.useEffect,tn=({children:s,exitBeforeEnter:e,custom:t,initial:n=!0,onExitComplete:i,presenceAffectsLayout:r=!0,mode:o="sync"})=>{const l=B.useMemo(()=>oS(s),[s]),u=l.map(Jc),d=B.useRef(!0),h=B.useRef(l),p=eg(()=>new Map),[m,v]=B.useState(l),[y,S]=B.useState(l);kb(()=>{d.current=!1,h.current=l;for(let w=0;w<y.length;w++){const L=Jc(y[w]);u.includes(L)?p.delete(L):p.get(L)!==!0&&p.set(L,!1)}},[y,u.length,u.join("-")]);const x=[];if(l!==m){let w=[...l];for(let L=0;L<y.length;L++){const I=y[L],k=Jc(I);u.includes(k)||(w.splice(L,0,I),x.push(I))}o==="wait"&&x.length&&(w=x),S(oS(w)),v(l);return}const{forceRender:b}=B.useContext(ng);return A.jsx(A.Fragment,{children:y.map(w=>{const L=Jc(w),I=l===y||u.includes(L),k=()=>{if(p.has(L))p.set(L,!0);else return;let M=!0;p.forEach(P=>{P||(M=!1)}),M&&(b==null||b(),S(h.current),i&&i())};return A.jsx(WN,{isPresent:I,initial:!d.current||n?void 0:!1,custom:I?void 0:t,presenceAffectsLayout:r,mode:o,onExitComplete:I?void 0:k,children:w},L)})})},YN={useManualTiming:!1};function QN(s){let e=new Set,t=new Set,n=!1,i=!1;const r=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(d){r.has(d)&&(u.schedule(d),s()),d(o)}const u={schedule:(d,h=!1,p=!1)=>{const v=p&&n?e:t;return h&&r.add(d),v.has(d)||v.add(d),d},cancel:d=>{t.delete(d),r.delete(d)},process:d=>{if(o=d,n){i=!0;return}n=!0,[e,t]=[t,e],e.forEach(l),e.clear(),n=!1,i&&(i=!1,u.process(d))}};return u}const Zc=["read","resolveKeyframes","update","preRender","render","postRender"],XN=40;function Cb(s,e){let t=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},r=()=>t=!0,o=Zc.reduce((b,w)=>(b[w]=QN(r),b),{}),{read:l,resolveKeyframes:u,update:d,preRender:h,render:p,postRender:m}=o,v=()=>{const b=performance.now();t=!1,i.delta=n?1e3/60:Math.max(Math.min(b-i.timestamp,XN),1),i.timestamp=b,i.isProcessing=!0,l.process(i),u.process(i),d.process(i),h.process(i),p.process(i),m.process(i),i.isProcessing=!1,t&&e&&(n=!1,s(v))},y=()=>{t=!0,n=!0,i.isProcessing||s(v)};return{schedule:Zc.reduce((b,w)=>{const L=o[w];return b[w]=(I,k=!1,M=!1)=>(t||y(),L.schedule(I,k,M)),b},{}),cancel:b=>{for(let w=0;w<Zc.length;w++)o[Zc[w]].cancel(b)},state:i,steps:o}}const{schedule:lt,cancel:Ui,state:Gt,steps:Nf}=Cb(typeof requestAnimationFrame<"u"?requestAnimationFrame:Pn,!0),Pb=B.createContext({strict:!1}),aS={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Uo={};for(const s in aS)Uo[s]={isEnabled:e=>aS[s].some(t=>!!e[t])};function JN(s){for(const e in s)Uo[e]={...Uo[e],...s[e]}}const ZN=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Vu(s){return s.startsWith("while")||s.startsWith("drag")&&s!=="draggable"||s.startsWith("layout")||s.startsWith("onTap")||s.startsWith("onPan")||s.startsWith("onLayout")||ZN.has(s)}let Db=s=>!Vu(s);function eM(s){s&&(Db=e=>e.startsWith("on")?!Vu(e):s(e))}try{eM(require("@emotion/is-prop-valid").default)}catch{}function tM(s,e,t){const n={};for(const i in s)i==="values"&&typeof s.values=="object"||(Db(i)||t===!0&&Vu(i)||!e&&!Vu(i)||s.draggable&&i.startsWith("onDrag"))&&(n[i]=s[i]);return n}function nM(s){if(typeof Proxy>"u")return s;const e=new Map,t=(...n)=>s(...n);return new Proxy(t,{get:(n,i)=>i==="create"?s:(e.has(i)||e.set(i,s(i)),e.get(i))})}const xd=B.createContext({});function cl(s){return typeof s=="string"||Array.isArray(s)}function Sd(s){return s!==null&&typeof s=="object"&&typeof s.start=="function"}const rg=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],og=["initial",...rg];function Ed(s){return Sd(s.animate)||og.some(e=>cl(s[e]))}function Ob(s){return!!(Ed(s)||s.variants)}function sM(s,e){if(Ed(s)){const{initial:t,animate:n}=s;return{initial:t===!1||cl(t)?t:void 0,animate:cl(n)?n:void 0}}return s.inherit!==!1?e:{}}function iM(s){const{initial:e,animate:t}=sM(s,B.useContext(xd));return B.useMemo(()=>({initial:e,animate:t}),[lS(e),lS(t)])}function lS(s){return Array.isArray(s)?s.join(" "):s}const rM=Symbol.for("motionComponentSymbol");function po(s){return s&&typeof s=="object"&&Object.prototype.hasOwnProperty.call(s,"current")}function oM(s,e,t){return B.useCallback(n=>{n&&s.mount&&s.mount(n),e&&(n?e.mount(n):e.unmount()),t&&(typeof t=="function"?t(n):po(t)&&(t.current=n))},[e])}const ag=s=>s.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),aM="framerAppearId",Nb="data-"+ag(aM),{schedule:lg}=Cb(queueMicrotask,!1),Mb=B.createContext({});function lM(s,e,t,n,i){var r,o;const{visualElement:l}=B.useContext(xd),u=B.useContext(Pb),d=B.useContext(vd),h=B.useContext(tg).reducedMotion,p=B.useRef(null);n=n||u.renderer,!p.current&&n&&(p.current=n(s,{visualState:e,parent:l,props:t,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:h}));const m=p.current,v=B.useContext(Mb);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&cM(p.current,t,i,v);const y=B.useRef(!1);B.useInsertionEffect(()=>{m&&y.current&&m.update(t,d)});const S=t[Nb],x=B.useRef(!!S&&!(!((r=window.MotionHandoffIsComplete)===null||r===void 0)&&r.call(window,S))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,S)));return kb(()=>{m&&(y.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),lg.render(m.render),x.current&&m.animationState&&m.animationState.animateChanges())}),B.useEffect(()=>{m&&(!x.current&&m.animationState&&m.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)===null||b===void 0||b.call(window,S)}),x.current=!1))}),m}function cM(s,e,t,n){const{layoutId:i,layout:r,drag:o,dragConstraints:l,layoutScroll:u,layoutRoot:d}=e;s.projection=new t(s.latestValues,e["data-framer-portal-id"]?void 0:Fb(s.parent)),s.projection.setOptions({layoutId:i,layout:r,alwaysMeasureLayout:!!o||l&&po(l),visualElement:s,animationType:typeof r=="string"?r:"both",initialPromotionConfig:n,layoutScroll:u,layoutRoot:d})}function Fb(s){if(s)return s.options.allowProjection!==!1?s.projection:Fb(s.parent)}function uM({preloadedFeatures:s,createVisualElement:e,useRender:t,useVisualState:n,Component:i}){var r,o;s&&JN(s);function l(d,h){let p;const m={...B.useContext(tg),...d,layoutId:dM(d)},{isStatic:v}=m,y=iM(d),S=n(d,v);if(!v&&ig){hM();const x=fM(m);p=x.MeasureLayout,y.visualElement=lM(i,S,m,e,x.ProjectionNode)}return A.jsxs(xd.Provider,{value:y,children:[p&&y.visualElement?A.jsx(p,{visualElement:y.visualElement,...m}):null,t(i,d,oM(S,y.visualElement,h),S,v,y.visualElement)]})}l.displayName=`motion.${typeof i=="string"?i:`create(${(o=(r=i.displayName)!==null&&r!==void 0?r:i.name)!==null&&o!==void 0?o:""})`}`;const u=B.forwardRef(l);return u[rM]=i,u}function dM({layoutId:s}){const e=B.useContext(ng).id;return e&&s!==void 0?e+"-"+s:s}function hM(s,e){B.useContext(Pb).strict}function fM(s){const{drag:e,layout:t}=Uo;if(!e&&!t)return{};const n={...e,...t};return{MeasureLayout:e!=null&&e.isEnabled(s)||t!=null&&t.isEnabled(s)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const pM=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function cg(s){return typeof s!="string"||s.includes("-")?!1:!!(pM.indexOf(s)>-1||/[A-Z]/u.test(s))}function Bb(s,{style:e,vars:t},n,i){Object.assign(s.style,e,i&&i.getProjectionStyles(n));for(const r in t)s.style.setProperty(r,t[r])}const Ub=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function $b(s,e,t,n){Bb(s,e,void 0,n);for(const i in e.attrs)s.setAttribute(Ub.has(i)?i:ag(i),e.attrs[i])}const nn=s=>!!(s&&s.getVelocity),Gu={};function mM(s){Object.assign(Gu,s)}const Pl=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Pr=new Set(Pl);function jb(s,{layout:e,layoutId:t}){return Pr.has(s)||s.startsWith("origin")||(e||t!==void 0)&&(!!Gu[s]||s==="opacity")}function ug(s,e,t){var n;const{style:i}=s,r={};for(const o in i)(nn(i[o])||e.style&&nn(e.style[o])||jb(o,s)||((n=t==null?void 0:t.getValue(o))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(r[o]=i[o]);return r}function Vb(s,e,t){const n=ug(s,e,t);for(const i in s)if(nn(s[i])||nn(e[i])){const r=Pl.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[r]=s[i]}return n}function cS(s){const e=[{},{}];return s==null||s.values.forEach((t,n)=>{e[0][n]=t.get(),e[1][n]=t.getVelocity()}),e}function dg(s,e,t,n){if(typeof e=="function"){const[i,r]=cS(n);e=e(t!==void 0?t:s.custom,i,r)}if(typeof e=="string"&&(e=s.variants&&s.variants[e]),typeof e=="function"){const[i,r]=cS(n);e=e(t!==void 0?t:s.custom,i,r)}return e}const Jp=s=>Array.isArray(s),gM=s=>!!(s&&typeof s=="object"&&s.mix&&s.toValue),yM=s=>Jp(s)?s[s.length-1]||0:s;function Lu(s){const e=nn(s)?s.get():s;return gM(e)?e.toValue():e}function vM({scrapeMotionValuesFromProps:s,createRenderState:e,onMount:t},n,i,r){const o={latestValues:xM(n,i,r,s),renderState:e()};return t&&(o.mount=l=>t(n,l,o)),o}const Gb=s=>(e,t)=>{const n=B.useContext(xd),i=B.useContext(vd),r=()=>vM(s,e,n,i);return t?r():eg(r)};function xM(s,e,t,n){const i={},r=n(s,{});for(const m in r)i[m]=Lu(r[m]);let{initial:o,animate:l}=s;const u=Ed(s),d=Ob(s);e&&d&&!u&&s.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let h=t?t.initial===!1:!1;h=h||o===!1;const p=h?l:o;if(p&&typeof p!="boolean"&&!Sd(p)){const m=Array.isArray(p)?p:[p];for(let v=0;v<m.length;v++){const y=dg(s,m[v]);if(y){const{transitionEnd:S,transition:x,...b}=y;for(const w in b){let L=b[w];if(Array.isArray(L)){const I=h?L.length-1:0;L=L[I]}L!==null&&(i[w]=L)}for(const w in S)i[w]=S[w]}}}return i}const hg=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Kb=()=>({...hg(),attrs:{}}),Hb=(s,e)=>e&&typeof s=="number"?e.transform(s):s,Xs=(s,e,t)=>t>e?e:t<s?s:t,qo={test:s=>typeof s=="number",parse:parseFloat,transform:s=>s},ul={...qo,transform:s=>Xs(0,1,s)},eu={...qo,default:1},Dl=s=>({test:e=>typeof e=="string"&&e.endsWith(s)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${s}`}),Ai=Dl("deg"),Ls=Dl("%"),Pe=Dl("px"),SM=Dl("vh"),EM=Dl("vw"),uS={...Ls,parse:s=>Ls.parse(s)/100,transform:s=>Ls.transform(s*100)},TM={borderWidth:Pe,borderTopWidth:Pe,borderRightWidth:Pe,borderBottomWidth:Pe,borderLeftWidth:Pe,borderRadius:Pe,radius:Pe,borderTopLeftRadius:Pe,borderTopRightRadius:Pe,borderBottomRightRadius:Pe,borderBottomLeftRadius:Pe,width:Pe,maxWidth:Pe,height:Pe,maxHeight:Pe,top:Pe,right:Pe,bottom:Pe,left:Pe,padding:Pe,paddingTop:Pe,paddingRight:Pe,paddingBottom:Pe,paddingLeft:Pe,margin:Pe,marginTop:Pe,marginRight:Pe,marginBottom:Pe,marginLeft:Pe,backgroundPositionX:Pe,backgroundPositionY:Pe},bM={rotate:Ai,rotateX:Ai,rotateY:Ai,rotateZ:Ai,scale:eu,scaleX:eu,scaleY:eu,scaleZ:eu,skew:Ai,skewX:Ai,skewY:Ai,distance:Pe,translateX:Pe,translateY:Pe,translateZ:Pe,x:Pe,y:Pe,z:Pe,perspective:Pe,transformPerspective:Pe,opacity:ul,originX:uS,originY:uS,originZ:Pe},dS={...qo,transform:Math.round},fg={...TM,...bM,zIndex:dS,size:Pe,fillOpacity:ul,strokeOpacity:ul,numOctaves:dS},AM={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},wM=Pl.length;function RM(s,e,t){let n="",i=!0;for(let r=0;r<wM;r++){const o=Pl[r],l=s[o];if(l===void 0)continue;let u=!0;if(typeof l=="number"?u=l===(o.startsWith("scale")?1:0):u=parseFloat(l)===0,!u||t){const d=Hb(l,fg[o]);if(!u){i=!1;const h=AM[o]||o;n+=`${h}(${d}) `}t&&(e[o]=d)}}return n=n.trim(),t?n=t(e,i?"":n):i&&(n="none"),n}const zb=s=>e=>typeof e=="string"&&e.startsWith(s),Wb=zb("--"),LM=zb("var(--"),pg=s=>LM(s)?IM.test(s.split("/*")[0].trim()):!1,IM=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function mg(s,e,t){const{style:n,vars:i,transformOrigin:r}=s;let o=!1,l=!1;for(const u in e){const d=e[u];if(Pr.has(u)){o=!0;continue}else if(Wb(u)){i[u]=d;continue}else{const h=Hb(d,fg[u]);u.startsWith("origin")?(l=!0,r[u]=h):n[u]=h}}if(e.transform||(o||t?n.transform=RM(e,s.transform,t):n.transform&&(n.transform="none")),l){const{originX:u="50%",originY:d="50%",originZ:h=0}=r;n.transformOrigin=`${u} ${d} ${h}`}}function hS(s,e,t){return typeof s=="string"?s:Pe.transform(e+t*s)}function _M(s,e,t){const n=hS(e,s.x,s.width),i=hS(t,s.y,s.height);return`${n} ${i}`}const kM={offset:"stroke-dashoffset",array:"stroke-dasharray"},CM={offset:"strokeDashoffset",array:"strokeDasharray"};function PM(s,e,t=1,n=0,i=!0){s.pathLength=1;const r=i?kM:CM;s[r.offset]=Pe.transform(-n);const o=Pe.transform(e),l=Pe.transform(t);s[r.array]=`${o} ${l}`}function gg(s,{attrX:e,attrY:t,attrScale:n,originX:i,originY:r,pathLength:o,pathSpacing:l=1,pathOffset:u=0,...d},h,p){if(mg(s,d,p),h){s.style.viewBox&&(s.attrs.viewBox=s.style.viewBox);return}s.attrs=s.style,s.style={};const{attrs:m,style:v,dimensions:y}=s;m.transform&&(y&&(v.transform=m.transform),delete m.transform),y&&(i!==void 0||r!==void 0||v.transform)&&(v.transformOrigin=_M(y,i!==void 0?i:.5,r!==void 0?r:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),n!==void 0&&(m.scale=n),o!==void 0&&PM(m,o,l,u,!1)}const yg=s=>typeof s=="string"&&s.toLowerCase()==="svg",DM={useVisualState:Gb({scrapeMotionValuesFromProps:Vb,createRenderState:Kb,onMount:(s,e,{renderState:t,latestValues:n})=>{lt.read(()=>{try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}),lt.render(()=>{gg(t,n,yg(e.tagName),s.transformTemplate),$b(e,t)})}})},OM={useVisualState:Gb({scrapeMotionValuesFromProps:ug,createRenderState:hg})};function qb(s,e,t){for(const n in e)!nn(e[n])&&!jb(n,t)&&(s[n]=e[n])}function NM({transformTemplate:s},e){return B.useMemo(()=>{const t=hg();return mg(t,e,s),Object.assign({},t.vars,t.style)},[e])}function MM(s,e){const t=s.style||{},n={};return qb(n,t,s),Object.assign(n,NM(s,e)),n}function FM(s,e){const t={},n=MM(s,e);return s.drag&&s.dragListener!==!1&&(t.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=s.drag===!0?"none":`pan-${s.drag==="x"?"y":"x"}`),s.tabIndex===void 0&&(s.onTap||s.onTapStart||s.whileTap)&&(t.tabIndex=0),t.style=n,t}function BM(s,e,t,n){const i=B.useMemo(()=>{const r=Kb();return gg(r,e,yg(n),s.transformTemplate),{...r.attrs,style:{...r.style}}},[e]);if(s.style){const r={};qb(r,s.style,s),i.style={...r,...i.style}}return i}function UM(s=!1){return(t,n,i,{latestValues:r},o)=>{const u=(cg(t)?BM:FM)(n,r,o,t),d=tM(n,typeof t=="string",s),h=t!==B.Fragment?{...d,...u,ref:i}:{},{children:p}=n,m=B.useMemo(()=>nn(p)?p.get():p,[p]);return B.createElement(t,{...h,children:m})}}function $M(s,e){return function(n,{forwardMotionProps:i}={forwardMotionProps:!1}){const o={...cg(n)?DM:OM,preloadedFeatures:s,useRender:UM(i),createVisualElement:e,Component:n};return uM(o)}}function Yb(s,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==s.length)return!1;for(let n=0;n<t;n++)if(e[n]!==s[n])return!1;return!0}function Td(s,e,t){const n=s.getProps();return dg(n,e,t!==void 0?t:n.custom,s)}const jM=sg(()=>window.ScrollTimeline!==void 0);class VM{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=t}attachTimeline(e,t){const n=this.animations.map(i=>{if(jM()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{n.forEach((i,r)=>{i&&i(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class GM extends VM{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function vg(s,e){return s?s[e]||s.default||s:void 0}const Zp=2e4;function Qb(s){let e=0;const t=50;let n=s.next(e);for(;!n.done&&e<Zp;)e+=t,n=s.next(e);return e>=Zp?1/0:e}function xg(s){return typeof s=="function"}function fS(s,e){s.timeline=e,s.onfinish=null}const Sg=s=>Array.isArray(s)&&typeof s[0]=="number",KM={linearEasing:void 0};function HM(s,e){const t=sg(s);return()=>{var n;return(n=KM[e])!==null&&n!==void 0?n:t()}}const Ku=HM(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Xb=(s,e,t=10)=>{let n="";const i=Math.max(Math.round(e/t),2);for(let r=0;r<i;r++)n+=s(Bo(0,i-1,r))+", ";return`linear(${n.substring(0,n.length-2)})`};function Jb(s){return!!(typeof s=="function"&&Ku()||!s||typeof s=="string"&&(s in em||Ku())||Sg(s)||Array.isArray(s)&&s.every(Jb))}const Wa=([s,e,t,n])=>`cubic-bezier(${s}, ${e}, ${t}, ${n})`,em={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Wa([0,.65,.55,1]),circOut:Wa([.55,0,1,.45]),backIn:Wa([.31,.01,.66,-.59]),backOut:Wa([.33,1.53,.69,.99])};function Zb(s,e){if(s)return typeof s=="function"&&Ku()?Xb(s,e):Sg(s)?Wa(s):Array.isArray(s)?s.map(t=>Zb(t,e)||em.easeOut):em[s]}const rs={x:!1,y:!1};function eA(){return rs.x||rs.y}function zM(s,e,t){var n;if(s instanceof Element)return[s];if(typeof s=="string"){let i=document;const r=(n=void 0)!==null&&n!==void 0?n:i.querySelectorAll(s);return r?Array.from(r):[]}return Array.from(s)}function tA(s,e){const t=zM(s),n=new AbortController,i={passive:!0,...e,signal:n.signal};return[t,i,()=>n.abort()]}function pS(s){return e=>{e.pointerType==="touch"||eA()||s(e)}}function WM(s,e,t={}){const[n,i,r]=tA(s,t),o=pS(l=>{const{target:u}=l,d=e(l);if(typeof d!="function"||!u)return;const h=pS(p=>{d(p),u.removeEventListener("pointerleave",h)});u.addEventListener("pointerleave",h,i)});return n.forEach(l=>{l.addEventListener("pointerenter",o,i)}),r}const nA=(s,e)=>e?s===e?!0:nA(s,e.parentElement):!1,Eg=s=>s.pointerType==="mouse"?typeof s.button!="number"||s.button<=0:s.isPrimary!==!1,qM=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function YM(s){return qM.has(s.tagName)||s.tabIndex!==-1}const qa=new WeakSet;function mS(s){return e=>{e.key==="Enter"&&s(e)}}function Mf(s,e){s.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const QM=(s,e)=>{const t=s.currentTarget;if(!t)return;const n=mS(()=>{if(qa.has(t))return;Mf(t,"down");const i=mS(()=>{Mf(t,"up")}),r=()=>Mf(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",r,e)});t.addEventListener("keydown",n,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",n),e)};function gS(s){return Eg(s)&&!eA()}function XM(s,e,t={}){const[n,i,r]=tA(s,t),o=l=>{const u=l.currentTarget;if(!gS(l)||qa.has(u))return;qa.add(u);const d=e(l),h=(v,y)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",m),!(!gS(v)||!qa.has(u))&&(qa.delete(u),typeof d=="function"&&d(v,{success:y}))},p=v=>{h(v,t.useGlobalTarget||nA(u,v.target))},m=v=>{h(v,!1)};window.addEventListener("pointerup",p,i),window.addEventListener("pointercancel",m,i)};return n.forEach(l=>{!YM(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",o,i),l.addEventListener("focus",d=>QM(d,i),i)}),r}function JM(s){return s==="x"||s==="y"?rs[s]?null:(rs[s]=!0,()=>{rs[s]=!1}):rs.x||rs.y?null:(rs.x=rs.y=!0,()=>{rs.x=rs.y=!1})}let Iu;function ZM(){Iu=void 0}const Is={now:()=>(Iu===void 0&&Is.set(Gt.isProcessing||YN.useManualTiming?Gt.timestamp:performance.now()),Iu),set:s=>{Iu=s,queueMicrotask(ZM)}};function Tg(s,e){s.indexOf(e)===-1&&s.push(e)}function bg(s,e){const t=s.indexOf(e);t>-1&&s.splice(t,1)}class Ag{constructor(){this.subscriptions=[]}add(e){return Tg(this.subscriptions,e),()=>bg(this.subscriptions,e)}notify(e,t,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,n);else for(let r=0;r<i;r++){const o=this.subscriptions[r];o&&o(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function sA(s,e){return e?s*(1e3/e):0}const yS=30,e2=s=>!isNaN(parseFloat(s));class t2{constructor(e,t={}){this.version="11.16.4",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,i=!0)=>{const r=Is.now();this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Is.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=e2(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Ag);const n=this.events[e].add(t);return e==="change"?()=>{n(),lt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Is.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>yS)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,yS);return sA(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function dl(s,e){return new t2(s,e)}function n2(s,e,t){s.hasValue(e)?s.getValue(e).set(t):s.addValue(e,dl(t))}function s2(s,e){const t=Td(s,e);let{transitionEnd:n={},transition:i={},...r}=t||{};r={...r,...n};for(const o in r){const l=yM(r[o]);n2(s,o,l)}}function i2(s){return!!(nn(s)&&s.add)}function tm(s,e){const t=s.getValue("willChange");if(i2(t))return t.add(e)}function iA(s){return s.props[Nb]}const rA=(s,e,t)=>(((1-3*t+3*e)*s+(3*t-6*e))*s+3*e)*s,r2=1e-7,o2=12;function a2(s,e,t,n,i){let r,o,l=0;do o=e+(t-e)/2,r=rA(o,n,i)-s,r>0?t=o:e=o;while(Math.abs(r)>r2&&++l<o2);return o}function Ol(s,e,t,n){if(s===e&&t===n)return Pn;const i=r=>a2(r,0,1,s,t);return r=>r===0||r===1?r:rA(i(r),e,n)}const oA=s=>e=>e<=.5?s(2*e)/2:(2-s(2*(1-e)))/2,aA=s=>e=>1-s(1-e),lA=Ol(.33,1.53,.69,.99),wg=aA(lA),cA=oA(wg),uA=s=>(s*=2)<1?.5*wg(s):.5*(2-Math.pow(2,-10*(s-1))),Rg=s=>1-Math.sin(Math.acos(s)),dA=aA(Rg),hA=oA(Rg),fA=s=>/^0[^.\s]+$/u.test(s);function l2(s){return typeof s=="number"?s===0:s!==null?s==="none"||s==="0"||fA(s):!0}const pA=s=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(s),c2=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function u2(s){const e=c2.exec(s);if(!e)return[,];const[,t,n,i]=e;return[`--${t??n}`,i]}function mA(s,e,t=1){const[n,i]=u2(s);if(!n)return;const r=window.getComputedStyle(e).getPropertyValue(n);if(r){const o=r.trim();return pA(o)?parseFloat(o):o}return pg(i)?mA(i,e,t+1):i}const d2=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),vS=s=>s===qo||s===Pe,xS=(s,e)=>parseFloat(s.split(", ")[e]),SS=(s,e)=>(t,{transform:n})=>{if(n==="none"||!n)return 0;const i=n.match(/^matrix3d\((.+)\)$/u);if(i)return xS(i[1],e);{const r=n.match(/^matrix\((.+)\)$/u);return r?xS(r[1],s):0}},h2=new Set(["x","y","z"]),f2=Pl.filter(s=>!h2.has(s));function p2(s){const e=[];return f2.forEach(t=>{const n=s.getValue(t);n!==void 0&&(e.push([t,n.get()]),n.set(t.startsWith("scale")?1:0))}),e}const $o={width:({x:s},{paddingLeft:e="0",paddingRight:t="0"})=>s.max-s.min-parseFloat(e)-parseFloat(t),height:({y:s},{paddingTop:e="0",paddingBottom:t="0"})=>s.max-s.min-parseFloat(e)-parseFloat(t),top:(s,{top:e})=>parseFloat(e),left:(s,{left:e})=>parseFloat(e),bottom:({y:s},{top:e})=>parseFloat(e)+(s.max-s.min),right:({x:s},{left:e})=>parseFloat(e)+(s.max-s.min),x:SS(4,13),y:SS(5,14)};$o.translateX=$o.x;$o.translateY=$o.y;const gA=s=>e=>e.test(s),m2={test:s=>s==="auto",parse:s=>s},yA=[qo,Pe,Ls,Ai,EM,SM,m2],ES=s=>yA.find(gA(s)),Rr=new Set;let nm=!1,sm=!1;function vA(){if(sm){const s=Array.from(Rr).filter(n=>n.needsMeasurement),e=new Set(s.map(n=>n.element)),t=new Map;e.forEach(n=>{const i=p2(n);i.length&&(t.set(n,i),n.render())}),s.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const i=t.get(n);i&&i.forEach(([r,o])=>{var l;(l=n.getValue(r))===null||l===void 0||l.set(o)})}),s.forEach(n=>n.measureEndState()),s.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}sm=!1,nm=!1,Rr.forEach(s=>s.complete()),Rr.clear()}function xA(){Rr.forEach(s=>{s.readKeyframes(),s.needsMeasurement&&(sm=!0)})}function g2(){xA(),vA()}class Lg{constructor(e,t,n,i,r,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=i,this.element=r,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Rr.add(this),nm||(nm=!0,lt.read(xA),lt.resolveKeyframes(vA))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:i}=this;for(let r=0;r<e.length;r++)if(e[r]===null)if(r===0){const o=i==null?void 0:i.get(),l=e[e.length-1];if(o!==void 0)e[0]=o;else if(n&&t){const u=n.readValue(t,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),i&&o===void 0&&i.set(e[0])}else e[r]=e[r-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Rr.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Rr.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Za=s=>Math.round(s*1e5)/1e5,Ig=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function y2(s){return s==null}const v2=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,_g=(s,e)=>t=>!!(typeof t=="string"&&v2.test(t)&&t.startsWith(s)||e&&!y2(t)&&Object.prototype.hasOwnProperty.call(t,e)),SA=(s,e,t)=>n=>{if(typeof n!="string")return n;const[i,r,o,l]=n.match(Ig);return{[s]:parseFloat(i),[e]:parseFloat(r),[t]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},x2=s=>Xs(0,255,s),Ff={...qo,transform:s=>Math.round(x2(s))},mr={test:_g("rgb","red"),parse:SA("red","green","blue"),transform:({red:s,green:e,blue:t,alpha:n=1})=>"rgba("+Ff.transform(s)+", "+Ff.transform(e)+", "+Ff.transform(t)+", "+Za(ul.transform(n))+")"};function S2(s){let e="",t="",n="",i="";return s.length>5?(e=s.substring(1,3),t=s.substring(3,5),n=s.substring(5,7),i=s.substring(7,9)):(e=s.substring(1,2),t=s.substring(2,3),n=s.substring(3,4),i=s.substring(4,5),e+=e,t+=t,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const im={test:_g("#"),parse:S2,transform:mr.transform},mo={test:_g("hsl","hue"),parse:SA("hue","saturation","lightness"),transform:({hue:s,saturation:e,lightness:t,alpha:n=1})=>"hsla("+Math.round(s)+", "+Ls.transform(Za(e))+", "+Ls.transform(Za(t))+", "+Za(ul.transform(n))+")"},Jt={test:s=>mr.test(s)||im.test(s)||mo.test(s),parse:s=>mr.test(s)?mr.parse(s):mo.test(s)?mo.parse(s):im.parse(s),transform:s=>typeof s=="string"?s:s.hasOwnProperty("red")?mr.transform(s):mo.transform(s)},E2=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function T2(s){var e,t;return isNaN(s)&&typeof s=="string"&&(((e=s.match(Ig))===null||e===void 0?void 0:e.length)||0)+(((t=s.match(E2))===null||t===void 0?void 0:t.length)||0)>0}const EA="number",TA="color",b2="var",A2="var(",TS="${}",w2=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function hl(s){const e=s.toString(),t=[],n={color:[],number:[],var:[]},i=[];let r=0;const l=e.replace(w2,u=>(Jt.test(u)?(n.color.push(r),i.push(TA),t.push(Jt.parse(u))):u.startsWith(A2)?(n.var.push(r),i.push(b2),t.push(u)):(n.number.push(r),i.push(EA),t.push(parseFloat(u))),++r,TS)).split(TS);return{values:t,split:l,indexes:n,types:i}}function bA(s){return hl(s).values}function AA(s){const{split:e,types:t}=hl(s),n=e.length;return i=>{let r="";for(let o=0;o<n;o++)if(r+=e[o],i[o]!==void 0){const l=t[o];l===EA?r+=Za(i[o]):l===TA?r+=Jt.transform(i[o]):r+=i[o]}return r}}const R2=s=>typeof s=="number"?0:s;function L2(s){const e=bA(s);return AA(s)(e.map(R2))}const $i={test:T2,parse:bA,createTransformer:AA,getAnimatableNone:L2},I2=new Set(["brightness","contrast","saturate","opacity"]);function _2(s){const[e,t]=s.slice(0,-1).split("(");if(e==="drop-shadow")return s;const[n]=t.match(Ig)||[];if(!n)return s;const i=t.replace(n,"");let r=I2.has(e)?1:0;return n!==t&&(r*=100),e+"("+r+i+")"}const k2=/\b([a-z-]*)\(.*?\)/gu,rm={...$i,getAnimatableNone:s=>{const e=s.match(k2);return e?e.map(_2).join(" "):s}},C2={...fg,color:Jt,backgroundColor:Jt,outlineColor:Jt,fill:Jt,stroke:Jt,borderColor:Jt,borderTopColor:Jt,borderRightColor:Jt,borderBottomColor:Jt,borderLeftColor:Jt,filter:rm,WebkitFilter:rm},kg=s=>C2[s];function wA(s,e){let t=kg(s);return t!==rm&&(t=$i),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const P2=new Set(["auto","none","0"]);function D2(s,e,t){let n=0,i;for(;n<s.length&&!i;){const r=s[n];typeof r=="string"&&!P2.has(r)&&hl(r).values.length&&(i=s[n]),n++}if(i&&t)for(const r of e)s[r]=wA(t,i)}class RA extends Lg{constructor(e,t,n,i,r){super(e,t,n,i,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let d=e[u];if(typeof d=="string"&&(d=d.trim(),pg(d))){const h=mA(d,t.current);h!==void 0&&(e[u]=h),u===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!d2.has(n)||e.length!==2)return;const[i,r]=e,o=ES(i),l=ES(r);if(o!==l)if(vS(o)&&vS(l))for(let u=0;u<e.length;u++){const d=e[u];typeof d=="string"&&(e[u]=parseFloat(d))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let i=0;i<e.length;i++)l2(e[i])&&n.push(i);n.length&&D2(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=$o[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(n,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const r=t.getValue(n);r&&r.jump(this.measuredOrigin,!1);const o=i.length-1,l=i[o];i[o]=$o[n](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,d])=>{t.getValue(u).set(d)}),this.resolveNoneKeyframes()}}const bS=(s,e)=>e==="zIndex"?!1:!!(typeof s=="number"||Array.isArray(s)||typeof s=="string"&&($i.test(s)||s==="0")&&!s.startsWith("url("));function O2(s){const e=s[0];if(s.length===1)return!0;for(let t=0;t<s.length;t++)if(s[t]!==e)return!0}function N2(s,e,t,n){const i=s[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const r=s[s.length-1],o=bS(i,e),l=bS(r,e);return!o||!l?!1:O2(s)||(t==="spring"||xg(t))&&n}const M2=s=>s!==null;function bd(s,{repeat:e,repeatType:t="loop"},n){const i=s.filter(M2),r=e&&t!=="loop"&&e%2===1?0:i.length-1;return!r||n===void 0?i[r]:n}const F2=40;class LA{constructor({autoplay:e=!0,delay:t=0,type:n="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:o="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Is.now(),this.options={autoplay:e,delay:t,type:n,repeat:i,repeatDelay:r,repeatType:o,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>F2?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&g2(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=Is.now(),this.hasAttemptedResolve=!0;const{name:n,type:i,velocity:r,delay:o,onComplete:l,onUpdate:u,isGenerator:d}=this.options;if(!d&&!N2(e,n,i,r))if(o)this.options.duration=0;else{u==null||u(bd(e,this.options,t)),l==null||l(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,t);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...h},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const pt=(s,e,t)=>s+(e-s)*t;function Bf(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*(2/3-t)*6:s}function B2({hue:s,saturation:e,lightness:t,alpha:n}){s/=360,e/=100,t/=100;let i=0,r=0,o=0;if(!e)i=r=o=t;else{const l=t<.5?t*(1+e):t+e-t*e,u=2*t-l;i=Bf(u,l,s+1/3),r=Bf(u,l,s),o=Bf(u,l,s-1/3)}return{red:Math.round(i*255),green:Math.round(r*255),blue:Math.round(o*255),alpha:n}}function Hu(s,e){return t=>t>0?e:s}const Uf=(s,e,t)=>{const n=s*s,i=t*(e*e-n)+n;return i<0?0:Math.sqrt(i)},U2=[im,mr,mo],$2=s=>U2.find(e=>e.test(s));function AS(s){const e=$2(s);if(!e)return!1;let t=e.parse(s);return e===mo&&(t=B2(t)),t}const wS=(s,e)=>{const t=AS(s),n=AS(e);if(!t||!n)return Hu(s,e);const i={...t};return r=>(i.red=Uf(t.red,n.red,r),i.green=Uf(t.green,n.green,r),i.blue=Uf(t.blue,n.blue,r),i.alpha=pt(t.alpha,n.alpha,r),mr.transform(i))},j2=(s,e)=>t=>e(s(t)),Nl=(...s)=>s.reduce(j2),om=new Set(["none","hidden"]);function V2(s,e){return om.has(s)?t=>t<=0?s:e:t=>t>=1?e:s}function G2(s,e){return t=>pt(s,e,t)}function Cg(s){return typeof s=="number"?G2:typeof s=="string"?pg(s)?Hu:Jt.test(s)?wS:z2:Array.isArray(s)?IA:typeof s=="object"?Jt.test(s)?wS:K2:Hu}function IA(s,e){const t=[...s],n=t.length,i=s.map((r,o)=>Cg(r)(r,e[o]));return r=>{for(let o=0;o<n;o++)t[o]=i[o](r);return t}}function K2(s,e){const t={...s,...e},n={};for(const i in t)s[i]!==void 0&&e[i]!==void 0&&(n[i]=Cg(s[i])(s[i],e[i]));return i=>{for(const r in n)t[r]=n[r](i);return t}}function H2(s,e){var t;const n=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const o=e.types[r],l=s.indexes[o][i[o]],u=(t=s.values[l])!==null&&t!==void 0?t:0;n[r]=u,i[o]++}return n}const z2=(s,e)=>{const t=$i.createTransformer(e),n=hl(s),i=hl(e);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?om.has(s)&&!i.values.length||om.has(e)&&!n.values.length?V2(s,e):Nl(IA(H2(n,i),i.values),t):Hu(s,e)};function _A(s,e,t){return typeof s=="number"&&typeof e=="number"&&typeof t=="number"?pt(s,e,t):Cg(s)(s,e)}const W2=5;function kA(s,e,t){const n=Math.max(e-W2,0);return sA(t-s(n),e-n)}const vt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},$f=.001;function q2({duration:s=vt.duration,bounce:e=vt.bounce,velocity:t=vt.velocity,mass:n=vt.mass}){let i,r,o=1-e;o=Xs(vt.minDamping,vt.maxDamping,o),s=Xs(vt.minDuration,vt.maxDuration,Qs(s)),o<1?(i=d=>{const h=d*o,p=h*s,m=h-t,v=am(d,o),y=Math.exp(-p);return $f-m/v*y},r=d=>{const p=d*o*s,m=p*t+t,v=Math.pow(o,2)*Math.pow(d,2)*s,y=Math.exp(-p),S=am(Math.pow(d,2),o);return(-i(d)+$f>0?-1:1)*((m-v)*y)/S}):(i=d=>{const h=Math.exp(-d*s),p=(d-t)*s+1;return-$f+h*p},r=d=>{const h=Math.exp(-d*s),p=(t-d)*(s*s);return h*p});const l=5/s,u=Q2(i,r,l);if(s=Ys(s),isNaN(u))return{stiffness:vt.stiffness,damping:vt.damping,duration:s};{const d=Math.pow(u,2)*n;return{stiffness:d,damping:o*2*Math.sqrt(n*d),duration:s}}}const Y2=12;function Q2(s,e,t){let n=t;for(let i=1;i<Y2;i++)n=n-s(n)/e(n);return n}function am(s,e){return s*Math.sqrt(1-e*e)}const X2=["duration","bounce"],J2=["stiffness","damping","mass"];function RS(s,e){return e.some(t=>s[t]!==void 0)}function Z2(s){let e={velocity:vt.velocity,stiffness:vt.stiffness,damping:vt.damping,mass:vt.mass,isResolvedFromDuration:!1,...s};if(!RS(s,J2)&&RS(s,X2))if(s.visualDuration){const t=s.visualDuration,n=2*Math.PI/(t*1.2),i=n*n,r=2*Xs(.05,1,1-(s.bounce||0))*Math.sqrt(i);e={...e,mass:vt.mass,stiffness:i,damping:r}}else{const t=q2(s);e={...e,...t,mass:vt.mass},e.isResolvedFromDuration=!0}return e}function CA(s=vt.visualDuration,e=vt.bounce){const t=typeof s!="object"?{visualDuration:s,keyframes:[0,1],bounce:e}:s;let{restSpeed:n,restDelta:i}=t;const r=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],l={done:!1,value:r},{stiffness:u,damping:d,mass:h,duration:p,velocity:m,isResolvedFromDuration:v}=Z2({...t,velocity:-Qs(t.velocity||0)}),y=m||0,S=d/(2*Math.sqrt(u*h)),x=o-r,b=Qs(Math.sqrt(u/h)),w=Math.abs(x)<5;n||(n=w?vt.restSpeed.granular:vt.restSpeed.default),i||(i=w?vt.restDelta.granular:vt.restDelta.default);let L;if(S<1){const k=am(b,S);L=M=>{const P=Math.exp(-S*b*M);return o-P*((y+S*b*x)/k*Math.sin(k*M)+x*Math.cos(k*M))}}else if(S===1)L=k=>o-Math.exp(-b*k)*(x+(y+b*x)*k);else{const k=b*Math.sqrt(S*S-1);L=M=>{const P=Math.exp(-S*b*M),C=Math.min(k*M,300);return o-P*((y+S*b*x)*Math.sinh(C)+k*x*Math.cosh(C))/k}}const I={calculatedDuration:v&&p||null,next:k=>{const M=L(k);if(v)l.done=k>=p;else{let P=0;S<1&&(P=k===0?Ys(y):kA(L,k,M));const C=Math.abs(P)<=n,U=Math.abs(o-M)<=i;l.done=C&&U}return l.value=l.done?o:M,l},toString:()=>{const k=Math.min(Qb(I),Zp),M=Xb(P=>I.next(k*P).value,k,30);return k+"ms "+M}};return I}function LS({keyframes:s,velocity:e=0,power:t=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:r=500,modifyTarget:o,min:l,max:u,restDelta:d=.5,restSpeed:h}){const p=s[0],m={done:!1,value:p},v=C=>l!==void 0&&C<l||u!==void 0&&C>u,y=C=>l===void 0?u:u===void 0||Math.abs(l-C)<Math.abs(u-C)?l:u;let S=t*e;const x=p+S,b=o===void 0?x:o(x);b!==x&&(S=b-p);const w=C=>-S*Math.exp(-C/n),L=C=>b+w(C),I=C=>{const U=w(C),O=L(C);m.done=Math.abs(U)<=d,m.value=m.done?b:O};let k,M;const P=C=>{v(m.value)&&(k=C,M=CA({keyframes:[m.value,y(m.value)],velocity:kA(L,C,m.value),damping:i,stiffness:r,restDelta:d,restSpeed:h}))};return P(0),{calculatedDuration:null,next:C=>{let U=!1;return!M&&k===void 0&&(U=!0,I(C),P(C)),k!==void 0&&C>=k?M.next(C-k):(!U&&I(C),m)}}}const eF=Ol(.42,0,1,1),tF=Ol(0,0,.58,1),PA=Ol(.42,0,.58,1),nF=s=>Array.isArray(s)&&typeof s[0]!="number",sF={linear:Pn,easeIn:eF,easeInOut:PA,easeOut:tF,circIn:Rg,circInOut:hA,circOut:dA,backIn:wg,backInOut:cA,backOut:lA,anticipate:uA},IS=s=>{if(Sg(s)){_b(s.length===4);const[e,t,n,i]=s;return Ol(e,t,n,i)}else if(typeof s=="string")return sF[s];return s};function iF(s,e,t){const n=[],i=t||_A,r=s.length-1;for(let o=0;o<r;o++){let l=i(s[o],s[o+1]);if(e){const u=Array.isArray(e)?e[o]||Pn:e;l=Nl(u,l)}n.push(l)}return n}function rF(s,e,{clamp:t=!0,ease:n,mixer:i}={}){const r=s.length;if(_b(r===e.length),r===1)return()=>e[0];if(r===2&&s[0]===s[1])return()=>e[1];s[0]>s[r-1]&&(s=[...s].reverse(),e=[...e].reverse());const o=iF(e,n,i),l=o.length,u=d=>{let h=0;if(l>1)for(;h<s.length-2&&!(d<s[h+1]);h++);const p=Bo(s[h],s[h+1],d);return o[h](p)};return t?d=>u(Xs(s[0],s[r-1],d)):u}function oF(s,e){const t=s[s.length-1];for(let n=1;n<=e;n++){const i=Bo(0,e,n);s.push(pt(t,1,i))}}function aF(s){const e=[0];return oF(e,s.length-1),e}function lF(s,e){return s.map(t=>t*e)}function cF(s,e){return s.map(()=>e||PA).splice(0,s.length-1)}function zu({duration:s=300,keyframes:e,times:t,ease:n="easeInOut"}){const i=nF(n)?n.map(IS):IS(n),r={done:!1,value:e[0]},o=lF(t&&t.length===e.length?t:aF(e),s),l=rF(o,e,{ease:Array.isArray(i)?i:cF(e,i)});return{calculatedDuration:s,next:u=>(r.value=l(u),r.done=u>=s,r)}}const uF=s=>{const e=({timestamp:t})=>s(t);return{start:()=>lt.update(e,!0),stop:()=>Ui(e),now:()=>Gt.isProcessing?Gt.timestamp:Is.now()}},dF={decay:LS,inertia:LS,tween:zu,keyframes:zu,spring:CA},hF=s=>s/100;class Pg extends LA{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:n,element:i,keyframes:r}=this.options,o=(i==null?void 0:i.KeyframeResolver)||Lg,l=(u,d)=>this.onKeyframesResolved(u,d);this.resolver=new o(r,l,t,n,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:r,velocity:o=0}=this.options,l=xg(t)?t:dF[t]||zu;let u,d;l!==zu&&typeof e[0]!="number"&&(u=Nl(hF,_A(e[0],e[1])),e=[0,100]);const h=l({...this.options,keyframes:e});r==="mirror"&&(d=l({...this.options,keyframes:[...e].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=Qb(h));const{calculatedDuration:p}=h,m=p+i,v=m*(n+1)-i;return{generator:h,mirroredGenerator:d,mapPercentToKeyframes:u,calculatedDuration:p,resolvedDuration:m,totalDuration:v}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:n}=this;if(!n){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:i,generator:r,mirroredGenerator:o,mapPercentToKeyframes:l,keyframes:u,calculatedDuration:d,totalDuration:h,resolvedDuration:p}=n;if(this.startTime===null)return r.next(0);const{delay:m,repeat:v,repeatType:y,repeatDelay:S,onUpdate:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const b=this.currentTime-m*(this.speed>=0?1:-1),w=this.speed>=0?b<0:b>h;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let L=this.currentTime,I=r;if(v){const C=Math.min(this.currentTime,h)/p;let U=Math.floor(C),O=C%1;!O&&C>=1&&(O=1),O===1&&U--,U=Math.min(U,v+1),!!(U%2)&&(y==="reverse"?(O=1-O,S&&(O-=S/p)):y==="mirror"&&(I=o)),L=Xs(0,1,O)*p}const k=w?{done:!1,value:u[0]}:I.next(L);l&&(k.value=l(k.value));let{done:M}=k;!w&&d!==null&&(M=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const P=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&M);return P&&i!==void 0&&(k.value=bd(u,this.options,i)),x&&x(k.value),P&&this.finish(),k}get duration(){const{resolved:e}=this;return e?Qs(e.calculatedDuration):0}get time(){return Qs(this.currentTime)}set time(e){e=Ys(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Qs(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=uF,onPlay:t,startTime:n}=this.options;this.driver||(this.driver=e(r=>this.tick(r))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const fF=new Set(["opacity","clipPath","filter","transform"]);function pF(s,e,t,{delay:n=0,duration:i=300,repeat:r=0,repeatType:o="loop",ease:l="easeInOut",times:u}={}){const d={[e]:t};u&&(d.offset=u);const h=Zb(l,i);return Array.isArray(h)&&(d.easing=h),s.animate(d,{delay:n,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:r+1,direction:o==="reverse"?"alternate":"normal"})}const mF=sg(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Wu=10,gF=2e4;function yF(s){return xg(s.type)||s.type==="spring"||!Jb(s.ease)}function vF(s,e){const t=new Pg({...e,keyframes:s,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:s[0]};const i=[];let r=0;for(;!n.done&&r<gF;)n=t.sample(r),i.push(n.value),r+=Wu;return{times:void 0,keyframes:i,duration:r-Wu,ease:"linear"}}const DA={anticipate:uA,backInOut:cA,circInOut:hA};function xF(s){return s in DA}class _S extends LA{constructor(e){super(e);const{name:t,motionValue:n,element:i,keyframes:r}=this.options;this.resolver=new RA(r,(o,l)=>this.onKeyframesResolved(o,l),t,n,i),this.resolver.scheduleResolve()}initPlayback(e,t){var n;let{duration:i=300,times:r,ease:o,type:l,motionValue:u,name:d,startTime:h}=this.options;if(!(!((n=u.owner)===null||n===void 0)&&n.current))return!1;if(typeof o=="string"&&Ku()&&xF(o)&&(o=DA[o]),yF(this.options)){const{onComplete:m,onUpdate:v,motionValue:y,element:S,...x}=this.options,b=vF(e,x);e=b.keyframes,e.length===1&&(e[1]=e[0]),i=b.duration,r=b.times,o=b.ease,l="keyframes"}const p=pF(u.owner.current,d,e,{...this.options,duration:i,times:r,ease:o});return p.startTime=h??this.calcStartTime(),this.pendingTimeline?(fS(p,this.pendingTimeline),this.pendingTimeline=void 0):p.onfinish=()=>{const{onComplete:m}=this.options;u.set(bd(e,this.options,t)),m&&m(),this.cancel(),this.resolveFinishedPromise()},{animation:p,duration:i,times:r,type:l,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return Qs(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return Qs(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.currentTime=Ys(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return Pn;const{animation:n}=t;fS(n,e)}return Pn}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:n,duration:i,type:r,ease:o,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:d,onUpdate:h,onComplete:p,element:m,...v}=this.options,y=new Pg({...v,keyframes:n,duration:i,type:r,ease:o,times:l,isGenerator:!0}),S=Ys(this.time);d.setWithVelocity(y.sample(S-Wu).value,y.sample(S).value,Wu)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:n,repeatDelay:i,repeatType:r,damping:o,type:l}=e;return mF()&&n&&fF.has(n)&&t&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate&&!i&&r!=="mirror"&&o!==0&&l!=="inertia"}}const SF={type:"spring",stiffness:500,damping:25,restSpeed:10},EF=s=>({type:"spring",stiffness:550,damping:s===0?2*Math.sqrt(550):30,restSpeed:10}),TF={type:"keyframes",duration:.8},bF={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},AF=(s,{keyframes:e})=>e.length>2?TF:Pr.has(s)?s.startsWith("scale")?EF(e[1]):SF:bF;function wF({when:s,delay:e,delayChildren:t,staggerChildren:n,staggerDirection:i,repeat:r,repeatType:o,repeatDelay:l,from:u,elapsed:d,...h}){return!!Object.keys(h).length}const Dg=(s,e,t,n={},i,r)=>o=>{const l=vg(n,s)||{},u=l.delay||n.delay||0;let{elapsed:d=0}=n;d=d-Ys(u);let h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-d,onUpdate:m=>{e.set(m),l.onUpdate&&l.onUpdate(m)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:s,motionValue:e,element:r?void 0:i};wF(l)||(h={...h,...AF(s,h)}),h.duration&&(h.duration=Ys(h.duration)),h.repeatDelay&&(h.repeatDelay=Ys(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(p=!0)),p&&!r&&e.get()!==void 0){const m=bd(h.keyframes,l);if(m!==void 0)return lt.update(()=>{h.onUpdate(m),h.onComplete()}),new GM([])}return!r&&_S.supports(h)?new _S(h):new Pg(h)};function RF({protectedKeys:s,needsAnimating:e},t){const n=s.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,n}function OA(s,e,{delay:t=0,transitionOverride:n,type:i}={}){var r;let{transition:o=s.getDefaultTransition(),transitionEnd:l,...u}=e;n&&(o=n);const d=[],h=i&&s.animationState&&s.animationState.getState()[i];for(const p in u){const m=s.getValue(p,(r=s.latestValues[p])!==null&&r!==void 0?r:null),v=u[p];if(v===void 0||h&&RF(h,p))continue;const y={delay:t,...vg(o||{},p)};let S=!1;if(window.MotionHandoffAnimation){const b=iA(s);if(b){const w=window.MotionHandoffAnimation(b,p,lt);w!==null&&(y.startTime=w,S=!0)}}tm(s,p),m.start(Dg(p,m,v,s.shouldReduceMotion&&Pr.has(p)?{type:!1}:y,s,S));const x=m.animation;x&&d.push(x)}return l&&Promise.all(d).then(()=>{lt.update(()=>{l&&s2(s,l)})}),d}function lm(s,e,t={}){var n;const i=Td(s,e,t.type==="exit"?(n=s.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:r=s.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(r=t.transitionOverride);const o=i?()=>Promise.all(OA(s,i,t)):()=>Promise.resolve(),l=s.variantChildren&&s.variantChildren.size?(d=0)=>{const{delayChildren:h=0,staggerChildren:p,staggerDirection:m}=r;return LF(s,e,h+d,p,m,t)}:()=>Promise.resolve(),{when:u}=r;if(u){const[d,h]=u==="beforeChildren"?[o,l]:[l,o];return d().then(()=>h())}else return Promise.all([o(),l(t.delay)])}function LF(s,e,t=0,n=0,i=1,r){const o=[],l=(s.variantChildren.size-1)*n,u=i===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(s.variantChildren).sort(IF).forEach((d,h)=>{d.notify("AnimationStart",e),o.push(lm(d,e,{...r,delay:t+u(h)}).then(()=>d.notify("AnimationComplete",e)))}),Promise.all(o)}function IF(s,e){return s.sortNodePosition(e)}function _F(s,e,t={}){s.notify("AnimationStart",e);let n;if(Array.isArray(e)){const i=e.map(r=>lm(s,r,t));n=Promise.all(i)}else if(typeof e=="string")n=lm(s,e,t);else{const i=typeof e=="function"?Td(s,e,t.custom):e;n=Promise.all(OA(s,i,t))}return n.then(()=>{s.notify("AnimationComplete",e)})}const kF=og.length;function NA(s){if(!s)return;if(!s.isControllingVariants){const t=s.parent?NA(s.parent)||{}:{};return s.props.initial!==void 0&&(t.initial=s.props.initial),t}const e={};for(let t=0;t<kF;t++){const n=og[t],i=s.props[n];(cl(i)||i===!1)&&(e[n]=i)}return e}const CF=[...rg].reverse(),PF=rg.length;function DF(s){return e=>Promise.all(e.map(({animation:t,options:n})=>_F(s,t,n)))}function OF(s){let e=DF(s),t=kS(),n=!0;const i=u=>(d,h)=>{var p;const m=Td(s,h,u==="exit"?(p=s.presenceContext)===null||p===void 0?void 0:p.custom:void 0);if(m){const{transition:v,transitionEnd:y,...S}=m;d={...d,...S,...y}}return d};function r(u){e=u(s)}function o(u){const{props:d}=s,h=NA(s.parent)||{},p=[],m=new Set;let v={},y=1/0;for(let x=0;x<PF;x++){const b=CF[x],w=t[b],L=d[b]!==void 0?d[b]:h[b],I=cl(L),k=b===u?w.isActive:null;k===!1&&(y=x);let M=L===h[b]&&L!==d[b]&&I;if(M&&n&&s.manuallyAnimateOnMount&&(M=!1),w.protectedKeys={...v},!w.isActive&&k===null||!L&&!w.prevProp||Sd(L)||typeof L=="boolean")continue;const P=NF(w.prevProp,L);let C=P||b===u&&w.isActive&&!M&&I||x>y&&I,U=!1;const O=Array.isArray(L)?L:[L];let W=O.reduce(i(b),{});k===!1&&(W={});const{prevResolvedValues:ne={}}=w,oe={...ne,...W},se=Z=>{C=!0,m.has(Z)&&(U=!0,m.delete(Z)),w.needsAnimating[Z]=!0;const F=s.getValue(Z);F&&(F.liveStyle=!1)};for(const Z in oe){const F=W[Z],ee=ne[Z];if(v.hasOwnProperty(Z))continue;let J=!1;Jp(F)&&Jp(ee)?J=!Yb(F,ee):J=F!==ee,J?F!=null?se(Z):m.add(Z):F!==void 0&&m.has(Z)?se(Z):w.protectedKeys[Z]=!0}w.prevProp=L,w.prevResolvedValues=W,w.isActive&&(v={...v,...W}),n&&s.blockInitialAnimation&&(C=!1),C&&(!(M&&P)||U)&&p.push(...O.map(Z=>({animation:Z,options:{type:b}})))}if(m.size){const x={};m.forEach(b=>{const w=s.getBaseTarget(b),L=s.getValue(b);L&&(L.liveStyle=!0),x[b]=w??null}),p.push({animation:x})}let S=!!p.length;return n&&(d.initial===!1||d.initial===d.animate)&&!s.manuallyAnimateOnMount&&(S=!1),n=!1,S?e(p):Promise.resolve()}function l(u,d){var h;if(t[u].isActive===d)return Promise.resolve();(h=s.variantChildren)===null||h===void 0||h.forEach(m=>{var v;return(v=m.animationState)===null||v===void 0?void 0:v.setActive(u,d)}),t[u].isActive=d;const p=o(u);for(const m in t)t[m].protectedKeys={};return p}return{animateChanges:o,setActive:l,setAnimateFunction:r,getState:()=>t,reset:()=>{t=kS(),n=!0}}}function NF(s,e){return typeof e=="string"?e!==s:Array.isArray(e)?!Yb(e,s):!1}function or(s=!1){return{isActive:s,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function kS(){return{animate:or(!0),whileInView:or(),whileHover:or(),whileTap:or(),whileDrag:or(),whileFocus:or(),exit:or()}}class Gi{constructor(e){this.isMounted=!1,this.node=e}update(){}}class MF extends Gi{constructor(e){super(e),e.animationState||(e.animationState=OF(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Sd(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let FF=0;class BF extends Gi{constructor(){super(...arguments),this.id=FF++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const UF={animation:{Feature:MF},exit:{Feature:BF}};function fl(s,e,t,n={passive:!0}){return s.addEventListener(e,t,n),()=>s.removeEventListener(e,t)}function Ml(s){return{point:{x:s.pageX,y:s.pageY}}}const $F=s=>e=>Eg(e)&&s(e,Ml(e));function el(s,e,t,n){return fl(s,e,$F(t),n)}const CS=(s,e)=>Math.abs(s-e);function jF(s,e){const t=CS(s.x,e.x),n=CS(s.y,e.y);return Math.sqrt(t**2+n**2)}class MA{constructor(e,t,{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:r=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=Vf(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,v=jF(p.offset,{x:0,y:0})>=3;if(!m&&!v)return;const{point:y}=p,{timestamp:S}=Gt;this.history.push({...y,timestamp:S});const{onStart:x,onMove:b}=this.handlers;m||(x&&x(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,p)},this.handlePointerMove=(p,m)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=jf(m,this.transformPagePoint),lt.update(this.updatePoint,!0)},this.handlePointerUp=(p,m)=>{this.end();const{onEnd:v,onSessionEnd:y,resumeAnimation:S}=this.handlers;if(this.dragSnapToOrigin&&S&&S(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=Vf(p.type==="pointercancel"?this.lastMoveEventInfo:jf(m,this.transformPagePoint),this.history);this.startEvent&&v&&v(p,x),y&&y(p,x)},!Eg(e))return;this.dragSnapToOrigin=r,this.handlers=t,this.transformPagePoint=n,this.contextWindow=i||window;const o=Ml(e),l=jf(o,this.transformPagePoint),{point:u}=l,{timestamp:d}=Gt;this.history=[{...u,timestamp:d}];const{onSessionStart:h}=t;h&&h(e,Vf(l,this.history)),this.removeListeners=Nl(el(this.contextWindow,"pointermove",this.handlePointerMove),el(this.contextWindow,"pointerup",this.handlePointerUp),el(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ui(this.updatePoint)}}function jf(s,e){return e?{point:e(s.point)}:s}function PS(s,e){return{x:s.x-e.x,y:s.y-e.y}}function Vf({point:s},e){return{point:s,delta:PS(s,FA(e)),offset:PS(s,VF(e)),velocity:GF(e,.1)}}function VF(s){return s[0]}function FA(s){return s[s.length-1]}function GF(s,e){if(s.length<2)return{x:0,y:0};let t=s.length-1,n=null;const i=FA(s);for(;t>=0&&(n=s[t],!(i.timestamp-n.timestamp>Ys(e)));)t--;if(!n)return{x:0,y:0};const r=Qs(i.timestamp-n.timestamp);if(r===0)return{x:0,y:0};const o={x:(i.x-n.x)/r,y:(i.y-n.y)/r};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const BA=1e-4,KF=1-BA,HF=1+BA,UA=.01,zF=0-UA,WF=0+UA;function On(s){return s.max-s.min}function qF(s,e,t){return Math.abs(s-e)<=t}function DS(s,e,t,n=.5){s.origin=n,s.originPoint=pt(e.min,e.max,s.origin),s.scale=On(t)/On(e),s.translate=pt(t.min,t.max,s.origin)-s.originPoint,(s.scale>=KF&&s.scale<=HF||isNaN(s.scale))&&(s.scale=1),(s.translate>=zF&&s.translate<=WF||isNaN(s.translate))&&(s.translate=0)}function tl(s,e,t,n){DS(s.x,e.x,t.x,n?n.originX:void 0),DS(s.y,e.y,t.y,n?n.originY:void 0)}function OS(s,e,t){s.min=t.min+e.min,s.max=s.min+On(e)}function YF(s,e,t){OS(s.x,e.x,t.x),OS(s.y,e.y,t.y)}function NS(s,e,t){s.min=e.min-t.min,s.max=s.min+On(e)}function nl(s,e,t){NS(s.x,e.x,t.x),NS(s.y,e.y,t.y)}function QF(s,{min:e,max:t},n){return e!==void 0&&s<e?s=n?pt(e,s,n.min):Math.max(s,e):t!==void 0&&s>t&&(s=n?pt(t,s,n.max):Math.min(s,t)),s}function MS(s,e,t){return{min:e!==void 0?s.min+e:void 0,max:t!==void 0?s.max+t-(s.max-s.min):void 0}}function XF(s,{top:e,left:t,bottom:n,right:i}){return{x:MS(s.x,t,i),y:MS(s.y,e,n)}}function FS(s,e){let t=e.min-s.min,n=e.max-s.max;return e.max-e.min<s.max-s.min&&([t,n]=[n,t]),{min:t,max:n}}function JF(s,e){return{x:FS(s.x,e.x),y:FS(s.y,e.y)}}function ZF(s,e){let t=.5;const n=On(s),i=On(e);return i>n?t=Bo(e.min,e.max-n,s.min):n>i&&(t=Bo(s.min,s.max-i,e.min)),Xs(0,1,t)}function eB(s,e){const t={};return e.min!==void 0&&(t.min=e.min-s.min),e.max!==void 0&&(t.max=e.max-s.min),t}const cm=.35;function tB(s=cm){return s===!1?s=0:s===!0&&(s=cm),{x:BS(s,"left","right"),y:BS(s,"top","bottom")}}function BS(s,e,t){return{min:US(s,e),max:US(s,t)}}function US(s,e){return typeof s=="number"?s:s[e]||0}const $S=()=>({translate:0,scale:1,origin:0,originPoint:0}),go=()=>({x:$S(),y:$S()}),jS=()=>({min:0,max:0}),Et=()=>({x:jS(),y:jS()});function Vn(s){return[s("x"),s("y")]}function $A({top:s,left:e,right:t,bottom:n}){return{x:{min:e,max:t},y:{min:s,max:n}}}function nB({x:s,y:e}){return{top:e.min,right:s.max,bottom:e.max,left:s.min}}function sB(s,e){if(!e)return s;const t=e({x:s.left,y:s.top}),n=e({x:s.right,y:s.bottom});return{top:t.y,left:t.x,bottom:n.y,right:n.x}}function Gf(s){return s===void 0||s===1}function um({scale:s,scaleX:e,scaleY:t}){return!Gf(s)||!Gf(e)||!Gf(t)}function cr(s){return um(s)||jA(s)||s.z||s.rotate||s.rotateX||s.rotateY||s.skewX||s.skewY}function jA(s){return VS(s.x)||VS(s.y)}function VS(s){return s&&s!=="0%"}function qu(s,e,t){const n=s-t,i=e*n;return t+i}function GS(s,e,t,n,i){return i!==void 0&&(s=qu(s,i,n)),qu(s,t,n)+e}function dm(s,e=0,t=1,n,i){s.min=GS(s.min,e,t,n,i),s.max=GS(s.max,e,t,n,i)}function VA(s,{x:e,y:t}){dm(s.x,e.translate,e.scale,e.originPoint),dm(s.y,t.translate,t.scale,t.originPoint)}const KS=.999999999999,HS=1.0000000000001;function iB(s,e,t,n=!1){const i=t.length;if(!i)return;e.x=e.y=1;let r,o;for(let l=0;l<i;l++){r=t[l],o=r.projectionDelta;const{visualElement:u}=r.options;u&&u.props.style&&u.props.style.display==="contents"||(n&&r.options.layoutScroll&&r.scroll&&r!==r.root&&vo(s,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,VA(s,o)),n&&cr(r.latestValues)&&vo(s,r.latestValues))}e.x<HS&&e.x>KS&&(e.x=1),e.y<HS&&e.y>KS&&(e.y=1)}function yo(s,e){s.min=s.min+e,s.max=s.max+e}function zS(s,e,t,n,i=.5){const r=pt(s.min,s.max,i);dm(s,e,t,r,n)}function vo(s,e){zS(s.x,e.x,e.scaleX,e.scale,e.originX),zS(s.y,e.y,e.scaleY,e.scale,e.originY)}function GA(s,e){return $A(sB(s.getBoundingClientRect(),e))}function rB(s,e,t){const n=GA(s,t),{scroll:i}=e;return i&&(yo(n.x,i.offset.x),yo(n.y,i.offset.y)),n}const KA=({current:s})=>s?s.ownerDocument.defaultView:null,oB=new WeakMap;class aB{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Et(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(Ml(h).point)},r=(h,p)=>{const{drag:m,dragPropagation:v,onDragStart:y}=this.getProps();if(m&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=JM(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Vn(x=>{let b=this.getAxisMotionValue(x).get()||0;if(Ls.test(b)){const{projection:w}=this.visualElement;if(w&&w.layout){const L=w.layout.layoutBox[x];L&&(b=On(L)*(parseFloat(b)/100))}}this.originPoint[x]=b}),y&&lt.postRender(()=>y(h,p)),tm(this.visualElement,"transform");const{animationState:S}=this.visualElement;S&&S.setActive("whileDrag",!0)},o=(h,p)=>{const{dragPropagation:m,dragDirectionLock:v,onDirectionLock:y,onDrag:S}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:x}=p;if(v&&this.currentDirection===null){this.currentDirection=lB(x),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",p.point,x),this.updateAxis("y",p.point,x),this.visualElement.render(),S&&S(h,p)},l=(h,p)=>this.stop(h,p),u=()=>Vn(h=>{var p;return this.getAnimationState(h)==="paused"&&((p=this.getAxisMotionValue(h).animation)===null||p===void 0?void 0:p.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new MA(e,{onSessionStart:i,onStart:r,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:KA(this.visualElement)})}stop(e,t){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&lt.postRender(()=>r(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:i}=this.getProps();if(!n||!tu(e,i,this.currentDirection))return;const r=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=QF(o,this.constraints[e],this.elastic[e])),r.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,r=this.constraints;t&&po(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=XF(i.layoutBox,t):this.constraints=!1,this.elastic=tB(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Vn(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=eB(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!po(e))return!1;const n=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=rB(n,i.root,this.visualElement.getTransformPagePoint());let o=JF(i.layout.layoutBox,r);if(t){const l=t(nB(o));this.hasMutatedConstraints=!!l,l&&(o=$A(l))}return o}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:i,dragTransition:r,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),u=this.constraints||{},d=Vn(h=>{if(!tu(h,t,this.currentDirection))return;let p=u&&u[h]||{};o&&(p={min:0,max:0});const m=i?200:1e6,v=i?40:1e7,y={type:"inertia",velocity:n?e[h]:0,bounceStiffness:m,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...r,...p};return this.startAxisValueAnimation(h,y)});return Promise.all(d).then(l)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return tm(this.visualElement,e),n.start(Dg(e,n,0,t,this.visualElement,!1))}stopAnimation(){Vn(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Vn(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),i=n[t];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Vn(t=>{const{drag:n}=this.getProps();if(!tu(t,n,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(t);if(i&&i.layout){const{min:o,max:l}=i.layout.layoutBox[t];r.set(e[t]-pt(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!po(t)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};Vn(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const u=l.get();i[o]=ZF({min:u,max:u},this.constraints[o])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Vn(o=>{if(!tu(o,e,null))return;const l=this.getAxisMotionValue(o),{min:u,max:d}=this.constraints[o];l.set(pt(u,d,i[o]))})}addListeners(){if(!this.visualElement.current)return;oB.set(this.visualElement,this);const e=this.visualElement.current,t=el(e,"pointerdown",u=>{const{drag:d,dragListener:h=!0}=this.getProps();d&&h&&this.start(u)}),n=()=>{const{dragConstraints:u}=this.getProps();po(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,r=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),lt.read(n);const o=fl(window,"resize",()=>this.scalePositionWithinConstraints()),l=i.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:d})=>{this.isDragging&&d&&(Vn(h=>{const p=this.getAxisMotionValue(h);p&&(this.originPoint[h]+=u[h].translate,p.set(p.get()+u[h].translate))}),this.visualElement.render())}));return()=>{o(),t(),r(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:o=cm,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:i,dragConstraints:r,dragElastic:o,dragMomentum:l}}}function tu(s,e,t){return(e===!0||e===s)&&(t===null||t===s)}function lB(s,e=10){let t=null;return Math.abs(s.y)>e?t="y":Math.abs(s.x)>e&&(t="x"),t}class cB extends Gi{constructor(e){super(e),this.removeGroupControls=Pn,this.removeListeners=Pn,this.controls=new aB(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Pn}unmount(){this.removeGroupControls(),this.removeListeners()}}const WS=s=>(e,t)=>{s&&lt.postRender(()=>s(e,t))};class uB extends Gi{constructor(){super(...arguments),this.removePointerDownListener=Pn}onPointerDown(e){this.session=new MA(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:KA(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:WS(e),onStart:WS(t),onMove:n,onEnd:(r,o)=>{delete this.session,i&&lt.postRender(()=>i(r,o))}}}mount(){this.removePointerDownListener=el(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function dB(){const s=B.useContext(vd);if(s===null)return[!0,null];const{isPresent:e,onExitComplete:t,register:n}=s,i=B.useId();B.useEffect(()=>n(i),[]);const r=B.useCallback(()=>t&&t(i),[i,t]);return!e&&t?[!1,r]:[!0]}const _u={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function qS(s,e){return e.max===e.min?0:s/(e.max-e.min)*100}const Ua={correct:(s,e)=>{if(!e.target)return s;if(typeof s=="string")if(Pe.test(s))s=parseFloat(s);else return s;const t=qS(s,e.target.x),n=qS(s,e.target.y);return`${t}% ${n}%`}},hB={correct:(s,{treeScale:e,projectionDelta:t})=>{const n=s,i=$i.parse(s);if(i.length>5)return n;const r=$i.createTransformer(s),o=typeof i[0]!="number"?1:0,l=t.x.scale*e.x,u=t.y.scale*e.y;i[0+o]/=l,i[1+o]/=u;const d=pt(l,u,.5);return typeof i[2+o]=="number"&&(i[2+o]/=d),typeof i[3+o]=="number"&&(i[3+o]/=d),r(i)}};class fB extends B.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:i}=this.props,{projection:r}=e;mM(pB),r&&(t.group&&t.group.add(r),n&&n.register&&i&&n.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),_u.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:i,isPresent:r}=this.props,o=n.projection;return o&&(o.isPresent=r,i||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?o.promote():o.relegate()||lt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),lg.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function HA(s){const[e,t]=dB(),n=B.useContext(ng);return A.jsx(fB,{...s,layoutGroup:n,switchLayoutGroup:B.useContext(Mb),isPresent:e,safeToRemove:t})}const pB={borderRadius:{...Ua,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ua,borderTopRightRadius:Ua,borderBottomLeftRadius:Ua,borderBottomRightRadius:Ua,boxShadow:hB};function mB(s,e,t){const n=nn(s)?s:dl(s);return n.start(Dg("",n,e,t)),n.animation}function gB(s){return s instanceof SVGElement&&s.tagName!=="svg"}const yB=(s,e)=>s.depth-e.depth;class vB{constructor(){this.children=[],this.isDirty=!1}add(e){Tg(this.children,e),this.isDirty=!0}remove(e){bg(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(yB),this.isDirty=!1,this.children.forEach(e)}}function xB(s,e){const t=Is.now(),n=({timestamp:i})=>{const r=i-t;r>=e&&(Ui(n),s(r-e))};return lt.read(n,!0),()=>Ui(n)}const zA=["TopLeft","TopRight","BottomLeft","BottomRight"],SB=zA.length,YS=s=>typeof s=="string"?parseFloat(s):s,QS=s=>typeof s=="number"||Pe.test(s);function EB(s,e,t,n,i,r){i?(s.opacity=pt(0,t.opacity!==void 0?t.opacity:1,TB(n)),s.opacityExit=pt(e.opacity!==void 0?e.opacity:1,0,bB(n))):r&&(s.opacity=pt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,n));for(let o=0;o<SB;o++){const l=`border${zA[o]}Radius`;let u=XS(e,l),d=XS(t,l);if(u===void 0&&d===void 0)continue;u||(u=0),d||(d=0),u===0||d===0||QS(u)===QS(d)?(s[l]=Math.max(pt(YS(u),YS(d),n),0),(Ls.test(d)||Ls.test(u))&&(s[l]+="%")):s[l]=d}(e.rotate||t.rotate)&&(s.rotate=pt(e.rotate||0,t.rotate||0,n))}function XS(s,e){return s[e]!==void 0?s[e]:s.borderRadius}const TB=WA(0,.5,dA),bB=WA(.5,.95,Pn);function WA(s,e,t){return n=>n<s?0:n>e?1:t(Bo(s,e,n))}function JS(s,e){s.min=e.min,s.max=e.max}function jn(s,e){JS(s.x,e.x),JS(s.y,e.y)}function ZS(s,e){s.translate=e.translate,s.scale=e.scale,s.originPoint=e.originPoint,s.origin=e.origin}function eE(s,e,t,n,i){return s-=e,s=qu(s,1/t,n),i!==void 0&&(s=qu(s,1/i,n)),s}function AB(s,e=0,t=1,n=.5,i,r=s,o=s){if(Ls.test(e)&&(e=parseFloat(e),e=pt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=pt(r.min,r.max,n);s===r&&(l-=e),s.min=eE(s.min,e,t,l,i),s.max=eE(s.max,e,t,l,i)}function tE(s,e,[t,n,i],r,o){AB(s,e[t],e[n],e[i],e.scale,r,o)}const wB=["x","scaleX","originX"],RB=["y","scaleY","originY"];function nE(s,e,t,n){tE(s.x,e,wB,t?t.x:void 0,n?n.x:void 0),tE(s.y,e,RB,t?t.y:void 0,n?n.y:void 0)}function sE(s){return s.translate===0&&s.scale===1}function qA(s){return sE(s.x)&&sE(s.y)}function iE(s,e){return s.min===e.min&&s.max===e.max}function LB(s,e){return iE(s.x,e.x)&&iE(s.y,e.y)}function rE(s,e){return Math.round(s.min)===Math.round(e.min)&&Math.round(s.max)===Math.round(e.max)}function YA(s,e){return rE(s.x,e.x)&&rE(s.y,e.y)}function oE(s){return On(s.x)/On(s.y)}function aE(s,e){return s.translate===e.translate&&s.scale===e.scale&&s.originPoint===e.originPoint}class IB{constructor(){this.members=[]}add(e){Tg(this.members,e),e.scheduleRender()}remove(e){if(bg(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let n;for(let i=t;i>=0;i--){const r=this.members[i];if(r.isPresent!==!1){n=r;break}}return n?(this.promote(n),!0):!1}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function _B(s,e,t){let n="";const i=s.x.translate/e.x,r=s.y.translate/e.y,o=(t==null?void 0:t.z)||0;if((i||r||o)&&(n=`translate3d(${i}px, ${r}px, ${o}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:d,rotate:h,rotateX:p,rotateY:m,skewX:v,skewY:y}=t;d&&(n=`perspective(${d}px) ${n}`),h&&(n+=`rotate(${h}deg) `),p&&(n+=`rotateX(${p}deg) `),m&&(n+=`rotateY(${m}deg) `),v&&(n+=`skewX(${v}deg) `),y&&(n+=`skewY(${y}deg) `)}const l=s.x.scale*e.x,u=s.y.scale*e.y;return(l!==1||u!==1)&&(n+=`scale(${l}, ${u})`),n||"none"}const ur={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Ya=typeof window<"u"&&window.MotionDebug!==void 0,Kf=["","X","Y","Z"],kB={visibility:"hidden"},lE=1e3;let CB=0;function Hf(s,e,t,n){const{latestValues:i}=e;i[s]&&(t[s]=i[s],e.setStaticValue(s,0),n&&(n[s]=0))}function QA(s){if(s.hasCheckedOptimisedAppear=!0,s.root===s)return;const{visualElement:e}=s.options;if(!e)return;const t=iA(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:r}=s.options;window.MotionCancelOptimisedAnimation(t,"transform",lt,!(i||r))}const{parent:n}=s;n&&!n.hasCheckedOptimisedAppear&&QA(n)}function XA({attachResizeListener:s,defaultParent:e,measureScroll:t,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(o={},l=e==null?void 0:e()){this.id=CB++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Ya&&(ur.totalNodes=ur.resolvedTargetDeltas=ur.recalculatedProjection=0),this.nodes.forEach(OB),this.nodes.forEach(UB),this.nodes.forEach($B),this.nodes.forEach(NB),Ya&&window.MotionDebug.record(ur)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new vB)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Ag),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const u=this.eventHandlers.get(o);u&&u.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=gB(o),this.instance=o;const{layoutId:u,layout:d,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||u)&&(this.isLayoutDirty=!0),s){let p;const m=()=>this.root.updateBlockedByResize=!1;s(o,()=>{this.root.updateBlockedByResize=!0,p&&p(),p=xB(m,250),_u.hasAnimatedSinceResize&&(_u.hasAnimatedSinceResize=!1,this.nodes.forEach(uE))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&h&&(u||d)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:m,hasRelativeTargetChanged:v,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const S=this.options.transition||h.getDefaultTransition()||HB,{onLayoutAnimationStart:x,onLayoutAnimationComplete:b}=h.getProps(),w=!this.targetLayout||!YA(this.targetLayout,y)||v,L=!m&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||L||m&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(p,L);const I={...vg(S,"layout"),onPlay:x,onComplete:b};(h.shouldReduceMotion||this.options.layoutRoot)&&(I.delay=0,I.type=!1),this.startAnimation(I)}else m||uE(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ui(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(jB),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&QA(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:u}=this.options;if(l===void 0&&!u)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(cE);return}this.isUpdating||this.nodes.forEach(FB),this.isUpdating=!1,this.nodes.forEach(BB),this.nodes.forEach(PB),this.nodes.forEach(DB),this.clearAllSnapshots();const l=Is.now();Gt.delta=Xs(0,1e3/60,l-Gt.timestamp),Gt.timestamp=l,Gt.isProcessing=!0,Nf.update.process(Gt),Nf.preRender.process(Gt),Nf.render.process(Gt),Gt.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,lg.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(MB),this.sharedNodes.forEach(VB)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,lt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){lt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Et(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l){const u=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!qA(this.projectionDelta),u=this.getTransformTemplate(),d=u?u(this.latestValues,""):void 0,h=d!==this.prevTransformTemplateValue;o&&(l||cr(this.latestValues)||h)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let u=this.removeElementScroll(l);return o&&(u=this.removeTransform(u)),zB(u),{animationId:this.root.animationId,measuredBox:l,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:l}=this.options;if(!l)return Et();const u=l.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(WB))){const{scroll:h}=this.root;h&&(yo(u.x,h.offset.x),yo(u.y,h.offset.y))}return u}removeElementScroll(o){var l;const u=Et();if(jn(u,o),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return u;for(let d=0;d<this.path.length;d++){const h=this.path[d],{scroll:p,options:m}=h;h!==this.root&&p&&m.layoutScroll&&(p.wasRoot&&jn(u,o),yo(u.x,p.offset.x),yo(u.y,p.offset.y))}return u}applyTransform(o,l=!1){const u=Et();jn(u,o);for(let d=0;d<this.path.length;d++){const h=this.path[d];!l&&h.options.layoutScroll&&h.scroll&&h!==h.root&&vo(u,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),cr(h.latestValues)&&vo(u,h.latestValues)}return cr(this.latestValues)&&vo(u,this.latestValues),u}removeTransform(o){const l=Et();jn(l,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];if(!d.instance||!cr(d.latestValues))continue;um(d.latestValues)&&d.updateSnapshot();const h=Et(),p=d.measurePageBox();jn(h,p),nE(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,h)}return cr(this.latestValues)&&nE(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Gt.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==u;if(!(o||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:m}=this.options;if(!(!this.layout||!(p||m))){if(this.resolvedRelativeTargetAt=Gt.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Et(),this.relativeTargetOrigin=Et(),nl(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),jn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Et(),this.targetWithTransforms=Et()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),YF(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):jn(this.target,this.layout.layoutBox),VA(this.target,this.targetDelta)):jn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Et(),this.relativeTargetOrigin=Et(),nl(this.relativeTargetOrigin,this.target,v.target),jn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Ya&&ur.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||um(this.parent.latestValues)||jA(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(d=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Gt.timestamp&&(d=!1),d)return;const{layout:h,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||p))return;jn(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,v=this.treeScale.y;iB(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Et());const{target:y}=l;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(ZS(this.prevProjectionDelta.x,this.projectionDelta.x),ZS(this.prevProjectionDelta.y,this.projectionDelta.y)),tl(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==v||!aE(this.projectionDelta.x,this.prevProjectionDelta.x)||!aE(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),Ya&&ur.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=go(),this.projectionDelta=go(),this.projectionDeltaWithTransform=go()}setAnimationOrigin(o,l=!1){const u=this.snapshot,d=u?u.latestValues:{},h={...this.latestValues},p=go();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=Et(),v=u?u.source:void 0,y=this.layout?this.layout.source:void 0,S=v!==y,x=this.getStack(),b=!x||x.members.length<=1,w=!!(S&&!b&&this.options.crossfade===!0&&!this.path.some(KB));this.animationProgress=0;let L;this.mixTargetDelta=I=>{const k=I/1e3;dE(p.x,o.x,k),dE(p.y,o.y,k),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(nl(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),GB(this.relativeTarget,this.relativeTargetOrigin,m,k),L&&LB(this.relativeTarget,L)&&(this.isProjectionDirty=!1),L||(L=Et()),jn(L,this.relativeTarget)),S&&(this.animationValues=h,EB(h,d,this.latestValues,k,w,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ui(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=lt.update(()=>{_u.hasAnimatedSinceResize=!0,this.currentAnimation=mB(0,lE,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(lE),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:u,layout:d,latestValues:h}=o;if(!(!l||!u||!d)){if(this!==o&&this.layout&&d&&JA(this.options.animationType,this.layout.layoutBox,d.layoutBox)){u=this.target||Et();const p=On(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+p;const m=On(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+m}jn(l,u),vo(l,h),tl(this.projectionDeltaWithTransform,this.layoutCorrected,l,h)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new IB),this.sharedNodes.get(o).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:u}={}){const d=this.getStack();d&&d.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(l=!0),!l)return;const d={};u.z&&Hf("z",o,d,this.animationValues);for(let h=0;h<Kf.length;h++)Hf(`rotate${Kf[h]}`,o,d,this.animationValues),Hf(`skew${Kf[h]}`,o,d,this.animationValues);o.render();for(const h in d)o.setStaticValue(h,d[h]),this.animationValues&&(this.animationValues[h]=d[h]);o.scheduleRender()}getProjectionStyles(o){var l,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return kB;const d={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=Lu(o==null?void 0:o.pointerEvents)||"",d.transform=h?h(this.latestValues,""):"none",d;const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){const S={};return this.options.layoutId&&(S.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,S.pointerEvents=Lu(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!cr(this.latestValues)&&(S.transform=h?h({},""):"none",this.hasProjected=!1),S}const m=p.animationValues||p.latestValues;this.applyTransformsToTarget(),d.transform=_B(this.projectionDeltaWithTransform,this.treeScale,m),h&&(d.transform=h(m,d.transform));const{x:v,y}=this.projectionDelta;d.transformOrigin=`${v.origin*100}% ${y.origin*100}% 0`,p.animationValues?d.opacity=p===this?(u=(l=m.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:d.opacity=p===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const S in Gu){if(m[S]===void 0)continue;const{correct:x,applyTo:b}=Gu[S],w=d.transform==="none"?m[S]:x(m[S],p);if(b){const L=b.length;for(let I=0;I<L;I++)d[b[I]]=w}else d[S]=w}return this.options.layoutId&&(d.pointerEvents=p===this?Lu(o==null?void 0:o.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(cE),this.root.sharedNodes.clear()}}}function PB(s){s.updateLayout()}function DB(s){var e;const t=((e=s.resumeFrom)===null||e===void 0?void 0:e.snapshot)||s.snapshot;if(s.isLead()&&s.layout&&t&&s.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=s.layout,{animationType:r}=s.options,o=t.source!==s.layout.source;r==="size"?Vn(p=>{const m=o?t.measuredBox[p]:t.layoutBox[p],v=On(m);m.min=n[p].min,m.max=m.min+v}):JA(r,t.layoutBox,n)&&Vn(p=>{const m=o?t.measuredBox[p]:t.layoutBox[p],v=On(n[p]);m.max=m.min+v,s.relativeTarget&&!s.currentAnimation&&(s.isProjectionDirty=!0,s.relativeTarget[p].max=s.relativeTarget[p].min+v)});const l=go();tl(l,n,t.layoutBox);const u=go();o?tl(u,s.applyTransform(i,!0),t.measuredBox):tl(u,n,t.layoutBox);const d=!qA(l);let h=!1;if(!s.resumeFrom){const p=s.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:m,layout:v}=p;if(m&&v){const y=Et();nl(y,t.layoutBox,m.layoutBox);const S=Et();nl(S,n,v.layoutBox),YA(y,S)||(h=!0),p.options.layoutRoot&&(s.relativeTarget=S,s.relativeTargetOrigin=y,s.relativeParent=p)}}}s.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:u,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:h})}else if(s.isLead()){const{onExitComplete:n}=s.options;n&&n()}s.options.transition=void 0}function OB(s){Ya&&ur.totalNodes++,s.parent&&(s.isProjecting()||(s.isProjectionDirty=s.parent.isProjectionDirty),s.isSharedProjectionDirty||(s.isSharedProjectionDirty=!!(s.isProjectionDirty||s.parent.isProjectionDirty||s.parent.isSharedProjectionDirty)),s.isTransformDirty||(s.isTransformDirty=s.parent.isTransformDirty))}function NB(s){s.isProjectionDirty=s.isSharedProjectionDirty=s.isTransformDirty=!1}function MB(s){s.clearSnapshot()}function cE(s){s.clearMeasurements()}function FB(s){s.isLayoutDirty=!1}function BB(s){const{visualElement:e}=s.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),s.resetTransform()}function uE(s){s.finishAnimation(),s.targetDelta=s.relativeTarget=s.target=void 0,s.isProjectionDirty=!0}function UB(s){s.resolveTargetDelta()}function $B(s){s.calcProjection()}function jB(s){s.resetSkewAndRotation()}function VB(s){s.removeLeadSnapshot()}function dE(s,e,t){s.translate=pt(e.translate,0,t),s.scale=pt(e.scale,1,t),s.origin=e.origin,s.originPoint=e.originPoint}function hE(s,e,t,n){s.min=pt(e.min,t.min,n),s.max=pt(e.max,t.max,n)}function GB(s,e,t,n){hE(s.x,e.x,t.x,n),hE(s.y,e.y,t.y,n)}function KB(s){return s.animationValues&&s.animationValues.opacityExit!==void 0}const HB={duration:.45,ease:[.4,0,.1,1]},fE=s=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(s),pE=fE("applewebkit/")&&!fE("chrome/")?Math.round:Pn;function mE(s){s.min=pE(s.min),s.max=pE(s.max)}function zB(s){mE(s.x),mE(s.y)}function JA(s,e,t){return s==="position"||s==="preserve-aspect"&&!qF(oE(e),oE(t),.2)}function WB(s){var e;return s!==s.root&&((e=s.scroll)===null||e===void 0?void 0:e.wasRoot)}const qB=XA({attachResizeListener:(s,e)=>fl(s,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),zf={current:void 0},ZA=XA({measureScroll:s=>({x:s.scrollLeft,y:s.scrollTop}),defaultParent:()=>{if(!zf.current){const s=new qB({});s.mount(window),s.setOptions({layoutScroll:!0}),zf.current=s}return zf.current},resetTransform:(s,e)=>{s.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:s=>window.getComputedStyle(s).position==="fixed"}),YB={pan:{Feature:uB},drag:{Feature:cB,ProjectionNode:ZA,MeasureLayout:HA}};function gE(s,e,t){const{props:n}=s;s.animationState&&n.whileHover&&s.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,r=n[i];r&&lt.postRender(()=>r(e,Ml(e)))}class QB extends Gi{mount(){const{current:e}=this.node;e&&(this.unmount=WM(e,t=>(gE(this.node,t,"Start"),n=>gE(this.node,n,"End"))))}unmount(){}}class XB extends Gi{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Nl(fl(this.node.current,"focus",()=>this.onFocus()),fl(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function yE(s,e,t){const{props:n}=s;s.animationState&&n.whileTap&&s.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),r=n[i];r&&lt.postRender(()=>r(e,Ml(e)))}class JB extends Gi{mount(){const{current:e}=this.node;e&&(this.unmount=XM(e,t=>(yE(this.node,t,"Start"),(n,{success:i})=>yE(this.node,n,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const hm=new WeakMap,Wf=new WeakMap,ZB=s=>{const e=hm.get(s.target);e&&e(s)},eU=s=>{s.forEach(ZB)};function tU({root:s,...e}){const t=s||document;Wf.has(t)||Wf.set(t,{});const n=Wf.get(t),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(eU,{root:s,...e})),n[i]}function nU(s,e,t){const n=tU(e);return hm.set(s,t),n.observe(s),()=>{hm.delete(s),n.unobserve(s)}}const sU={some:0,all:1};class iU extends Gi{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:i="some",once:r}=e,o={root:t?t.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:sU[i]},l=u=>{const{isIntersecting:d}=u;if(this.isInView===d||(this.isInView=d,r&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),m=d?h:p;m&&m(u)};return nU(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(rU(e,t))&&this.startObserver()}unmount(){}}function rU({viewport:s={}},{viewport:e={}}={}){return t=>s[t]!==e[t]}const oU={inView:{Feature:iU},tap:{Feature:JB},focus:{Feature:XB},hover:{Feature:QB}},aU={layout:{ProjectionNode:ZA,MeasureLayout:HA}},fm={current:null},ew={current:!1};function lU(){if(ew.current=!0,!!ig)if(window.matchMedia){const s=window.matchMedia("(prefers-reduced-motion)"),e=()=>fm.current=s.matches;s.addListener(e),e()}else fm.current=!1}function cU(s,e,t){for(const n in e){const i=e[n],r=t[n];if(nn(i))s.addValue(n,i);else if(nn(r))s.addValue(n,dl(i,{owner:s}));else if(r!==i)if(s.hasValue(n)){const o=s.getValue(n);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=s.getStaticValue(n);s.addValue(n,dl(o!==void 0?o:i,{owner:s}))}}for(const n in t)e[n]===void 0&&s.removeValue(n);return e}const vE=new WeakMap,uU=[...yA,Jt,$i],dU=s=>uU.find(gA(s)),xE=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class hU{scrapeMotionValuesFromProps(e,t,n){return{}}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:r,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Lg,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Is.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,lt.render(this.render,!1,!0))};const{latestValues:u,renderState:d}=o;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=d,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=l,this.blockInitialAnimation=!!r,this.isControllingVariants=Ed(t),this.isVariantNode=Ob(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in p){const v=p[m];u[m]!==void 0&&nn(v)&&v.set(u[m],!1)}}mount(e){this.current=e,vE.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,n)=>this.bindToMotionValue(n,t)),ew.current||lU(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:fm.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){vE.delete(this.current),this.projection&&this.projection.unmount(),Ui(this.notifyUpdate),Ui(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=Pr.has(e),i=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&lt.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),r=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),r(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Uo){const t=Uo[e];if(!t)continue;const{isEnabled:n,Feature:i}=t;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Et()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<xE.length;n++){const i=xE[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const r="on"+i,o=e[r];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=cU(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&t!==void 0&&(n=dl(t===null?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(pA(i)||fA(i))?i=parseFloat(i):!dU(i)&&$i.test(t)&&(i=wA(e,t)),this.setBaseTarget(e,nn(i)?i.get():i)),nn(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const o=dg(this.props,n,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(i=o[e])}if(n&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!nn(r)?r:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new Ag),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class tw extends hU{constructor(){super(...arguments),this.KeyframeResolver=RA}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:n}){delete t[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;nn(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function fU(s){return window.getComputedStyle(s)}class pU extends tw{constructor(){super(...arguments),this.type="html",this.renderInstance=Bb}readValueFromInstance(e,t){if(Pr.has(t)){const n=kg(t);return n&&n.default||0}else{const n=fU(e),i=(Wb(t)?n.getPropertyValue(t):n[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return GA(e,t)}build(e,t,n){mg(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return ug(e,t,n)}}class mU extends tw{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Et}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Pr.has(t)){const n=kg(t);return n&&n.default||0}return t=Ub.has(t)?t:ag(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return Vb(e,t,n)}build(e,t,n){gg(e,t,this.isSVGTag,n.transformTemplate)}renderInstance(e,t,n,i){$b(e,t,n,i)}mount(e){this.isSVGTag=yg(e.tagName),super.mount(e)}}const gU=(s,e)=>cg(s)?new mU(e):new pU(e,{allowProjection:s!==B.Fragment}),yU=$M({...UF,...oU,...YB,...aU},gU),Ee=nM(yU);function vU({onVerify:s}){const[e,t]=B.useState(!1),[n,i]=B.useState(0),[r,o]=B.useState(!1),[l,u]=B.useState([]);B.useEffect(()=>{const h=Array.from({length:20},(p,m)=>({id:m,delay:Math.random()*2,duration:1+Math.random()*2}));u(h)},[]);const d=()=>{t(!0);const h=setInterval(()=>{i(p=>p>=100?(clearInterval(h),o(!0),setTimeout(()=>s(),1500),100):p+2)},50)};return A.jsxs("div",{className:"fixed inset-0 bg-[#0a0a0f] flex items-center justify-center overflow-hidden",children:[A.jsx("div",{className:"absolute inset-0 opacity-20",children:A.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`
              linear-gradient(rgba(0, 245, 255, 0.1) 1px, transparent 1px),
              linear-gradient(90deg, rgba(0, 245, 255, 0.1) 1px, transparent 1px)
            `,backgroundSize:"50px 50px"}})}),A.jsx(Ee.div,{className:"absolute top-1/4 left-1/4 w-64 h-64 rounded-full bg-cyan-500/20 blur-3xl",animate:{x:[0,50,0],y:[0,-30,0],scale:[1,1.2,1]},transition:{duration:8,repeat:1/0}}),A.jsx(Ee.div,{className:"absolute bottom-1/4 right-1/4 w-64 h-64 rounded-full bg-purple-500/20 blur-3xl",animate:{x:[0,-50,0],y:[0,30,0],scale:[1,1.1,1]},transition:{duration:10,repeat:1/0}}),A.jsxs(Ee.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"relative z-10 text-center",children:[A.jsxs("div",{className:"relative",children:[A.jsx(Ee.div,{className:"w-64 h-64 mx-auto relative",animate:{rotate:e?360:0},transition:{duration:20,repeat:1/0,ease:"linear"},children:A.jsxs("svg",{className:"absolute inset-0 w-full h-full",viewBox:"0 0 200 200",children:[A.jsx(Ee.circle,{cx:"100",cy:"100",r:"95",fill:"none",stroke:"url(#gradient1)",strokeWidth:"2",strokeDasharray:"600",strokeDashoffset:600-n*6,className:"drop-shadow-[0_0_10px_rgba(0,245,255,0.5)]"}),A.jsx("defs",{children:A.jsxs("linearGradient",{id:"gradient1",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[A.jsx("stop",{offset:"0%",stopColor:"#00f5ff"}),A.jsx("stop",{offset:"50%",stopColor:"#a855f7"}),A.jsx("stop",{offset:"100%",stopColor:"#00f5ff"})]})})]})}),A.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:A.jsxs(Ee.div,{className:"relative",animate:e?{scale:[1,1.1,1]}:{},transition:{duration:1,repeat:1/0},children:[r?A.jsx(Ee.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10},children:A.jsx(h_,{className:"w-24 h-24 text-green-400 drop-shadow-[0_0_20px_rgba(74,222,128,0.5)]"})}):e?A.jsx(ik,{className:"w-24 h-24 text-cyan-400 drop-shadow-[0_0_20px_rgba(0,245,255,0.5)]"}):A.jsx(y_,{className:"w-24 h-24 text-cyan-400 drop-shadow-[0_0_20px_rgba(0,245,255,0.5)]"}),e&&!r&&A.jsx(Ee.div,{className:"absolute inset-0 overflow-hidden",initial:{opacity:0},animate:{opacity:1},children:A.jsx(Ee.div,{className:"absolute left-0 right-0 h-1 bg-gradient-to-r from-transparent via-cyan-400 to-transparent",animate:{top:["0%","100%","0%"]},transition:{duration:2,repeat:1/0,ease:"linear"}})})]})}),[0,60,120,180,240,300].map((h,p)=>A.jsx(Ee.div,{className:"absolute w-3 h-3 rounded-full bg-cyan-400",style:{top:"50%",left:"50%",transform:`rotate(${h}deg) translateY(-120px)`},animate:{opacity:e?[.3,1,.3]:.5,scale:e?[.8,1.2,.8]:1},transition:{duration:1.5,repeat:1/0,delay:p*.2}},p))]}),A.jsxs(Ee.div,{className:"mt-12 space-y-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[A.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-cyan-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent",children:r?"Access Granted":e?"Scanning...":"Human Verification"}),A.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:r?"Welcome to StreamVerse. Initializing your experience...":e?`Analyzing biometric signature... ${n}%`:"Please verify you are human to access the streaming platform"}),e&&!r&&A.jsx("div",{className:"w-64 mx-auto h-2 bg-gray-800 rounded-full overflow-hidden mt-6",children:A.jsx(Ee.div,{className:"h-full bg-gradient-to-r from-cyan-500 to-purple-500",style:{width:`${n}%`}})}),!e&&A.jsxs(Ee.button,{onClick:d,className:"mt-8 px-8 py-4 bg-gradient-to-r from-cyan-500/20 to-purple-500/20 rounded-xl border border-cyan-500/50 text-cyan-400 font-semibold relative overflow-hidden group",whileHover:{scale:1.05},whileTap:{scale:.95},children:[A.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:[A.jsx(lk,{className:"w-5 h-5"}),"Verify Identity"]}),A.jsx(Ee.div,{className:"absolute inset-0 bg-gradient-to-r from-cyan-500/30 to-purple-500/30",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.5}})]})]}),A.jsxs(Ee.div,{className:"absolute -bottom-20 left-1/2 -translate-x-1/2 flex items-center gap-2 text-gray-500 text-sm",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[A.jsx(ol,{className:"w-4 h-4 text-cyan-500"}),A.jsx("span",{children:"Secured by Advanced AI Protection"})]})]}),["top-left","top-right","bottom-left","bottom-right"].map((h,p)=>A.jsx("div",{className:`absolute ${h.includes("top")?"top-8":"bottom-8"} ${h.includes("left")?"left-8":"right-8"} w-16 h-16 border-2 border-cyan-500/30`,style:{borderTopWidth:h.includes("top")?"2px":"0",borderBottomWidth:h.includes("bottom")?"2px":"0",borderLeftWidth:h.includes("left")?"2px":"0",borderRightWidth:h.includes("right")?"2px":"0"}},h))]})}function xU(s){const e=s.split(`
`),t=[];let n=null;for(let i=0;i<e.length;i++){const r=e[i].trim();if(r.startsWith("#EXTINF:")){const o=r.substring(8),l=$a(o,"tvg-id"),u=$a(o,"tvg-name"),d=$a(o,"tvg-logo"),h=$a(o,"tvg-country"),p=$a(o,"group-title"),m=o.lastIndexOf(","),v=m!==-1?o.substring(m+1).trim():"Unknown Channel";n={id:`ch_${t.length}`,name:v,tvgId:l||u||v,tvgName:u||v,logo:d||null,country:h||SU(v),group:p||"General",url:null}}else r&&!r.startsWith("#")&&n&&(n.url=r,t.push(n),n=null)}return t}function $a(s,e){const t=new RegExp(`${e}="([^"]*)"`,"i"),n=s.match(t);return n?n[1]:null}function SU(s){const e={US:/\b(usa|united states|american|us)\b/i,UK:/\b(uk|british|england|bbc|itv)\b/i,IN:/\b(india|hindi|tamil|telugu|zee|star)\b/i,FR:/\b(france|french|tf1|france\s?\d)\b/i,DE:/\b(germany|german|deutsch|ard|zdf)\b/i,ES:/\b(spain|spanish|espaa|rtve)\b/i,IT:/\b(italy|italian|rai|mediaset)\b/i,BR:/\b(brazil|brazilian|globo|sbt)\b/i,MX:/\b(mexico|mexican|televisa)\b/i,CA:/\b(canada|canadian|cbc|ctv)\b/i,AU:/\b(australia|australian|abc au)\b/i,JP:/\b(japan|japanese|nhk)\b/i,KR:/\b(korea|korean|kbs|mbc|sbs)\b/i,CN:/\b(china|chinese|cctv)\b/i,RU:/\b(russia|russian||)\b/i,AE:/\b(uae|dubai|abu dhabi|al jazeera)\b/i,SA:/\b(saudi|arabia|mbc)\b/i,TR:/\b(turkey|turkish|trt)\b/i,PL:/\b(poland|polish|tvp)\b/i,NL:/\b(netherlands|dutch|npo|rtl nl)\b/i,PT:/\b(portugal|portuguese|rtp|sic)\b/i,AR:/\b(argentina|argentine)\b/i};for(const[t,n]of Object.entries(e))if(n.test(s))return t;return null}function EU(s){const e=(s.name+" "+s.group).toLowerCase(),t={Sports:/\b(sport|football|soccer|basketball|nba|nfl|cricket|tennis|golf|f1|racing|espn|fox sports|sky sports|eurosport|bein)\b/i,News:/\b(news|cnn|bbc|fox news|msnbc|al jazeera|reuters|bloomberg|cnbc|sky news|headline)\b/i,Movies:/\b(movie|film|cinema|hbo|showtime|starz|cinemax|amc|tcm|hallmark)\b/i,Kids:/\b(kid|child|cartoon|disney|nick|nickelodeon|cartoon network|junior|baby|anime|pokemon|pbs kids)\b/i,Music:/\b(music|mtv|vh1|vevo|cmtv|trace|hits|radio|song)\b/i,Entertainment:/\b(entertainment|comedy|reality|drama|e!|bravo|tlc|discovery|nat geo|history|food|hgtv)\b/i,Gaming:/\b(gaming|esport|twitch|game|gamer|playstation|xbox)\b/i,Education:/\b(education|learning|documentary|science|knowledge|discovery|national geographic|ted|pbs)\b/i,Religious:/\b(religious|church|god|christian|catholic|muslim|islamic|jewish|hindu|prayer|faith|worship)\b/i};for(const[n,i]of Object.entries(t))if(i.test(e))return n;return"General"}const nw={US:"United States",UK:"United Kingdom",GB:"United Kingdom",IN:"India",FR:"France",DE:"Germany",ES:"Spain",IT:"Italy",BR:"Brazil",MX:"Mexico",CA:"Canada",AU:"Australia",JP:"Japan",KR:"South Korea",CN:"China",RU:"Russia",AE:"UAE",SA:"Saudi Arabia",TR:"Turkey",PL:"Poland",NL:"Netherlands",PT:"Portugal",AR:"Argentina",CL:"Chile",CO:"Colombia",PE:"Peru",VE:"Venezuela",PH:"Philippines",ID:"Indonesia",MY:"Malaysia",TH:"Thailand",VN:"Vietnam",SG:"Singapore",PK:"Pakistan",BD:"Bangladesh",EG:"Egypt",ZA:"South Africa",NG:"Nigeria",KE:"Kenya",GH:"Ghana",MA:"Morocco",DZ:"Algeria",TN:"Tunisia",IQ:"Iraq",IR:"Iran",IL:"Israel",GR:"Greece",SE:"Sweden",NO:"Norway",DK:"Denmark",FI:"Finland",BE:"Belgium",AT:"Austria",CH:"Switzerland",CZ:"Czech Republic",HU:"Hungary",RO:"Romania",UA:"Ukraine",BY:"Belarus",RS:"Serbia",HR:"Croatia",BG:"Bulgaria",SK:"Slovakia",SI:"Slovenia",LT:"Lithuania",LV:"Latvia",EE:"Estonia",IE:"Ireland",NZ:"New Zealand"};function Js(s){if(!s||s.length!==2)return"";const e=s.toUpperCase().split("").map(t=>127397+t.charCodeAt(0));return String.fromCodePoint(...e)}function qf(s){return new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}const TU=[{id:"all",icon:R_,label:"All Channels"},{id:"favorites",icon:od,label:"Favorites"},{id:"recent",icon:s1,label:"Recently Played"}],bU=[{id:"Entertainment",icon:Cr,label:"Entertainment"},{id:"Movies",icon:m_,label:"Movies"},{id:"News",icon:W_,label:"News"},{id:"Sports",icon:vk,label:"Sports"},{id:"Music",icon:H_,label:"Music"},{id:"Kids",icon:n_,label:"Kids"},{id:"Gaming",icon:x_,label:"Gaming"},{id:"Education",icon:T_,label:"Education"}];function AU({activeView:s,setActiveView:e,onSearch:t,onSettings:n,userCountry:i}){const[r,o]=B.useState(!1);return A.jsxs(A.Fragment,{children:[A.jsx(tn,{children:r&&A.jsx(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 lg:hidden",onClick:()=>o(!1)})}),A.jsxs(Ee.aside,{className:"fixed left-0 top-0 h-full z-50 flex flex-col bg-[#0d0d15]/95 backdrop-blur-xl border-r border-cyan-500/10",initial:!1,animate:{width:r?240:64},onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),transition:{duration:.2},children:[A.jsx("div",{className:"p-4 border-b border-cyan-500/10",children:A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsx(Ee.div,{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-500 to-purple-500 flex items-center justify-center flex-shrink-0",animate:{boxShadow:r?"0 0 20px rgba(0, 245, 255, 0.3)":"0 0 10px rgba(0, 245, 255, 0.2)"},children:A.jsx(ol,{className:"w-5 h-5 text-white"})}),A.jsx(tn,{children:r&&A.jsx(Ee.span,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},className:"font-bold text-lg bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent whitespace-nowrap",children:"StreamVerse"})})]})}),A.jsxs("div",{className:"p-2 space-y-1 border-b border-cyan-500/10",children:[A.jsx(ja,{icon:Ep,label:"Search",isExpanded:r,onClick:t}),A.jsx(ja,{icon:o1,label:"Settings",isExpanded:r,onClick:n})]}),A.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-cyan-500/20 scrollbar-track-transparent",children:[A.jsx("div",{className:"p-2 space-y-1",children:TU.map(l=>A.jsx(ja,{icon:l.icon,label:l.label,isExpanded:r,isActive:s===l.id,onClick:()=>e(l.id)},l.id))}),A.jsxs("div",{className:"p-2 pt-0",children:[A.jsx(tn,{children:r&&A.jsx(Ee.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Categories"})}),A.jsx("div",{className:"space-y-1",children:bU.map(l=>A.jsx(ja,{icon:l.icon,label:l.label,isExpanded:r,isActive:s===l.id,onClick:()=>e(l.id)},l.id))})]}),A.jsxs("div",{className:"p-2 pt-0",children:[A.jsx(tn,{children:r&&A.jsx(Ee.p,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Countries"})}),A.jsx(ja,{icon:Fm,label:"All Countries",isExpanded:r,isActive:s==="countries",onClick:()=>e("countries"),badge:i?Js(i.code):null})]})]}),i&&A.jsx("div",{className:"p-3 border-t border-cyan-500/10",children:A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsx("span",{className:"text-xl",children:Js(i.code)}),A.jsx(tn,{children:r&&A.jsxs(Ee.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},className:"overflow-hidden",children:[A.jsx("p",{className:"text-xs text-gray-500",children:"Your Location"}),A.jsx("p",{className:"text-sm font-medium text-white truncate",children:i.name})]})})]})})]})]})}function ja({icon:s,label:e,isExpanded:t,isActive:n,onClick:i,badge:r}){return A.jsxs(Ee.button,{onClick:i,className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all relative overflow-hidden group ${n?"bg-gradient-to-r from-cyan-500/20 to-purple-500/20 text-cyan-400":"text-gray-400 hover:text-white hover:bg-white/5"}`,whileHover:{x:2},whileTap:{scale:.98},children:[n&&A.jsx(Ee.div,{layoutId:"activeIndicator",className:"absolute left-0 top-1/2 -translate-y-1/2 w-1 h-6 bg-gradient-to-b from-cyan-400 to-purple-400 rounded-r-full"}),A.jsx(s,{className:"w-5 h-5 flex-shrink-0"}),A.jsx(tn,{children:t&&A.jsx(Ee.span,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},className:"text-sm font-medium whitespace-nowrap flex-1 text-left",children:e})}),r&&t&&A.jsx("span",{className:"text-sm",children:r}),A.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:A.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500/5 to-purple-500/5"})})]})}function SE({channels:s,categories:e,countries:t,onSelect:n,onToggleFavorite:i,isFavorite:r,userCountry:o,activeView:l,setActiveView:u,compact:d}){const[h,p]=B.useState(new Set(["local"])),[m,v]=B.useState(new Set([o==null?void 0:o.code])),y=x=>{const b=new Set(h);b.has(x)?b.delete(x):b.add(x),p(b)},S=x=>{const b=new Set(m);b.has(x)?b.delete(x):b.add(x),v(b)};if(l==="countries"&&t){const x=Object.entries(t).sort((b,w)=>b[0]===(o==null?void 0:o.code)?-1:w[0]===(o==null?void 0:o.code)?1:w[1].length-b[1].length);return A.jsxs("div",{className:"space-y-4",children:[A.jsxs("div",{className:"flex items-center justify-between mb-6",children:[A.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[A.jsx(Fm,{className:"w-7 h-7 text-cyan-400"}),"Channels by Country"]}),A.jsxs("span",{className:"text-gray-500",children:[Object.keys(t).length," countries"]})]}),A.jsx("div",{className:"space-y-2",children:x.map(([b,w])=>{const L=b===(o==null?void 0:o.code),I=m.has(b);return A.jsxs("div",{className:"rounded-xl overflow-hidden",children:[A.jsxs("button",{onClick:()=>S(b),className:`w-full flex items-center justify-between p-4 transition-all ${L?"bg-gradient-to-r from-cyan-500/20 to-purple-500/20 border border-cyan-500/30":"bg-white/5 hover:bg-white/10 border border-transparent"} rounded-xl`,children:[A.jsxs("div",{className:"flex items-center gap-4",children:[A.jsx("span",{className:"text-3xl",children:Js(b)}),A.jsxs("div",{className:"text-left",children:[A.jsxs("div",{className:"flex items-center gap-2",children:[A.jsx("span",{className:"font-semibold text-white",children:nw[b]||b}),L&&A.jsxs("span",{className:"px-2 py-0.5 bg-cyan-500/30 text-cyan-300 text-xs rounded-full flex items-center gap-1",children:[A.jsx(xp,{className:"w-3 h-3"}),"LOCAL"]})]}),A.jsxs("span",{className:"text-sm text-gray-500",children:[w.length," channels"]})]})]}),A.jsx(Ee.div,{animate:{rotate:I?90:0},transition:{duration:.2},children:A.jsx(Mm,{className:"w-5 h-5 text-gray-400"})})]}),A.jsx(tn,{children:I&&A.jsx(Ee.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:A.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3 p-4 bg-black/20 rounded-b-xl",children:w.map(k=>A.jsx(pm,{channel:k,onSelect:n,onToggleFavorite:i,isFavorite:r(k),isLocal:k.country===(o==null?void 0:o.code),compact:!0},k.id))})})})]},b)})})]})}if(e&&l==="all"){const x=s.filter(b=>b.country===(o==null?void 0:o.code));return A.jsxs("div",{className:"space-y-6",children:[x.length>0&&A.jsx(EE,{title:"Your Local Channels",icon:A.jsx(xp,{className:"w-5 h-5 text-cyan-400"}),channels:x.slice(0,12),onSelect:n,onToggleFavorite:i,isFavorite:r,userCountry:o,isExpanded:h.has("local"),onToggle:()=>y("local"),badge:A.jsxs("span",{className:"px-2 py-0.5 bg-cyan-500/30 text-cyan-300 text-xs rounded-full",children:[Js(o==null?void 0:o.code)," ",o==null?void 0:o.name]})}),Object.entries(e).slice(0,8).map(([b,w])=>A.jsx(EE,{title:b,channels:w.slice(0,12),onSelect:n,onToggleFavorite:i,isFavorite:r,userCountry:o,isExpanded:h.has(b),onToggle:()=>y(b),onViewAll:()=>u(b)},b))]})}return A.jsxs("div",{className:"space-y-6",children:[A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[A.jsx(Cr,{className:"w-7 h-7 text-cyan-400"}),l==="favorites"?"Favorites":l==="recent"?"Recently Played":l]}),A.jsxs("span",{className:"text-gray-500",children:[s.length," channels"]})]}),s.length===0?A.jsx(wU,{view:l}):A.jsx("div",{className:`grid gap-4 ${d?"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6":"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6"}`,children:s.map(x=>A.jsx(pm,{channel:x,onSelect:n,onToggleFavorite:i,isFavorite:r(x),isLocal:x.country===(o==null?void 0:o.code),compact:d},x.id))})]})}function EE({title:s,icon:e,channels:t,onSelect:n,onToggleFavorite:i,isFavorite:r,userCountry:o,isExpanded:l,onToggle:u,onViewAll:d,badge:h}){return A.jsxs("div",{className:"space-y-4",children:[A.jsxs("div",{className:"flex items-center justify-between",children:[A.jsxs("button",{onClick:u,className:"flex items-center gap-3 group",children:[e||A.jsx(Cr,{className:"w-5 h-5 text-cyan-400"}),A.jsx("h3",{className:"text-xl font-semibold text-white group-hover:text-cyan-400 transition-colors",children:s}),h,A.jsx(Ee.div,{animate:{rotate:l?180:0},transition:{duration:.2},children:A.jsx(o_,{className:"w-5 h-5 text-gray-500"})})]}),d&&A.jsx("button",{onClick:d,className:"text-sm text-cyan-400 hover:text-cyan-300 transition-colors",children:"View All "})]}),A.jsx(tn,{children:l&&A.jsx(Ee.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:A.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:t.map(p=>A.jsx(pm,{channel:p,onSelect:n,onToggleFavorite:i,isFavorite:r(p),isLocal:p.country===(o==null?void 0:o.code)},p.id))})})})]})}function pm({channel:s,onSelect:e,onToggleFavorite:t,isFavorite:n,isLocal:i,compact:r}){const[o,l]=B.useState(!1);return A.jsxs(Ee.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},whileHover:{scale:1.02,y:-4},className:"group relative",children:[A.jsxs("div",{onClick:()=>e(s),className:`relative rounded-xl overflow-hidden cursor-pointer transition-all duration-300 ${i?"ring-2 ring-cyan-500/50 shadow-[0_0_20px_rgba(0,245,255,0.15)]":"ring-1 ring-white/10 hover:ring-cyan-500/30"} bg-gradient-to-br from-[#12121a] to-[#0a0a0f]`,children:[A.jsxs("div",{className:`relative ${r?"aspect-video":"aspect-[4/3]"} bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center overflow-hidden`,children:[s.logo&&!o?A.jsx("img",{src:s.logo,alt:s.name,className:"w-full h-full object-contain p-4",onError:()=>l(!0)}):A.jsxs("div",{className:"flex flex-col items-center gap-2 text-gray-600",children:[A.jsx(Cr,{className:"w-10 h-10"}),A.jsx("span",{className:"text-xs text-center px-2 line-clamp-2",children:s.name})]}),A.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-all duration-300 flex items-center justify-center",children:A.jsx(Ee.div,{initial:{scale:0},whileHover:{scale:1.1},className:"w-14 h-14 rounded-full bg-cyan-500/90 flex items-center justify-center shadow-[0_0_30px_rgba(0,245,255,0.5)]",children:A.jsx(Sp,{className:"w-6 h-6 text-white ml-1",fill:"white"})})}),A.jsx("div",{className:"absolute top-2 left-2 flex gap-2",children:i&&A.jsxs("span",{className:"px-2 py-1 bg-cyan-500/90 text-white text-xs rounded-md font-medium flex items-center gap-1",children:[A.jsx(xp,{className:"w-3 h-3"}),"LOCAL"]})}),s.country&&A.jsx("span",{className:"absolute top-2 right-2 text-lg",children:Js(s.country)})]}),A.jsxs("div",{className:"p-3",children:[A.jsx("h4",{className:"font-medium text-white truncate text-sm",children:s.name}),A.jsx("p",{className:"text-xs text-gray-500 truncate mt-1",children:s.group})]}),A.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:A.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500/10 to-purple-500/10"})})]}),A.jsx("button",{onClick:u=>{u.stopPropagation(),t(s)},className:`absolute bottom-14 right-2 p-2 rounded-full transition-all z-10 ${n?"bg-yellow-500/20 text-yellow-400":"bg-black/50 text-gray-400 opacity-0 group-hover:opacity-100"} hover:scale-110`,children:A.jsx(od,{className:"w-4 h-4",fill:n?"currentColor":"none"})})]})}function wU({view:s}){const e={favorites:{title:"No favorites yet",description:"Star channels you love to find them here quickly"},recent:{title:"No recently played",description:"Channels you watch will appear here"},default:{title:"No channels found",description:"Try a different category or search"}},{title:t,description:n}=e[s]||e.default;return A.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-20",children:[A.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-cyan-500/20 to-purple-500/20 flex items-center justify-center",children:s==="favorites"?A.jsx(od,{className:"w-10 h-10 text-gray-500"}):s==="recent"?A.jsx(Clock,{className:"w-10 h-10 text-gray-500"}):A.jsx(Cr,{className:"w-10 h-10 text-gray-500"})}),A.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:t}),A.jsx("p",{className:"text-gray-500",children:n})]})}const pe=Number.isFinite||function(s){return typeof s=="number"&&isFinite(s)},RU=Number.isSafeInteger||function(s){return typeof s=="number"&&Math.abs(s)<=LU},LU=Number.MAX_SAFE_INTEGER||9007199254740991;let Re=(function(s){return s.NETWORK_ERROR="networkError",s.MEDIA_ERROR="mediaError",s.KEY_SYSTEM_ERROR="keySystemError",s.MUX_ERROR="muxError",s.OTHER_ERROR="otherError",s})({}),H=(function(s){return s.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",s.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",s.KEY_SYSTEM_NO_SESSION="keySystemNoSession",s.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",s.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",s.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",s.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",s.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",s.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",s.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",s.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",s.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",s.MANIFEST_LOAD_ERROR="manifestLoadError",s.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",s.MANIFEST_PARSING_ERROR="manifestParsingError",s.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",s.LEVEL_EMPTY_ERROR="levelEmptyError",s.LEVEL_LOAD_ERROR="levelLoadError",s.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",s.LEVEL_PARSING_ERROR="levelParsingError",s.LEVEL_SWITCH_ERROR="levelSwitchError",s.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",s.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",s.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",s.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",s.FRAG_LOAD_ERROR="fragLoadError",s.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",s.FRAG_DECRYPT_ERROR="fragDecryptError",s.FRAG_PARSING_ERROR="fragParsingError",s.FRAG_GAP="fragGap",s.REMUX_ALLOC_ERROR="remuxAllocError",s.KEY_LOAD_ERROR="keyLoadError",s.KEY_LOAD_TIMEOUT="keyLoadTimeOut",s.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",s.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",s.BUFFER_APPEND_ERROR="bufferAppendError",s.BUFFER_APPENDING_ERROR="bufferAppendingError",s.BUFFER_STALLED_ERROR="bufferStalledError",s.BUFFER_FULL_ERROR="bufferFullError",s.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",s.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",s.ASSET_LIST_LOAD_ERROR="assetListLoadError",s.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",s.ASSET_LIST_PARSING_ERROR="assetListParsingError",s.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",s.INTERNAL_EXCEPTION="internalException",s.INTERNAL_ABORTED="aborted",s.ATTACH_MEDIA_ERROR="attachMediaError",s.UNKNOWN="unknown",s})({}),R=(function(s){return s.MEDIA_ATTACHING="hlsMediaAttaching",s.MEDIA_ATTACHED="hlsMediaAttached",s.MEDIA_DETACHING="hlsMediaDetaching",s.MEDIA_DETACHED="hlsMediaDetached",s.MEDIA_ENDED="hlsMediaEnded",s.STALL_RESOLVED="hlsStallResolved",s.BUFFER_RESET="hlsBufferReset",s.BUFFER_CODECS="hlsBufferCodecs",s.BUFFER_CREATED="hlsBufferCreated",s.BUFFER_APPENDING="hlsBufferAppending",s.BUFFER_APPENDED="hlsBufferAppended",s.BUFFER_EOS="hlsBufferEos",s.BUFFERED_TO_END="hlsBufferedToEnd",s.BUFFER_FLUSHING="hlsBufferFlushing",s.BUFFER_FLUSHED="hlsBufferFlushed",s.MANIFEST_LOADING="hlsManifestLoading",s.MANIFEST_LOADED="hlsManifestLoaded",s.MANIFEST_PARSED="hlsManifestParsed",s.LEVEL_SWITCHING="hlsLevelSwitching",s.LEVEL_SWITCHED="hlsLevelSwitched",s.LEVEL_LOADING="hlsLevelLoading",s.LEVEL_LOADED="hlsLevelLoaded",s.LEVEL_UPDATED="hlsLevelUpdated",s.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",s.LEVELS_UPDATED="hlsLevelsUpdated",s.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",s.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",s.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",s.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",s.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",s.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",s.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",s.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",s.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",s.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",s.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",s.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",s.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",s.CUES_PARSED="hlsCuesParsed",s.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",s.INIT_PTS_FOUND="hlsInitPtsFound",s.FRAG_LOADING="hlsFragLoading",s.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",s.FRAG_LOADED="hlsFragLoaded",s.FRAG_DECRYPTED="hlsFragDecrypted",s.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",s.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",s.FRAG_PARSING_METADATA="hlsFragParsingMetadata",s.FRAG_PARSED="hlsFragParsed",s.FRAG_BUFFERED="hlsFragBuffered",s.FRAG_CHANGED="hlsFragChanged",s.FPS_DROP="hlsFpsDrop",s.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",s.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",s.ERROR="hlsError",s.DESTROYING="hlsDestroying",s.KEY_LOADING="hlsKeyLoading",s.KEY_LOADED="hlsKeyLoaded",s.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",s.BACK_BUFFER_REACHED="hlsBackBufferReached",s.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",s.ASSET_LIST_LOADING="hlsAssetListLoading",s.ASSET_LIST_LOADED="hlsAssetListLoaded",s.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",s.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",s.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",s.INTERSTITIAL_STARTED="hlsInterstitialStarted",s.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",s.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",s.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",s.INTERSTITIAL_ENDED="hlsInterstitialEnded",s.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",s.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",s.EVENT_CUE_ENTER="hlsEventCueEnter",s})({});var Ge={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ye={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class ao{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class IU{constructor(e,t,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new ao(e),this.fast_=new ao(t),this.defaultTTFB_=i,this.ttfb_=new ao(e)}update(e,t){const{slow_:n,fast_:i,ttfb_:r}=this;n.halfLife!==e&&(this.slow_=new ao(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==t&&(this.fast_=new ao(t,i.getEstimate(),i.getTotalWeight())),r.halfLife!==e&&(this.ttfb_=new ao(e,r.getEstimate(),r.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,i=e/1e3,r=n/i;this.fast_.sample(i,r),this.slow_.sample(i,r)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function _U(s,e,t){return(e=CU(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function tt(){return tt=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},tt.apply(null,arguments)}function TE(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),t.push.apply(t,n)}return t}function Ze(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?TE(Object(t),!0).forEach(function(n){_U(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):TE(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function kU(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function CU(s){var e=kU(s,"string");return typeof e=="symbol"?e:e+""}class Wn{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n=`[${e}]:`;this.trace=wi,this.debug=t.debug.bind(null,n),this.log=t.log.bind(null,n),this.warn=t.warn.bind(null,n),this.info=t.info.bind(null,n),this.error=t.error.bind(null,n)}}const wi=function(){},PU={trace:wi,debug:wi,log:wi,warn:wi,info:wi,error:wi};function mm(){return tt({},PU)}function DU(s,e){const t=self.console[s];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${s}] >`):wi}function bE(s,e,t){return e[s]?e[s].bind(e):DU(s,t)}const gm=mm();function OU(s,e,t){const n=mm();if(typeof console=="object"&&s===!0||typeof s=="object"){const i=["debug","log","info","warn","error"];i.forEach(r=>{n[r]=bE(r,s,t)});try{n.log(`Debug logs enabled for "${e}" in hls.js version 1.6.15`)}catch{return mm()}i.forEach(r=>{gm[r]=bE(r,s)})}else tt(gm,n);return n}const et=gm;function ji(s=!0){return typeof self>"u"?void 0:(s||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function NU(s){return typeof self<"u"&&s===self.ManagedMediaSource}function sw(s,e){const t=Object.keys(s),n=Object.keys(e),i=t.length,r=n.length;return!i||!r||i===r&&!t.some(o=>n.indexOf(o)===-1)}function Dn(s,e=!1){if(typeof TextDecoder<"u"){const d=new TextDecoder("utf-8").decode(s);if(e){const h=d.indexOf("\0");return h!==-1?d.substring(0,h):d}return d.replace(/\0/g,"")}const t=s.length;let n,i,r,o="",l=0;for(;l<t;){if(n=s[l++],n===0&&e)return o;if(n===0||n===3)continue;switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(n);break;case 12:case 13:i=s[l++],o+=String.fromCharCode((n&31)<<6|i&63);break;case 14:i=s[l++],r=s[l++],o+=String.fromCharCode((n&15)<<12|(i&63)<<6|(r&63)<<0);break}}return o}function Ht(s){let e="";for(let t=0;t<s.length;t++){let n=s[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}function iw(s){return Uint8Array.from(s.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function MU(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Yf={exports:{}},AE;function FU(){return AE||(AE=1,(function(s,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,r=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,l={buildAbsoluteURL:function(u,d,h){if(h=h||{},u=u.trim(),d=d.trim(),!d){if(!h.alwaysNormalize)return u;var p=l.parseURL(u);if(!p)throw new Error("Error trying to parse base URL.");return p.path=l.normalizePath(p.path),l.buildURLFromParts(p)}var m=l.parseURL(d);if(!m)throw new Error("Error trying to parse relative URL.");if(m.scheme)return h.alwaysNormalize?(m.path=l.normalizePath(m.path),l.buildURLFromParts(m)):d;var v=l.parseURL(u);if(!v)throw new Error("Error trying to parse base URL.");if(!v.netLoc&&v.path&&v.path[0]!=="/"){var y=i.exec(v.path);v.netLoc=y[1],v.path=y[2]}v.netLoc&&!v.path&&(v.path="/");var S={scheme:v.scheme,netLoc:m.netLoc,path:null,params:m.params,query:m.query,fragment:m.fragment};if(!m.netLoc&&(S.netLoc=v.netLoc,m.path[0]!=="/"))if(!m.path)S.path=v.path,m.params||(S.params=v.params,m.query||(S.query=v.query));else{var x=v.path,b=x.substring(0,x.lastIndexOf("/")+1)+m.path;S.path=l.normalizePath(b)}return S.path===null&&(S.path=h.alwaysNormalize?l.normalizePath(m.path):m.path),l.buildURLFromParts(S)},parseURL:function(u){var d=n.exec(u);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(u){for(u=u.split("").reverse().join("").replace(r,"");u.length!==(u=u.replace(o,"")).length;);return u.split("").reverse().join("")},buildURLFromParts:function(u){return u.scheme+u.netLoc+u.path+u.params+u.query+u.fragment}};s.exports=l})()})(Yf)),Yf.exports}var Og=FU();class Ng{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var nt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class rw{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,UU(this,"stats")}setByteRange(e,t){const n=e.split("@",2);let i;n.length===1?i=(t==null?void 0:t.byteRangeEndOffset)||0:i=parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[nt.AUDIO]:null,[nt.VIDEO]:null,[nt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new Ng),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Og.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[nt.AUDIO]=null,e[nt.VIDEO]=null,e[nt.AUDIOVIDEO]=null}}function Tt(s){return s.sn!=="initSegment"}class Qf extends rw{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(pe(e)&&pe(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:t}=this;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const n=Object.keys(t);if(n.length===1){const i=this._decryptdata=t[n[0]]||null;i&&(this._decryptdata=i.getDecryptData(this.sn,t))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=pe(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var t;const n=Object.keys(this.levelkeys),i=n.length;if(i>1||i===1&&(t=this.levelkeys[n[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!pe(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return Tt(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const t=this.levelkeys;if(t){var n;const i=t[e];i&&!((n=this._decryptdata)!=null&&n.keyId)&&(this._decryptdata=i.getDecryptData(this.sn,t))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,i,r,o=!1){const{elementaryStreams:l}=this,u=l[e];if(!u){l[e]={startPTS:t,endPTS:n,startDTS:i,endDTS:r,partial:o};return}u.startPTS=Math.min(u.startPTS,t),u.endPTS=Math.max(u.endPTS,n),u.startDTS=Math.min(u.startDTS,i),u.endDTS=Math.max(u.endDTS,r)}}class BU extends rw{constructor(e,t,n,i,r){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,r),r&&(this.fragOffset=r.fragOffset+r.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function ow(s,e){const t=Object.getPrototypeOf(s);if(t){const n=Object.getOwnPropertyDescriptor(t,e);return n||ow(t,e)}}function UU(s,e){const t=ow(s,e);t&&(t.enumerable=!0,Object.defineProperty(s,e,t))}const wE=Math.pow(2,32)-1,$U=[].push,aw={video:1,audio:2,id3:3,text:4};function Ct(s){return String.fromCharCode.apply(null,s)}function lw(s,e){const t=s[e]<<8|s[e+1];return t<0?65536+t:t}function Ne(s,e){const t=cw(s,e);return t<0?4294967296+t:t}function RE(s,e){let t=Ne(s,e);return t*=Math.pow(2,32),t+=Ne(s,e+4),t}function cw(s,e){return s[e]<<24|s[e+1]<<16|s[e+2]<<8|s[e+3]}function jU(s){const e=s.byteLength;for(let t=0;t<e;){const n=Ne(s,t);if(n>8&&s[t+4]===109&&s[t+5]===111&&s[t+6]===111&&s[t+7]===102)return!0;t=n>1?t+n:e}return!1}function je(s,e){const t=[];if(!e.length)return t;const n=s.byteLength;for(let i=0;i<n;){const r=Ne(s,i),o=Ct(s.subarray(i+4,i+8)),l=r>1?i+r:n;if(o===e[0])if(e.length===1)t.push(s.subarray(i+8,l));else{const u=je(s.subarray(i+8,l),e.slice(1));u.length&&$U.apply(t,u)}i=l}return t}function VU(s){const e=[],t=s[0];let n=8;const i=Ne(s,n);n+=4;let r=0,o=0;t===0?(r=Ne(s,n),o=Ne(s,n+4),n+=8):(r=RE(s,n),o=RE(s,n+8),n+=16),n+=2;let l=s.length+o;const u=lw(s,n);n+=2;for(let d=0;d<u;d++){let h=n;const p=Ne(s,h);h+=4;const m=p&2147483647;if((p&2147483648)>>>31===1)return et.warn("SIDX has hierarchical references (not supported)"),null;const y=Ne(s,h);h+=4,e.push({referenceSize:m,subsegmentDuration:y,info:{duration:y/i,start:l,end:l+m-1}}),l+=m,h+=4,n=h}return{earliestPresentationTime:r,timescale:i,version:t,referencesCount:u,references:e}}function uw(s){const e=[],t=je(s,["moov","trak"]);for(let i=0;i<t.length;i++){const r=t[i],o=je(r,["tkhd"])[0];if(o){let l=o[0];const u=Ne(o,l===0?12:20),d=je(r,["mdia","mdhd"])[0];if(d){l=d[0];const h=Ne(d,l===0?12:20),p=je(r,["mdia","hdlr"])[0];if(p){const m=Ct(p.subarray(8,12)),v={soun:nt.AUDIO,vide:nt.VIDEO}[m],y=je(r,["mdia","minf","stbl","stsd"])[0],S=GU(y);v?(e[u]={timescale:h,type:v,stsd:S},e[v]=Ze({timescale:h,id:u},S)):e[u]={timescale:h,type:m,stsd:S}}}}}return je(s,["moov","mvex","trex"]).forEach(i=>{const r=Ne(i,4),o=e[r];o&&(o.default={duration:Ne(i,12),flags:Ne(i,20)})}),e}function GU(s){const e=s.subarray(8),t=e.subarray(86),n=Ct(e.subarray(4,8));let i=n,r;const o=n==="enca"||n==="encv";if(o){const d=je(e,[n])[0].subarray(n==="enca"?28:78);je(d,["sinf"]).forEach(p=>{const m=je(p,["schm"])[0];if(m){const v=Ct(m.subarray(4,8));if(v==="cbcs"||v==="cenc"){const y=je(p,["frma"])[0];y&&(i=Ct(y))}}})}const l=i;switch(i){case"avc1":case"avc2":case"avc3":case"avc4":{const u=je(t,["avcC"])[0];u&&u.length>3&&(i+="."+su(u[1])+su(u[2])+su(u[3]),r=nu(l==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const u=je(e,[n])[0],d=je(u.subarray(28),["esds"])[0];if(d&&d.length>7){let h=4;if(d[h++]!==3)break;h=Xf(d,h),h+=2;const p=d[h++];if(p&128&&(h+=2),p&64&&(h+=d[h++]),d[h++]!==4)break;h=Xf(d,h);const m=d[h++];if(m===64)i+="."+su(m);else break;if(h+=12,d[h++]!==5)break;h=Xf(d,h);const v=d[h++];let y=(v&248)>>3;y===31&&(y+=1+((v&7)<<3)+((d[h]&224)>>5)),i+="."+y}break}case"hvc1":case"hev1":{const u=je(t,["hvcC"])[0];if(u&&u.length>12){const d=u[1],h=["","A","B","C"][d>>6],p=d&31,m=Ne(u,2),v=(d&32)>>5?"H":"L",y=u[12],S=u.subarray(6,12);i+="."+h+p,i+="."+KU(m).toString(16).toUpperCase(),i+="."+v+y;let x="";for(let b=S.length;b--;){const w=S[b];(w||x)&&(x="."+w.toString(16).toUpperCase()+x)}i+=x}r=nu(l=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{i=nu(i,t)||i;break}case"vp09":{const u=je(t,["vpcC"])[0];if(u&&u.length>6){const d=u[4],h=u[5],p=u[6]>>4&15;i+="."+xs(d)+"."+xs(h)+"."+xs(p)}break}case"av01":{const u=je(t,["av1C"])[0];if(u&&u.length>2){const d=u[1]>>>5,h=u[1]&31,p=u[2]>>>7?"H":"M",m=(u[2]&64)>>6,v=(u[2]&32)>>5,y=d===2&&m?v?12:10:m?10:8,S=(u[2]&16)>>4,x=(u[2]&8)>>3,b=(u[2]&4)>>2,w=u[2]&3;i+="."+d+"."+xs(h)+p+"."+xs(y)+"."+S+"."+x+b+w+"."+xs(1)+"."+xs(1)+"."+xs(1)+"."+0,r=nu("dav1",t)}break}}return{codec:i,encrypted:o,supplemental:r}}function nu(s,e){const t=je(e,["dvvC"]),n=t.length?t[0]:je(e,["dvcC"])[0];if(n){const i=n[2]>>1&127,r=n[2]<<5&32|n[3]>>3&31;return s+"."+xs(i)+"."+xs(r)}}function KU(s){let e=0;for(let t=0;t<32;t++)e|=(s>>t&1)<<31-t;return e>>>0}function Xf(s,e){const t=e+5;for(;s[e++]&128&&e<t;);return e}function su(s){return("0"+s.toString(16).toUpperCase()).slice(-2)}function xs(s){return(s<10?"0":"")+s}function HU(s,e){if(!s||!e)return;const t=e.keyId;t&&e.isCommonEncryption&&dw(s,(n,i)=>{const r=n.subarray(8,24);r.some(o=>o!==0)||(et.log(`[eme] Patching keyId in 'enc${i?"a":"v"}>sinf>>tenc' box: ${Ht(r)} -> ${Ht(t)}`),n.set(t,8))})}function zU(s){const e=[];return dw(s,t=>e.push(t.subarray(8,24))),e}function dw(s,e){je(s,["moov","trak"]).forEach(n=>{const i=je(n,["mdia","minf","stbl","stsd"])[0];if(!i)return;const r=i.subarray(8);let o=je(r,["enca"]);const l=o.length>0;l||(o=je(r,["encv"])),o.forEach(u=>{const d=l?u.subarray(28):u.subarray(78);je(d,["sinf"]).forEach(p=>{const m=hw(p);m&&e(m,l)})})})}function hw(s){const e=je(s,["schm"])[0];if(e){const t=Ct(e.subarray(4,8));if(t==="cbcs"||t==="cenc"){const n=je(s,["schi","tenc"])[0];if(n)return n}}}function WU(s,e,t){const n={},i=je(s,["moof","traf"]);for(let r=0;r<i.length;r++){const o=i[r],l=je(o,["tfhd"])[0],u=Ne(l,4),d=e[u];if(!d)continue;n[u]||(n[u]={start:NaN,duration:0,sampleCount:0,timescale:d.timescale,type:d.type});const h=n[u],p=je(o,["tfdt"])[0];if(p){const L=p[0];let I=Ne(p,4);L===1&&(I===wE?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(I*=wE+1,I+=Ne(p,8))),pe(I)&&(!pe(h.start)||I<h.start)&&(h.start=I)}const m=d.default,v=Ne(l,0)|(m==null?void 0:m.flags);let y=(m==null?void 0:m.duration)||0;v&8&&(v&2?y=Ne(l,12):y=Ne(l,8));const S=je(o,["trun"]);let x=h.start||0,b=0,w=y;for(let L=0;L<S.length;L++){const I=S[L],k=Ne(I,4),M=h.sampleCount;h.sampleCount+=k;const P=I[3]&1,C=I[3]&4,U=I[2]&1,O=I[2]&2,W=I[2]&4,ne=I[2]&8;let oe=8,se=k;for(P&&(oe+=4),C&&k&&(!(I[oe+1]&1)&&h.keyFrameIndex===void 0&&(h.keyFrameIndex=M),oe+=4,U?(w=Ne(I,oe),oe+=4):w=y,O&&(oe+=4),ne&&(oe+=4),x+=w,b+=w,se--);se--;)U?(w=Ne(I,oe),oe+=4):w=y,O&&(oe+=4),W&&(I[oe+1]&1||h.keyFrameIndex===void 0&&(h.keyFrameIndex=h.sampleCount-(se+1),h.keyFrameStart=x),oe+=4),ne&&(oe+=4),x+=w,b+=w;!b&&y&&(b+=y*k)}h.duration+=b}if(!Object.keys(n).some(r=>n[r].duration)){let r=1/0,o=0;const l=je(s,["sidx"]);for(let u=0;u<l.length;u++){const d=VU(l[u]);if(d!=null&&d.references){r=Math.min(r,d.earliestPresentationTime/d.timescale);const h=d.references.reduce((p,m)=>p+m.info.duration||0,0);o=Math.max(o,h+d.earliestPresentationTime/d.timescale)}}o&&pe(o)&&Object.keys(n).forEach(u=>{n[u].duration||(n[u].duration=o*n[u].timescale-n[u].start)})}return n}function qU(s){const e={valid:null,remainder:null},t=je(s,["moof"]);if(t.length<2)return e.remainder=s,e;const n=t[t.length-1];return e.valid=s.slice(0,n.byteOffset-8),e.remainder=s.slice(n.byteOffset-8),e}function zn(s,e){const t=new Uint8Array(s.length+e.length);return t.set(s),t.set(e,s.length),t}function LE(s,e){const t=[],n=e.samples,i=e.timescale,r=e.id;let o=!1;return je(n,["moof"]).map(u=>{const d=u.byteOffset-8;je(u,["traf"]).map(p=>{const m=je(p,["tfdt"]).map(v=>{const y=v[0];let S=Ne(v,4);return y===1&&(S*=Math.pow(2,32),S+=Ne(v,8)),S/i})[0];return m!==void 0&&(s=m),je(p,["tfhd"]).map(v=>{const y=Ne(v,4),S=Ne(v,0)&16777215,x=(S&1)!==0,b=(S&2)!==0,w=(S&8)!==0;let L=0;const I=(S&16)!==0;let k=0;const M=(S&32)!==0;let P=8;y===r&&(x&&(P+=8),b&&(P+=4),w&&(L=Ne(v,P),P+=4),I&&(k=Ne(v,P),P+=4),M&&(P+=4),e.type==="video"&&(o=Ad(e.codec)),je(p,["trun"]).map(C=>{const U=C[0],O=Ne(C,0)&16777215,W=(O&1)!==0;let ne=0;const oe=(O&4)!==0,se=(O&256)!==0;let re=0;const X=(O&512)!==0;let Z=0;const F=(O&1024)!==0,ee=(O&2048)!==0;let J=0;const D=Ne(C,4);let j=8;W&&(ne=Ne(C,j),j+=4),oe&&(j+=4);let ie=ne+d;for(let ce=0;ce<D;ce++){if(se?(re=Ne(C,j),j+=4):re=L,X?(Z=Ne(C,j),j+=4):Z=k,F&&(j+=4),ee&&(U===0?J=Ne(C,j):J=cw(C,j),j+=4),e.type===nt.VIDEO){let de=0;for(;de<Z;){const fe=Ne(n,ie);if(ie+=4,YU(o,n[ie])){const ve=n.subarray(ie,ie+fe);Mg(ve,o?2:1,s+J/i,t)}ie+=fe,de+=fe+4}}s+=re/i}}))})})}),t}function Ad(s){if(!s)return!1;const e=s.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function YU(s,e){if(s){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Mg(s,e,t,n){const i=fw(s);let r=0;r+=e;let o=0,l=0,u=0;for(;r<i.length;){o=0;do{if(r>=i.length)break;u=i[r++],o+=u}while(u===255);l=0;do{if(r>=i.length)break;u=i[r++],l+=u}while(u===255);const d=i.length-r;let h=r;if(l<d)r+=l;else if(l>d){et.error(`Malformed SEI payload. ${l} is too small, only ${d} bytes left to parse.`);break}if(o===4){if(i[h++]===181){const m=lw(i,h);if(h+=2,m===49){const v=Ne(i,h);if(h+=4,v===1195456820){const y=i[h++];if(y===3){const S=i[h++],x=31&S,b=64&S,w=b?2+x*3:0,L=new Uint8Array(w);if(b){L[0]=S;for(let I=1;I<w;I++)L[I]=i[h++]}n.push({type:y,payloadType:o,pts:t,bytes:L})}}}}}else if(o===5&&l>16){const p=[];for(let y=0;y<16;y++){const S=i[h++].toString(16);p.push(S.length==1?"0"+S:S),(y===3||y===5||y===7||y===9)&&p.push("-")}const m=l-16,v=new Uint8Array(m);for(let y=0;y<m;y++)v[y]=i[h++];n.push({payloadType:o,pts:t,uuid:p.join(""),userData:Dn(v),userDataBytes:v})}}}function fw(s){const e=s.byteLength,t=[];let n=1;for(;n<e-2;)s[n]===0&&s[n+1]===0&&s[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return s;const i=e-t.length,r=new Uint8Array(i);let o=0;for(n=0;n<i;o++,n++)o===t[0]&&(o++,t.shift()),r[n]=s[o];return r}function QU(s){const e=s[0];let t="",n="",i=0,r=0,o=0,l=0,u=0,d=0;if(e===0){for(;Ct(s.subarray(d,d+1))!=="\0";)t+=Ct(s.subarray(d,d+1)),d+=1;for(t+=Ct(s.subarray(d,d+1)),d+=1;Ct(s.subarray(d,d+1))!=="\0";)n+=Ct(s.subarray(d,d+1)),d+=1;n+=Ct(s.subarray(d,d+1)),d+=1,i=Ne(s,12),r=Ne(s,16),l=Ne(s,20),u=Ne(s,24),d=28}else if(e===1){d+=4,i=Ne(s,d),d+=4;const p=Ne(s,d);d+=4;const m=Ne(s,d);for(d+=4,o=2**32*p+m,RU(o)||(o=Number.MAX_SAFE_INTEGER,et.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),l=Ne(s,d),d+=4,u=Ne(s,d),d+=4;Ct(s.subarray(d,d+1))!=="\0";)t+=Ct(s.subarray(d,d+1)),d+=1;for(t+=Ct(s.subarray(d,d+1)),d+=1;Ct(s.subarray(d,d+1))!=="\0";)n+=Ct(s.subarray(d,d+1)),d+=1;n+=Ct(s.subarray(d,d+1)),d+=1}const h=s.subarray(d,s.byteLength);return{schemeIdUri:t,value:n,timeScale:i,presentationTime:o,presentationTimeDelta:r,eventDuration:l,id:u,payload:h}}function XU(s,...e){const t=e.length;let n=8,i=t;for(;i--;)n+=e[i].byteLength;const r=new Uint8Array(n);for(r[0]=n>>24&255,r[1]=n>>16&255,r[2]=n>>8&255,r[3]=n&255,r.set(s,4),i=0,n=8;i<t;i++)r.set(e[i],n),n+=e[i].byteLength;return r}function JU(s,e,t){if(s.byteLength!==16)throw new RangeError("Invalid system id");let n,i;n=0,i=new Uint8Array;let r;n>0?(r=new Uint8Array(4),e.length>0&&new DataView(r.buffer).setUint32(0,e.length,!1)):r=new Uint8Array;const o=new Uint8Array(4);return t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),XU([112,115,115,104],new Uint8Array([n,0,0,0]),s,r,i,o,t)}function ZU(s){const e=[];if(s instanceof ArrayBuffer){const t=s.byteLength;let n=0;for(;n+32<t;){const i=new DataView(s,n),r=e$(i);e.push(r),n+=r.size}}return e}function e$(s){const e=s.getUint32(0),t=s.byteOffset,n=s.byteLength;if(n<e)return{offset:t,size:n};if(s.getUint32(4)!==1886614376)return{offset:t,size:e};const r=s.getUint32(8)>>>24;if(r!==0&&r!==1)return{offset:t,size:e};const o=s.buffer,l=Ht(new Uint8Array(o,t+12,16));let u=null,d=null,h=0;if(r===0)h=28;else{const m=s.getUint32(28);if(!m||n<32+m*16)return{offset:t,size:e};u=[];for(let v=0;v<m;v++)u.push(new Uint8Array(o,t+32+v*16,16));h=32+m*16}if(!h)return{offset:t,size:e};const p=s.getUint32(h);return e-32<p?{offset:t,size:e}:(d=new Uint8Array(o,t+h+4,p),{version:r,systemId:l,kids:u,data:d,offset:t,size:e})}const pw=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),jo={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Fg(s,e){const t=jo[e];return!!t&&!!t[s.slice(0,4)]}function pl(s,e,t=!0){return!s.split(",").some(n=>!Bg(n,e,t))}function Bg(s,e,t=!0){var n;const i=ji(t);return(n=i==null?void 0:i.isTypeSupported(ml(s,e)))!=null?n:!1}function ml(s,e){return`${e}/mp4;codecs=${s}`}function IE(s){if(s){const e=s.substring(0,4);return jo.video[e]}return 2}function Yu(s){const e=pw();return s.split(",").reduce((t,n)=>{const r=e&&Ad(n)?9:jo.video[n];return r?(r*2+t)/(t?3:2):(jo.audio[n]+t)/(t?2:1)},0)}const Jf={};function t$(s,e=!0){if(Jf[s])return Jf[s];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[s];for(let i=0;i<t.length;i++){var n;if(Bg(t[i],"audio",e))return Jf[s]=t[i],t[i];if(t[i]==="mp3"&&(n=ji(e))!=null&&n.isTypeSupported("audio/mpeg"))return""}return s}const n$=/flac|opus|mp4a\.40\.34/i;function Qu(s,e=!0){return s.replace(n$,t=>t$(t.toLowerCase(),e))}function s$(s,e){const t=[];if(s){const n=s.split(",");for(let i=0;i<n.length;i++)Fg(n[i],"video")||t.push(n[i])}return e&&t.push(e),t.join(",")}function ku(s,e){if(s&&(s.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(s)!==-1)&&(_E(s,"audio")||_E(s,"video")))return s;if(e){const t=e.split(",");if(t.length>1){if(s){for(let n=t.length;n--;)if(t[n].substring(0,4)===s.substring(0,4))return t[n]}return t[0]}}return e||s}function _E(s,e){return Fg(s,e)&&Bg(s,e)}function i$(s){const e=s.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");n.length>2&&n[0]==="avc1"&&(e[t]=`avc1.${parseInt(n[1]).toString(16)}${("000"+parseInt(n[2]).toString(16)).slice(-4)}`)}return e.join(",")}function r$(s){if(s.startsWith("av01.")){const e=s.split("."),t=["0","111","01","01","01","0"];for(let n=e.length;n>4&&n<10;n++)e[n]=t[n-4];return e.join(".")}return s}function kE(s){const e=ji(s)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function ym(s){return s.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const o$={supported:!0,powerEfficient:!0,smooth:!0},a$={supported:!1,smooth:!1,powerEfficient:!1},mw={supported:!0,configurations:[],decodingInfoResults:[o$]};function gw(s,e){return{supported:!1,configurations:e,decodingInfoResults:[a$],error:s}}function l$(s,e,t,n,i,r){const o=s.videoCodec,l=s.audioCodec?s.audioGroups:null,u=r==null?void 0:r.audioCodec,d=r==null?void 0:r.channels,h=d?parseInt(d):u?1/0:2;let p=null;if(l!=null&&l.length)try{l.length===1&&l[0]?p=e.groups[l[0]].channels:p=l.reduce((m,v)=>{if(v){const y=e.groups[v];if(!y)throw new Error(`Audio track group ${v} not found`);Object.keys(y.channels).forEach(S=>{m[S]=(m[S]||0)+y.channels[S]})}return m},{2:0})}catch{return!0}return o!==void 0&&(o.split(",").some(m=>Ad(m))||s.width>1920&&s.height>1088||s.height>1920&&s.width>1088||s.frameRate>Math.max(n,30)||s.videoRange!=="SDR"&&s.videoRange!==t||s.bitrate>Math.max(i,8e6))||!!p&&pe(h)&&Object.keys(p).some(m=>parseInt(m)>h)}function yw(s,e,t,n={}){const i=s.videoCodec;if(!i&&!s.audioCodec||!t)return Promise.resolve(mw);const r=[],o=c$(s),l=o.length,u=u$(s,e,l>0),d=u.length;for(let h=l||1*d||1;h--;){const p={type:"media-source"};if(l&&(p.video=o[h%l]),d){p.audio=u[h%d];const m=p.audio.bitrate;p.video&&m&&(p.video.bitrate-=m)}r.push(p)}if(i){const h=navigator.userAgent;if(i.split(",").some(p=>Ad(p))&&pw())return Promise.resolve(gw(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${h})`),r))}return Promise.all(r.map(h=>{const p=h$(h);return n[p]||(n[p]=t.decodingInfo(h))})).then(h=>({supported:!h.some(p=>!p.supported),configurations:r,decodingInfoResults:h})).catch(h=>({supported:!1,configurations:r,decodingInfoResults:[],error:h}))}function c$(s){var e;const t=(e=s.videoCodec)==null?void 0:e.split(","),n=vw(s),i=s.width||640,r=s.height||480,o=s.frameRate||30,l=s.videoRange.toLowerCase();return t?t.map(u=>{const d={contentType:ml(r$(u),"video"),width:i,height:r,bitrate:n,framerate:o};return l!=="sdr"&&(d.transferFunction=l),d}):[]}function u$(s,e,t){var n;const i=(n=s.audioCodec)==null?void 0:n.split(","),r=vw(s);return i&&s.audioGroups?s.audioGroups.reduce((o,l)=>{var u;const d=l?(u=e.groups[l])==null?void 0:u.tracks:null;return d?d.reduce((h,p)=>{if(p.groupId===l){const m=parseFloat(p.channels||"");i.forEach(v=>{const y={contentType:ml(v,"audio"),bitrate:t?d$(v,r):r};m&&(y.channels=""+m),h.push(y)})}return h},o):o},[]):[]}function d$(s,e){if(e<=1)return 1;let t=128e3;return s==="ec-3"?t=768e3:s==="ac-3"&&(t=64e4),Math.min(e/2,t)}function vw(s){return Math.ceil(Math.max(s.bitrate*.9,s.averageBitrate)/1e3)*1e3||1}function h$(s){let e="";const{audio:t,video:n}=s;if(n){const i=ym(n.contentType);e+=`${i}_r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${Math.ceil(n.bitrate/1e5)}`}if(t){const i=ym(t.contentType);e+=`${n?"_":""}${i}_c${t.channels}`}return e}const vm=["NONE","TYPE-0","TYPE-1",null];function f$(s){return vm.indexOf(s)>-1}const Xu=["SDR","PQ","HLG"];function p$(s){return!!s&&Xu.indexOf(s)>-1}var Cu={No:"",Yes:"YES",v2:"v2"};function CE(s){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=s,i=n<e/2;return e&&i?t?Cu.v2:Cu.Yes:Cu.No}class PE{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class gl{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(n=>!!n).map(n=>n.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const n=(t=e.supplemental)==null?void 0:t.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=`,${n.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return DE(this._audioGroups,e)}hasSubtitleGroup(e){return DE(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function DE(s,e){return!e||!s?!1:s.indexOf(e)!==-1}function m$(){if(typeof matchMedia=="function"){const s=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(s.media!==e.media)return s.matches===!0}return!1}function g$(s,e){let t=!1,n=[];if(s&&(t=s!=="SDR",n=[s]),e){n=e.allowedVideoRanges||Xu.slice(0);const i=n.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:i&&m$(),t||(n=["SDR"])}return{preferHDR:t,allowedVideoRanges:n}}const y$=s=>{const e=new WeakSet;return(t,n)=>{if(s&&(n=s(t,n)),typeof n=="object"&&n!==null){if(e.has(n))return;e.add(n)}return n}},it=(s,e)=>JSON.stringify(s,y$(e));function v$(s,e,t,n,i){const r=Object.keys(s),o=n==null?void 0:n.channels,l=n==null?void 0:n.audioCodec,u=i==null?void 0:i.videoCodec,d=o&&parseInt(o)===2;let h=!1,p=!1,m=1/0,v=1/0,y=1/0,S=1/0,x=0,b=[];const{preferHDR:w,allowedVideoRanges:L}=g$(e,i);for(let C=r.length;C--;){const U=s[r[C]];h||(h=U.channels[2]>0),m=Math.min(m,U.minHeight),v=Math.min(v,U.minFramerate),y=Math.min(y,U.minBitrate),L.filter(W=>U.videoRanges[W]>0).length>0&&(p=!0)}m=pe(m)?m:0,v=pe(v)?v:0;const I=Math.max(1080,m),k=Math.max(30,v);y=pe(y)?y:t,t=Math.max(y,t),p||(e=void 0);const M=r.length>1;return{codecSet:r.reduce((C,U)=>{const O=s[U];if(U===C)return C;if(b=p?L.filter(W=>O.videoRanges[W]>0):[],M){if(O.minBitrate>t)return ys(U,`min bitrate of ${O.minBitrate} > current estimate of ${t}`),C;if(!O.hasDefaultAudio)return ys(U,"no renditions with default or auto-select sound found"),C;if(l&&U.indexOf(l.substring(0,4))%5!==0)return ys(U,`audio codec preference "${l}" not found`),C;if(o&&!d){if(!O.channels[o])return ys(U,`no renditions with ${o} channel sound found (channels options: ${Object.keys(O.channels)})`),C}else if((!l||d)&&h&&O.channels[2]===0)return ys(U,"no renditions with stereo sound found"),C;if(O.minHeight>I)return ys(U,`min resolution of ${O.minHeight} > maximum of ${I}`),C;if(O.minFramerate>k)return ys(U,`min framerate of ${O.minFramerate} > maximum of ${k}`),C;if(!b.some(W=>O.videoRanges[W]>0))return ys(U,`no variants with VIDEO-RANGE of ${it(b)} found`),C;if(u&&U.indexOf(u.substring(0,4))%5!==0)return ys(U,`video codec preference "${u}" not found`),C;if(O.maxScore<x)return ys(U,`max score of ${O.maxScore} < selected max of ${x}`),C}return C&&(Yu(U)>=Yu(C)||O.fragmentError>s[C].fragmentError)?C:(S=O.minIndex,x=O.maxScore,U)},void 0),videoRanges:b,preferHDR:w,minFramerate:v,minBitrate:y,minIndex:S}}function ys(s,e){et.log(`[abr] start candidates with "${s}" ignored because ${e}`)}function xw(s){return s.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const i=t.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function x$(s,e,t,n){return s.slice(t,n+1).reduce((i,r,o)=>{if(!r.codecSet)return i;const l=r.audioGroups;let u=i[r.codecSet];u||(i[r.codecSet]=u={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:o,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!l,fragmentError:0}),u.minBitrate=Math.min(u.minBitrate,r.bitrate);const d=Math.min(r.height,r.width);return u.minHeight=Math.min(u.minHeight,d),u.minFramerate=Math.min(u.minFramerate,r.frameRate),u.minIndex=Math.min(u.minIndex,o),u.maxScore=Math.max(u.maxScore,r.score),u.fragmentError+=r.fragmentError,u.videoRanges[r.videoRange]=(u.videoRanges[r.videoRange]||0)+1,l&&l.forEach(h=>{if(!h)return;const p=e.groups[h];p&&(u.hasDefaultAudio=u.hasDefaultAudio||e.hasDefaultAudio?p.hasDefault:p.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(p.channels).forEach(m=>{u.channels[m]=(u.channels[m]||0)+p.channels[m]}))}),i},{})}function OE(s){if(!s)return s;const{lang:e,assocLang:t,characteristics:n,channels:i,audioCodec:r}=s;return{lang:e,assocLang:t,characteristics:n,channels:i,audioCodec:r}}function As(s,e,t){if("attrs"in s){const n=e.indexOf(s);if(n!==-1)return n}for(let n=0;n<e.length;n++){const i=e[n];if(Lr(s,i,t))return n}return-1}function Lr(s,e,t){const{groupId:n,name:i,lang:r,assocLang:o,default:l}=s,u=s.forced;return(n===void 0||e.groupId===n)&&(i===void 0||e.name===i)&&(r===void 0||S$(r,e.lang))&&(r===void 0||e.assocLang===o)&&(l===void 0||e.default===l)&&(u===void 0||e.forced===u)&&(!("characteristics"in s)||E$(s.characteristics||"",e.characteristics))&&(t===void 0||t(s,e))}function S$(s,e="--"){return s.length===e.length?s===e:s.startsWith(e)||e.startsWith(s)}function E$(s,e=""){const t=s.split(","),n=e.split(",");return t.length===n.length&&!t.some(i=>n.indexOf(i)===-1)}function dr(s,e){const{audioCodec:t,channels:n}=s;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function T$(s,e,t,n,i){const r=e[n],l=e.reduce((m,v,y)=>{const S=v.uri;return(m[S]||(m[S]=[])).push(y),m},{})[r.uri];l.length>1&&(n=Math.max.apply(Math,l));const u=r.videoRange,d=r.frameRate,h=r.codecSet.substring(0,4),p=NE(e,n,m=>{if(m.videoRange!==u||m.frameRate!==d||m.codecSet.substring(0,4)!==h)return!1;const v=m.audioGroups,y=t.filter(S=>!v||v.indexOf(S.groupId)!==-1);return As(s,y,i)>-1});return p>-1?p:NE(e,n,m=>{const v=m.audioGroups,y=t.filter(S=>!v||v.indexOf(S.groupId)!==-1);return As(s,y,i)>-1})}function NE(s,e,t){for(let n=e;n>-1;n--)if(t(s[n]))return n;for(let n=e+1;n<s.length;n++)if(t(s[n]))return n;return-1}function Ju(s,e){var t;return!!s&&s!==((t=e.loadLevelObj)==null?void 0:t.uri)}class b$ extends Wn{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var n;const{fragCurrent:i,partCurrent:r,hls:o}=this,{autoLevelEnabled:l,media:u}=o;if(!i||!u)return;const d=performance.now(),h=r?r.stats:i.stats,p=r?r.duration:i.duration,m=d-h.loading.start,v=o.minAutoLevel,y=i.level,S=this._nextAutoLevel;if(h.aborted||h.loaded&&h.loaded===h.total||y<=v){this.clearTimer(),this._nextAutoLevel=-1;return}if(!l)return;const x=S>-1&&S!==y,b=!!t||x;if(!b&&(u.paused||!u.playbackRate||!u.readyState))return;const w=o.mainForwardBufferInfo;if(!b&&w===null)return;const L=this.bwEstimator.getEstimateTTFB(),I=Math.abs(u.playbackRate);if(m<=Math.max(L,1e3*(p/(I*2))))return;const k=w?w.len/I:0,M=h.loading.first?h.loading.first-h.loading.start:-1,P=h.loaded&&M>-1,C=this.getBwEstimate(),U=o.levels,O=U[y],W=Math.max(h.loaded,Math.round(p*(i.bitrate||O.averageBitrate)/8));let ne=P?m-M:m;ne<1&&P&&(ne=Math.min(m,h.loaded*8/C));const oe=P?h.loaded*1e3/ne:0,se=L/1e3,re=oe?(W-h.loaded)/oe:W*8/C+se;if(re<=k)return;const X=oe?oe*8:C,Z=((n=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:n.live)===!0,F=this.hls.config.abrBandWidthUpFactor;let ee=Number.POSITIVE_INFINITY,J;for(J=y-1;J>v;J--){const ce=U[J].maxBitrate,de=!U[J].details||Z;if(ee=this.getTimeToLoadFrag(se,X,p*ce,de),ee<Math.min(k,p+se))break}if(ee>=re||ee>p*10)return;P?this.bwEstimator.sample(m-Math.min(L,M),h.loaded):this.bwEstimator.sampleTTFB(m);const D=U[J].maxBitrate;this.getBwEstimate()*F>D&&this.resetEstimator(D);const j=this.findBestLevel(D,v,J,0,k,1,1);j>-1&&(J=j),this.warn(`Fragment ${i.sn}${r?" part "+r.index:""} of level ${y} is loading too slowly;
      Fragment duration: ${i.duration.toFixed(3)}
      Time to underbuffer: ${k.toFixed(3)} s
      Estimated load time for current fragment: ${re.toFixed(3)} s
      Estimated load time for down switch fragment: ${ee.toFixed(3)} s
      TTFB estimate: ${M|0} ms
      Current BW estimate: ${pe(C)?C|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${J} @ ${D|0} bps`),o.nextLoadLevel=o.nextAutoLevel=J,this.clearTimer();const ie=()=>{if(this.clearTimer(),this.fragCurrent===i&&this.hls.loadLevel===J&&J>0){const ce=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${J>0?"and switching down":""}
      Fragment duration: ${i.duration.toFixed(3)} s
      Time to underbuffer: ${ce.toFixed(3)} s`),i.abortRequests(),this.fragCurrent=this.partCurrent=null,J>v){let de=this.findBestLevel(this.hls.levels[v].bitrate,v,J,0,ce,1,1);de===-1&&(de=v),this.hls.nextLoadLevel=this.hls.nextAutoLevel=de,this.resetEstimator(this.hls.levels[de].bitrate)}}};x||re>ee*2?ie():this.timer=self.setInterval(ie,ee*1e3),o.trigger(R.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,part:r,stats:h})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new IU(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.FRAG_LOADING,this.onFragLoading,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this),e.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.FRAG_LOADING,this.onFragLoading,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this),e.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(R.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var i;this.fragCurrent=n,this.partCurrent=(i=t.part)!=null?i:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case H.BUFFER_ADD_CODEC_ERROR:case H.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case H.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:i,partCurrent:r}=this;if(n&&i&&n.sn===i.sn&&n.level===i.level){const o=performance.now(),l=r?r.stats:n.stats,u=o-l.loading.start,d=l.loading.first?l.loading.first-l.loading.start:-1;if(l.loaded&&d>-1){const p=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(u-Math.min(p,d),l.loaded)}else this.bwEstimator.sampleTTFB(u)}break}}}getTimeToLoadFrag(e,t,n,i){const r=e+n/t,o=i?e+this.lastLevelLoadSec:0;return r+o}onLevelLoaded(e,t){const n=this.hls.config,{loading:i}=t.stats,r=i.end-i.first;pe(r)&&(this.lastLevelLoadSec=r/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:n}){const i=n?n.stats:t.stats;if(t.type===ye.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const r=n?n.duration:t.duration,o=this.hls.levels[t.level],l=(o.loaded?o.loaded.bytes:0)+i.loaded,u=(o.loaded?o.loaded.duration:0)+r;o.loaded={bytes:l,duration:u},o.realBitrate=Math.round(8*l/u)}if(t.bitrateTest){const r={stats:i,frag:t,part:n,id:t.type};this.onFragBuffered(R.FRAG_BUFFERED,r),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:i}=t,r=i!=null&&i.stats.loaded?i.stats:n.stats;if(r.aborted||this.ignoreFragment(n))return;const o=r.parsing.end-r.loading.start-Math.min(r.loading.first-r.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,r.loaded),r.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ye.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,r=this.findBestLevel(n,t,e,0,i,1,1);if(r>-1)return r;const o=this.hls.firstLevel,l=Math.min(Math.max(o,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${l}`),l}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),i=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!i||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const r=n&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,r)&&o[e].loadError<=o[r].loadError)return e}return this._nextAutoLevel=r,this.nextAutoLevelKey=this.getAutoLevelKey(),r}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:i,config:r,minAutoLevel:o}=n,l=t?t.duration:e?e.duration:0,u=this.getBwEstimate(),d=this.getStarvationDelay();let h=r.abrBandWidthFactor,p=r.abrBandWidthUpFactor;if(d){const x=this.findBestLevel(u,o,i,d,0,h,p);if(x>=0)return this.rebufferNotice=-1,x}let m=l?Math.min(l,r.maxStarvationDelay):r.maxStarvationDelay;if(!d){const x=this.bitrateTestDelay;x&&(m=(l?Math.min(l,r.maxLoadingDelay):r.maxLoadingDelay)-x,this.info(`bitrate test took ${Math.round(1e3*x)}ms, set first fragment max fetchDuration to ${Math.round(1e3*m)} ms`),h=p=1)}const v=this.findBestLevel(u,o,i,d,m,h,p);if(this.rebufferNotice!==v&&(this.rebufferNotice=v,this.info(`${d?"rebuffering expected":"buffer is empty"}, optimal quality level ${v}`)),v>-1)return v;const y=n.levels[o],S=n.loadLevelObj;return S&&(y==null?void 0:y.bitrate)<S.bitrate?o:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,i,r,o,l){var u;const d=i+r,h=this.lastLoadedFragLevel,p=h===-1?this.hls.firstLevel:h,{fragCurrent:m,partCurrent:v}=this,{levels:y,allAudioTracks:S,loadLevel:x,config:b}=this.hls;if(y.length===1)return 0;const w=y[p],L=!!((u=this.hls.latestLevelDetails)!=null&&u.live),I=x===-1||h===-1;let k,M="SDR",P=(w==null?void 0:w.frameRate)||0;const{audioPreference:C,videoPreference:U}=b,O=this.audioTracksByGroup||(this.audioTracksByGroup=xw(S));let W=-1;if(I){if(this.firstSelection!==-1)return this.firstSelection;const X=this.codecTiers||(this.codecTiers=x$(y,O,t,n)),Z=v$(X,M,e,C,U),{codecSet:F,videoRanges:ee,minFramerate:J,minBitrate:D,minIndex:j,preferHDR:ie}=Z;W=j,k=F,M=ie?ee[ee.length-1]:ee[0],P=J,e=Math.max(e,D),this.log(`picked start tier ${it(Z)}`)}else k=w==null?void 0:w.codecSet,M=w==null?void 0:w.videoRange;const ne=v?v.duration:m?m.duration:0,oe=this.bwEstimator.getEstimateTTFB()/1e3,se=[];for(let X=n;X>=t;X--){var re;const Z=y[X],F=X>p;if(!Z)continue;if(b.useMediaCapabilities&&!Z.supportedResult&&!Z.supportedPromise){const de=navigator.mediaCapabilities;typeof(de==null?void 0:de.decodingInfo)=="function"&&l$(Z,O,M,P,e,C)?(Z.supportedPromise=yw(Z,O,de,this.supportedCache),Z.supportedPromise.then(fe=>{if(!this.hls)return;Z.supportedResult=fe;const ve=this.hls.levels,Ie=ve.indexOf(Z);fe.error?this.warn(`MediaCapabilities decodingInfo error: "${fe.error}" for level ${Ie} ${it(fe)}`):fe.supported?fe.decodingInfoResults.some(Me=>Me.smooth===!1||Me.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Ie} not smooth or powerEfficient: ${it(fe)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Ie} ${it(fe)}`),Ie>-1&&ve.length>1&&(this.log(`Removing unsupported level ${Ie}`),this.hls.removeLevel(Ie),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(fe=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${fe}`)})):Z.supportedResult=mw}if((k&&Z.codecSet!==k||M&&Z.videoRange!==M||F&&P>Z.frameRate||!F&&P>0&&P<Z.frameRate||(re=Z.supportedResult)!=null&&(re=re.decodingInfoResults)!=null&&re.some(de=>de.smooth===!1))&&(!I||X!==W)){se.push(X);continue}const ee=Z.details,J=(v?ee==null?void 0:ee.partTarget:ee==null?void 0:ee.averagetargetduration)||ne;let D;F?D=l*e:D=o*e;const j=ne&&i>=ne*2&&r===0?Z.averageBitrate:Z.maxBitrate,ie=this.getTimeToLoadFrag(oe,D,j*J,ee===void 0);if(D>=j&&(X===h||Z.loadError===0&&Z.fragmentError===0)&&(ie<=oe||!pe(ie)||L&&!this.bitrateTestDelay||ie<d)){const de=this.forcedAutoLevel;return X!==x&&(de===-1||de!==x)&&(se.length&&this.trace(`Skipped level(s) ${se.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${y[se[0]].codecs}" ${y[se[0]].videoRange}; not compatible with "${k}" ${M}`),this.info(`switch candidate:${p}->${X} adjustedbw(${Math.round(D)})-bitrate=${Math.round(D-j)} ttfb:${oe.toFixed(1)} avgDuration:${J.toFixed(1)} maxFetchDuration:${d.toFixed(1)} fetchDuration:${ie.toFixed(1)} firstSelection:${I} codecSet:${Z.codecSet} videoRange:${Z.videoRange} hls.loadLevel:${x}`)),I&&(this.firstSelection=X),X}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),t)}}const Sw={search:function(s,e){let t=0,n=s.length-1,i=null,r=null;for(;t<=n;){i=(t+n)/2|0,r=s[i];const o=e(r);if(o>0)t=i+1;else if(o<0)n=i-1;else return r}return null}};function A$(s,e,t){if(e===null||!Array.isArray(s)||!s.length||!pe(e))return null;const n=s[0].programDateTime;if(e<(n||0))return null;const i=s[s.length-1].endProgramDateTime;if(e>=(i||0))return null;for(let r=0;r<s.length;++r){const o=s[r];if(R$(e,t,o))return o}return null}function kr(s,e,t=0,n=0,i=.005){let r=null;if(s){r=e[1+s.sn-e[0].sn]||null;const l=s.endDTS-t;l>0&&l<15e-7&&(t+=15e-7),r&&s.level!==r.level&&r.end<=s.end&&(r=e[2+s.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(r=e[0]);if(r&&((!s||s.level===r.level)&&ME(t,n,r)===0||w$(r,s,Math.min(i,n))))return r;const o=Sw.search(e,ME.bind(null,t,n));return o&&(o!==s||!r)?o:r}function w$(s,e,t){if(e&&e.start===0&&e.level<s.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((i,r)=>(r[0]==="INF"&&(i+=parseFloat(r[1])),i),t);return s.start<=n}return!1}function ME(s=0,e=0,t){if(t.start<=s&&t.start+t.duration>s)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=s?1:t.start-n>s&&t.start?-1:0}function R$(s,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>s}function Ew(s,e,t){if(s&&s.startCC<=e&&s.endCC>=e){let n=s.fragments;const{fragmentHint:i}=s;i&&(n=n.concat(i));let r;return Sw.search(n,o=>o.cc<e?1:o.cc>e?-1:(r=o,o.end<=t?1:o.start>t?-1:0)),r||null}return null}function Zu(s){switch(s.details){case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_TIMEOUT:case H.LEVEL_LOAD_TIMEOUT:case H.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Tw(s){return s.details.startsWith("key")}function bw(s){return Tw(s)&&!!s.frag&&!s.frag.decryptdata}function FE(s,e){const t=Zu(e);return s.default[`${t?"timeout":"error"}Retry`]}function Ug(s,e){const t=s.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*s.retryDelayMs,s.maxRetryDelayMs)}function BE(s){return Ze(Ze({},s),{errorRetry:null,timeoutRetry:null})}function ed(s,e,t,n){if(!s)return!1;const i=n==null?void 0:n.code,r=e<s.maxNumRetry&&(L$(i)||!!t);return s.shouldRetry?s.shouldRetry(s,e,t,n,r):r}function L$(s){return xm(s)||!!s&&(s<400||s>499)}function xm(s){return s===0&&navigator.onLine===!1}var Kt={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},_n={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class I$ extends Wn{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(R.ERROR,this.onError,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(R.ERROR,this.onError,this),e.off(R.ERROR,this.onErrorOut,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===ye.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,n=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||n===-1?t.loadLevel:n}variantHasKey(e,t){if(e){var n;if((n=e.details)!=null&&n.hasKey(t))return!0;const i=e.audioGroups;if(i)return this.hls.allAudioTracks.filter(o=>i.indexOf(o.groupId)>=0).some(o=>{var l;return(l=o.details)==null?void 0:l.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const i=this.hls,r=t.context;switch(t.details){case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case H.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction=Eo();return}case H.FRAG_GAP:case H.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Kt.SendAlternateToPenaltyBox;return}case H.LEVEL_EMPTY_ERROR:case H.LEVEL_PARSING_ERROR:{var o;const u=t.parent===ye.MAIN?t.level:i.loadLevel;t.details===H.LEVEL_EMPTY_ERROR&&((o=t.context)!=null&&(o=o.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case H.LEVEL_LOAD_ERROR:case H.LEVEL_LOAD_TIMEOUT:typeof(r==null?void 0:r.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.level));return;case H.AUDIO_TRACK_LOAD_ERROR:case H.AUDIO_TRACK_LOAD_TIMEOUT:case H.SUBTITLE_LOAD_ERROR:case H.SUBTITLE_TRACK_LOAD_TIMEOUT:if(r){const u=i.loadLevelObj;if(u&&(r.type===Ge.AUDIO_TRACK&&u.hasAudioGroup(r.groupId)||r.type===Ge.SUBTITLE_TRACK&&u.hasSubtitleGroup(r.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=Kt.SendAlternateToPenaltyBox,t.errorAction.flags=_n.MoveAllAlternatesMatchingHost;return}}return;case H.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:Kt.SendAlternateToPenaltyBox,flags:_n.MoveAllAlternatesMatchingHDCP};return;case H.KEY_SYSTEM_SESSION_UPDATE_FAILED:case H.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case H.KEY_SYSTEM_NO_SESSION:t.errorAction={action:Kt.SendAlternateToPenaltyBox,flags:_n.MoveAllAlternatesMatchingKey};return;case H.BUFFER_ADD_CODEC_ERROR:case H.REMUX_ALLOC_ERROR:case H.BUFFER_APPEND_ERROR:if(!t.errorAction){var l;t.errorAction=this.getLevelSwitchAction(t,(l=t.level)!=null?l:i.loadLevel)}return;case H.INTERNAL_EXCEPTION:case H.BUFFER_APPENDING_ERROR:case H.BUFFER_FULL_ERROR:case H.LEVEL_SWITCH_ERROR:case H.BUFFER_STALLED_ERROR:case H.BUFFER_SEEK_OVER_HOLE:case H.BUFFER_NUDGE_ON_STALL:t.errorAction=Eo();return}t.type===Re.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=Eo())}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,i=FE(n.config.playlistLoadPolicy,e),r=this.playlistError++;if(ed(i,r,Zu(e),e.response))return{action:Kt.RetryRequest,flags:_n.None,retryConfig:i,retryCount:r};const l=this.getLevelSwitchAction(e,t);return i&&(l.retryConfig=i,l.retryCount=r),l}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),i=t.levels[n],{fragLoadPolicy:r,keyLoadPolicy:o}=t.config,l=FE(Tw(e)?o:r,e),u=t.levels.reduce((h,p)=>h+p.fragmentError,0);if(i&&(e.details!==H.FRAG_GAP&&i.fragmentError++,!bw(e)&&ed(l,u,Zu(e),e.response)))return{action:Kt.RetryRequest,flags:_n.None,retryConfig:l,retryCount:u};const d=this.getLevelSwitchAction(e,n);return l&&(d.retryConfig=l,d.retryCount=u),d}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const i=this.hls.levels[t];if(i){var r,o;const d=e.details;i.loadError++,d===H.BUFFER_APPEND_ERROR&&i.fragmentError++;let h=-1;const{levels:p,loadLevel:m,minAutoLevel:v,maxAutoLevel:y}=n;!n.autoLevelEnabled&&!n.config.preserveManualLevelOnError&&(n.loadLevel=-1);const S=(r=e.frag)==null?void 0:r.type,b=(S===ye.AUDIO&&d===H.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(d===H.BUFFER_ADD_CODEC_ERROR||d===H.BUFFER_APPEND_ERROR))&&p.some(({audioCodec:M})=>i.audioCodec!==M),L=e.sourceBufferName==="video"&&(d===H.BUFFER_ADD_CODEC_ERROR||d===H.BUFFER_APPEND_ERROR)&&p.some(({codecSet:M,audioCodec:P})=>i.codecSet!==M&&i.audioCodec===P),{type:I,groupId:k}=(o=e.context)!=null?o:{};for(let M=p.length;M--;){const P=(M+m)%p.length;if(P!==m&&P>=v&&P<=y&&p[P].loadError===0){var l,u;const C=p[P];if(d===H.FRAG_GAP&&S===ye.MAIN&&e.frag){const U=p[P].details;if(U){const O=kr(e.frag,U.fragments,e.frag.start);if(O!=null&&O.gap)continue}}else{if(I===Ge.AUDIO_TRACK&&C.hasAudioGroup(k)||I===Ge.SUBTITLE_TRACK&&C.hasSubtitleGroup(k))continue;if(S===ye.AUDIO&&(l=i.audioGroups)!=null&&l.some(U=>C.hasAudioGroup(U))||S===ye.SUBTITLE&&(u=i.subtitleGroups)!=null&&u.some(U=>C.hasSubtitleGroup(U))||b&&i.audioCodec===C.audioCodec||L&&i.codecSet===C.codecSet||!b&&i.codecSet!==C.codecSet)continue}h=P;break}}if(h>-1&&n.loadLevel!==h)return e.levelRetry=!0,this.playlistError=0,{action:Kt.SendAlternateToPenaltyBox,flags:_n.None,nextAutoLevel:h}}return{action:Kt.SendAlternateToPenaltyBox,flags:_n.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case Kt.DoNothing:break;case Kt.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==H.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:i}=n,r=n.nextAutoLevel;switch(i){case _n.None:this.switchLevel(e,r);break;case _n.MoveAllAlternatesMatchingHDCP:{const u=this.getVariantLevelIndex(e.frag),d=t.levels[u],h=d==null?void 0:d.attrs["HDCP-LEVEL"];if(n.hdcpLevel=h,h==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(h){t.maxHdcpLevel=vm[vm.indexOf(h)-1],n.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case _n.MoveAllAlternatesMatchingKey:{const u=e.decryptdata;if(u){const d=this.hls.levels,h=d.length;for(let m=h;m--;)if(this.variantHasKey(d[m],u)){var o,l;this.log(`Banned key found in level ${m} (${d[m].bitrate}bps) or audio group "${(o=d[m].audioGroups)==null?void 0:o.join(",")}" (${(l=e.frag)==null?void 0:l.type} fragment) ${Ht(u.keyId||[])}`),d[m].fragmentError++,d[m].loadError++,this.log(`Removing level ${m} with key error (${e.error})`),this.hls.removeLevel(m)}const p=e.frag;if(this.hls.levels.length<h)n.resolved=!0;else if(p&&p.type!==ye.MAIN){const m=p.decryptdata;m&&!u.matches(m)&&(n.resolved=!0)}}break}}n.resolved||this.switchLevel(e,r)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===H.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const n=ym(e.mimeType),i=this.hls.levels;for(let r=i.length;r--;)i[r][`${e.sourceBufferName}Codec`]===n&&(this.log(`Removing level ${r} for ${e.details} ("${n}" not supported)`),this.hls.removeLevel(r))}}}function Eo(s){const e={action:Kt.DoNothing,flags:_n.None};return s&&(e.resolved=!0),e}var Pt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class _${constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.BUFFER_APPENDED,this.onBufferAppended,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.BUFFER_APPENDED,this.onBufferAppended,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let i=n.length;i--;){const r=n[i];if(!r)break;if(r.start<=e&&e<=r.end&&r.loaded)return r}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,n){const{fragments:i}=this,r=Object.keys(i);for(let o=r.length;o--;){const l=i[r[o]];if((l==null?void 0:l.body.type)===t&&(!n||l.buffered)){const u=l.body;if(u.start<=e&&e<=u.end)return u}}return null}detectEvictedFragments(e,t,n,i,r){this.timeRanges&&(this.timeRanges[e]=t);const o=(i==null?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(l=>{const u=this.fragments[l];if(!u||o>=u.body.sn)return;if(!u.buffered&&(!u.loaded||r)){u.body.type===n&&this.removeFragment(u.body);return}const d=u.range[e];if(d){if(d.time.length===0){this.removeFragment(u.body);return}d.time.some(h=>{const p=!this.isTimeBuffered(h.startPTS,h.endPTS,t);return p&&this.removeFragment(u.body),p})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const n=e.frag,i=lo(n),r=this.fragments[i];if(!r||r.buffered&&n.gap)return;const o=!n.relurl;Object.keys(t).forEach(l=>{const u=n.elementaryStreams[l];if(!u)return;const d=t[l],h=o||u.partial===!0;r.range[l]=this.getBufferedTimes(n,e.part,h,d)}),r.loaded=null,Object.keys(r.range).length?(this.bufferedEnd(r,n),iu(r)||this.removeParts(n.sn-1,n.type)):this.removeFragment(r.body)}bufferedEnd(e,t){e.buffered=!0,(e.body.endList=t.endList||e.body.endList)&&(this.endListFragments[e.body.type]=e)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=UE(n,i=>i.fragment.sn>=e))}fragBuffered(e,t){const n=lo(e);let i=this.fragments[n];!i&&t&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,this.bufferedEnd(i,e))}getBufferedTimes(e,t,n,i){const r={time:[],partial:n},o=e.start,l=e.end,u=e.minEndPTS||l,d=e.maxStartPTS||o;for(let h=0;h<i.length;h++){const p=i.start(h)-this.bufferPadding,m=i.end(h)+this.bufferPadding;if(d>=p&&u<=m){r.time.push({startPTS:Math.max(o,i.start(h)),endPTS:Math.min(l,i.end(h))});break}else if(o<m&&l>p){const v=Math.max(o,i.start(h)),y=Math.min(l,i.end(h));y>v&&(r.partial=!0,r.time.push({startPTS:v,endPTS:y}))}else if(l<=p)break}return r}getPartialFragment(e){let t=null,n,i,r,o=0;const{bufferPadding:l,fragments:u}=this;return Object.keys(u).forEach(d=>{const h=u[d];h&&iu(h)&&(i=h.body.start-l,r=h.body.end+l,e>=i&&e<=r&&(n=Math.min(e-i,r-e),o<=n&&(t=h.body,o=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||iu(t))}getState(e){const t=lo(e),n=this.fragments[t];return n?n.buffered?iu(n)?Pt.PARTIAL:Pt.OK:Pt.APPENDING:Pt.NOT_LOADED}isTimeBuffered(e,t,n){let i,r;for(let o=0;o<n.length;o++){if(i=n.start(o)-this.bufferPadding,r=n.end(o)+this.bufferPadding,e>=i&&t<=r)return!0;if(t<=i)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const n=t.frag,i=t.part?null:t,r=lo(n);this.fragments[r]={body:n,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:i,timeRanges:r,type:o}=t;if(n.sn==="initSegment")return;const l=n.type;if(i){let d=this.activePartLists[l];d||(this.activePartLists[l]=d=[]),d.push(i)}this.timeRanges=r;const u=r[o];this.detectEvictedFragments(o,u,l,i)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=lo(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,n=Object.keys(t);if(!e)return n.length>0;for(let i=n.length;i--;){const r=t[n[i]];if((r==null?void 0:r.body.type)===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,i,r){i&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const l=this.fragments[o];if(!l)return;const u=l.body;u.type!==n||i&&!u.gap||u.start<t&&u.end>e&&(l.buffered||r)&&this.removeFragment(u)})}removeFragment(e){const t=lo(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const i=e.sn;this.activePartLists[e.type]=UE(n,r=>r.fragment.sn!==i)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(n=>n.clearElementaryStreamInfo())}}function iu(s){var e,t,n;return s.buffered&&!!(s.body.gap||(e=s.range.video)!=null&&e.partial||(t=s.range.audio)!=null&&t.partial||(n=s.range.audiovideo)!=null&&n.partial)}function lo(s){return`${s.type}_${s.level}_${s.sn}`}function UE(s,e){return s.filter(t=>{const n=e(t);return n||t.clearElementaryStreamInfo(),n})}var Vi={cbc:0,ctr:1};class k${constructor(e,t,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=n}decrypt(e,t){switch(this.aesMode){case Vi.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Vi.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function C$(s){const e=s.byteLength,t=e&&new DataView(s.buffer).getUint8(e-1);return t?s.slice(0,e-t):s}class P${constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=t.getUint32(i*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,i=n[0],r=n[1],o=n[2],l=n[3],u=this.invSubMix,d=u[0],h=u[1],p=u[2],m=u[3],v=new Uint32Array(256);let y=0,S=0,x=0;for(x=0;x<256;x++)x<128?v[x]=x<<1:v[x]=x<<1^283;for(x=0;x<256;x++){let b=S^S<<1^S<<2^S<<3^S<<4;b=b>>>8^b&255^99,e[y]=b,t[b]=y;const w=v[y],L=v[w],I=v[L];let k=v[b]*257^b*16843008;i[y]=k<<24|k>>>8,r[y]=k<<16|k>>>16,o[y]=k<<8|k>>>24,l[y]=k,k=I*16843009^L*65537^w*257^y*16843008,d[b]=k<<24|k>>>8,h[b]=k<<16|k>>>16,p[b]=k<<8|k>>>24,m[b]=k,y?(y=w^v[v[v[I^w]]],S^=v[v[S]]):y=S=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<t.length&&n;)n=t[i]===this.key[i],i++;if(n)return;this.key=t;const r=this.keySize=t.length;if(r!==4&&r!==6&&r!==8)throw new Error("Invalid aes key size="+r);const o=this.ksRows=(r+6+1)*4;let l,u;const d=this.keySchedule=new Uint32Array(o),h=this.invKeySchedule=new Uint32Array(o),p=this.sBox,m=this.rcon,v=this.invSubMix,y=v[0],S=v[1],x=v[2],b=v[3];let w,L;for(l=0;l<o;l++){if(l<r){w=d[l]=t[l];continue}L=w,l%r===0?(L=L<<8|L>>>24,L=p[L>>>24]<<24|p[L>>>16&255]<<16|p[L>>>8&255]<<8|p[L&255],L^=m[l/r|0]<<24):r>6&&l%r===4&&(L=p[L>>>24]<<24|p[L>>>16&255]<<16|p[L>>>8&255]<<8|p[L&255]),d[l]=w=(d[l-r]^L)>>>0}for(u=0;u<o;u++)l=o-u,u&3?L=d[l]:L=d[l-4],u<4||l<=4?h[u]=L:h[u]=y[p[L>>>24]]^S[p[L>>>16&255]]^x[p[L>>>8&255]]^b[p[L&255]],h[u]=h[u]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const i=this.keySize+6,r=this.invKeySchedule,o=this.invSBox,l=this.invSubMix,u=l[0],d=l[1],h=l[2],p=l[3],m=this.uint8ArrayToUint32Array_(n);let v=m[0],y=m[1],S=m[2],x=m[3];const b=new Int32Array(e),w=new Int32Array(b.length);let L,I,k,M,P,C,U,O,W,ne,oe,se,re,X;const Z=this.networkToHostOrderSwap;for(;t<b.length;){for(W=Z(b[t]),ne=Z(b[t+1]),oe=Z(b[t+2]),se=Z(b[t+3]),P=W^r[0],C=se^r[1],U=oe^r[2],O=ne^r[3],re=4,X=1;X<i;X++)L=u[P>>>24]^d[C>>16&255]^h[U>>8&255]^p[O&255]^r[re],I=u[C>>>24]^d[U>>16&255]^h[O>>8&255]^p[P&255]^r[re+1],k=u[U>>>24]^d[O>>16&255]^h[P>>8&255]^p[C&255]^r[re+2],M=u[O>>>24]^d[P>>16&255]^h[C>>8&255]^p[U&255]^r[re+3],P=L,C=I,U=k,O=M,re=re+4;L=o[P>>>24]<<24^o[C>>16&255]<<16^o[U>>8&255]<<8^o[O&255]^r[re],I=o[C>>>24]<<24^o[U>>16&255]<<16^o[O>>8&255]<<8^o[P&255]^r[re+1],k=o[U>>>24]<<24^o[O>>16&255]<<16^o[P>>8&255]<<8^o[C&255]^r[re+2],M=o[O>>>24]<<24^o[P>>16&255]<<16^o[C>>8&255]<<8^o[U&255]^r[re+3],w[t]=Z(L^v),w[t+1]=Z(M^y),w[t+2]=Z(k^S),w[t+3]=Z(I^x),v=W,y=ne,S=oe,x=se,t=t+4}return w.buffer}}class D${constructor(e,t,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=n}expandKey(){const e=O$(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function O$(s){switch(s){case Vi.cbc:return"AES-CBC";case Vi.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${s}`)}}const N$=16;class $g{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?C$(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n,i){return this.useSoftware?new Promise((r,o)=>{const l=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(l,t,n,i);const u=this.flush();u?r(u.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n,i)}softwareDecrypt(e,t,n,i){const{currentIV:r,currentResult:o,remainderData:l}=this;if(i!==Vi.cbc||t.byteLength!==16)return et.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),l&&(e=zn(l,e),this.remainderData=null);const u=this.getValidChunk(e);if(!u.length)return null;r&&(n=r);let d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new P$),d.expandKey(t);const h=o;return this.currentResult=d.decrypt(u.buffer,0,n),this.currentIV=u.slice(-16).buffer,h||null}webCryptoDecrypt(e,t,n,i){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n,i));this.key=t,this.fastAesKey=new D$(this.subtle,t,i)}return this.fastAesKey.expandKey().then(r=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new k$(this.subtle,new Uint8Array(n),i).decrypt(e.buffer,r)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(et.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n,i)))}onWebCryptoError(e,t,n,i){const r=this.enableSoftwareAES;if(r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n,i);const o=this.flush();if(o)return o.buffer}throw new Error("WebCrypto"+(r?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%N$;return n!==e.length&&(t=e.slice(0,n),this.remainderData=e.slice(n)),t}logOnce(e){this.logEnabled&&(et.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const $E=Math.pow(2,17);class M${constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new Ks({type:Re.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const i=this.config,r=i.fLoader,o=i.loader;return new Promise((l,u)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(y=>y[0]==="GAP")){u(VE(e));return}else e.gap=!1;const d=this.loader=r?new r(i):new o(i),h=jE(e);e.loader=d;const p=BE(i.fragLoadPolicy.default),m={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:$E};e.stats=d.stats;const v={onSuccess:(y,S,x,b)=>{this.resetLoader(e,d);let w=y.data;x.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(w.slice(0,16)),w=w.slice(16)),l({frag:e,part:null,payload:w,networkDetails:b})},onError:(y,S,x,b)=>{this.resetLoader(e,d),u(new Ks({type:Re.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Ze({url:n,data:void 0},y),error:new Error(`HTTP Error ${y.code} ${y.text}`),networkDetails:x,stats:b}))},onAbort:(y,S,x)=>{this.resetLoader(e,d),u(new Ks({type:Re.NETWORK_ERROR,details:H.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:x,stats:y}))},onTimeout:(y,S,x)=>{this.resetLoader(e,d),u(new Ks({type:Re.NETWORK_ERROR,details:H.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${m.timeout}ms`),networkDetails:x,stats:y}))}};t&&(v.onProgress=(y,S,x,b)=>t({frag:e,part:null,payload:x,networkDetails:b})),d.load(h,m,v)})}loadPart(e,t,n){this.abort();const i=this.config,r=i.fLoader,o=i.loader;return new Promise((l,u)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){u(VE(e,t));return}const d=this.loader=r?new r(i):new o(i),h=jE(e,t);e.loader=d;const p=BE(i.fragLoadPolicy.default),m={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:$E};t.stats=d.stats,d.load(h,m,{onSuccess:(v,y,S,x)=>{this.resetLoader(e,d),this.updateStatsFromPart(e,t);const b={frag:e,part:t,payload:v.data,networkDetails:x};n(b),l(b)},onError:(v,y,S,x)=>{this.resetLoader(e,d),u(new Ks({type:Re.NETWORK_ERROR,details:H.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Ze({url:h.url,data:void 0},v),error:new Error(`HTTP Error ${v.code} ${v.text}`),networkDetails:S,stats:x}))},onAbort:(v,y,S)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,d),u(new Ks({type:Re.NETWORK_ERROR,details:H.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:S,stats:v}))},onTimeout:(v,y,S)=>{this.resetLoader(e,d),u(new Ks({type:Re.NETWORK_ERROR,details:H.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${m.timeout}ms`),networkDetails:S,stats:v}))}})})}updateStatsFromPart(e,t){const n=e.stats,i=t.stats,r=i.total;if(n.loaded+=i.loaded,r){const u=Math.round(e.duration/t.duration),d=Math.min(Math.round(n.loaded/r),u),p=(u-d)*Math.round(n.loaded/d);n.total=n.loaded+p}else n.total=Math.max(n.loaded,n.total);const o=n.loading,l=i.loading;o.start?o.first+=l.first-l.start:(o.start=l.start,o.first=l.first),o.end=l.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function jE(s,e=null){const t=e||s,n={frag:s,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},i=t.byteRangeStartOffset,r=t.byteRangeEndOffset;if(pe(i)&&pe(r)){var o;let l=i,u=r;if(s.sn==="initSegment"&&F$((o=s.decryptdata)==null?void 0:o.method)){const d=r-i;d%16&&(u=r+(16-d%16)),i!==0&&(n.resetIV=!0,l=i-16)}n.rangeStart=l,n.rangeEnd=u}return n}function VE(s,e){const t=new Error(`GAP ${s.gap?"tag":"attribute"} found`),n={type:Re.MEDIA_ERROR,details:H.FRAG_GAP,fatal:!1,frag:s,error:t,networkDetails:null};return e&&(n.part=e),(e||s).stats.aborted=!0,new Ks(n)}function F$(s){return s==="AES-128"||s==="AES-256"}class Ks extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class Aw extends Wn{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class jg{constructor(e,t,n,i=0,r=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=ru(),this.buffering={audio:ru(),video:ru(),audiovideo:ru()},this.level=e,this.sn=t,this.id=n,this.size=i,this.part=r,this.partial=o}}function ru(){return{start:0,executeStart:0,executeEnd:0,end:0}}const GE={length:0,start:()=>0,end:()=>0};class Fe{static isBuffered(e,t){if(e){const n=Fe.getBuffered(e);for(let i=n.length;i--;)if(t>=n.start(i)&&t<=n.end(i))return!0}return!1}static bufferedRanges(e){if(e){const t=Fe.getBuffered(e);return Fe.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}static bufferInfo(e,t,n){if(e){const i=Fe.bufferedRanges(e);if(i.length)return Fe.bufferedInfo(i,t,n)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.length>1&&e.sort((h,p)=>h.start-p.start||p.end-h.end);let i=-1,r=[];if(n)for(let h=0;h<e.length;h++){t>=e[h].start&&t<=e[h].end&&(i=h);const p=r.length;if(p){const m=r[p-1].end;e[h].start-m<n?e[h].end>m&&(r[p-1].end=e[h].end):r.push(e[h])}else r.push(e[h])}else r=e;let o=0,l,u=t,d=t;for(let h=0;h<r.length;h++){const p=r[h].start,m=r[h].end;if(i===-1&&t>=p&&t<=m&&(i=h),t+n>=p&&t<m)u=p,d=m,o=d-t;else if(t+n<p){l=p;break}}return{len:o,start:u||0,end:d||0,nextStart:l,buffered:e,bufferedIndex:i}}static getBuffered(e){try{return e.buffered||GE}catch(t){return et.log("failed to get media.buffered",t),GE}}}const ww=/\{\$([a-zA-Z0-9-_]+)\}/g;function KE(s){return ww.test(s)}function Sm(s,e){if(s.variableList!==null||s.hasVariableRefs){const t=s.variableList;return e.replace(ww,n=>{const i=n.substring(2,n.length-1),r=t==null?void 0:t[i];return r===void 0?(s.playlistParsingError||(s.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),n):r})}return e}function HE(s,e,t){let n=s.variableList;n||(s.variableList=n={});let i,r;if("QUERYPARAM"in e){i=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(i))r=o.get(i);else throw new Error(`"${i}" does not match any query parameter in URI: "${t}"`)}catch(o){s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else i=e.NAME,r=e.VALUE;i in n?s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):n[i]=r||""}function B$(s,e,t){const n=e.IMPORT;if(t&&n in t){let i=s.variableList;i||(s.variableList=i={}),i[n]=t[n]}else s.playlistParsingError||(s.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}const U$=/^(\d+)x(\d+)$/,zE=/(.+?)=(".*?"|.*?)(?:,|$)/g;class ht{constructor(e,t){typeof e=="string"&&(e=ht.parseAttrList(e,t)),tt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let i=0;i<t.length/2;i++)n[i]=parseInt(t.slice(i*2,i*2+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce((i,r)=>(i[r.toLowerCase()]=!0,i),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=U$.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let n;const i={};for(zE.lastIndex=0;(n=zE.exec(e))!==null;){const o=n[1].trim();let l=n[2];const u=l.indexOf('"')===0&&l.lastIndexOf('"')===l.length-1;let d=!1;if(u)l=l.slice(1,-1);else switch(o){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":d=!0}if(t&&(u||d))l=Sm(t,l);else if(!d&&!u)switch(o){case"CLOSED-CAPTIONS":if(l==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":et.warn(`${e}: attribute ${o} is missing quotes`)}i[o]=l}return i}}const $$="com.apple.hls.interstitial";function j$(s){return s!=="ID"&&s!=="CLASS"&&s!=="CUE"&&s!=="START-DATE"&&s!=="DURATION"&&s!=="END-DATE"&&s!=="END-ON-NEXT"}function V$(s){return s==="SCTE35-OUT"||s==="SCTE35-IN"||s==="SCTE35-CMD"}class Rw{constructor(e,t,n=0){var i;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(i=t==null?void 0:t.tagOrder)!=null?i:n,t){const r=t.attr;for(const o in r)if(Object.prototype.hasOwnProperty.call(e,o)&&e[o]!==r[o]){et.warn(`DATERANGE tag attribute: "${o}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=o;break}e=tt(new ht({}),r,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const r=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);pe(r.getTime())&&(this._endDate=r)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(et.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(pe(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===$$}get isValid(){return!!this.id&&!this._badValueForSameId&&pe(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const G$=10;class K${constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let n=t.decryptdata;return n||(t.setKeyFormat(e.keyFormat),n=t.decryptdata),!!n&&e.matches(n)})}get hasProgramDateTime(){return this.fragments.length?pe(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||G$}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let n=e.length;n--;)if(e[n].index>t)return e[n].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function td(s,e){return s.length===e.length?!s.some((t,n)=>t!==e[n]):!1}function WE(s,e){return!s&&!e?!0:!s||!e?!1:td(s,e)}function To(s){return s==="AES-128"||s==="AES-256"||s==="AES-256-CTR"}function Vg(s){switch(s){case"AES-128":case"AES-256":return Vi.cbc;case"AES-256-CTR":return Vi.ctr;default:throw new Error(`invalid full segment method ${s}`)}}function Gg(s){return Uint8Array.from(atob(s),e=>e.charCodeAt(0))}function Em(s){return Uint8Array.from(unescape(encodeURIComponent(s)),e=>e.charCodeAt(0))}function H$(s){const e=Em(s).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function Lw(s){const e=function(n,i,r){const o=n[i];n[i]=n[r],n[r]=o};e(s,0,3),e(s,1,2),e(s,4,5),e(s,6,7)}function Iw(s){const e=s.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),i=n[n.length-1].split(",");if(i.length===2){const r=i[0]==="base64",o=i[1];r?(n.splice(-1,1),t=Gg(o)):t=H$(o)}}return t}const nd=typeof self<"u"?self:void 0;var ft={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Wt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Pu(s){switch(s){case Wt.FAIRPLAY:return ft.FAIRPLAY;case Wt.PLAYREADY:return ft.PLAYREADY;case Wt.WIDEVINE:return ft.WIDEVINE;case Wt.CLEARKEY:return ft.CLEARKEY}}function Zf(s){switch(s){case ft.FAIRPLAY:return Wt.FAIRPLAY;case ft.PLAYREADY:return Wt.PLAYREADY;case ft.WIDEVINE:return Wt.WIDEVINE;case ft.CLEARKEY:return Wt.CLEARKEY}}function Qa(s){const{drmSystems:e,widevineLicenseUrl:t}=s,n=e?[ft.FAIRPLAY,ft.WIDEVINE,ft.PLAYREADY,ft.CLEARKEY].filter(i=>!!e[i]):[];return!n[ft.WIDEVINE]&&t&&n.push(ft.WIDEVINE),n}const _w=(function(s){return nd!=null&&(s=nd.navigator)!=null&&s.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function z$(s,e,t,n){let i;switch(s){case ft.FAIRPLAY:i=["cenc","sinf"];break;case ft.WIDEVINE:case ft.PLAYREADY:i=["cenc"];break;case ft.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${s}`)}return W$(i,e,t,n)}function W$(s,e,t,n){return[{initDataTypes:s,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(r=>({contentType:`audio/mp4; codecs=${r}`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(r=>({contentType:`video/mp4; codecs=${r}`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function q$(s){var e;return!!s&&(s.sessionType==="persistent-license"||!!((e=s.sessionTypes)!=null&&e.some(t=>t==="persistent-license")))}function kw(s){const e=new Uint16Array(s.buffer,s.byteOffset,s.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),n=t.substring(t.indexOf("<"),t.length),o=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(o){const l=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(l){const u=Gg(l).subarray(0,16);return Lw(u),u}}return null}let co={};class Bi{static clearKeyUriToKeyIdMap(){co={}}static setKeyIdForUri(e,t){co[e]=t}static addKeyIdForUri(e){const t=Object.keys(co).length%Number.MAX_SAFE_INTEGER,n=new Uint8Array(16);return new DataView(n.buffer,12,4).setUint32(0,t),co[e]=n,n}constructor(e,t,n,i=[1],r=null,o){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=i,this.iv=r,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!To(e),o!=null&&o.startsWith("0x")&&(this.keyId=new Uint8Array(iw(o)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&td(e.keyFormatVersions,this.keyFormatVersions)&&WE(e.iv,this.iv)&&WE(e.keyId,this.keyId)}isSupported(){if(this.method){if(To(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Wt.FAIRPLAY:case Wt.WIDEVINE:case Wt.PLAYREADY:case Wt.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,t){if(!this.encrypted||!this.uri)return null;if(To(this.method)){let r=this.iv;return r||(typeof e!="number"&&(et.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),r=Q$(e)),new Bi(this.method,this.uri,"identity",this.keyFormatVersions,r)}if(this.keyId){const r=co[this.uri];if(r&&!td(this.keyId,r)&&Bi.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const n=Iw(this.uri);if(n)switch(this.keyFormat){case Wt.WIDEVINE:if(this.pssh=n,!this.keyId){const r=ZU(n.buffer);if(r.length){var i;const o=r[0];this.keyId=(i=o.kids)!=null&&i.length?o.kids[0]:null}}this.keyId||(this.keyId=qE(t));break;case Wt.PLAYREADY:{const r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=JU(r,null,n),this.keyId=kw(n);break}default:{let r=n.subarray(0,16);if(r.length!==16){const o=new Uint8Array(16);o.set(r,16-r.length),r=o}this.keyId=r;break}}if(!this.keyId||this.keyId.byteLength!==16){let r;r=Y$(t),r||(r=qE(t),r||(r=co[this.uri])),r&&(this.keyId=r,Bi.setKeyIdForUri(this.uri,r))}return this}}function Y$(s){const e=s==null?void 0:s[Wt.WIDEVINE];return e?e.keyId:null}function qE(s){const e=s==null?void 0:s[Wt.PLAYREADY];if(e){const t=Iw(e.uri);if(t)return kw(t)}return null}function Q$(s){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=s>>8*(15-t)&255;return e}const YE=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,QE=/#EXT-X-MEDIA:(.*)/g,X$=/^#EXT(?:INF|-X-TARGETDURATION):/m,ep=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),J$=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class ws{static findGroup(e,t){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===t)return i}}static resolve(e,t){return Og.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return X$.test(e)}static parseMasterPlaylist(e,t){const n=KE(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},r=[];if(YE.lastIndex=0,!e.startsWith("#EXTM3U"))return i.playlistParsingError=new Error("no EXTM3U delimiter"),i;let o;for(;(o=YE.exec(e))!=null;)if(o[1]){var l;const d=new ht(o[1],i),h=Sm(i,o[2]),p={attrs:d,bitrate:d.decimalInteger("BANDWIDTH")||d.decimalInteger("AVERAGE-BANDWIDTH"),name:d.NAME,url:ws.resolve(h,t)},m=d.decimalResolution("RESOLUTION");m&&(p.width=m.width,p.height=m.height),ZE(d.CODECS,p);const v=d["SUPPLEMENTAL-CODECS"];v&&(p.supplemental={},ZE(v,p.supplemental)),(l=p.unknownCodecs)!=null&&l.length||r.push(p),i.levels.push(p)}else if(o[3]){const d=o[3],h=o[4];switch(d){case"SESSION-DATA":{const p=new ht(h,i),m=p["DATA-ID"];m&&(i.sessionData===null&&(i.sessionData={}),i.sessionData[m]=p);break}case"SESSION-KEY":{const p=XE(h,t,i);p.encrypted&&p.isSupported()?(i.sessionKeys===null&&(i.sessionKeys=[]),i.sessionKeys.push(p)):et.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${h}"`);break}case"DEFINE":{{const p=new ht(h,i);HE(i,p,t)}break}case"CONTENT-STEERING":{const p=new ht(h,i);i.contentSteering={uri:ws.resolve(p["SERVER-URI"],t),pathwayId:p["PATHWAY-ID"]||"."};break}case"START":{i.startTimeOffset=JE(h);break}}}const u=r.length>0&&r.length<i.levels.length;return i.levels=u?r:i.levels,i.levels.length===0&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,n){let i;const r={},o=n.levels,l={AUDIO:o.map(d=>({id:d.attrs.AUDIO,audioCodec:d.audioCodec})),SUBTITLES:o.map(d=>({id:d.attrs.SUBTITLES,textCodec:d.textCodec})),"CLOSED-CAPTIONS":[]};let u=0;for(QE.lastIndex=0;(i=QE.exec(e))!==null;){const d=new ht(i[1],n),h=d.TYPE;if(h){const p=l[h],m=r[h]||[];r[h]=m;const v=d.LANGUAGE,y=d["ASSOC-LANGUAGE"],S=d.CHANNELS,x=d.CHARACTERISTICS,b=d["INSTREAM-ID"],w={attrs:d,bitrate:0,id:u++,groupId:d["GROUP-ID"]||"",name:d.NAME||v||"",type:h,default:d.bool("DEFAULT"),autoselect:d.bool("AUTOSELECT"),forced:d.bool("FORCED"),lang:v,url:d.URI?ws.resolve(d.URI,t):""};if(y&&(w.assocLang=y),S&&(w.channels=S),x&&(w.characteristics=x),b&&(w.instreamId=b),p!=null&&p.length){const L=ws.findGroup(p,w.groupId)||p[0];eT(w,L,"audioCodec"),eT(w,L,"textCodec")}m.push(w)}}return r}static parseLevelPlaylist(e,t,n,i,r,o){var l;const u={url:t},d=new K$(t),h=d.fragments,p=[];let m=null,v=0,y=0,S=0,x=0,b=0,w=null,L=new Qf(i,u),I,k,M,P=-1,C=!1,U=null,O;if(ep.lastIndex=0,d.m3u8=e,d.hasVariableRefs=KE(e),((l=ep.exec(e))==null?void 0:l[0])!=="#EXTM3U")return d.playlistParsingError=new Error("Missing format identifier #EXTM3U"),d;for(;(I=ep.exec(e))!==null;){C&&(C=!1,L=new Qf(i,u),L.playlistOffset=S,L.setStart(S),L.sn=v,L.cc=x,b&&(L.bitrate=b),L.level=n,m&&(L.initSegment=m,m.rawProgramDateTime&&(L.rawProgramDateTime=m.rawProgramDateTime,m.rawProgramDateTime=null),U&&(L.setByteRange(U),U=null)));const se=I[1];if(se){L.duration=parseFloat(se);const re=(" "+I[2]).slice(1);L.title=re||null,L.tagList.push(re?["INF",se,re]:["INF",se])}else if(I[3]){if(pe(L.duration)){L.playlistOffset=S,L.setStart(S),M&&nT(L,M,d),L.sn=v,L.level=n,L.cc=x,h.push(L);const re=(" "+I[3]).slice(1);L.relurl=Sm(d,re),Tm(L,w,p),w=L,S+=L.duration,v++,y=0,C=!0}}else{if(I=I[0].match(J$),!I){et.warn("No matches on slow regex match for level playlist!");continue}for(k=1;k<I.length&&I[k]===void 0;k++);const re=(" "+I[k]).slice(1),X=(" "+I[k+1]).slice(1),Z=I[k+2]?(" "+I[k+2]).slice(1):null;switch(re){case"BYTERANGE":w?L.setByteRange(X,w):L.setByteRange(X);break;case"PROGRAM-DATE-TIME":L.rawProgramDateTime=X,L.tagList.push(["PROGRAM-DATE-TIME",X]),P===-1&&(P=h.length);break;case"PLAYLIST-TYPE":d.type&&js(d,re,I),d.type=X.toUpperCase();break;case"MEDIA-SEQUENCE":d.startSN!==0?js(d,re,I):h.length>0&&sT(d,re,I),v=d.startSN=parseInt(X);break;case"SKIP":{d.skippedSegments&&js(d,re,I);const F=new ht(X,d),ee=F.decimalInteger("SKIPPED-SEGMENTS");if(pe(ee)){d.skippedSegments+=ee;for(let D=ee;D--;)h.push(null);v+=ee}const J=F.enumeratedString("RECENTLY-REMOVED-DATERANGES");J&&(d.recentlyRemovedDateranges=(d.recentlyRemovedDateranges||[]).concat(J.split("	")));break}case"TARGETDURATION":d.targetduration!==0&&js(d,re,I),d.targetduration=Math.max(parseInt(X),1);break;case"VERSION":d.version!==null&&js(d,re,I),d.version=parseInt(X);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":d.live||js(d,re,I),d.live=!1;break;case"#":(X||Z)&&L.tagList.push(Z?[X,Z]:[X]);break;case"DISCONTINUITY":x++,L.tagList.push(["DIS"]);break;case"GAP":L.gap=!0,L.tagList.push([re]);break;case"BITRATE":L.tagList.push([re,X]),b=parseInt(X)*1e3,pe(b)?L.bitrate=b:b=0;break;case"DATERANGE":{const F=new ht(X,d),ee=new Rw(F,d.dateRanges[F.ID],d.dateRangeTagCount);d.dateRangeTagCount++,ee.isValid||d.skippedSegments?d.dateRanges[ee.id]=ee:et.warn(`Ignoring invalid DATERANGE tag: "${X}"`),L.tagList.push(["EXT-X-DATERANGE",X]);break}case"DEFINE":{{const F=new ht(X,d);"IMPORT"in F?B$(d,F,o):HE(d,F,t)}break}case"DISCONTINUITY-SEQUENCE":d.startCC!==0?js(d,re,I):h.length>0&&sT(d,re,I),d.startCC=x=parseInt(X);break;case"KEY":{const F=XE(X,t,d);if(F.isSupported()){if(F.method==="NONE"){M=void 0;break}M||(M={});const ee=M[F.keyFormat];ee!=null&&ee.matches(F)||(ee&&(M=tt({},M)),M[F.keyFormat]=F)}else et.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${X}"`);break}case"START":d.startTimeOffset=JE(X);break;case"MAP":{const F=new ht(X,d);if(L.duration){const ee=new Qf(i,u);tT(ee,F,n,M),m=ee,L.initSegment=m,m.rawProgramDateTime&&!L.rawProgramDateTime&&(L.rawProgramDateTime=m.rawProgramDateTime)}else{const ee=L.byteRangeEndOffset;if(ee){const J=L.byteRangeStartOffset;U=`${ee-J}@${J}`}else U=null;tT(L,F,n,M),m=L,C=!0}m.cc=x;break}case"SERVER-CONTROL":{O&&js(d,re,I),O=new ht(X),d.canBlockReload=O.bool("CAN-BLOCK-RELOAD"),d.canSkipUntil=O.optionalFloat("CAN-SKIP-UNTIL",0),d.canSkipDateRanges=d.canSkipUntil>0&&O.bool("CAN-SKIP-DATERANGES"),d.partHoldBack=O.optionalFloat("PART-HOLD-BACK",0),d.holdBack=O.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{d.partTarget&&js(d,re,I);const F=new ht(X);d.partTarget=F.decimalFloatingPoint("PART-TARGET");break}case"PART":{let F=d.partList;F||(F=d.partList=[]);const ee=y>0?F[F.length-1]:void 0,J=y++,D=new ht(X,d),j=new BU(D,L,u,J,ee);F.push(j),L.duration+=j.duration;break}case"PRELOAD-HINT":{const F=new ht(X,d);d.preloadHint=F;break}case"RENDITION-REPORT":{const F=new ht(X,d);d.renditionReports=d.renditionReports||[],d.renditionReports.push(F);break}default:et.warn(`line parsed but not handled: ${I}`);break}}}w&&!w.relurl?(h.pop(),S-=w.duration,d.partList&&(d.fragmentHint=w)):d.partList&&(Tm(L,w,p),L.cc=x,d.fragmentHint=L,M&&nT(L,M,d)),d.targetduration||(d.playlistParsingError=new Error("Missing Target Duration"));const W=h.length,ne=h[0],oe=h[W-1];if(S+=d.skippedSegments*d.targetduration,S>0&&W&&oe){d.averagetargetduration=S/W;const se=oe.sn;d.endSN=se!=="initSegment"?se:0,d.live||(oe.endList=!0),P>0&&(e3(h,P),ne&&p.unshift(ne))}return d.fragmentHint&&(S+=d.fragmentHint.duration),d.totalduration=S,p.length&&d.dateRangeTagCount&&ne&&Cw(p,d),d.endCC=x,d}}function Cw(s,e){let t=s.length;if(!t)if(e.hasProgramDateTime){const l=e.fragments[e.fragments.length-1];s.push(l),t++}else return;const n=s[t-1],i=e.live?1/0:e.totalduration,r=Object.keys(e.dateRanges);for(let l=r.length;l--;){const u=e.dateRanges[r[l]],d=u.startDate.getTime();u.tagAnchor=n.ref;for(let h=t;h--;){var o;if(((o=s[h])==null?void 0:o.sn)<e.startSN)break;const p=Z$(e,d,s,h,i);if(p!==-1){u.tagAnchor=e.fragments[p].ref;break}}}}function Z$(s,e,t,n,i){const r=t[n];if(r){const l=r.programDateTime;if(e>=l||n===0){var o;const u=(((o=t[n+1])==null?void 0:o.start)||i)-r.start;if(e<=l+u*1e3){const d=t[n].sn-s.startSN;if(d<0)return-1;const h=s.fragments;if(h.length>t.length){const m=(t[n+1]||h[h.length-1]).sn-s.startSN;for(let v=m;v>d;v--){const y=h[v].programDateTime;if(e>=y&&e<y+h[v].duration*1e3)return v}}return d}}}return-1}function XE(s,e,t){var n,i;const r=new ht(s,t),o=(n=r.METHOD)!=null?n:"",l=r.URI,u=r.hexadecimalInteger("IV"),d=r.KEYFORMATVERSIONS,h=(i=r.KEYFORMAT)!=null?i:"identity";l&&r.IV&&!u&&et.error(`Invalid IV: ${r.IV}`);const p=l?ws.resolve(l,e):"",m=(d||"1").split("/").map(Number).filter(Number.isFinite);return new Bi(o,p,h,m,u,r.KEYID)}function JE(s){const t=new ht(s).decimalFloatingPoint("TIME-OFFSET");return pe(t)?t:null}function ZE(s,e){let t=(s||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const i=t.filter(r=>Fg(r,n));i.length&&(e[`${n}Codec`]=i.map(r=>r.split("/")[0]).join(","),t=t.filter(r=>i.indexOf(r)===-1))}),e.unknownCodecs=t}function eT(s,e,t){const n=e[t];n&&(s[t]=n)}function e3(s,e){let t=s[e];for(let n=e;n--;){const i=s[n];if(!i)return;i.programDateTime=t.programDateTime-i.duration*1e3,t=i}}function Tm(s,e,t){s.rawProgramDateTime?t.push(s):e!=null&&e.programDateTime&&(s.programDateTime=e.endProgramDateTime)}function tT(s,e,t,n){s.relurl=e.URI,e.BYTERANGE&&s.setByteRange(e.BYTERANGE),s.level=t,s.sn="initSegment",n&&(s.levelkeys=n),s.initSegment=null}function nT(s,e,t){s.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(i=>e[i].isCommonEncryption)&&n.push(s)}function js(s,e,t){s.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function sT(s,e,t){s.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function tp(s,e){const t=e.startPTS;if(pe(t)){let n=0,i;e.sn>s.sn?(n=t-s.start,i=s):(n=s.start-t,i=e),i.duration!==n&&i.setDuration(n)}else e.sn>s.sn?s.cc===e.cc&&s.minEndPTS?e.setStart(s.start+(s.minEndPTS-s.start)):e.setStart(s.start+s.duration):e.setStart(Math.max(s.start-e.duration,0))}function Pw(s,e,t,n,i,r,o){n-t<=0&&(o.warn("Fragment should have a positive duration",e),n=t+e.duration,r=i+e.duration);let u=t,d=n;const h=e.startPTS,p=e.endPTS;if(pe(h)){const b=Math.abs(h-t);s&&b>s.totalduration?o.warn(`media timestamps and playlist times differ by ${b}s for level ${e.level} ${s.url}`):pe(e.deltaPTS)?e.deltaPTS=Math.max(b,e.deltaPTS):e.deltaPTS=b,u=Math.max(t,h),t=Math.min(t,h),i=e.startDTS!==void 0?Math.min(i,e.startDTS):i,d=Math.min(n,p),n=Math.max(n,p),r=e.endDTS!==void 0?Math.max(r,e.endDTS):r}const m=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(n-e.start),e.startPTS=t,e.maxStartPTS=u,e.startDTS=i,e.endPTS=n,e.minEndPTS=d,e.endDTS=r;const v=e.sn;if(!s||v<s.startSN||v>s.endSN)return 0;let y;const S=v-s.startSN,x=s.fragments;for(x[S]=e,y=S;y>0;y--)tp(x[y],x[y-1]);for(y=S;y<x.length-1;y++)tp(x[y],x[y+1]);return s.fragmentHint&&tp(x[x.length-1],s.fragmentHint),s.PTSKnown=s.alignedSliding=!0,m}function t3(s,e,t){if(s===e)return;let n=null;const i=s.fragments;for(let h=i.length-1;h>=0;h--){const p=i[h].initSegment;if(p){n=p;break}}s.fragmentHint&&delete s.fragmentHint.endPTS;let r;i3(s,e,(h,p,m,v)=>{if((!e.startCC||e.skippedSegments)&&p.cc!==h.cc){const y=h.cc-p.cc;for(let S=m;S<v.length;S++)v[S].cc+=y;e.endCC=v[v.length-1].cc}pe(h.startPTS)&&pe(h.endPTS)&&(p.setStart(p.startPTS=h.startPTS),p.startDTS=h.startDTS,p.maxStartPTS=h.maxStartPTS,p.endPTS=h.endPTS,p.endDTS=h.endDTS,p.minEndPTS=h.minEndPTS,p.setDuration(h.endPTS-h.startPTS),p.duration&&(r=p),e.PTSKnown=e.alignedSliding=!0),h.hasStreams&&(p.elementaryStreams=h.elementaryStreams),p.loader=h.loader,h.hasStats&&(p.stats=h.stats),h.initSegment&&(p.initSegment=h.initSegment,n=h.initSegment)});const o=e.fragments,l=e.fragmentHint?o.concat(e.fragmentHint):o;if(n&&l.forEach(h=>{var p;h&&(!h.initSegment||h.initSegment.relurl===((p=n)==null?void 0:p.relurl))&&(h.initSegment=n)}),e.skippedSegments){if(e.deltaUpdateFailed=o.some(h=>!h),e.deltaUpdateFailed){t.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let h=e.skippedSegments;h--;)o.shift();e.startSN=o[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=n3(s.dateRanges,e,t));const h=s.fragments.filter(p=>p.rawProgramDateTime);if(s.hasProgramDateTime&&!e.hasProgramDateTime)for(let p=1;p<l.length;p++)l[p].programDateTime===null&&Tm(l[p],l[p-1],h);Cw(h,e)}e.endCC=o[o.length-1].cc}if(!e.startCC){var u;const h=Nw(s,e.startSN-1);e.startCC=(u=h==null?void 0:h.cc)!=null?u:o[0].cc}s3(s.partList,e.partList,(h,p)=>{p.elementaryStreams=h.elementaryStreams,p.stats=h.stats}),r?Pw(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS,t):Dw(s,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=s.driftStartTime,e.driftStart=s.driftStart;const d=e.advancedDateTime;if(e.advanced&&d){const h=e.edge;e.driftStart||(e.driftStartTime=d,e.driftStart=h),e.driftEndTime=d,e.driftEnd=h}else e.driftEndTime=s.driftEndTime,e.driftEnd=s.driftEnd,e.advancedDateTime=s.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=s.requestScheduled)}function n3(s,e,t){const{dateRanges:n,recentlyRemovedDateranges:i}=e,r=tt({},s);i&&i.forEach(u=>{delete r[u]});const l=Object.keys(r).length;return l?(Object.keys(n).forEach(u=>{const d=r[u],h=new Rw(n[u].attr,d);h.isValid?(r[u]=h,d||(h.tagOrder+=l)):t.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${it(n[u].attr)}"`)}),r):n}function s3(s,e,t){if(s&&e){let n=0;for(let i=0,r=s.length;i<=r;i++){const o=s[i],l=e[i+n];o&&l&&o.index===l.index&&o.fragment.sn===l.fragment.sn?t(o,l):n--}}}function i3(s,e,t){const n=e.skippedSegments,i=Math.max(s.startSN,e.startSN)-e.startSN,r=(s.fragmentHint?1:0)+(n?e.endSN:Math.min(s.endSN,e.endSN))-e.startSN,o=e.startSN-s.startSN,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments;for(let d=i;d<=r;d++){const h=u[o+d];let p=l[d];if(n&&!p&&h&&(p=e.fragments[d]=h),h&&p){t(h,p,d,l);const m=h.relurl,v=p.relurl;if(m&&r3(m,v)){e.playlistParsingError=iT(`media sequence mismatch ${p.sn}:`,s,e,h,p);return}else if(h.cc!==p.cc){e.playlistParsingError=iT(`discontinuity sequence mismatch (${h.cc}!=${p.cc})`,s,e,h,p);return}}}}function iT(s,e,t,n,i){return new Error(`${s} ${i.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function Dw(s,e,t=!0){const n=e.startSN+e.skippedSegments-s.startSN,i=s.fragments,r=n>=0;let o=0;if(r&&n<i.length)o=i[n].start;else if(r&&e.startSN===s.endSN+1)o=s.fragmentEnd;else if(r&&t)o=s.fragmentStart+n*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)o=s.fragmentStart;else return;bm(e,o)}function bm(s,e){if(e){const t=s.fragments;for(let n=s.skippedSegments;n<t.length;n++)t[n].addStart(e);s.fragmentHint&&s.fragmentHint.addStart(e)}}function Ow(s,e=1/0){let t=1e3*s.targetduration;if(s.updated){const n=s.fragments;if(n.length&&t*4>e){const r=n[n.length-1].duration*1e3;r<t&&(t=r)}}else t/=2;return Math.round(t)}function Nw(s,e,t){if(!s)return null;let n=s.fragments[e-s.startSN];return n||(n=s.fragmentHint,n&&n.sn===e)?n:e<s.startSN&&t&&t.sn===e?t:null}function rT(s,e,t){return s?Mw(s.partList,e,t):null}function Mw(s,e,t){if(s)for(let n=s.length;n--;){const i=s[n];if(i.index===t&&i.fragment.sn===e)return i}return null}function Fw(s){s.forEach((e,t)=>{var n;(n=e.details)==null||n.fragments.forEach(i=>{i.level=t,i.initSegment&&(i.initSegment.level=t)})})}function r3(s,e){return s!==e&&e?oT(s)!==oT(e):!1}function oT(s){return s.replace(/\?[^?]*$/,"")}function sl(s,e){for(let n=0,i=s.length;n<i;n++){var t;if(((t=s[n])==null?void 0:t.cc)===e)return s[n]}return null}function o3(s,e){return!!(s&&e.startCC<s.endCC&&e.endCC>s.startCC)}function aT(s,e){const t=s.start+e;s.startPTS=t,s.setStart(t),s.endPTS=t+s.duration}function Bw(s,e){const t=e.fragments;for(let n=0,i=t.length;n<i;n++)aT(t[n],s);e.fragmentHint&&aT(e.fragmentHint,s),e.alignedSliding=!0}function a3(s,e){s&&(Uw(e,s),e.alignedSliding||sd(e,s),!e.alignedSliding&&!e.skippedSegments&&Dw(s,e,!1))}function Uw(s,e){if(!o3(e,s))return;const t=Math.min(e.endCC,s.endCC),n=sl(e.fragments,t),i=sl(s.fragments,t);if(!n||!i)return;et.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const r=n.start-i.start;Bw(r,s)}function sd(s,e){if(!s.hasProgramDateTime||!e.hasProgramDateTime)return;const t=s.fragments,n=e.fragments;if(!t.length||!n.length)return;let i,r;const o=Math.min(e.endCC,s.endCC);e.startCC<o&&s.startCC<o&&(i=sl(n,o),r=sl(t,o)),(!i||!r)&&(i=n[Math.floor(n.length/2)],r=sl(t,i.cc)||t[Math.floor(t.length/2)]);const l=i.programDateTime,u=r.programDateTime;if(!l||!u)return;const d=(u-l)/1e3-(r.start-i.start);Bw(d,s)}function cn(s,e,t){xn(s,e,t),s.addEventListener(e,t)}function xn(s,e,t){s.removeEventListener(e,t)}const l3={toString:function(s){let e="";const t=s.length;for(let n=0;n<t;n++)e+=`[${s.start(n).toFixed(3)}-${s.end(n).toFixed(3)}]`;return e}},te={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Kg extends Aw{constructor(e,t,n,i,r){super(i,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=te.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:o,fragCurrent:l,media:u,mediaBuffer:d,state:h}=this,p=u?u.currentTime:0,m=Fe.bufferInfo(d||u,p,o.maxBufferHole),v=!m.len;if(this.log(`Media seeking to ${pe(p)?p.toFixed(3):p}, state: ${h}, ${v?"out of":"in"} buffer`),this.state===te.ENDED)this.resetLoadingState();else if(l){const y=o.maxFragLookUpTolerance,S=l.start-y,x=l.start+l.duration+y;if(v||x<m.start||S>m.end){const b=p>x;(p<S||b)&&(b&&l.loader&&(this.log(`Cancelling fragment load for seek (sn: ${l.sn})`),l.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(u){this.fragmentTracker.removeFragmentsInRange(p,1/0,this.playlistType,!0);const y=this.lastCurrentTime;if(p>y&&(this.lastCurrentTime=p),!this.loadingParts){const S=Math.max(m.end,p),x=this.shouldLoadParts(this.getLevelDetails(),S);x&&(this.log(`LL-Part loading ON after seeking to ${p.toFixed(2)} with buffer @${S.toFixed(2)}`),this.loadingParts=x)}}this.hls.hasEnoughToStart||(this.log(`Setting ${v?"startPosition":"nextLoadPosition"} to ${p} for seek without enough to start`),this.nextLoadPosition=p,v&&(this.startPosition=p)),v&&this.state===te.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=r,this.hls=e,this.fragmentLoader=new M$(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new $g(e.config)}registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===te.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=te.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const n=e.end||0,i=this.config.timelineOffset||0;if(n<=i)return!1;const r=e.buffered;this.config.maxBufferHole&&r&&r.length>1&&(e=Fe.bufferedInfo(r,e.start,0));const o=e.nextStart;if(o&&o>i&&o<t.edge||this.media.currentTime<e.start)return!1;const u=t.partList;if(u!=null&&u.length){const h=u[u.length-1];return Fe.isBuffered(this.media,h.start+h.duration/2)}const d=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(d)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;cn(n,"seeking",this.onMediaSeeking),cn(n,"ended",this.onMediaEnded);const i=this.config;this.levels&&i.autoStartLoad&&this.state===te.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(i!==null){if(i.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),xn(i,"seeking",this.onMediaSeeking),xn(i,"ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=te.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this.startFragRequested=!0,this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const i=r=>{const o=r.frag;if(this.fragContextChanged(o)){this.warn(`${o.type} sn: ${o.sn}${r.part?" part: "+r.part.index:""} of ${this.fragInfo(o,!1,r.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(o);return}o.stats.chunkCount++,this._handleFragmentLoadProgress(r)};this._doFragLoad(e,t,n,i).then(r=>{if(!r)return;const o=this.state,l=r.frag;if(this.fragContextChanged(l)){(o===te.FRAG_LOADING||!this.fragCurrent&&o===te.PARSING)&&(this.fragmentTracker.removeFragment(l),this.state=te.IDLE);return}"payload"in r&&(this.log(`Loaded ${l.type} sn: ${l.sn} of ${this.playlistLabel()} ${l.level}`),this.hls.trigger(R.FRAG_LOADED,r)),this._handleFragmentLoadComplete(r)}).catch(r=>{this.state===te.STOPPED||this.state===te.ERROR||(this.warn(`Frag error: ${(r==null?void 0:r.message)||r}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Pt.APPENDING){const r=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,r),l=Math.max(e.duration,o?o.len:this.config.maxBufferLength),u=this.backtrackFragment;((u?e.sn-u.sn:0)===1||this.reduceMaxBufferLength(l,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Pt.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:n};this.hls.trigger(R.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{const i=n==null?void 0:n.frag;if(!i||this.fragContextChanged(i)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:i}=this,{frag:r,payload:o}=n,l=r.decryptdata;if(o&&o.byteLength>0&&l!=null&&l.key&&l.iv&&To(l.method)){const u=self.performance.now();return this.decrypter.decrypt(new Uint8Array(o),l.key.buffer,l.iv.buffer,Vg(l.method)).catch(d=>{throw i.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.FRAG_DECRYPT_ERROR,fatal:!1,error:d,reason:d.message,frag:r}),d}).then(d=>{const h=self.performance.now();return i.trigger(R.FRAG_DECRYPTED,{frag:r,payload:d,stats:{tstart:u,tdecrypt:h}}),n.payload=d,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===te.STOPPED||this.state===te.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==te.STOPPED&&(this.state=te.IDLE),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var n,i;const r=e.tracks;if(r&&!t.encrypted&&((n=r.audio)!=null&&n.encrypted||(i=r.video)!=null&&i.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const o=this.media,l=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${o?"attached mediaKeys: "+o.mediaKeys:"detached"})`);return this.warn(l.message),!o||o.mediaKeys?!1:(this.hls.trigger(R.ERROR,{type:Re.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_KEYS,fatal:!1,error:l,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${n?l3.toString(Fe.getBuffered(n)):"(detached)"})`),Tt(e)){var i;if(e.type!==ye.SUBTITLE){const o=e.elementaryStreams;if(!Object.keys(o).some(l=>!!o[l])){this.state=te.IDLE;return}}const r=(i=this.levels)==null?void 0:i[e.level];r!=null&&r.fragmentError&&(this.log(`Resetting level fragment error count of ${r.fragmentError} on frag buffered`),r.fragmentError=0)}this.state=te.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:i,partsLoaded:r}=e,o=!r||r.length===0||r.some(u=>!u),l=new jg(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!o);t.flush(l)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,i){var r;this.fragCurrent=e;const o=t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let l=null;if(e.encrypted&&!((r=e.decryptdata)!=null&&r.key)){if(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=te.KEY_LOADING,this.fragCurrent=e,l=this.keyLoader.load(e).then(m=>{if(!this.fragContextChanged(m.frag))return this.hls.trigger(R.KEY_LOADED,m),this.state===te.KEY_LOADING&&(this.state=te.IDLE),m}),this.hls.trigger(R.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(l=this.keyLoader.loadClear(e,o.encryptedFragments,this.startFragRequested),l&&this.log("[eme] blocking frag load until media-keys acquired"));const u=this.fragPrevious;if(Tt(e)&&(!u||e.sn!==u.sn)){const m=this.shouldLoadParts(t.details,e.end);m!==this.loadingParts&&(this.log(`LL-Part loading ${m?"ON":"OFF"} loading sn ${u==null?void 0:u.sn}->${e.sn}`),this.loadingParts=m)}if(n=Math.max(e.start,n||0),this.loadingParts&&Tt(e)){const m=o.partList;if(m&&i){n>o.fragmentEnd&&o.fragmentHint&&(e=o.fragmentHint);const v=this.getNextPart(m,e,n);if(v>-1){const y=m[v];e=this.fragCurrent=y.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${y.index} (${v}/${m.length-1}) of ${this.fragInfo(e,!1,y)}) cc: ${e.cc} [${o.startSN}-${o.endSN}], target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=y.start+y.duration,this.state=te.FRAG_LOADING;let S;return l?S=l.then(x=>!x||this.fragContextChanged(x.frag)?null:this.doFragPartsLoad(e,y,t,i)).catch(x=>this.handleFragLoadError(x)):S=this.doFragPartsLoad(e,y,t,i).catch(x=>this.handleFragLoadError(x)),this.hls.trigger(R.FRAG_LOADING,{frag:e,part:y,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):S}else if(!e.url||this.loadedEndOfParts(m,n))return Promise.resolve(null)}}if(Tt(e)&&this.loadingParts){var d;this.log(`LL-Part loading OFF after next part miss @${n.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(d=o.partList)==null?void 0:d.filter(m=>m.loaded).map(m=>`[${m.start}-${m.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+o.startSN+"-"+o.endSN+"]"}, target: ${parseFloat(n.toFixed(3))}`),pe(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=te.FRAG_LOADING;const h=this.config.progressive&&e.type!==ye.SUBTITLE;let p;return h&&l?p=l.then(m=>!m||this.fragContextChanged(m.frag)?null:this.fragmentLoader.load(e,i)).catch(m=>this.handleFragLoadError(m)):p=Promise.all([this.fragmentLoader.load(e,h?i:void 0),l]).then(([m])=>(!h&&i&&i(m),m)).catch(m=>this.handleFragLoadError(m)),this.hls.trigger(R.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):p}doFragPartsLoad(e,t,n,i){return new Promise((r,o)=>{var l;const u=[],d=(l=n.details)==null?void 0:l.partList,h=p=>{this.fragmentLoader.loadPart(e,p,i).then(m=>{u[p.index]=m;const v=m.part;this.hls.trigger(R.FRAG_LOADED,m);const y=rT(n.details,e.sn,p.index+1)||Mw(d,e.sn,p.index+1);if(y)h(y);else return r({frag:e,part:v,partsLoaded:u})}).catch(o)};h(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===H.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===Re.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(R.ERROR,t)}else this.hls.trigger(R.ERROR,{type:Re.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==te.PARSING){!this.fragCurrent&&this.state!==te.STOPPED&&this.state!==te.ERROR&&(this.state=te.IDLE);return}const{frag:n,part:i,level:r}=t,o=self.performance.now();n.stats.parsing.end=o,i&&(i.stats.parsing.end=o);const l=this.getLevelDetails(),d=l&&n.sn>l.endSN||this.shouldLoadParts(l,n.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} after parsing segment ending @${n.end.toFixed(2)}`),this.loadingParts=d),this.updateLevelTiming(n,i,r,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var n;const r=e.partList[0];if(r.fragment.type===ye.SUBTITLE)return!1;const o=r.end+(((n=e.fragmentHint)==null?void 0:n.duration)||0);if(t>=o){var i;if((this.hls.hasEnoughToStart?((i=this.media)==null?void 0:i.currentTime)||this.lastCurrentTime:this.getLoadPosition())>r.start-r.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:i,sn:r,part:o}=e;if(!(t!=null&&t[i]))return this.warn(`Levels object was unset while buffering fragment ${r} of ${this.playlistLabel()} ${i}. The current chunk will not be buffered.`),null;const l=t[i],u=l.details,d=o>-1?rT(u,r,o):null,h=d?d.fragment:Nw(u,r,n);return h?(n&&n!==h&&(h.stats=n.stats),{frag:h,part:d,level:l}):null}bufferFragmentData(e,t,n,i,r){if(this.state!==te.PARSING)return;const{data1:o,data2:l}=e;let u=o;if(l&&(u=zn(o,l)),!u.length)return;const d=this.initPTS[t.cc],h=d?-d.baseTime/d.timescale:void 0,p={type:e.type,frag:t,part:n,chunkMeta:i,offset:h,parent:t.type,data:u};if(this.hls.trigger(R.BUFFER_APPENDING,p),e.dropped&&e.independent&&!n){if(r)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Fe.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,i=Fe.bufferInfo(t,n,0),r=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,r*.25),l=Math.max(Math.min(e.start-o,i.end-o),n+o);e.start-l>o&&this.flushMainBuffer(l,e.start)}getFwdBufferInfo(e,t){var n;const i=this.getLoadPosition();if(!pe(i))return null;const o=this.lastCurrentTime>i||(n=this.media)!=null&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,i,t,o)}getFwdBufferInfoAtPos(e,t,n,i){const r=Fe.bufferInfo(e,t,i);if(r.len===0&&r.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,n);if(o&&(r.nextStart<=o.end||o.gap)){const l=Math.max(Math.min(r.nextStart,o.end)-t,i);return Fe.bufferInfo(e,t,l)}}return r}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,i=Math.max(Math.min(e-t,n.maxBufferLength),t),r=Math.max(e-t*3,n.maxMaxBufferLength/2,i);return r>=i?(n.maxMaxBufferLength=r,this.warn(`Reduce max buffer length to ${r}s`),!0):!1}getAppendedFrag(e,t=ye.MAIN){const n=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,i=n.length;if(!i)return null;const{config:r}=this,o=n[0].start,l=r.lowLatencyMode&&!!t.partList;let u=null;if(t.live){const p=r.initialLiveManifestSize;if(i<p)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${p})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o){var d;l&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),u=this.getInitialLiveFragment(t);const m=this.hls.startPosition,v=this.hls.liveSyncPosition,y=u?(m!==-1&&m>=o?m:v)||u.start:e;this.log(`Setting startPosition to ${y} to match start frag at live edge. mainStart: ${m} liveSyncPosition: ${v} frag.start: ${(d=u)==null?void 0:d.start}`),this.startPosition=this.nextLoadPosition=y}}else e<=o&&(u=n[0]);if(!u){const p=this.loadingParts?t.partEnd:t.fragmentEnd;u=this.getFragmentAtPosition(e,p,t)}let h=this.filterReplacedPrimary(u,t);if(!h&&u){const p=u.sn-t.startSN;h=this.filterReplacedPrimary(n[p+1]||null,t)}return this.mapToInitFragWhenRequired(h)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Pt.OK||n===Pt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,i,r){let o=null;if(e.gap&&(o=this.getNextFragment(this.nextLoadPosition,t),o&&!o.gap&&n.nextStart)){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i,0);if(l!==null&&n.len+l.len>=r){const u=o.sn;return this.loopSn!==u&&(this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${u}`),this.loopSn=u),null}}return this.loopSn=void 0,o}get primaryPrefetch(){if(lT(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(lT(this.config)&&e.type!==ye.SUBTITLE){const n=this.hls.interstitialsManager,i=n==null?void 0:n.bufferingItem;if(i){const o=i.event;if(o){if(o.appendInPlace||Math.abs(e.start-i.start)>1||i.start===0)return null}else if(e.end<=i.start&&(t==null?void 0:t.live)===!1||e.start>i.end&&i.nextEvent&&(i.nextEvent.appendInPlace||e.start-i.end>1))return null}const r=n==null?void 0:n.playerQueue;if(r)for(let o=r.length;o--;){const l=r[o].interstitial;if(l.appendInPlace&&e.start>=l.startTime&&e.end<=l.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let i=-1,r=!1,o=!0;for(let l=0,u=e.length;l<u;l++){const d=e[l];if(o=o&&!d.independent,i>-1&&n<d.start)break;const h=d.loaded;h?i=-1:(r||(d.independent||o)&&d.fragment===t)&&(d.fragment!==t&&this.warn(`Need buffer at ${n} but next unloaded part starts at ${d.start}`),i=l),r=h}return i}loadedEndOfParts(e,t){let n;for(let i=e.length;i--;){if(n=e[i],!n.loaded)return!1;if(t>n.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=A$(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const r=n.sn+1;if(r>=e.startSN&&r<=e.endSN){const o=t[r-e.startSN];n.cc===o.cc&&(i=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=Ew(e,n.cc,n.end),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const r=this.hls.liveSyncPosition;r!==null&&(i=this.getFragmentAtPosition(r,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,n){const{config:i}=this;let{fragPrevious:r}=this,{fragments:o,endSN:l}=n;const{fragmentHint:u}=n,{maxFragLookUpTolerance:d}=i,h=n.partList,p=!!(this.loadingParts&&h!=null&&h.length&&u);p&&!this.bitrateTest&&h[h.length-1].fragment.sn===u.sn&&(o=o.concat(u),l=u.sn);let m;if(e<t){var v;const S=e<this.lastCurrentTime||e>t-d||(v=this.media)!=null&&v.paused||!this.startFragRequested?0:d;m=kr(r,o,e,S)}else m=o[o.length-1];if(m){const y=m.sn-n.startSN,S=this.fragmentTracker.getState(m);if((S===Pt.OK||S===Pt.PARTIAL&&m.gap)&&(r=m),r&&m.sn===r.sn&&(!p||h[0].fragment.sn>m.sn||!n.live)&&m.level===r.level){const b=o[y+1];m.sn<l&&this.fragmentTracker.getState(b)!==Pt.OK?m=b:m=null}}return m}alignPlaylists(e,t,n){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const r=e.fragmentStart,o=!t,l=e.alignedSliding&&pe(r);if(o||!l&&!r){a3(n,e);const u=e.fragmentStart;return this.log(`Live playlist sliding: ${u.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${i}`),u}return r}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;n<t&&(n=-1);const i=this.timelineOffset;if(n===-1){const r=this.startTimeOffset!==null,o=r?this.startTimeOffset:e.startTimeOffset;o!==null&&pe(o)?(n=t+o,o<0&&(n+=e.edge),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Setting startPosition to ${n} for start time offset ${o} found in ${r?"multivariant":"media"} playlist`),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${n}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+i}this.nextLoadPosition=n+i}getLoadPosition(){var e;const{media:t}=this;let n=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?n=t.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&Tt(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==te.FRAG_LOADING_WAITING_RETRY)&&(this.state=te.IDLE)}onFragmentOrKeyLoadError(e,t){var n;if(t.chunkMeta&&!t.frag){const b=this.getCurrentContext(t.chunkMeta);b&&(t.frag=b.frag)}const i=t.frag;if(!i||i.type!==e||!this.levels)return;if(this.fragContextChanged(i)){var r;this.warn(`Frag load error must match current frag to retry ${i.url} > ${(r=this.fragCurrent)==null?void 0:r.url}`);return}const o=t.details===H.FRAG_GAP;o&&this.fragmentTracker.fragBuffered(i,!0);const l=t.errorAction;if(!l){this.state=te.ERROR;return}const{action:u,flags:d,retryCount:h=0,retryConfig:p}=l,m=!!p,v=m&&u===Kt.RetryRequest,y=m&&!l.resolved&&d===_n.MoveAllAlternatesMatchingHost,S=(n=this.hls.latestLevelDetails)==null?void 0:n.live;if(!v&&y&&Tt(i)&&!i.endList&&S&&!bw(t))this.resetFragmentErrors(e),this.treatAsGap(i),l.resolved=!0;else if((v||y)&&h<p.maxNumRetry){var x;const b=xm((x=t.response)==null?void 0:x.code),w=Ug(p,h);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+w,this.state=te.FRAG_LOADING_WAITING_RETRY,l.resolved=!0,b){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${i.sn} of ${e} ${i.level} errored with ${t.details}, retrying loading ${h+1}/${p.maxNumRetry} in ${w}ms`)}else if(p)if(this.resetFragmentErrors(e),h<p.maxNumRetry)!o&&u!==Kt.RemoveAlternatePermanently&&(l.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${h})`);return}else u===Kt.SendAlternateToPenaltyBox?this.state=te.WAITING_LEVEL:this.state=te.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,n=t===1/0;(!t||e>=t||n&&!xm(0))&&(n&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=te.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===te.PARSING||this.state===te.PARSED){const t=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len,(t==null?void 0:t.duration)||10);const o=!r;return o&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===ye.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==te.STOPPED&&(this.state=te.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const i=Fe.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,n),this.state===te.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==te.STOPPED&&(this.state=te.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,i){const r=n.details;if(!r){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((u,d)=>{const h=e.elementaryStreams[d];if(h){const p=h.endPTS-h.startPTS;if(p<=0)return this.warn(`Could not parse fragment ${e.sn} ${d} duration reliably (${p})`),u||!1;const m=i?0:Pw(r,e,h.startPTS,h.endPTS,h.startDTS,h.endDTS,this);return this.hls.trigger(R.LEVEL_PTS_UPDATED,{details:r,level:n,drift:m,type:d,frag:e,start:h.startPTS,end:h.endPTS}),!0}return u},!1)){var l;const u=((l=this.transmuxer)==null?void 0:l.error)===null;if((n.fragmentError===0||u&&(n.fragmentError<2||e.endList))&&this.treatAsGap(e,n),u){const d=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=te.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(R.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===ye.MAIN?"level":"track"}fragInfo(e,t=!0,n){var i,r;return`${this.playlistLabel()} ${e.level} (${n?"part":"frag"}:[${((i=t&&!n?e.startPTS:(n||e).start)!=null?i:NaN).toFixed(3)}-${((r=t&&!n?e.endPTS:(n||e).end)!=null?r:NaN).toFixed(3)}]${n&&e.type==="main"?"INDEPENDENT="+(n.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function lT(s){return!!s.interstitialsController&&s.enableInterstitialPlayback!==!1}class $w{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=c3(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function c3(s,e){const t=new Uint8Array(e);let n=0;for(let i=0;i<s.length;i++){const r=s[i];t.set(r,n),n+=r.length}return t}var np={exports:{}},cT;function u3(){return cT||(cT=1,(function(s){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(u,d,h){this.fn=u,this.context=d,this.once=h||!1}function r(u,d,h,p,m){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new i(h,p||u,m),y=t?t+d:d;return u._events[y]?u._events[y].fn?u._events[y]=[u._events[y],v]:u._events[y].push(v):(u._events[y]=v,u._eventsCount++),u}function o(u,d){--u._eventsCount===0?u._events=new n:delete u._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],h,p;if(this._eventsCount===0)return d;for(p in h=this._events)e.call(h,p)&&d.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(h)):d},l.prototype.listeners=function(d){var h=t?t+d:d,p=this._events[h];if(!p)return[];if(p.fn)return[p.fn];for(var m=0,v=p.length,y=new Array(v);m<v;m++)y[m]=p[m].fn;return y},l.prototype.listenerCount=function(d){var h=t?t+d:d,p=this._events[h];return p?p.fn?1:p.length:0},l.prototype.emit=function(d,h,p,m,v,y){var S=t?t+d:d;if(!this._events[S])return!1;var x=this._events[S],b=arguments.length,w,L;if(x.fn){switch(x.once&&this.removeListener(d,x.fn,void 0,!0),b){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,h),!0;case 3:return x.fn.call(x.context,h,p),!0;case 4:return x.fn.call(x.context,h,p,m),!0;case 5:return x.fn.call(x.context,h,p,m,v),!0;case 6:return x.fn.call(x.context,h,p,m,v,y),!0}for(L=1,w=new Array(b-1);L<b;L++)w[L-1]=arguments[L];x.fn.apply(x.context,w)}else{var I=x.length,k;for(L=0;L<I;L++)switch(x[L].once&&this.removeListener(d,x[L].fn,void 0,!0),b){case 1:x[L].fn.call(x[L].context);break;case 2:x[L].fn.call(x[L].context,h);break;case 3:x[L].fn.call(x[L].context,h,p);break;case 4:x[L].fn.call(x[L].context,h,p,m);break;default:if(!w)for(k=1,w=new Array(b-1);k<b;k++)w[k-1]=arguments[k];x[L].fn.apply(x[L].context,w)}}return!0},l.prototype.on=function(d,h,p){return r(this,d,h,p,!1)},l.prototype.once=function(d,h,p){return r(this,d,h,p,!0)},l.prototype.removeListener=function(d,h,p,m){var v=t?t+d:d;if(!this._events[v])return this;if(!h)return o(this,v),this;var y=this._events[v];if(y.fn)y.fn===h&&(!m||y.once)&&(!p||y.context===p)&&o(this,v);else{for(var S=0,x=[],b=y.length;S<b;S++)(y[S].fn!==h||m&&!y[S].once||p&&y[S].context!==p)&&x.push(y[S]);x.length?this._events[v]=x.length===1?x[0]:x:o(this,v)}return this},l.prototype.removeAllListeners=function(d){var h;return d?(h=t?t+d:d,this._events[h]&&o(this,h)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,s.exports=l})(np)),np.exports}var d3=u3(),Hg=MU(d3);const yl="1.6.15",Vo={};function h3(){return typeof __HLS_WORKER_BUNDLE__=="function"}function f3(){const s=Vo[yl];if(s)return s.clientCount++,s;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),i={worker:new self.Worker(t),objectURL:t,clientCount:1};return Vo[yl]=i,i}function p3(s){const e=Vo[s];if(e)return e.clientCount++,e;const t=new self.URL(s,self.location.href).href,i={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Vo[s]=i,i}function m3(s){const e=Vo[s||yl];if(e&&e.clientCount--===1){const{worker:n,objectURL:i}=e;delete Vo[s||yl],i&&self.URL.revokeObjectURL(i),n.terminate()}}function jw(s,e){return e+10<=s.length&&s[e]===51&&s[e+1]===68&&s[e+2]===73&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128}function zg(s,e){return e+10<=s.length&&s[e]===73&&s[e+1]===68&&s[e+2]===51&&s[e+3]<255&&s[e+4]<255&&s[e+6]<128&&s[e+7]<128&&s[e+8]<128&&s[e+9]<128}function wd(s,e){let t=0;return t=(s[e]&127)<<21,t|=(s[e+1]&127)<<14,t|=(s[e+2]&127)<<7,t|=s[e+3]&127,t}function vl(s,e){const t=e;let n=0;for(;zg(s,e);){n+=10;const i=wd(s,e+6);n+=i,jw(s,e+10)&&(n+=10),e+=n}if(n>0)return s.subarray(t,t+n)}function g3(s,e,t,n){const i=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],r=e[t+2],o=r>>2&15;if(o>12){const v=new Error(`invalid ADTS sampling index:${o}`);s.emit(R.ERROR,R.ERROR,{type:Re.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!0,error:v,reason:v.message});return}const l=(r>>6&3)+1,u=e[t+3]>>6&3|(r&1)<<2,d="mp4a.40."+l,h=i[o];let p=o;(l===5||l===29)&&(p-=3);const m=[l<<3|(p&14)>>1,(p&1)<<7|u<<3];return et.log(`manifest codec:${n}, parsed codec:${d}, channels:${u}, rate:${h} (ADTS object type:${l} sampling index:${o})`),{config:m,samplerate:h,channelCount:u,codec:d,parsedCodec:d,manifestCodec:n}}function Vw(s,e){return s[e]===255&&(s[e+1]&246)===240}function Gw(s,e){return s[e+1]&1?7:9}function Wg(s,e){return(s[e+3]&3)<<11|s[e+4]<<3|(s[e+5]&224)>>>5}function y3(s,e){return e+5<s.length}function id(s,e){return e+1<s.length&&Vw(s,e)}function v3(s,e){return y3(s,e)&&Vw(s,e)&&Wg(s,e)<=s.length-e}function x3(s,e){if(id(s,e)){const t=Gw(s,e);if(e+t>=s.length)return!1;const n=Wg(s,e);if(n<=t)return!1;const i=e+n;return i===s.length||id(s,i)}return!1}function Kw(s,e,t,n,i){if(!s.samplerate){const r=g3(e,t,n,i);if(!r)return;tt(s,r)}}function Hw(s){return 1024*9e4/s}function S3(s,e){const t=Gw(s,e);if(e+t<=s.length){const n=Wg(s,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function zw(s,e,t,n,i){const r=Hw(s.samplerate),o=n+i*r,l=S3(e,t);let u;if(l){const{frameLength:p,headerLength:m}=l,v=m+p,y=Math.max(0,t+v-e.length);y?(u=new Uint8Array(v-m),u.set(e.subarray(t+m,e.length),0)):u=e.subarray(t+m,t+v);const S={unit:u,pts:o};return y||s.samples.push(S),{sample:S,length:v,missing:y}}const d=e.length-t;return u=new Uint8Array(d),u.set(e.subarray(t,e.length),0),{sample:{unit:u,pts:o},length:d,missing:-1}}function E3(s,e){return zg(s,e)&&wd(s,e+6)+10<=s.length-e}function T3(s){return s instanceof ArrayBuffer?s:s.byteOffset==0&&s.byteLength==s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer}function sp(s,e=0,t=1/0){return b3(s,e,t,Uint8Array)}function b3(s,e,t,n){const i=A3(s);let r=1;"BYTES_PER_ELEMENT"in n&&(r=n.BYTES_PER_ELEMENT);const o=w3(s)?s.byteOffset:0,l=(o+s.byteLength)/r,u=(o+e)/r,d=Math.floor(Math.max(0,Math.min(u,l))),h=Math.floor(Math.min(d+Math.max(t,0),l));return new n(i,d,h-d)}function A3(s){return s instanceof ArrayBuffer?s:s.buffer}function w3(s){return s&&s.buffer instanceof ArrayBuffer&&s.byteLength!==void 0&&s.byteOffset!==void 0}function R3(s){const e={key:s.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(s.size<2)return;if(s.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const n=s.data.subarray(1).indexOf(0);if(n===-1)return;const i=Dn(sp(s.data,1,n)),r=s.data[2+n],o=s.data.subarray(3+n).indexOf(0);if(o===-1)return;const l=Dn(sp(s.data,3+n,o));let u;return i==="-->"?u=Dn(sp(s.data,4+n+o)):u=T3(s.data.subarray(4+n+o)),e.mimeType=i,e.pictureType=r,e.description=l,e.data=u,e}function L3(s){if(s.size<2)return;const e=Dn(s.data,!0),t=new Uint8Array(s.data.subarray(e.length+1));return{key:s.type,info:e,data:t.buffer}}function I3(s){if(s.size<2)return;if(s.type==="TXXX"){let t=1;const n=Dn(s.data.subarray(t),!0);t+=n.length+1;const i=Dn(s.data.subarray(t));return{key:s.type,info:n,data:i}}const e=Dn(s.data.subarray(1));return{key:s.type,info:"",data:e}}function _3(s){if(s.type==="WXXX"){if(s.size<2)return;let t=1;const n=Dn(s.data.subarray(t),!0);t+=n.length+1;const i=Dn(s.data.subarray(t));return{key:s.type,info:n,data:i}}const e=Dn(s.data);return{key:s.type,info:"",data:e}}function k3(s){return s.type==="PRIV"?L3(s):s.type[0]==="W"?_3(s):s.type==="APIC"?R3(s):I3(s)}function C3(s){const e=String.fromCharCode(s[0],s[1],s[2],s[3]),t=wd(s,4),n=10;return{type:e,size:t,data:s.subarray(n,n+t)}}const ou=10,P3=10;function Ww(s){let e=0;const t=[];for(;zg(s,e);){const n=wd(s,e+6);s[e+5]>>6&1&&(e+=ou),e+=ou;const i=e+n;for(;e+P3<i;){const r=C3(s.subarray(e)),o=k3(r);o&&t.push(o),e+=r.size+ou}jw(s,e)&&(e+=ou)}return t}function qw(s){return s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp"}function D3(s){if(s.data.byteLength===8){const e=new Uint8Array(s.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}}function qg(s){const e=Ww(s);for(let t=0;t<e.length;t++){const n=e[t];if(qw(n))return D3(n)}}let Cn=(function(s){return s.audioId3="org.id3",s.dateRange="com.apple.quicktime.HLS",s.emsg="https://aomedia.org/emsg/ID3",s.misbklv="urn:misb:KLV:bin:1910.1",s})({});function bs(s="",e=9e4){return{type:s,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Yg{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=zn(this.cachedData,e),this.cachedData=null);let n=vl(e,0),i=n?n.length:0,r;const o=this._audioTrack,l=this._id3Track,u=n?qg(n):void 0,d=e.length;for((this.basePTS===null||this.frameIndex===0&&pe(u))&&(this.basePTS=O3(u,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Cn.audioId3,duration:Number.POSITIVE_INFINITY});i<d;){if(this.canParse(e,i)){const h=this.appendFrame(o,e,i);h?(this.frameIndex++,this.lastPTS=h.sample.pts,i+=h.length,r=i):i=d}else E3(e,i)?(n=vl(e,i),l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Cn.audioId3,duration:Number.POSITIVE_INFINITY}),i+=n.length,r=i):i++;if(i===d&&r!==d){const h=e.slice(r);this.cachedData?this.cachedData=zn(this.cachedData,h):this.cachedData=h}}return{audioTrack:o,videoTrack:bs(),id3Track:l,textTrack:bs()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:bs(),id3Track:this._id3Track,textTrack:bs()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const O3=(s,e,t)=>{if(pe(s))return s*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};let au=null;const N3=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],M3=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],F3=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],B3=[0,1,1,4];function Yw(s,e,t,n,i){if(t+24>e.length)return;const r=Qw(e,t);if(r&&t+r.frameLength<=e.length){const o=r.samplesPerFrame*9e4/r.sampleRate,l=n+i*o,u={unit:e.subarray(t,t+r.frameLength),pts:l,dts:l};return s.config=[],s.channelCount=r.channelCount,s.samplerate=r.sampleRate,s.samples.push(u),{sample:u,length:r.frameLength,missing:0}}}function Qw(s,e){const t=s[e+1]>>3&3,n=s[e+1]>>1&3,i=s[e+2]>>4&15,r=s[e+2]>>2&3;if(t!==1&&i!==0&&i!==15&&r!==3){const o=s[e+2]>>1&1,l=s[e+3]>>6,u=t===3?3-n:n===3?3:4,d=N3[u*14+i-1]*1e3,p=M3[(t===3?0:t===2?1:2)*3+r],m=l===3?1:2,v=F3[t][n],y=B3[n],S=v*8*y,x=Math.floor(v*d/p+o)*y;if(au===null){const L=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);au=L?parseInt(L[1]):0}return!!au&&au<=87&&n===2&&d>=224e3&&l===0&&(s[e+3]=s[e+3]|128),{sampleRate:p,channelCount:m,frameLength:x,samplesPerFrame:S}}}function Qg(s,e){return s[e]===255&&(s[e+1]&224)===224&&(s[e+1]&6)!==0}function Xw(s,e){return e+1<s.length&&Qg(s,e)}function U3(s,e){return Qg(s,e)&&4<=s.length-e}function Jw(s,e){if(e+1<s.length&&Qg(s,e)){const n=Qw(s,e);let i=4;n!=null&&n.frameLength&&(i=n.frameLength);const r=e+i;return r===s.length||Xw(s,r)}return!1}class $3 extends Yg{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const n=vl(e,0);let i=(n==null?void 0:n.length)||0;if(Jw(e,i))return!1;for(let r=e.length;i<r;i++)if(x3(e,i))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return v3(e,t)}appendFrame(e,t,n){Kw(e,this.observer,t,n,e.manifestCodec);const i=zw(e,t,n,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i}}const Zw=(s,e)=>{let t=0,n=5;e+=n;const i=new Uint32Array(1),r=new Uint32Array(1),o=new Uint8Array(1);for(;n>0;){o[0]=s[e];const l=Math.min(n,8),u=8-l;r[0]=4278190080>>>24+u<<u,i[0]=(o[0]&r[0])>>u,t=t?t<<l|i[0]:i[0],e+=1,n-=l}return t};class j3 extends Yg{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const i=eR(e,t,n,this.basePTS,this.frameIndex);if(i!==-1)return{sample:e.samples[e.samples.length-1],length:i,missing:0}}static probe(e){if(!e)return!1;const t=vl(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&qg(t)!==void 0&&Zw(e,n)<16}}function eR(s,e,t,n,i){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const r=e[t+4]>>6;if(r>=3)return-1;const l=[48e3,44100,32e3][r],u=e[t+4]&63,h=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][u*3+r]*2;if(t+h>e.length)return-1;const p=e[t+6]>>5;let m=0;p===2?m+=2:(p&1&&p!==1&&(m+=2),p&4&&(m+=2));const v=(e[t+6]<<8|e[t+7])>>12-m&1,S=[2,1,2,3,3,4,4,5][p]+v,x=e[t+5]>>3,b=e[t+5]&7,w=new Uint8Array([r<<6|x<<1|b>>2,(b&3)<<6|p<<3|v<<2|u>>4,u<<4&224]),L=1536/l*9e4,I=n+i*L,k=e.subarray(t,t+h);return s.config=w,s.channelCount=S,s.samplerate=l,s.samples.push({unit:k,pts:I}),h}class V3 extends Yg{resetInitSegment(e,t,n,i){super.resetInitSegment(e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=vl(e,0);let n=(t==null?void 0:t.length)||0;if(t&&e[n]===11&&e[n+1]===119&&qg(t)!==void 0&&Zw(e,n)<=16)return!1;for(let i=e.length;n<i;n++)if(Jw(e,n))return et.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return U3(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return Yw(e,t,n,this.basePTS,this.frameIndex)}}const G3=/\/emsg[-/]ID3/i;class K3{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,i){const r=this.videoTrack=bs("video",1),o=this.audioTrack=bs("audio",1),l=this.txtTrack=bs("text",1);if(this.id3Track=bs("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const u=uw(e);if(u.video){const{id:d,timescale:h,codec:p,supplemental:m}=u.video;r.id=d,r.timescale=l.timescale=h,r.codec=p,r.supplemental=m}if(u.audio){const{id:d,timescale:h,codec:p}=u.audio;o.id=d,o.timescale=h,o.codec=p}l.id=aw.text,r.sampleDuration=0,r.duration=o.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return jU(e)}demux(e,t){this.timeOffset=t;let n=e;const i=this.videoTrack,r=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=zn(this.remainderData,e));const l=qU(n);this.remainderData=l.remainder,i.samples=l.valid||new Uint8Array}else i.samples=n;const o=this.extractID3Track(i,t);return r.samples=LE(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return n.samples=LE(e,t),{videoTrack:t,audioTrack:bs(),id3Track:i,textTrack:bs()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const i=je(e.samples,["emsg"]);i&&i.forEach(r=>{const o=QU(r);if(G3.test(o.schemeIdUri)){const l=uT(o,t);let u=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;u<=.001&&(u=Number.POSITIVE_INFINITY);const d=o.payload;n.samples.push({data:d,len:d.byteLength,dts:l,pts:l,type:Cn.emsg,duration:u})}else if(this.config.enableEmsgKLVMetadata&&o.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const l=uT(o,t);n.samples.push({data:o.payload,len:o.payload.byteLength,dts:l,pts:l,type:Cn.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function uT(s,e){return pe(s.presentationTime)?s.presentationTime/s.timeScale:e+s.presentationTimeDelta/s.timeScale}class H3{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new $g(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Vi.cbc)}decryptAacSample(e,t,n){const i=e[t].unit;if(i.length<=16)return;const r=i.subarray(16,i.length-i.length%16),o=r.buffer.slice(r.byteOffset,r.byteOffset+r.length);this.decryptBuffer(o).then(l=>{const u=new Uint8Array(l);i.set(u,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)}).catch(n)}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)n.set(e.subarray(r,r+16),i);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let i=0;for(let r=32;r<e.length-16;r+=160,i+=16)e.set(n.subarray(i,i+16),r);return e}decryptAvcSample(e,t,n,i,r){const o=fw(r.data),l=this.getAvcEncryptedData(o);this.decryptBuffer(l.buffer).then(u=>{r.data=this.getAvcDecryptedUnit(o,u),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,i)}).catch(i)}decryptAvcSamples(e,t,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){i();return}const r=e[t].units;for(;!(n>=r.length);n++){const o=r[n];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,n,i,o),!this.decrypter.isSync()))return}}}}class tR{constructor(){this.VideoSample=null}createVideoSample(e,t,n){return{key:e,frame:!1,pts:t,dts:n,units:[],length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,i;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const r=n.units;i=r[r.length-1]}return i}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,i=n.length;if(i){const r=n[i-1];e.pts=r.pts,e.dts=r.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,n){const i=t.byteLength;let r=e.naluState||0;const o=r,l=[];let u=0,d,h,p,m=-1,v=0;for(r===-1&&(m=0,v=this.getNALuType(t,0),r=0,u=1);u<i;){if(d=t[u++],!r){r=d?0:1;continue}if(r===1){r=d?0:2;continue}if(!d)r=3;else if(d===1){if(h=u-r-1,m>=0){const y={data:t.subarray(m,h),type:v};l.push(y)}else{const y=this.getLastNalUnit(e.samples);y&&(o&&u<=4-o&&y.state&&(y.data=y.data.subarray(0,y.data.byteLength-o)),h>0&&(y.data=zn(y.data,t.subarray(0,h)),y.state=0))}u<i?(p=this.getNALuType(t,u),m=u,v=p,r=0):r=-1}else r=0}if(m>=0&&r>=0){const y={data:t.subarray(m,i),type:v,state:r};l.push(y)}if(l.length===0){const y=this.getLastNalUnit(e.samples);y&&(y.data=zn(y.data,t))}return e.naluState=r,l}}class il{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,i=new Uint8Array(4),r=Math.min(4,t);if(r===0)throw new Error("no bytes available");i.set(e.subarray(n,n+r)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=r*8,this.bytesAvailable-=r}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&et.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class z3 extends tR{parsePES(e,t,n,i){const r=this.parseNALu(e,n.data,i);let o=this.VideoSample,l,u=!1;n.data=null,o&&r.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach(d=>{var h,p;switch(d.type){case 1:{let S=!1;l=!0;const x=d.data;if(u&&x.length>4){const b=this.readSliceType(x);(b===2||b===4||b===7||b===9)&&(S=!0)}if(S){var m;(m=o)!=null&&m.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.frame=!0,o.key=S;break}case 5:l=!0,(h=o)!=null&&h.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.key=!0,o.frame=!0;break;case 6:{l=!0,Mg(d.data,1,n.pts,t.samples);break}case 7:{var v,y;l=!0,u=!0;const S=d.data,x=this.readSPS(S);if(!e.sps||e.width!==x.width||e.height!==x.height||((v=e.pixelRatio)==null?void 0:v[0])!==x.pixelRatio[0]||((y=e.pixelRatio)==null?void 0:y[1])!==x.pixelRatio[1]){e.width=x.width,e.height=x.height,e.pixelRatio=x.pixelRatio,e.sps=[S];const b=S.subarray(1,4);let w="avc1.";for(let L=0;L<3;L++){let I=b[L].toString(16);I.length<2&&(I="0"+I),w+=I}e.codec=w}break}case 8:l=!0,e.pps=[d.data];break;case 9:l=!0,e.audFound=!0,(p=o)!=null&&p.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:l=!0;break;default:l=!1;break}o&&l&&o.units.push(d)}),i&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new il(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let n=8,i=8,r;for(let o=0;o<e;o++)i!==0&&(r=t.readEG(),i=(n+r+256)%256),n=i===0?n:i}readSPS(e){const t=new il(e);let n=0,i=0,r=0,o=0,l,u,d;const h=t.readUByte.bind(t),p=t.readBits.bind(t),m=t.readUEG.bind(t),v=t.readBoolean.bind(t),y=t.skipBits.bind(t),S=t.skipEG.bind(t),x=t.skipUEG.bind(t),b=this.skipScalingList.bind(this);h();const w=h();if(p(5),y(3),h(),x(),w===100||w===110||w===122||w===244||w===44||w===83||w===86||w===118||w===128){const C=m();if(C===3&&y(1),x(),x(),y(1),v())for(u=C!==3?8:12,d=0;d<u;d++)v()&&(d<6?b(16,t):b(64,t))}x();const L=m();if(L===0)m();else if(L===1)for(y(1),S(),S(),l=m(),d=0;d<l;d++)S();x(),y(1);const I=m(),k=m(),M=p(1);M===0&&y(1),y(1),v()&&(n=m(),i=m(),r=m(),o=m());let P=[1,1];if(v()&&v())switch(h()){case 1:P=[1,1];break;case 2:P=[12,11];break;case 3:P=[10,11];break;case 4:P=[16,11];break;case 5:P=[40,33];break;case 6:P=[24,11];break;case 7:P=[20,11];break;case 8:P=[32,11];break;case 9:P=[80,33];break;case 10:P=[18,11];break;case 11:P=[15,11];break;case 12:P=[64,33];break;case 13:P=[160,99];break;case 14:P=[4,3];break;case 15:P=[3,2];break;case 16:P=[2,1];break;case 255:{P=[h()<<8|h(),h()<<8|h()];break}}return{width:Math.ceil((I+1)*16-n*2-i*2),height:(2-M)*(k+1)*16-(M?2:4)*(r+o),pixelRatio:P}}}class W3 extends tR{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,n,i){const r=this.parseNALu(e,n.data,i);let o=this.VideoSample,l,u=!1;n.data=null,o&&r.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),r.forEach(d=>{var h,p;switch(d.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:o||(o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),o.frame=!0,l=!0;break;case 16:case 17:case 18:case 21:if(l=!0,u){var m;(m=o)!=null&&m.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.key=!0,o.frame=!0;break;case 19:case 20:l=!0,(h=o)!=null&&h.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.key=!0,o.frame=!0;break;case 39:l=!0,Mg(d.data,2,n.pts,t.samples);break;case 32:l=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=tt(e.params,this.readVPS(d.data)),this.initVPS=d.data),e.vps=[d.data];break;case 33:if(l=!0,u=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],d.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const v=this.readSPS(d.data);e.width=v.width,e.height=v.height,e.pixelRatio=v.pixelRatio,e.codec=v.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const y in v.params)e.params[y]=v.params[y]}this.pushParameterSet(e.sps,d.data,e.vps),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),o.key=!0;break;case 34:if(l=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const v=this.readPPS(d.data);for(const y in v)e.params[y]=v[y]}this.pushParameterSet(e.pps,d.data,e.vps)}break;case 35:l=!0,e.audFound=!0,(p=o)!=null&&p.frame&&(this.pushAccessUnit(o,e),o=null),o||(o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:l=!1;break}o&&l&&o.units.push(d)}),i&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}pushParameterSet(e,t,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let n=0;for(let i=0;i<e.byteLength;i++)i>=2&&e[i]===3&&e[i-1]===0&&e[i-2]===0||(t[n]=e[i],n++);return new Uint8Array(t.buffer,0,n)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new il(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const n=t.readBits(3),i=t.readBoolean();return{numTemporalLayers:n+1,temporalIdNested:i}}readSPS(e){const t=new il(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const n=t.readBits(3);t.readBoolean();const i=t.readBits(2),r=t.readBoolean(),o=t.readBits(5),l=t.readUByte(),u=t.readUByte(),d=t.readUByte(),h=t.readUByte(),p=t.readUByte(),m=t.readUByte(),v=t.readUByte(),y=t.readUByte(),S=t.readUByte(),x=t.readUByte(),b=t.readUByte(),w=[],L=[];for(let Ue=0;Ue<n;Ue++)w.push(t.readBoolean()),L.push(t.readBoolean());if(n>0)for(let Ue=n;Ue<8;Ue++)t.readBits(2);for(let Ue=0;Ue<n;Ue++)w[Ue]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),L[Ue]&&t.readUByte();t.readUEG();const I=t.readUEG();I==3&&t.skipBits(1);const k=t.readUEG(),M=t.readUEG(),P=t.readBoolean();let C=0,U=0,O=0,W=0;P&&(C+=t.readUEG(),U+=t.readUEG(),O+=t.readUEG(),W+=t.readUEG());const ne=t.readUEG(),oe=t.readUEG(),se=t.readUEG(),re=t.readBoolean();for(let Ue=re?0:n;Ue<=n;Ue++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let At=0;At<4;At++)for(let sn=0;sn<(At===3?2:6);sn++)if(!t.readBoolean())t.readUEG();else{const Ut=Math.min(64,1<<4+(At<<1));At>1&&t.readEG();for(let bn=0;bn<Ut;bn++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const F=t.readUEG();let ee=0;for(let Ue=0;Ue<F;Ue++){let At=!1;if(Ue!==0&&(At=t.readBoolean()),At){Ue===F&&t.readUEG(),t.readBoolean(),t.readUEG();let sn=0;for(let qn=0;qn<=ee;qn++){const Ut=t.readBoolean();let bn=!1;Ut||(bn=t.readBoolean()),(Ut||bn)&&sn++}ee=sn}else{const sn=t.readUEG(),qn=t.readUEG();ee=sn+qn;for(let Ut=0;Ut<sn;Ut++)t.readUEG(),t.readBoolean();for(let Ut=0;Ut<qn;Ut++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const Ue=t.readUEG();for(let At=0;At<Ue;At++){for(let sn=0;sn<se+4;sn++)t.readBits(1);t.readBits(1)}}let D=0,j=1,ie=1,ce=!0,de=1,fe=0;t.readBoolean(),t.readBoolean();let ve=!1;if(t.readBoolean()){if(t.readBoolean()){const Yn=t.readUByte(),Yo=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],Hi=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Yn>0&&Yn<16?(j=Yo[Yn-1],ie=Hi[Yn-1]):Yn===255&&(j=t.readBits(16),ie=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),ve=t.readBoolean(),ve&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(de=t.readBits(32),fe=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const Hi=t.readBoolean(),Qo=t.readBoolean();let Zs=!1;(Hi||Qo)&&(Zs=t.readBoolean(),Zs&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),Zs&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let Dr=0;Dr<=n;Dr++){ce=t.readBoolean();const Or=ce||t.readBoolean();let Xo=!1;Or?t.readEG():Xo=t.readBoolean();const ei=Xo?1:t.readUEG()+1;if(Hi)for(let Qn=0;Qn<ei;Qn++)t.readUEG(),t.readUEG(),Zs&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Qo)for(let Qn=0;Qn<ei;Qn++)t.readUEG(),t.readUEG(),Zs&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),D=t.readUEG())}let Me=k,Qe=M;if(P){let Ue=1,At=1;I===1?Ue=At=2:I==2&&(Ue=2),Me=k-Ue*U-Ue*C,Qe=M-At*W-At*O}const Lt=i?["A","B","C"][i]:"",xe=l<<24|u<<16|d<<8|h;let We=0;for(let Ue=0;Ue<32;Ue++)We=(We|(xe>>Ue&1)<<31-Ue)>>>0;let Bt=We.toString(16);return o===1&&Bt==="2"&&(Bt="6"),{codecString:`hvc1.${Lt}${o}.${Bt}.${r?"H":"L"}${b}.B0`,params:{general_tier_flag:r,general_profile_idc:o,general_profile_space:i,general_profile_compatibility_flags:[l,u,d,h],general_constraint_indicator_flags:[p,m,v,y,S,x],general_level_idc:b,bit_depth:ne+8,bit_depth_luma_minus8:ne,bit_depth_chroma_minus8:oe,min_spatial_segmentation_idc:D,chroma_format_idc:I,frame_rate:{fixed:ce,fps:fe/de}},width:Me,height:Qe,pixelRatio:[j,ie]}}readPPS(e){const t=new il(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const i=t.readBoolean(),r=t.readBoolean();let o=1;return r&&i?o=0:r?o=3:i&&(o=2),{parallelismType:o}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Mt=188;class Ri{constructor(e,t,n,i){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=i,this.videoParser=null}static probe(e,t){const n=Ri.syncOffset(e);return n>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(e){const t=e.length;let n=Math.min(Mt*5,t-Mt)+1,i=0;for(;i<n;){let r=!1,o=-1,l=0;for(let u=i;u<t;u+=Mt)if(e[u]===71&&(t-u===Mt||e[u+Mt]===71)){if(l++,o===-1&&(o=u,o!==0&&(n=Math.min(o+Mt*99,e.length-Mt)+1)),r||(r=Am(e,u)===0),r&&l>1&&(o===0&&l>2||u+Mt>n))return o}else{if(l)return-1;break}i++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:aw[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Ri.createTrack("video"),this._videoTrack.duration=i,this._audioTrack=Ri.createTrack("audio",i),this._id3Track=Ri.createTrack("id3"),this._txtTrack=Ri.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,i=!1){n||(this.sampleAes=null);let r;const o=this._videoTrack,l=this._audioTrack,u=this._id3Track,d=this._txtTrack;let h=o.pid,p=o.pesData,m=l.pid,v=u.pid,y=l.pesData,S=u.pesData,x=null,b=this.pmtParsed,w=this._pmtId,L=e.length;if(this.remainderData&&(e=zn(this.remainderData,e),L=e.length,this.remainderData=null),L<Mt&&!i)return this.remainderData=e,{audioTrack:l,videoTrack:o,id3Track:u,textTrack:d};const I=Math.max(0,Ri.syncOffset(e));L-=(L-I)%Mt,L<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,L,e.buffer.byteLength-L));let k=0;for(let P=I;P<L;P+=Mt)if(e[P]===71){const C=!!(e[P+1]&64),U=Am(e,P),O=(e[P+3]&48)>>4;let W;if(O>1){if(W=P+5+e[P+4],W===P+Mt)continue}else W=P+4;switch(U){case h:C&&(p&&(r=uo(p,this.logger))&&(this.readyVideoParser(o.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(o,d,r,!1)),p={data:[],size:0}),p&&(p.data.push(e.subarray(W,P+Mt)),p.size+=P+Mt-W);break;case m:if(C){if(y&&(r=uo(y,this.logger)))switch(l.segmentCodec){case"aac":this.parseAACPES(l,r);break;case"mp3":this.parseMPEGPES(l,r);break;case"ac3":this.parseAC3PES(l,r);break}y={data:[],size:0}}y&&(y.data.push(e.subarray(W,P+Mt)),y.size+=P+Mt-W);break;case v:C&&(S&&(r=uo(S,this.logger))&&this.parseID3PES(u,r),S={data:[],size:0}),S&&(S.data.push(e.subarray(W,P+Mt)),S.size+=P+Mt-W);break;case 0:C&&(W+=e[W]+1),w=this._pmtId=q3(e,W);break;case w:{C&&(W+=e[W]+1);const ne=Y3(e,W,this.typeSupported,n,this.observer,this.logger);h=ne.videoPid,h>0&&(o.pid=h,o.segmentCodec=ne.segmentVideoCodec),m=ne.audioPid,m>0&&(l.pid=m,l.segmentCodec=ne.segmentAudioCodec),v=ne.id3Pid,v>0&&(u.pid=v),x!==null&&!b&&(this.logger.warn(`MPEG-TS PMT found at ${P} after unknown PID '${x}'. Backtracking to sync byte @${I} to parse all TS packets.`),x=null,P=I-188),b=this.pmtParsed=!0;break}case 17:case 8191:break;default:x=U;break}}else k++;k>0&&wm(this.observer,new Error(`Found ${k} TS packet/s that do not start with 0x47`),void 0,this.logger),o.pesData=p,l.pesData=y,u.pesData=S;const M={audioTrack:l,videoTrack:o,id3Track:u,textTrack:d};return i&&this.extractRemainingSamples(M),M}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:i,textTrack:r}=e,o=n.pesData,l=t.pesData,u=i.pesData;let d;if(o&&(d=uo(o,this.logger))?(this.readyVideoParser(n.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(n,r,d,!0),n.pesData=null)):n.pesData=o,l&&(d=uo(l,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,d);break;case"mp3":this.parseMPEGPES(t,d);break;case"ac3":this.parseAC3PES(t,d);break}t.pesData=null}else l!=null&&l.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=l;u&&(d=uo(u,this.logger))?(this.parseID3PES(i,d),i.pesData=null):i.pesData=u}demuxSampleAes(e,t,n){const i=this.demux(e,n,!0,!this.config.progressive),r=this.sampleAes=new H3(this.observer,this.config,t);return this.decrypt(i,r)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new z3:e==="hevc"&&(this.videoParser=new W3))}decrypt(e,t){return new Promise(n=>{const{audioTrack:i,videoTrack:r}=e;i.samples&&i.segmentCodec==="aac"?t.decryptAacSamples(i.samples,0,()=>{r.samples?t.decryptAvcSamples(r.samples,0,0,()=>{n(e)}):n(e)}):r.samples&&t.decryptAvcSamples(r.samples,0,0,()=>{n(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let n=0;const i=this.aacOverFlow;let r=t.data;if(i){this.aacOverFlow=null;const p=i.missing,m=i.sample.unit.byteLength;if(p===-1)r=zn(i.sample.unit,r);else{const v=m-p;i.sample.unit.set(r.subarray(0,p),v),e.samples.push(i.sample),n=i.missing}}let o,l;for(o=n,l=r.length;o<l-1&&!id(r,o);o++);if(o!==n){let p;const m=o<l-1;if(m?p=`AAC PES did not start with ADTS header,offset:${o}`:p="No ADTS header found in AAC PES",wm(this.observer,new Error(p),m,this.logger),!m)return}Kw(e,this.observer,r,o,this.audioCodec);let u;if(t.pts!==void 0)u=t.pts;else if(i){const p=Hw(e.samplerate);u=i.sample.pts+p}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let d=0,h;for(;o<l;)if(h=zw(e,r,o,u,d),o+=h.length,h.missing){this.aacOverFlow=h;break}else for(d++;o<l-1&&!id(r,o);o++);}parseMPEGPES(e,t){const n=t.data,i=n.length;let r=0,o=0;const l=t.pts;if(l===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<i;)if(Xw(n,o)){const u=Yw(e,n,o,l,r);if(u)o+=u.length,r++;else break}else o++}parseAC3PES(e,t){{const n=t.data,i=t.pts;if(i===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const r=n.length;let o=0,l=0,u;for(;l<r&&(u=eR(e,n,l,i,o++))>0;)l+=u}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=tt({},t,{type:this._videoTrack?Cn.emsg:Cn.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function Am(s,e){return((s[e+1]&31)<<8)+s[e+2]}function q3(s,e){return(s[e+10]&31)<<8|s[e+11]}function Y3(s,e,t,n,i,r){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},l=(s[e+1]&15)<<8|s[e+2],u=e+3+l-4,d=(s[e+10]&15)<<8|s[e+11];for(e+=12+d;e<u;){const h=Am(s,e),p=(s[e+3]&15)<<8|s[e+4];switch(s[e]){case 207:if(!n){ip("ADTS AAC",r);break}case 15:o.audioPid===-1&&(o.audioPid=h);break;case 21:o.id3Pid===-1&&(o.id3Pid=h);break;case 219:if(!n){ip("H.264",r);break}case 27:o.videoPid===-1&&(o.videoPid=h);break;case 3:case 4:!t.mpeg&&!t.mp3?r.log("MPEG audio found, not supported in this browser"):o.audioPid===-1&&(o.audioPid=h,o.segmentAudioCodec="mp3");break;case 193:if(!n){ip("AC-3",r);break}case 129:t.ac3?o.audioPid===-1&&(o.audioPid=h,o.segmentAudioCodec="ac3"):r.log("AC-3 audio found, not supported in this browser");break;case 6:if(o.audioPid===-1&&p>0){let m=e+5,v=p;for(;v>2;){switch(s[m]){case 106:t.ac3!==!0?r.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=h,o.segmentAudioCodec="ac3");break}const S=s[m+1]+2;m+=S,v-=S}}break;case 194:case 135:return wm(i,new Error("Unsupported EC-3 in M2TS found"),void 0,r),o;case 36:o.videoPid===-1&&(o.videoPid=h,o.segmentVideoCodec="hevc",r.log("HEVC in M2TS found"));break}e+=p+5}return o}function wm(s,e,t,n){n.warn(`parsing error: ${e.message}`),s.emit(R.ERROR,R.ERROR,{type:Re.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function ip(s,e){e.log(`${s} with AES-128-CBC encryption found in unencrypted stream`)}function uo(s,e){let t=0,n,i,r,o,l;const u=s.data;if(!s||s.size===0)return null;for(;u[0].length<19&&u.length>1;)u[0]=zn(u[0],u[1]),u.splice(1,1);if(n=u[0],(n[0]<<16)+(n[1]<<8)+n[2]===1){if(i=(n[4]<<8)+n[5],i&&i>s.size-6)return null;const h=n[7];h&192&&(o=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,h&64?(l=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,o-l>60*9e4&&(e.warn(`${Math.round((o-l)/9e4)}s delta between PTS and DTS, align them`),o=l)):l=o),r=n[8];let p=r+9;if(s.size<=p)return null;s.size-=p;const m=new Uint8Array(s.size);for(let v=0,y=u.length;v<y;v++){n=u[v];let S=n.byteLength;if(p)if(p>S){p-=S;continue}else n=n.subarray(p),S-=p,p=0;m.set(n,t),t+=S}return i&&(i-=r+3),{data:m,pts:o,dts:l,len:i}}return null}class Q3{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Ei=Math.pow(2,32)-1;class K{static init(){K.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in K.types)K.types.hasOwnProperty(e)&&(K.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);K.HDLR_TYPES={video:t,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),r=new Uint8Array([0,0,0,0,0,0,0,0]);K.STTS=K.STSC=K.STCO=r,K.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),K.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),K.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),K.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),l=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);K.FTYP=K.box(K.types.ftyp,o,u,o,l),K.DINF=K.box(K.types.dinf,K.box(K.types.dref,i))}static box(e,...t){let n=8,i=t.length;const r=i;for(;i--;)n+=t[i].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=n&255,o.set(e,4),i=0,n=8;i<r;i++)o.set(t[i],n),n+=t[i].byteLength;return o}static hdlr(e){return K.box(K.types.hdlr,K.HDLR_TYPES[e])}static mdat(e){return K.box(K.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(Ei+1)),i=Math.floor(t%(Ei+1));return K.box(K.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))}static mdia(e){return K.box(K.types.mdia,K.mdhd(e.timescale||0,e.duration||0),K.hdlr(e.type),K.minf(e))}static mfhd(e){return K.box(K.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?K.box(K.types.minf,K.box(K.types.smhd,K.SMHD),K.DINF,K.stbl(e)):K.box(K.types.minf,K.box(K.types.vmhd,K.VMHD),K.DINF,K.stbl(e))}static moof(e,t,n){return K.box(K.types.moof,K.mfhd(e),K.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=K.trak(e[t]);return K.box.apply(null,[K.types.moov,K.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(K.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=K.trex(e[t]);return K.box.apply(null,[K.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(Ei+1)),i=Math.floor(t%(Ei+1)),r=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return K.box(K.types.mvhd,r)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let i,r;for(i=0;i<t.length;i++)r=t[i].flags,n[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return K.box(K.types.sdtp,n)}static stbl(e){return K.box(K.types.stbl,K.stsd(e),K.box(K.types.stts,K.STTS),K.box(K.types.stsc,K.STSC),K.box(K.types.stsz,K.STSZ),K.box(K.types.stco,K.STCO))}static avc1(e){let t=[],n=[],i,r,o;for(i=0;i<e.sps.length;i++)r=e.sps[i],o=r.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(r));for(i=0;i<e.pps.length;i++)r=e.pps[i],o=r.byteLength,n.push(o>>>8&255),n.push(o&255),n=n.concat(Array.prototype.slice.call(r));const l=K.box(K.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),u=e.width,d=e.height,h=e.pixelRatio[0],p=e.pixelRatio[1];return K.box(K.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,u&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,K.box(K.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),K.box(K.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,h&255,p>>24,p>>16&255,p>>8&255,p&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return K.box(K.types.mp4a,K.audioStsd(e),K.box(K.types.esds,K.esds(e)))}static mp3(e){return K.box(K.types[".mp3"],K.audioStsd(e))}static ac3(e){return K.box(K.types["ac-3"],K.audioStsd(e),K.box(K.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return K.box(K.types.stsd,K.STSD,K.mp4a(e));if(t==="ac3"&&e.config)return K.box(K.types.stsd,K.STSD,K.ac3(e));if(t==="mp3"&&e.codec==="mp3")return K.box(K.types.stsd,K.STSD,K.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return K.box(K.types.stsd,K.STSD,K.avc1(e));if(t==="hevc"&&e.vps)return K.box(K.types.stsd,K.STSD,K.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,n=(e.duration||0)*(e.timescale||0),i=e.width||0,r=e.height||0,o=Math.floor(n/(Ei+1)),l=Math.floor(n%(Ei+1));return K.box(K.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,l>>24,l>>16&255,l>>8&255,l&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,r>>8&255,r&255,0,0]))}static traf(e,t){const n=K.sdtp(e),i=e.id,r=Math.floor(t/(Ei+1)),o=Math.floor(t%(Ei+1));return K.box(K.types.traf,K.box(K.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),K.box(K.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,r&255,o>>24,o>>16&255,o>>8&255,o&255])),K.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,K.box(K.types.trak,K.tkhd(e),K.mdia(e))}static trex(e){const t=e.id;return K.box(K.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],i=n.length,r=12+16*i,o=new Uint8Array(r);let l,u,d,h,p,m;for(t+=8+r,o.set([e.type==="video"?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),l=0;l<i;l++)u=n[l],d=u.duration,h=u.size,p=u.flags,m=u.cts,o.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,p.isLeading<<2|p.dependsOn,p.isDependedOn<<6|p.hasRedundancy<<4|p.paddingValue<<1|p.isNonSync,p.degradPrio&61440,p.degradPrio&15,m>>>24&255,m>>>16&255,m>>>8&255,m&255],12+16*l);return K.box(K.types.trun,o)}static initSegment(e){K.types||K.init();const t=K.moov(e);return zn(K.FTYP,t)}static hvc1(e){const t=e.params,n=[e.vps,e.sps,e.pps],i=4,r=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),i-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]);let o=r.length;for(let y=0;y<n.length;y+=1){o+=3;for(let S=0;S<n[y].length;S+=1)o+=2+n[y][S].length}const l=new Uint8Array(o);l.set(r,0),o=r.length;const u=n.length-1;for(let y=0;y<n.length;y+=1){l.set(new Uint8Array([32+y|(y===u?128:0),0,n[y].length]),o),o+=3;for(let S=0;S<n[y].length;S+=1)l.set(new Uint8Array([n[y][S].length>>8,n[y][S].length&255]),o),o+=2,l.set(n[y][S],o),o+=n[y][S].length}const d=K.box(K.types.hvcC,l),h=e.width,p=e.height,m=e.pixelRatio[0],v=e.pixelRatio[1];return K.box(K.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,h&255,p>>8&255,p&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,K.box(K.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),K.box(K.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,v>>24,v>>16&255,v>>8&255,v&255])))}}K.types=void 0;K.HDLR_TYPES=void 0;K.STTS=void 0;K.STSC=void 0;K.STCO=void 0;K.STSZ=void 0;K.VMHD=void 0;K.SMHD=void 0;K.STSD=void 0;K.FTYP=void 0;K.DINF=void 0;const nR=9e4;function Xg(s,e,t=1,n=!1){const i=s*e*t;return n?Math.round(i):i}function X3(s,e,t=1,n=!1){return Xg(s,e,1/t,n)}function Va(s,e=!1){return Xg(s,1e3,1/nR,e)}function J3(s,e=1){return Xg(s,nR,1/e)}function dT(s){const{baseTime:e,timescale:t,trackId:n}=s;return`${e/t} (${e}/${t}) trackId: ${n}`}const Z3=10*1e3,e4=1024,t4=1152,n4=1536;let ho=null,rp=null;function hT(s,e,t,n){return{duration:e,size:t,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:s?2:1,isNonSync:s?0:1}}}class Du extends Wn{constructor(e,t,n,i){if(super("mp4-remuxer",i),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,ho===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);ho=o?parseInt(o[1]):0}if(rp===null){const r=navigator.userAgent.match(/Safari\/(\d+)/i);rp=r?parseInt(r[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const t=this._initPTS;(!t||!e||e.trackId!==t.trackId||e.baseTime!==t.baseTime||e.timescale!==t.timescale)&&this.log(`Reset initPTS: ${t&&dT(t)} > ${e&&dT(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,i=e.reduce((r,o)=>{let l=o.pts,u=l-r;return u<-4294967296&&(t=!0,l=kn(l,n),u=l-r),u>0?r:l},n);return t&&this.debug("PTS rollover detected"),i}remux(e,t,n,i,r,o,l,u){let d,h,p,m,v,y,S=r,x=r;const b=e.pid>-1,w=t.pid>-1,L=t.samples.length,I=e.samples.length>0,k=l&&L>0||L>1;if((!b||I)&&(!w||k)||this.ISGenerated||l){if(this.ISGenerated){var P,C,U,O;const se=this.videoTrackConfig;(se&&(t.width!==se.width||t.height!==se.height||((P=t.pixelRatio)==null?void 0:P[0])!==((C=se.pixelRatio)==null?void 0:C[0])||((U=t.pixelRatio)==null?void 0:U[1])!==((O=se.pixelRatio)==null?void 0:O[1]))||!se&&k||this.nextAudioTs===null&&I)&&this.resetInitSegment()}this.ISGenerated||(p=this.generateIS(e,t,r,o));const W=this.isVideoContiguous;let ne=-1,oe;if(k&&(ne=s4(t.samples),!W&&this.config.forceKeyFrameOnDiscontinuity))if(y=!0,ne>0){this.warn(`Dropped ${ne} out of ${L} video samples due to a missing keyframe`);const se=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(ne),t.dropped+=ne,x+=(t.samples[0].pts-se)/t.inputTimeScale,oe=x}else ne===-1&&(this.warn(`No keyframe found out of ${L} video samples`),y=!1);if(this.ISGenerated){if(I&&k){const se=this.getVideoStartPts(t.samples),X=(kn(e.samples[0].pts,se)-se)/t.inputTimeScale;S+=Math.max(0,X),x+=Math.max(0,-X)}if(I){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),p=this.generateIS(e,t,r,o)),h=this.remuxAudio(e,S,this.isAudioContiguous,o,w||k||u===ye.AUDIO?x:void 0),k){const se=h?h.endPTS-h.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),p=this.generateIS(e,t,r,o)),d=this.remuxVideo(t,x,W,se)}}else k&&(d=this.remuxVideo(t,x,W,0));d&&(d.firstKeyFrame=ne,d.independent=ne!==-1,d.firstKeyFramePTS=oe)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(v=sR(n,r,this._initPTS,this._initDTS)),i.samples.length&&(m=iR(i,r,this._initPTS))),{audio:h,video:d,initSegment:p,independent:y,text:m,id3:v}}computeInitPts(e,t,n,i){const r=Math.round(n*t);let o=kn(e,r);if(o<r+t)for(this.log(`Adjusting PTS for rollover in timeline near ${(r-o)/t} ${i}`);o<r+t;)o+=8589934592;return o-r}generateIS(e,t,n,i){const r=e.samples,o=t.samples,l=this.typeSupported,u={},d=this._initPTS;let h=!d||i,p="audio/mp4",m,v,y,S=-1;if(h&&(m=v=1/0),e.config&&r.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":l.mpeg?(p="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}u.audio={id:"audio",container:p,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&l.mpeg?new Uint8Array(0):K.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(S=e.id,y=e.inputTimeScale,!d||y!==d.timescale?m=v=this.computeInitPts(r[0].pts,y,n,"audio"):h=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,u.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:K.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(S=t.id,y=t.inputTimeScale,!d||y!==d.timescale){const x=this.getVideoStartPts(o),b=kn(o[0].dts,x),w=this.computeInitPts(b,y,n,"video"),L=this.computeInitPts(x,y,n,"video");v=Math.min(v,w),m=Math.min(m,L)}else h=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(u).length)return this.ISGenerated=!0,h?(d&&this.warn(`Timestamps at playlist time: ${i?"":"~"}${n} ${m/y} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${n} offset: ${m/y} (${m}/${y}) trackId: ${S}`),this._initPTS={baseTime:m,timescale:y,trackId:S},this._initDTS={baseTime:v,timescale:y,trackId:S}):m=y=void 0,{tracks:u,initPTS:m,timescale:y,trackId:S}}remuxVideo(e,t,n,i){const r=e.inputTimeScale,o=e.samples,l=[],u=o.length,d=this._initPTS,h=d.baseTime*r/d.timescale;let p=this.nextVideoTs,m=8,v=this.videoSampleDuration,y,S,x=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,w=!1;if(!n||p===null){const D=h+t*r,j=o[0].pts-kn(o[0].dts,o[0].pts);ho&&p!==null&&Math.abs(D-j-(p+h))<15e3?n=!0:p=D-j-h}const L=p+h;for(let D=0;D<u;D++){const j=o[D];j.pts=kn(j.pts,L),j.dts=kn(j.dts,L),j.dts<o[D>0?D-1:D].dts&&(w=!0)}w&&o.sort(function(D,j){const ie=D.dts-j.dts,ce=D.pts-j.pts;return ie||ce}),y=o[0].dts,S=o[o.length-1].dts;const I=S-y,k=I?Math.round(I/(u-1)):v||e.inputTimeScale/30;if(n){const D=y-L,j=D>k,ie=D<-1;if((j||ie)&&(j?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Va(D,!0)} ms (${D}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Va(-D,!0)} ms (${D}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!ie||L>=o[0].pts||ho)){y=L;const ce=o[0].pts-D;if(j)o[0].dts=y,o[0].pts=ce;else{let de=!0;for(let fe=0;fe<o.length&&!(o[fe].dts>ce&&de);fe++){const ve=o[fe].pts;if(o[fe].dts-=D,o[fe].pts-=D,fe<o.length-1){const Ie=o[fe+1].pts,Me=o[fe].pts,Qe=Ie<=Me,Lt=Ie<=ve;de=Qe==Lt}}}this.log(`Video: Initial PTS/DTS adjusted: ${Va(ce,!0)}/${Va(y,!0)}, delta: ${Va(D,!0)} ms`)}}y=Math.max(0,y);let M=0,P=0,C=y;for(let D=0;D<u;D++){const j=o[D],ie=j.units,ce=ie.length;let de=0;for(let fe=0;fe<ce;fe++)de+=ie[fe].data.length;P+=de,M+=ce,j.length=de,j.dts<C?(j.dts=C,C+=k/4|0||1):C=j.dts,x=Math.min(j.pts,x),b=Math.max(j.pts,b)}S=o[u-1].dts;const U=P+4*M+8;let O;try{O=new Uint8Array(U)}catch(D){this.observer.emit(R.ERROR,R.ERROR,{type:Re.MUX_ERROR,details:H.REMUX_ALLOC_ERROR,fatal:!1,error:D,bytes:U,reason:`fail allocating video mdat ${U}`});return}const W=new DataView(O.buffer);W.setUint32(0,U),O.set(K.types.mdat,4);let ne=!1,oe=Number.POSITIVE_INFINITY,se=Number.POSITIVE_INFINITY,re=Number.NEGATIVE_INFINITY,X=Number.NEGATIVE_INFINITY;for(let D=0;D<u;D++){const j=o[D],ie=j.units;let ce=0;for(let ve=0,Ie=ie.length;ve<Ie;ve++){const Me=ie[ve],Qe=Me.data,Lt=Me.data.byteLength;W.setUint32(m,Lt),m+=4,O.set(Qe,m),m+=Lt,ce+=4+Lt}let de;if(D<u-1)v=o[D+1].dts-j.dts,de=o[D+1].pts-j.pts;else{const ve=this.config,Ie=D>0?j.dts-o[D-1].dts:k;if(de=D>0?j.pts-o[D-1].pts:k,ve.stretchShortVideoTrack&&this.nextAudioTs!==null){const Me=Math.floor(ve.maxBufferHole*r),Qe=(i?x+i*r:this.nextAudioTs+h)-j.pts;Qe>Me?(v=Qe-Ie,v<0?v=Ie:ne=!0,this.log(`It is approximately ${Qe/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=Ie}else v=Ie}const fe=Math.round(j.pts-j.dts);oe=Math.min(oe,v),re=Math.max(re,v),se=Math.min(se,de),X=Math.max(X,de),l.push(hT(j.key,v,ce,fe))}if(l.length){if(ho){if(ho<70){const D=l[0].flags;D.dependsOn=2,D.isNonSync=0}}else if(rp&&X-se<re-oe&&k/re<.025&&l[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let D=y;for(let j=0,ie=l.length;j<ie;j++){const ce=D+l[j].duration,de=D+l[j].cts;if(j<ie-1){const fe=ce+l[j+1].cts;l[j].duration=fe-de}else l[j].duration=j?l[j-1].duration:k;l[j].cts=0,D=ce}}}v=ne||!v?k:v;const Z=S+v;this.nextVideoTs=p=Z-h,this.videoSampleDuration=v,this.isVideoContiguous=!0;const J={data1:K.moof(e.sequenceNumber++,y,tt(e,{samples:l})),data2:O,startPTS:(x-h)/r,endPTS:(b+v-h)/r,startDTS:(y-h)/r,endDTS:p/r,type:"video",hasAudio:!1,hasVideo:!0,nb:l.length,dropped:e.dropped};return e.samples=[],e.dropped=0,J}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return t4;case"ac3":return n4;default:return e4}}remuxAudio(e,t,n,i,r){const o=e.inputTimeScale,l=e.samplerate?e.samplerate:o,u=o/l,d=this.getSamplesPerFrame(e),h=d*u,p=this._initPTS,m=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,v=[],y=r!==void 0;let S=e.samples,x=m?0:8,b=this.nextAudioTs||-1;const w=p.baseTime*o/p.timescale,L=w+t*o;if(this.isAudioContiguous=n=n||S.length&&b>0&&(i&&Math.abs(L-(b+w))<9e3||Math.abs(kn(S[0].pts,L)-(b+w))<20*h),S.forEach(function(X){X.pts=kn(X.pts,L)}),!n||b<0){const X=S.length;if(S=S.filter(Z=>Z.pts>=0),X!==S.length&&this.warn(`Removed ${S.length-X} of ${X} samples (initPTS ${w} / ${o})`),!S.length)return;r===0?b=0:i&&!y?b=Math.max(0,L-w):b=S[0].pts-w}if(e.segmentCodec==="aac"){const X=this.config.maxAudioFramesDrift;for(let Z=0,F=b+w;Z<S.length;Z++){const ee=S[Z],J=ee.pts,D=J-F,j=Math.abs(1e3*D/o);if(D<=-X*h&&y)Z===0&&(this.warn(`Audio frame @ ${(J/o).toFixed(3)}s overlaps marker by ${Math.round(1e3*D/o)} ms.`),this.nextAudioTs=b=J-w,F=J);else if(D>=X*h&&j<Z3&&y){let ie=Math.round(D/h);for(F=J-ie*h;F<0&&ie&&h;)ie--,F+=h;Z===0&&(this.nextAudioTs=b=F-w),this.warn(`Injecting ${ie} audio frames @ ${((F-w)/o).toFixed(3)}s due to ${Math.round(1e3*D/o)} ms gap.`);for(let ce=0;ce<ie;ce++){let de=Q3.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);de||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),de=ee.unit.subarray()),S.splice(Z,0,{unit:de,pts:F}),F+=h,Z++}}ee.pts=F,F+=h}}let I=null,k=null,M,P=0,C=S.length;for(;C--;)P+=S[C].unit.byteLength;for(let X=0,Z=S.length;X<Z;X++){const F=S[X],ee=F.unit;let J=F.pts;if(k!==null){const j=v[X-1];j.duration=Math.round((J-k)/u)}else if(n&&e.segmentCodec==="aac"&&(J=b+w),I=J,P>0){P+=x;try{M=new Uint8Array(P)}catch(j){this.observer.emit(R.ERROR,R.ERROR,{type:Re.MUX_ERROR,details:H.REMUX_ALLOC_ERROR,fatal:!1,error:j,bytes:P,reason:`fail allocating audio mdat ${P}`});return}m||(new DataView(M.buffer).setUint32(0,P),M.set(K.types.mdat,4))}else return;M.set(ee,x);const D=ee.byteLength;x+=D,v.push(hT(!0,d,D,0)),k=J}const U=v.length;if(!U)return;const O=v[v.length-1];b=k-w,this.nextAudioTs=b+u*O.duration;const W=m?new Uint8Array(0):K.moof(e.sequenceNumber++,I/u,tt({},e,{samples:v}));e.samples=[];const ne=(I-w)/o,oe=this.nextAudioTs/o,re={data1:W,data2:M,startPTS:ne,endPTS:oe,startDTS:ne,endDTS:oe,type:"audio",hasAudio:!0,hasVideo:!1,nb:U};return this.isAudioContiguous=!0,re}}function kn(s,e){let t;if(e===null)return s;for(e<s?t=-8589934592:t=8589934592;Math.abs(s-e)>4294967296;)s+=t;return s}function s4(s){for(let e=0;e<s.length;e++)if(s[e].key)return e;return-1}function sR(s,e,t,n){const i=s.samples.length;if(!i)return;const r=s.inputTimeScale;for(let l=0;l<i;l++){const u=s.samples[l];u.pts=kn(u.pts-t.baseTime*r/t.timescale,e*r)/r,u.dts=kn(u.dts-n.baseTime*r/n.timescale,e*r)/r}const o=s.samples;return s.samples=[],{samples:o}}function iR(s,e,t){const n=s.samples.length;if(!n)return;const i=s.inputTimeScale;for(let o=0;o<n;o++){const l=s.samples[o];l.pts=kn(l.pts-t.baseTime*i/t.timescale,e*i)/i}s.samples.sort((o,l)=>o.pts-l.pts);const r=s.samples;return s.samples=[],{samples:r}}class i4 extends Wn{constructor(e,t,n,i){super("passthrough-remuxer",i),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,n,i){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(e,i),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:n,videoCodec:i}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:r,video:o}=this.initData=uw(e);if(t)HU(e,t);else{const u=r||o;u!=null&&u.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${u.codec}")!`)}r&&(n=fT(r,nt.AUDIO,this)),o&&(i=fT(o,nt.VIDEO,this));const l={};r&&o?l.audiovideo={container:"video/mp4",codec:n+","+i,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:e,id:"main"}:r?l.audio={container:"audio/mp4",codec:n,encrypted:r.encrypted,initSegment:e,id:"audio"}:o?l.video={container:"video/mp4",codec:i,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=l}remux(e,t,n,i,r,o){var l,u;let{initPTS:d,lastEndTime:h}=this;const p={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};pe(h)||(h=this.lastEndTime=r||0);const m=t.samples;if(!m.length)return p;const v={initPTS:void 0,timescale:void 0,trackId:void 0};let y=this.initData;if((l=y)!=null&&l.length||(this.generateInitSegment(m),y=this.initData),!((u=y)!=null&&u.length))return this.warn("Failed to generate initSegment."),p;this.emitInitSegment&&(v.tracks=this.initTracks,this.emitInitSegment=!1);const S=WU(m,y,this),x=y.audio?S[y.audio.id]:null,b=y.video?S[y.video.id]:null,w=lu(b,1/0),L=lu(x,1/0),I=lu(b,0,!0),k=lu(x,0,!0);let M=r,P=0;const C=x&&(!b||!d&&L<w||d&&d.trackId===y.audio.id),U=C?x:b;if(U){const F=U.timescale,ee=U.start-r*F,J=C?y.audio.id:y.video.id;M=U.start/F,P=C?k-L:I-w,(o||!d)&&(r4(d,M,r,P)||F!==d.timescale)&&(d&&this.warn(`Timestamps at playlist time: ${o?"":"~"}${r} ${ee/F} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${r} offset: ${M-r} (${ee}/${F}) trackId: ${J}`),d=null,v.initPTS=ee,v.timescale=F,v.trackId=J)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${r}`);d?(v.initPTS=d.baseTime,v.timescale=d.timescale,v.trackId=d.trackId):((!v.timescale||v.trackId===void 0||v.initPTS===void 0)&&(this.warn("Could not set initPTS"),v.initPTS=M,v.timescale=1,v.trackId=-1),this.initPTS=d={baseTime:v.initPTS,timescale:v.timescale,trackId:v.trackId});const O=M-d.baseTime/d.timescale,W=O+P;P>0?this.lastEndTime=W:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const ne=!!y.audio,oe=!!y.video;let se="";ne&&(se+="audio"),oe&&(se+="video");const re=(y.audio?y.audio.encrypted:!1)||(y.video?y.video.encrypted:!1),X={data1:m,startPTS:O,startDTS:O,endPTS:W,endDTS:W,type:se,hasAudio:ne,hasVideo:oe,nb:1,dropped:0,encrypted:re};p.audio=ne&&!oe?X:void 0,p.video=oe?X:void 0;const Z=b==null?void 0:b.sampleCount;if(Z){const F=b.keyFrameIndex,ee=F!==-1;X.nb=Z,X.dropped=F===0||this.isVideoContiguous?0:ee?F:Z,X.independent=ee,X.firstKeyFrame=F,ee&&b.keyFrameStart&&(X.firstKeyFramePTS=(b.keyFrameStart-d.baseTime)/d.timescale),this.isVideoContiguous||(p.independent=ee),this.isVideoContiguous||(this.isVideoContiguous=ee),X.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${F}/${Z} dropped: ${X.dropped} start: ${X.firstKeyFramePTS||"NA"}`)}return p.initSegment=v,p.id3=sR(n,r,d,d),i.samples.length&&(p.text=iR(i,r,d)),p}}function lu(s,e,t=!1){return(s==null?void 0:s.start)!==void 0?(s.start+(t?s.duration:0))/s.timescale:e}function r4(s,e,t,n){if(s===null)return!0;const i=Math.max(n,1),r=e-s.baseTime/s.timescale;return Math.abs(r-t)>i}function fT(s,e,t){const n=s.codec;return n&&n.length>4?n:e===nt.AUDIO?n==="ec-3"||n==="ac-3"||n==="alac"?n:n==="fLaC"||n==="Opus"?Qu(n,!1):(t.warn(`Unhandled audio codec "${n}" in mp4 MAP`),n||"mp4a"):(t.warn(`Unhandled video codec "${n}" in mp4 MAP`),n||"avc1")}let Hs;try{Hs=self.performance.now.bind(self.performance)}catch{Hs=Date.now}const Ou=[{demux:K3,remux:i4},{demux:Ri,remux:Du},{demux:$3,remux:Du},{demux:V3,remux:Du}];Ou.splice(2,0,{demux:j3,remux:Du});class pT{constructor(e,t,n,i,r,o){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.id=r,this.logger=o}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,i){const r=n.transmuxing;r.executeStart=Hs();let o=new Uint8Array(e);const{currentTransmuxState:l,transmuxConfig:u}=this;i&&(this.currentTransmuxState=i);const{contiguous:d,discontinuity:h,trackSwitch:p,accurateTimeOffset:m,timeOffset:v,initSegmentChange:y}=i||l,{audioCodec:S,videoCodec:x,defaultInitPts:b,duration:w,initSegmentData:L}=u,I=o4(o,t);if(I&&To(I.method)){const C=this.getDecrypter(),U=Vg(I.method);if(C.isSync()){let O=C.softwareDecrypt(o,I.key.buffer,I.iv.buffer,U);if(n.part>-1){const ne=C.flush();O=ne&&ne.buffer}if(!O)return r.executeEnd=Hs(),op(n);o=new Uint8Array(O)}else return this.asyncResult=!0,this.decryptionPromise=C.webCryptoDecrypt(o,I.key.buffer,I.iv.buffer,U).then(O=>{const W=this.push(O,null,n);return this.decryptionPromise=null,W}),this.decryptionPromise}const k=this.needsProbing(h,p);if(k){const C=this.configureTransmuxer(o);if(C)return this.logger.warn(`[transmuxer] ${C.message}`),this.observer.emit(R.ERROR,R.ERROR,{type:Re.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,fatal:!1,error:C,reason:C.message}),r.executeEnd=Hs(),op(n)}(h||p||y||k)&&this.resetInitSegment(L,S,x,w,t),(h||y||k)&&this.resetInitialTimestamp(b),d||this.resetContiguity();const M=this.transmux(o,I,v,m,n);this.asyncResult=xl(M);const P=this.currentTransmuxState;return P.contiguous=!0,P.discontinuity=!1,P.trackSwitch=!1,r.executeEnd=Hs(),M}flush(e){const t=e.transmuxing;t.executeStart=Hs();const{decrypter:n,currentTransmuxState:i,decryptionPromise:r}=this;if(r)return this.asyncResult=!0,r.then(()=>this.flush(e));const o=[],{timeOffset:l}=i;if(n){const p=n.flush();p&&o.push(this.push(p.buffer,null,e))}const{demuxer:u,remuxer:d}=this;if(!u||!d){t.executeEnd=Hs();const p=[op(e)];return this.asyncResult?Promise.resolve(p):p}const h=u.flush(l);return xl(h)?(this.asyncResult=!0,h.then(p=>(this.flushRemux(o,p,e),o))):(this.flushRemux(o,h,e),this.asyncResult?Promise.resolve(o):o)}flushRemux(e,t,n){const{audioTrack:i,videoTrack:r,id3Track:o,textTrack:l}=t,{accurateTimeOffset:u,timeOffset:d}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${n.sn}${n.part>-1?" part: "+n.part:""} of ${this.id===ye.MAIN?"level":"track"} ${n.level}`);const h=this.remuxer.remux(i,r,o,l,d,u,!0,this.id);e.push({remuxResult:h,chunkMeta:n}),n.transmuxing.executeEnd=Hs()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,i,r){const{demuxer:o,remuxer:l}=this;!o||!l||(o.resetInitSegment(e,t,n,i),l.resetInitSegment(e,t,n,r))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,i,r){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,n,i,r):o=this.transmuxUnencrypted(e,n,i,r),o}transmuxUnencrypted(e,t,n,i){const{audioTrack:r,videoTrack:o,id3Track:l,textTrack:u}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(r,o,l,u,t,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,n,i,r){return this.demuxer.demuxSampleAes(e,t,n).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,n,i,!1,this.id),chunkMeta:r}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:i}=this;let r;for(let p=0,m=Ou.length;p<m;p++){var o;if((o=Ou[p].demux)!=null&&o.probe(e,this.logger)){r=Ou[p];break}}if(!r)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,u=this.remuxer,d=r.remux,h=r.demux;(!u||!(u instanceof d))&&(this.remuxer=new d(n,t,i,this.logger)),(!l||!(l instanceof h))&&(this.demuxer=new h(n,t,i,this.logger),this.probe=h.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new $g(this.config)),e}}function o4(s,e){let t=null;return s.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const op=s=>({remuxResult:{},chunkMeta:s});function xl(s){return"then"in s&&s.then instanceof Function}class a4{constructor(e,t,n,i,r){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=i,this.defaultInitPts=r||null}}class l4{constructor(e,t,n,i,r,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=r,this.initSegmentChange=o}}let mT=0;class rR{constructor(e,t,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=mT++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=u=>{const d=u.data,h=this.hls;if(!(!h||!(d!=null&&d.event)||d.instanceNo!==this.instanceNo))switch(d.event){case"init":{var p;const m=(p=this.workerContext)==null?void 0:p.objectURL;m&&self.URL.revokeObjectURL(m);break}case"transmuxComplete":{this.handleTransmuxComplete(d.data);break}case"flush":{this.onFlush(d.data);break}case"workerLog":{h.logger[d.data.logType]&&h.logger[d.data.logType](d.data.message);break}default:{d.data=d.data||{},d.data.frag=this.frag,d.data.part=this.part,d.data.id=this.id,h.trigger(d.event,d.data);break}}},this.onWorkerError=u=>{if(!this.hls)return;const d=new Error(`${u.message}  (${u.filename}:${u.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(R.ERROR,{type:Re.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:d})};const r=e.config;this.hls=e,this.id=t,this.useWorker=!!r.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const o=(u,d)=>{d=d||{},d.frag=this.frag||void 0,u===R.ERROR&&(d=d,d.parent=this.id,d.part=this.part,this.error=d.error),this.hls.trigger(u,d)};this.observer=new Hg,this.observer.on(R.FRAG_DECRYPTED,o),this.observer.on(R.ERROR,o);const l=kE(r.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const u=this.hls.logger;if(r.workerPath||h3()){try{r.workerPath?(u.log(`loading Web Worker ${r.workerPath} for "${t}"`),this.workerContext=p3(r.workerPath)):(u.log(`injecting Web Worker for "${t}"`),this.workerContext=f3());const{worker:h}=this.workerContext;h.addEventListener("message",this.onWorkerMessage),h.addEventListener("error",this.onWorkerError),h.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:l,id:t,config:it(r)})}catch(h){u.warn(`Error setting up "${t}" Web Worker, fallback to inline`,h),this.terminateWorker(),this.error=null,this.transmuxer=new pT(this.observer,l,r,"",t,e.logger)}return}}this.transmuxer=new pT(this.observer,l,r,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=mT++;const t=this.hls.config,n=kE(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:it(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),m3(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,n,i,r,o,l,u,d,h){var p,m;d.transmuxing.start=self.performance.now();const{instanceNo:v,transmuxer:y}=this,S=o?o.start:r.start,x=r.decryptdata,b=this.frag,w=!(b&&r.cc===b.cc),L=!(b&&d.level===b.level),I=b?d.sn-b.sn:-1,k=this.part?d.part-this.part.index:-1,M=I===0&&d.id>1&&d.id===(b==null?void 0:b.stats.chunkCount),P=!L&&(I===1||I===0&&(k===1||M&&k<=0)),C=self.performance.now();(L||I||r.stats.parsing.start===0)&&(r.stats.parsing.start=C),o&&(k||!P)&&(o.stats.parsing.start=C);const U=!(b&&((p=r.initSegment)==null?void 0:p.url)===((m=b.initSegment)==null?void 0:m.url)),O=new l4(w,P,u,L,S,U);if(!P||w||U){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${r.type} sn: ${d.sn}${d.part>-1?" part: "+d.part:""} ${this.id===ye.MAIN?"level":"track"}: ${d.level} id: ${d.id}
        discontinuity: ${w}
        trackSwitch: ${L}
        contiguous: ${P}
        accurateTimeOffset: ${u}
        timeOffset: ${S}
        initSegmentChange: ${U}`);const W=new a4(n,i,t,l,h);this.configureTransmuxer(W)}if(this.frag=r,this.part=o,this.workerContext)this.workerContext.worker.postMessage({instanceNo:v,cmd:"demux",data:e,decryptdata:x,chunkMeta:d,state:O},e instanceof ArrayBuffer?[e]:[]);else if(y){const W=y.push(e,x,d,O);xl(W)?W.then(ne=>{this.handleTransmuxComplete(ne)}).catch(ne=>{this.transmuxerError(ne,d,"transmuxer-interface push error")}):this.handleTransmuxComplete(W)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(n){const i=n.flush(e);xl(i)?i.then(r=>{this.handleFlushResult(r,e)}).catch(r=>{this.transmuxerError(r,e,"transmuxer-interface flush error")}):this.handleFlushResult(i,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const gT=100;class c4 extends Kg{constructor(e,t,n){super(e,t,n,"audio-stream-controller",ye.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(R.BUFFER_RESET,this.onBufferReset,this),e.on(R.BUFFER_CREATED,this.onBufferCreated,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(R.FRAG_LOADING,this.onFragLoading,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(R.BUFFER_RESET,this.onBufferReset,this),e.off(R.BUFFER_CREATED,this.onBufferCreated,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(R.FRAG_LOADING,this.onFragLoading,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r,trackId:o}){if(n===ye.MAIN){const l=t.cc,u=this.fragCurrent;if(this.initPTS[l]={baseTime:i,timescale:r,trackId:o},this.log(`InitPTS for cc: ${l} found from main: ${i/r} (${i}/${r}) trackId: ${o}`),this.mainAnchor=t,this.state===te.WAITING_INIT_PTS){const d=this.waitingData;(!d&&!this.loadingParts||d&&d.frag.cc!==l)&&this.syncWithAnchor(t,d==null?void 0:d.frag)}else!this.hls.hasEnoughToStart&&u&&u.cc!==l?(u.abortRequests(),this.syncWithAnchor(t,u)):this.state===te.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var n;const i=((n=this.mainFragLoading)==null?void 0:n.frag)||null;if(t&&(i==null?void 0:i.cc)===t.cc)return;const r=(i||e).cc,o=this.getLevelDetails(),l=this.getLoadPosition(),u=Ew(o,r,l);u&&(this.log(`Syncing with main frag at ${u.start} cc ${u.cc}`),this.startFragRequested=!1,this.nextLoadPosition=u.start,this.resetLoadingState(),this.state===te.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=te.STOPPED;return}const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(gT),n>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n,this.state=te.IDLE):this.state=te.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case te.IDLE:this.doTickIdle();break;case te.WAITING_TRACK:{const{levels:e,trackId:t}=this,n=e==null?void 0:e[t],i=n==null?void 0:n.details;if(i&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(i))break;this.state=te.WAITING_INIT_PTS}break}case te.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case te.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:i,complete:r}=e,o=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=te.FRAG_LOADING;const l=i.flush().buffer,u={frag:t,part:n,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),r&&super._handleFragmentLoadComplete(u)}else o&&o.cc!==e.frag.cc&&this.syncWithAnchor(o,e.frag)}else this.state=te.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:n,media:i,trackId:r}=this,o=t.config;if(!this.buffering||!i&&!this.primaryPrefetch&&(this.startFragRequested||!o.startFragPrefetch)||!(n!=null&&n[r]))return;const l=n[r],u=l.details;if(!u||this.waitForLive(l)||this.waitForCdnTuneIn(u)){this.state=te.WAITING_TRACK,this.startFragRequested=!1;return}const d=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&d&&(this.bufferFlushed=!1,this.afterBufferFlushed(d,nt.AUDIO,ye.AUDIO));const h=this.getFwdBufferInfo(d,ye.AUDIO);if(h===null)return;if(!this.switchingTrack&&this._streamEnded(h,u)){t.trigger(R.BUFFER_EOS,{type:"audio"}),this.state=te.ENDED;return}const p=h.len,m=t.maxBufferLength,v=u.fragments,y=v[0].start,S=this.getLoadPosition(),x=this.flushing?S:h.end;if(this.switchingTrack&&i){const L=S;u.PTSKnown&&L<y&&(h.end>y||h.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=y+.05)}if(p>=m&&!this.switchingTrack&&x<v[v.length-1].start)return;let b=this.getNextFragment(x,u);if(b&&this.isLoopLoading(b,x)&&(b=this.getNextFragmentLoopLoading(b,u,h,ye.MAIN,m)),!b){this.bufferFlushed=!0;return}let w=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&w&&Tt(b)&&!b.endList&&(!u.live||!this.loadingParts&&x<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(w)===Pt.OK&&(this.mainFragLoading=w=null),w&&Tt(w))){if(b.start>w.end){const I=this.fragmentTracker.getFragAtPos(x,ye.MAIN);I&&I.end>w.end&&(w=I,this.mainFragLoading={frag:I,targetBufferTime:null})}if(b.start>w.end)return}this.loadFragment(b,l,x)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new gl(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==te.STOPPED&&(this.setInterval(gT),this.state=te.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(R.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,t){var n;const{levels:i}=this,{details:r,id:o,groupId:l,track:u}=t;if(!i){this.warn(`Audio tracks reset while loading track ${o} "${u.name}" of "${l}"`);return}const d=this.mainDetails;if(!d||r.endCC>d.endCC||d.expired){this.cachedTrackLoadedData=t,this.state!==te.STOPPED&&(this.state=te.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${o} "${u.name}" of "${l}" loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`);const h=i[o];let p=0;if(r.live||(n=h.details)!=null&&n.live){if(this.checkLiveUpdate(r),r.deltaUpdateFailed)return;if(h.details){var m;p=this.alignPlaylists(r,h.details,(m=this.levelLastLoaded)==null?void 0:m.details)}r.alignedSliding||(Uw(r,d),r.alignedSliding||sd(r,d),p=r.fragmentStart)}h.details=r,this.levelLastLoaded=h,this.startFragRequested||this.setStartPosition(d,p),this.hls.trigger(R.AUDIO_TRACK_UPDATED,{details:r,id:o,groupId:t.groupId}),this.state===te.WAITING_TRACK&&!this.waitForCdnTuneIn(r)&&(this.state=te.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:r}=e,{config:o,trackId:l,levels:u}=this;if(!u){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const d=u[l];if(!d){this.warn("Audio track is undefined on fragment load progress");return}const h=d.details;if(!h){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const p=o.defaultAudioCodec||d.audioCodec||"mp4a.40.2";let m=this.transmuxer;m||(m=this.transmuxer=new rR(this.hls,ye.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const v=this.initPTS[n.cc],y=(t=n.initSegment)==null?void 0:t.data;if(v!==void 0){const x=i?i.index:-1,b=x!==-1,w=new jg(n.level,n.sn,n.stats.chunkCount,r.byteLength,x,b);m.push(r,y,p,"",n,i,h.totalduration,!1,w,v)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${h.startSN} ,${h.endSN}],track ${l}`);const{cache:S}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new $w,complete:!1};S.push(new Uint8Array(r)),this.state!==te.STOPPED&&(this.state=te.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===ye.MAIN&&Tt(t.frag)&&(this.mainFragLoading=t,this.state===te.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:n,part:i}=t;if(n.type!==ye.AUDIO){!this.audioOnly&&n.type===ye.MAIN&&!n.elementaryStreams.video&&!n.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Tt(n)){this.fragPrevious=n;const r=this.switchingTrack;r&&(this.bufferedTrack=r,this.switchingTrack=null,this.hls.trigger(R.AUDIO_TRACK_SWITCHED,Ze({},r)))}this.fragBufferedComplete(n,i),this.media&&this.tick()}onError(e,t){var n;if(t.fatal){this.state=te.ERROR;return}switch(t.details){case H.FRAG_GAP:case H.FRAG_PARSING_ERROR:case H.FRAG_DECRYPT_ERROR:case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ye.AUDIO,t);break;case H.AUDIO_TRACK_LOAD_ERROR:case H.AUDIO_TRACK_LOAD_TIMEOUT:case H.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===te.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===Ge.AUDIO_TRACK&&(this.state=te.IDLE);break;case H.BUFFER_ADD_CODEC_ERROR:case H.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case H.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case H.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==nt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==nt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===te.ENDED&&(this.state=te.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,ye.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:i}=this,{remuxResult:r,chunkMeta:o}=e,l=this.getCurrentContext(o);if(!l){this.resetWhenMissingContext(o);return}const{frag:u,part:d,level:h}=l,{details:p}=h,{audio:m,text:v,id3:y,initSegment:S}=r;if(this.fragContextChanged(u)||!p){this.fragmentTracker.removeFragment(u);return}if(this.state=te.PARSING,this.switchingTrack&&m&&this.completeAudioSwitch(this.switchingTrack),S!=null&&S.tracks){const x=u.initSegment||u;if(this.unhandledEncryptionError(S,u))return;this._bufferInitSegment(h,S.tracks,x,o),i.trigger(R.FRAG_PARSING_INIT_SEGMENT,{frag:x,id:n,tracks:S.tracks})}if(m){const{startPTS:x,endPTS:b,startDTS:w,endDTS:L}=m;d&&(d.elementaryStreams[nt.AUDIO]={startPTS:x,endPTS:b,startDTS:w,endDTS:L}),u.setElementaryStreamInfo(nt.AUDIO,x,b,w,L),this.bufferFragmentData(m,u,d,o)}if(y!=null&&(t=y.samples)!=null&&t.length){const x=tt({id:n,frag:u,details:p},y);i.trigger(R.FRAG_PARSING_METADATA,x)}if(v){const x=tt({id:n,frag:u,details:p},v);i.trigger(R.FRAG_PARSING_USERDATA,x)}}_bufferInitSegment(e,t,n,i){if(this.state!==te.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const r=t.audio;r.id=ye.AUDIO;const o=e.audioCodec;this.log(`Init audio buffer, container:${r.container}, codecs[level/parsed]=[${o}/${r.codec}]`),o&&o.split(",").length===1&&(r.levelCodec=o),this.hls.trigger(R.BUFFER_CODECS,t);const l=r.initSegment;if(l!=null&&l.byteLength){const u={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:l};this.hls.trigger(R.BUFFER_APPENDING,u)}this.tickImmediate()}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);if(this.switchingTrack||i===Pt.NOT_LOADED||i===Pt.PARTIAL){var r;if(!Tt(e))this._loadInitSegment(e,t);else if((r=t.details)!=null&&r.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=te.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragmentStart!==t.details.fragmentStart&&sd(t.details,o)}else super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:i,characteristics:r,audioCodec:o,channels:l}=this.bufferedTrack;Lr({name:t,lang:n,assocLang:i,characteristics:r,audioCodec:o,channels:l},e,dr)||(Ju(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(R.AUDIO_TRACK_SWITCHED,Ze({},e))}}class Jg extends Wn{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const i=t==null?void 0:t.renditionReports;if(i){let r=-1;for(let o=0;o<i.length;o++){const l=i[o];let u;try{u=new self.URL(l.URI,t.url).href}catch(d){this.warn(`Could not construct new URL for Rendition Report: ${d}`),u=l.URI||""}if(u===e){r=o;break}else u===e.substring(0,u.length)&&(r=o)}if(r!==-1){const o=i[r],l=parseInt(o["LAST-MSN"])||t.lastPartSn;let u=parseInt(o["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const h=Math.min(t.age-t.partTarget,t.targetduration);u>=0&&h>t.partTarget&&(u+=1)}const d=n&&CE(n);return new PE(l,u>=0?u:void 0,d)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}return e}playlistLoaded(e,t,n){const{details:i,stats:r}=t,o=self.performance.now(),l=r.loading.first?Math.max(0,o-r.loading.first):0;i.advancedDateTime=Date.now()-l;const u=this.hls.config.timelineOffset;if(u!==i.appliedTimelineOffset){const h=Math.max(u||0,0);i.appliedTimelineOffset=h,i.fragments.forEach(p=>{p.setStart(p.playlistOffset+h)})}if(i.live||n!=null&&n.live){const h="levelInfo"in t?t.levelInfo:t.track;if(i.reloaded(n),n&&i.fragments.length>0){t3(n,i,this);const w=i.playlistParsingError;if(w){this.warn(w);const L=this.hls;if(!L.config.ignorePlaylistParsingErrors){var d;const{networkDetails:I}=t;L.trigger(R.ERROR,{type:Re.NETWORK_ERROR,details:H.LEVEL_PARSING_ERROR,fatal:!1,url:i.url,error:w,reason:w.message,level:t.level||void 0,parent:(d=i.fragments[0])==null?void 0:d.type,networkDetails:I,stats:r});return}i.playlistParsingError=null}}i.requestScheduled===-1&&(i.requestScheduled=r.loading.start);const p=this.hls.mainForwardBufferInfo,m=p?p.end-p.len:0,v=(i.edge-m)*1e3,y=Ow(i,v);if(i.requestScheduled+y<o?i.requestScheduled=o:i.requestScheduled+=y,this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),!this.canLoad||!i.live)return;let S,x,b;if(i.canBlockReload&&i.endSN&&i.advanced){const w=this.hls.config.lowLatencyMode,L=i.lastPartSn,I=i.endSN,k=i.lastPartIndex,M=k!==-1,P=L===I;M?P?(x=I+1,b=w?0:k):(x=L,b=w?k+1:i.maxPartIndex):x=I+1;const C=i.age,U=C+i.ageHeader;let O=Math.min(U-i.partTarget,i.targetduration*1.5);if(O>0){if(U>i.targetduration*3)this.log(`Playlist last advanced ${C.toFixed(2)}s ago. Omitting segment and part directives.`),x=void 0,b=void 0;else if(n!=null&&n.tuneInGoal&&U-i.partTarget>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${O} with playlist age: ${i.age}`),O=0;else{const W=Math.floor(O/i.targetduration);if(x+=W,b!==void 0){const ne=Math.round(O%i.targetduration/i.partTarget);b+=ne}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${C.toFixed(2)}s goal: ${O} skip sn ${W} to part ${b}`)}i.tuneInGoal=O}if(S=this.getDeliveryDirectives(i,t.deliveryDirectives,x,b),w||!P){i.requestScheduled=o,this.loadingPlaylist(h,S);return}}else(i.canBlockReload||i.canSkipUntil)&&(S=this.getDeliveryDirectives(i,t.deliveryDirectives,x,b));S&&x!==void 0&&i.canBlockReload&&(i.requestScheduled=r.loading.first+Math.max(y-l*2,y/2)),this.scheduleLoading(h,S,i)}else this.clearTimer()}scheduleLoading(e,t,n){const i=n||e.details;if(!i){this.loadingPlaylist(e,t);return}const r=self.performance.now(),o=i.requestScheduled;if(r>=o){this.loadingPlaylist(e,t);return}const l=o-r;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(l)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),l)}getDeliveryDirectives(e,t,n,i){let r=CE(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,i=t.part,r=Cu.No),new PE(n,i,r)}checkRetry(e){const t=e.details,n=Zu(e),i=e.errorAction,{action:r,retryCount:o=0,retryConfig:l}=i||{},u=!!i&&!!l&&(r===Kt.RetryRequest||!i.resolved&&r===Kt.SendAlternateToPenaltyBox);if(u){var d;if(o>=l.maxNumRetry)return!1;if(n&&(d=e.context)!=null&&d.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${l.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const h=Ug(l,o);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),h),this.warn(`Retrying playlist loading ${o+1}/${l.maxNumRetry} after "${t}" in ${h}ms`)}e.levelRetry=!0,i.resolved=!0}return u}}function oR(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(!Sl(s[t].attrs,e[t].attrs))return!1;return!0}function Sl(s,e,t){const n=s["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(i=>s[i]!==e[i])}function Rm(s,e){return e.label.toLowerCase()===s.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(s.lang||"").toLowerCase())}class u4 extends Jg{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVEL_LOADING,this.onLevelLoading,this),e.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(R.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==i){this.warn(`Audio track with id:${n} and group:${i} not found in active group ${o==null?void 0:o.groupId}`);return}const l=o.details;o.details=t.details,this.log(`Audio track ${n} "${o.name}" lang:${o.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(l=>(i==null?void 0:i.indexOf(l))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(m=>!n||n.indexOf(m.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(m=>m.default)&&(this.selectDefaultTrack=!1),l.forEach((m,v)=>{m.id=v});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const u=this.hls.config.audioPreference;if(!r&&u){const m=As(u,l,dr);if(m>-1)r=l[m];else{const v=As(u,this.tracks);r=this.tracks[v]}}let d=this.findTrackId(r);d===-1&&r&&(d=this.findTrackId(null));const h={audioTracks:l};this.log(`Updating audio tracks, ${l.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(R.AUDIO_TRACKS_UPDATED,h);const p=this.trackId;if(d!==-1&&p===-1)this.setAudioTrack(d);else if(l.length&&p===-1){var o;const m=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${l.length}`);this.warn(m.message),this.hls.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:m})}}}onError(e,t){t.fatal||!t.context||t.context.type===Ge.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&Lr(e,i,dr))return i;const r=As(e,this.tracksInGroup,dr);if(r>-1){const o=this.tracksInGroup[r];return this.setAudioTrack(r),o}else if(i){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const l=T$(e,t.levels,n,o,dr);if(l===-1)return null;t.nextLoadLevel=l}if(e.channels||e.audioCodec){const o=As(e,n);if(o>-1)return n[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e],r=i.details&&!i.details.live;if(e===this.trackId&&i===n&&r||(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(R.AUDIO_TRACK_SWITCHING,Ze({},i)),r))return;const o=this.switchParams(i.url,n==null?void 0:n.details,i.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(!(this.selectDefaultTrack&&!i.default)&&(!e||Lr(e,i,dr)))return n}if(e){const{name:n,lang:i,assocLang:r,characteristics:o,audioCodec:l,channels:u}=e;for(let d=0;d<t.length;d++){const h=t[d];if(Lr({name:n,lang:i,assocLang:r,characteristics:o,audioCodec:l,channels:u},h,dr))return d}for(let d=0;d<t.length;d++){const h=t[d];if(Sl(e.attrs,h.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(let d=0;d<t.length;d++){const h=t[d];if(Sl(e.attrs,h.attrs,["LANGUAGE"]))return d}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Ju(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,r=this.getUrlWithDirectives(e.url,t),o=e.details,l=o==null?void 0:o.age;this.log(`Loading audio-track ${n} "${e.name}" lang:${e.lang} group:${i}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${l&&o.live?" age "+l.toFixed(1)+(o.type&&" "+o.type||""):""} ${r}`),this.hls.trigger(R.AUDIO_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:t||null,track:e})}}class d4{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,n){if(this.queues===null||this.tracks===null)return;const i=this.queues[t];i.push(e),i.length===1&&!n&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const n={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const n={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const n=(t=e[0])==null?void 0:t.label;(n==="async-blocker"||n==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const i=t[0];try{i.execute()}catch(r){var n;if(i.onError(r),this.queues===null||this.tracks===null)return;const o=(n=this.tracks[e])==null?void 0:n.buffer;o!=null&&o.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,n;return(t=this.queues)!=null&&t[e]||(n=this.tracks)!=null&&n[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const n=(t=this.tracks)==null?void 0:t[e],i=n==null?void 0:n.buffer;return i?`SourceBuffer${i.updating?" updating":""}${n.ended?" ended":""}${n.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(n=>n.label).join(", "))||""}}const yT=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,aR="HlsJsTrackRemovedError";class h4 extends Error{constructor(e){super(e),this.name=aR}}class f4 extends Wn{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=n=>{var i;this.hls&&((i=this.mediaSource)==null?void 0:i.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=n=>{const{media:i,mediaSource:r}=this;n&&this.log("Media source opened"),!(!i||!r)&&(r.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(R.MEDIA_ATTACHED,{media:i,mediaSource:r}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:i}=this;n!==i&&this.error(`Media element src was set while attaching MediaSource (${i} > ${n})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=NU(ji(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.BUFFER_RESET,this.onBufferReset,this),e.on(R.BUFFER_APPENDING,this.onBufferAppending,this),e.on(R.BUFFER_CODECS,this.onBufferCodecs,this),e.on(R.BUFFER_EOS,this.onBufferEos,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(R.FRAG_PARSED,this.onFragParsed,this),e.on(R.FRAG_CHANGED,this.onFragChanged,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.BUFFER_RESET,this.onBufferReset,this),e.off(R.BUFFER_APPENDING,this.onBufferAppending,this),e.off(R.BUFFER_CODECS,this.onBufferCodecs,this),e.off(R.BUFFER_EOS,this.onBufferEos,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(R.FRAG_PARSED,this.onFragParsed,this),e.off(R.FRAG_CHANGED,this.onFragChanged,this),e.off(R.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const n={};if(this.operationQueue){const r=this.isUpdating();r||this.operationQueue.removeBlockers();const o=this.isQueued();(r||o)&&this.warn(`Transfering MediaSource with${o?" operations in queue":""}${r?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const i=this.transferData;return!this.sourceBufferCount&&i&&i.mediaSource===t?tt(n,i.tracks):this.sourceBuffers.forEach(r=>{const[o]=r;o&&(n[o]=tt({},this.tracks[o]),this.removeBuffer(o)),r[0]=r[1]=null}),{media:e,mediaSource:t,tracks:n}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var n;let i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsTotal=i,this.log(`${i} bufferCodec event(s) expected.`),(n=this.transferData)!=null&&n.mediaSource&&this.sourceBufferCount&&i&&this.bufferCreated()}onMediaAttaching(e,t){const n=this.media=t.media;this.transferData=this.overrides=void 0;const i=ji(this.appendSource);if(i){const r=!!t.mediaSource;(r||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const o=this.mediaSource=t.mediaSource||new i;if(this.assignMediaSource(o),r)this._objectUrl=n.src,this.attachTransferred();else{const l=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{n.removeAttribute("src");const u=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||u&&o instanceof u,vT(n),p4(n,l),n.load()}catch{n.src=l}else n.src=l}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,n;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(n=e.constructor)==null?void 0:n.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const n=this.tracks,i=t.tracks,r=i?Object.keys(i):null,o=r?r.length:0,l=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(i&&r&&o){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${it(n,(u,d)=>u==="initSegment"?void 0:d)};
transfer tracks: ${it(i,(u,d)=>u==="initSegment"?void 0:d)}}`),!sw(i,n)){t.mediaSource=null,t.tracks=void 0;const u=e.currentTime,d=this.details,h=Math.max(u,(d==null?void 0:d.fragments[0].start)||0);if(h-u>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${u} -> ${h}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(i)}"->"${Object.keys(n)}") start time: ${h} currentTime: ${u}`),this.onMediaDetaching(R.MEDIA_DETACHING,{}),this.onMediaAttaching(R.MEDIA_ATTACHING,t),e.currentTime=h;return}this.transferData=void 0,r.forEach(u=>{const d=u,h=i[d];if(h){const p=h.buffer;if(p){const m=this.fragmentTracker,v=h.id;if(m.hasFragments(v)||m.hasParts(v)){const x=Fe.getBuffered(p);m.detectEvictedFragments(d,x,v,null,!0)}const y=ap(d),S=[d,p];this.sourceBuffers[y]=S,p.updating&&this.operationQueue&&this.operationQueue.prependBlocker(d),this.trackSourceBuffer(d,h)}}}),l(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),l()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const n=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:i,mediaSource:r,_objectUrl:o}=this;if(r){if(this.log(`media source ${n?"transferring":"detaching"}`),n)this.sourceBuffers.forEach(([l])=>{l&&this.removeBuffer(l)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const l=r.readyState==="open";try{const u=r.sourceBuffers;for(let d=u.length;d--;)l&&u[d].abort(),r.removeSourceBuffer(u[d]);l&&r.endOfStream()}catch(u){this.warn(`onMediaDetaching: ${u.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}i&&(i.removeEventListener("emptied",this._onMediaEmptied),n||(o&&self.URL.revokeObjectURL(o),this.mediaSrc===o?(i.removeAttribute("src"),this.appendSource&&vT(i),i.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(R.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const n=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),n)try{var i;(i=this.mediaSource)!=null&&i.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(r){this.warn(`onBufferReset ${e}`,r)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[ap(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new d4(this.tracks)}onBufferCodecs(e,t){var n;const i=this.tracks,r=Object.keys(t);this.log(`BUFFER_CODECS: "${r}" (current SB count ${this.sourceBufferCount})`);const o="audiovideo"in t&&(i.audio||i.video)||i.audiovideo&&("audio"in t||"video"in t),l=!o&&this.sourceBufferCount&&this.media&&r.some(u=>!i[u]);if(o||l){this.warn(`Unsupported transition between "${Object.keys(i)}" and "${r}" SourceBuffers`);return}r.forEach(u=>{var d,h;const p=t[u],{id:m,codec:v,levelCodec:y,container:S,metadata:x,supplemental:b}=p;let w=i[u];const L=(d=this.transferData)==null||(d=d.tracks)==null?void 0:d[u],I=L!=null&&L.buffer?L:w,k=(I==null?void 0:I.pendingCodec)||(I==null?void 0:I.codec),M=I==null?void 0:I.levelCodec;w||(w=i[u]={buffer:void 0,listeners:[],codec:v,supplemental:b,container:S,levelCodec:y,metadata:x,id:m});const P=ku(k,M),C=P==null?void 0:P.replace(yT,"$1");let U=ku(v,y);const O=(h=U)==null?void 0:h.replace(yT,"$1");U&&P&&C!==O&&(u.slice(0,5)==="audio"&&(U=Qu(U,this.appendSource)),this.log(`switching codec ${k} to ${U}`),U!==(w.pendingCodec||w.codec)&&(w.pendingCodec=U),w.container=S,this.appendChangeType(u,S,U))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&((n=t.audio)==null?void 0:n.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const n=this.tracks[t];return e[t]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e},{})}appendChangeType(e,t,n){const i=`${t};codecs=${n}`,r={label:`change-type=${i}`,execute:()=>{const o=this.tracks[e];if(o){const l=o.buffer;l!=null&&l.changeType&&(this.log(`changing ${e} sourceBuffer type to ${i}`),l.changeType(i),o.codec=n,o.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn(`Failed to change ${e} SourceBuffer type`,o)}};this.append(r,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const n=e.start,i=n+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(n,ye.MAIN))==null?void 0:t.gap)===!0)return;const o={label:"block-audio",execute:()=>{var l;const u=this.tracks.video;(this.lastVideoAppendEnd>i||u!=null&&u.buffer&&Fe.isBuffered(u.buffer,i)||((l=this.fragmentTracker.getAppendedFrag(i,ye.MAIN))==null?void 0:l.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:l=>{this.warn("Error executing block-audio operation",l)}};this.blockedAudioAppend={op:o,frag:e},this.append(o,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:n}=this,{data:i,type:r,parent:o,frag:l,part:u,chunkMeta:d,offset:h}=t,p=d.buffering[r],{sn:m,cc:v}=l,y=self.performance.now();p.start=y;const S=l.stats.buffering,x=u?u.stats.buffering:null;S.start===0&&(S.start=y),x&&x.start===0&&(x.start=y);const b=n.audio;let w=!1;r==="audio"&&(b==null?void 0:b.container)==="audio/mpeg"&&(w=!this.lastMpegAudioChunk||d.id===1||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const L=n.video,I=L==null?void 0:L.buffer;if(I&&m!=="initSegment"){const P=u||l,C=this.blockedAudioAppend;if(r==="audio"&&o!=="main"&&!this.blockedAudioAppend&&!(L.ending||L.ended)){const O=P.start+P.duration*.05,W=I.buffered,ne=this.currentOp("video");!W.length&&!ne?this.blockAudio(P):!ne&&!Fe.isBuffered(I,O)&&this.lastVideoAppendEnd<O&&this.blockAudio(P)}else if(r==="video"){const U=P.end;if(C){const O=C.frag.start;(U>O||U<this.lastVideoAppendEnd||Fe.isBuffered(I,O))&&this.unblockAudio()}this.lastVideoAppendEnd=U}}const k=(u||l).start,M={label:`append-${r}`,execute:()=>{var P;p.executeStart=self.performance.now();const C=(P=this.tracks[r])==null?void 0:P.buffer;C&&(w?this.updateTimestampOffset(C,k,.1,r,m,v):h!==void 0&&pe(h)&&this.updateTimestampOffset(C,h,1e-6,r,m,v)),this.appendExecutor(i,r)},onStart:()=>{},onComplete:()=>{const P=self.performance.now();p.executeEnd=p.end=P,S.first===0&&(S.first=P),x&&x.first===0&&(x.first=P);const C={};this.sourceBuffers.forEach(([U,O])=>{U&&(C[U]=Fe.getBuffered(O))}),this.appendErrors[r]=0,r==="audio"||r==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(R.BUFFER_APPENDED,{type:r,frag:l,part:u,chunkMeta:d,parent:l.type,timeRanges:C})},onError:P=>{var C;const U={type:Re.MEDIA_ERROR,parent:l.type,details:H.BUFFER_APPEND_ERROR,sourceBufferName:r,frag:l,part:u,chunkMeta:d,error:P,err:P,fatal:!1},O=(C=this.media)==null?void 0:C.error;if(P.code===DOMException.QUOTA_EXCEEDED_ERR||P.name=="QuotaExceededError"||"quota"in P)U.details=H.BUFFER_FULL_ERROR;else if(P.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!O)U.errorAction=Eo(!0);else if(P.name===aR&&this.sourceBufferCount===0)U.errorAction=Eo(!0);else{const W=++this.appendErrors[r];this.warn(`Failed ${W}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${r}" sourceBuffer (${O||"no media error"})`),(W>=this.hls.config.appendErrorMaxRetry||O)&&(U.fatal=!0)}this.hls.trigger(R.ERROR,U)}};this.log(`queuing "${r}" append sn: ${m}${u?" p: "+u.index:""} of ${l.type===ye.MAIN?"level":"track"} ${l.level} cc: ${v}`),this.append(M,r,this.isPending(this.tracks[r]))}getFlushOp(e,t,n){return this.log(`queuing "${e}" remove ${t}-${n}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(R.BUFFER_FLUSHED,{type:e})},onError:i=>{this.warn(`Failed to remove ${t}-${n} from "${e}" SourceBuffer`,i)}}}onBufferFlushing(e,t){const{type:n,startOffset:i,endOffset:r}=t;n?this.append(this.getFlushOp(n,i,r),n):this.sourceBuffers.forEach(([o])=>{o&&this.append(this.getFlushOp(o,i,r),o)})}onFragParsed(e,t){const{frag:n,part:i}=t,r=[],o=i?i.elementaryStreams:n.elementaryStreams;o[nt.AUDIOVIDEO]?r.push("audiovideo"):(o[nt.AUDIO]&&r.push("audio"),o[nt.VIDEO]&&r.push("video"));const l=()=>{const u=self.performance.now();n.stats.buffering.end=u,i&&(i.stats.buffering.end=u);const d=i?i.stats:n.stats;this.hls.trigger(R.FRAG_BUFFERED,{frag:n,part:i,stats:d,id:n.type})};r.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(l,r).catch(u=>{this.warn(`Fragment buffered callback ${u}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var n;this.sourceBuffers.forEach(([o])=>{if(o){const l=this.tracks[o];(!t.type||t.type===o)&&(l.ending=!0,l.ended||(l.ended=!0,this.log(`${o} buffer reached EOS`)))}});const i=((n=this.overrides)==null?void 0:n.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([o])=>{var l;return o&&!((l=this.tracks[o])!=null&&l.ended)})?i?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:o}=this;if(!o||o.readyState!=="open"){o&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${o.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),o.endOfStream(),this.hls.trigger(R.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(R.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===H.BUFFER_APPEND_ERROR&&t.frag){var n;const i=(n=t.errorAction)==null?void 0:n.nextAutoLevel;pe(i)&&i!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.sourceBufferCount)return;const i=e.config,r=n.currentTime,o=t.levelTargetDuration,l=t.live&&i.liveBackBufferLength!==null?i.liveBackBufferLength:i.backBufferLength;if(pe(l)&&l>=0){const d=Math.max(l,o),h=Math.floor(r/o)*o-d;this.flushBackBuffer(r,o,h)}const u=i.frontBufferFlushThreshold;if(pe(u)&&u>0){const d=Math.max(i.maxBufferLength,u),h=Math.max(d,o),p=Math.floor(r/o)*o+h;this.flushFrontBuffer(r,o,p)}}flushBackBuffer(e,t,n){this.sourceBuffers.forEach(([i,r])=>{if(r){const l=Fe.getBuffered(r);if(l.length>0&&n>l.start(0)){var o;this.hls.trigger(R.BACK_BUFFER_REACHED,{bufferEnd:n});const u=this.tracks[i];if((o=this.details)!=null&&o.live)this.hls.trigger(R.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(u!=null&&u.ended){this.log(`Cannot flush ${i} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(R.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:i})}}})}flushFrontBuffer(e,t,n){this.sourceBuffers.forEach(([i,r])=>{if(r){const o=Fe.getBuffered(r),l=o.length;if(l<2)return;const u=o.start(l-1),d=o.end(l-1);if(n>u||e>=u&&e<=d)return;this.hls.trigger(R.BUFFER_FLUSHING,{startOffset:u,endOffset:1/0,type:i})}})}getDurationAndRange(){var e;const{details:t,mediaSource:n}=this;if(!t||!this.media||(n==null?void 0:n.readyState)!=="open")return null;const i=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&n.setLiveSeekableRange){const d=Math.max(0,t.fragmentStart),h=Math.max(d,i);return{duration:1/0,start:d,end:h}}return{duration:1/0}}const r=(e=this.overrides)==null?void 0:e.duration;if(r)return pe(r)?{duration:r}:null;const o=this.media.duration,l=pe(n.duration)?n.duration:0;return i>l&&i>o||!pe(o)?{duration:i}:null}updateMediaSource({duration:e,start:t,end:n}){const i=this.mediaSource;!this.media||!i||i.readyState!=="open"||(i.duration!==e&&(pe(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),i.duration=e),t!==void 0&&n!==void 0&&(this.log(`MediaSource duration is set to ${i.duration}. Setting seekable range to ${t}-${n}.`),i.setLiveSeekableRange(t,n)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:n}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${it(n)}`),this.tracksReady){var i;const r=(i=this.transferData)==null?void 0:i.tracks;r&&Object.keys(r).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,n])=>{if(t){const i=this.tracks[t];e[t]={buffer:n,container:i.container,codec:i.codec,supplemental:i.supplemental,levelCodec:i.levelCodec,id:i.id,metadata:i.metadata}}}),this.hls.trigger(R.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const r in e){const o=r,l=e[o];if(this.isPending(l)){const u=this.getTrackCodec(l,o),d=`${l.container};codecs=${u}`;l.codec=u,this.log(`creating sourceBuffer(${d})${this.currentOp(o)?" Queued":""} ${it(l)}`);try{const h=n.addSourceBuffer(d),p=ap(o),m=[o,h];t[p]=m,l.buffer=h}catch(h){var i;this.error(`error while trying to add sourceBuffer: ${h.message}`),this.shiftAndExecuteNext(o),(i=this.operationQueue)==null||i.removeBlockers(),delete this.tracks[o],this.hls.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,sourceBufferName:o,mimeType:d,parent:l.id});return}this.trackSourceBuffer(o,l)}}this.bufferCreated()}getTrackCodec(e,t){const n=e.supplemental;let i=e.codec;n&&(t==="video"||t==="audiovideo")&&pl(n,"video")&&(i=s$(i,n));const r=ku(i,e.levelCodec);return r?t.slice(0,5)==="audio"?Qu(r,this.appendSource):r:""}trackSourceBuffer(e,t){const n=t.buffer;if(!n)return;const i=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:i,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(r,o)=>{const l=o.removedRanges;l!=null&&l.length&&this.hls.trigger(R.BUFFER_FLUSHED,{type:r})})}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n==null?void 0:n.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${i}`,t),this.hls.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const r=this.currentOp(e);r&&r.onError(i)}updateTimestampOffset(e,t,n,i,r,o){const l=t-e.timestampOffset;Math.abs(l)>=n&&(this.log(`Updating ${i} SourceBuffer timestampOffset to ${t} (sn: ${r} cc: ${o})`),e.timestampOffset=t)}removeExecutor(e,t,n){const{media:i,mediaSource:r}=this,o=this.tracks[e],l=o==null?void 0:o.buffer;if(!i||!r||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const u=pe(i.duration)?i.duration:1/0,d=pe(r.duration)?r.duration:1/0,h=Math.max(0,t),p=Math.min(n,u,d);p>h&&(!o.ending||o.ended)?(o.ended=!1,this.log(`Removing [${h},${p}] from the ${e} SourceBuffer`),l.remove(h,p)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.tracks[t],i=n==null?void 0:n.buffer;if(!i)throw new h4(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);n.ending=!1,n.ended=!1,i.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:n}=this,i=t.map(o=>this.appendBlocker(o));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(i).then(o=>{n===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var n;const i=(n=this.tracks[t])==null?void 0:n.buffer;!i||i.updating||this.shiftAndExecuteNext(t)})}append(e,t,n){this.operationQueue&&this.operationQueue.append(e,t,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,n){const i=this.tracks[e];if(!i)return;const r=i.buffer;if(!r)return;const o=n.bind(this,e);i.listeners.push({event:t,listener:o}),r.addEventListener(t,o)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const n=t.buffer;n&&(t.listeners.forEach(i=>{n.removeEventListener(i.event,i.listener)}),t.listeners.length=0)}}function vT(s){const e=s.querySelectorAll("source");[].slice.call(e).forEach(t=>{s.removeChild(t)})}function p4(s,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,s.appendChild(t)}function ap(s){return s==="audio"?1:0}class Zg{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(R.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.BUFFER_CODECS,this.onBufferCodecs,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(R.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.BUFFER_CODECS,this.onBufferCodecs,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&pe(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((i,r)=>this.isLevelAllowed(i)&&r<=e);return this.clientRect=null,Zg.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const i=(l,u)=>u?l.width!==u.width||l.height!==u.height:!0;let r=e.length-1;const o=Math.max(t,n);for(let l=0;l<e.length;l+=1){const u=e[l];if((u.width>=o||u.height>=o)&&i(u,e[l+1])){r=l;break}}return r}}const m4={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},gn=m4,g4={HLS:"h"},y4=g4;class ks{constructor(e,t){Array.isArray(e)&&(e=e.map(n=>n instanceof ks?n:new ks(n))),this.value=e,this.params=t}}const v4="Dict";function x4(s){return Array.isArray(s)?JSON.stringify(s):s instanceof Map?"Map{}":s instanceof Set?"Set{}":typeof s=="object"?JSON.stringify(s):String(s)}function S4(s,e,t,n){return new Error(`failed to ${s} "${x4(e)}" as ${t}`,{cause:n})}function Cs(s,e,t){return S4("serialize",s,e,t)}class lR{constructor(e){this.description=e}}const xT="Bare Item",E4="Boolean";function T4(s){if(typeof s!="boolean")throw Cs(s,E4);return s?"?1":"?0"}function b4(s){return btoa(String.fromCharCode(...s))}const A4="Byte Sequence";function w4(s){if(ArrayBuffer.isView(s)===!1)throw Cs(s,A4);return`:${b4(s)}:`}const R4="Integer";function L4(s){return s<-999999999999999||999999999999999<s}function cR(s){if(L4(s))throw Cs(s,R4);return s.toString()}function I4(s){return`@${cR(s.getTime()/1e3)}`}function uR(s,e){if(s<0)return-uR(-s,e);const t=Math.pow(10,e);if(Math.abs(s*t%1-.5)<Number.EPSILON){const i=Math.floor(s*t);return(i%2===0?i:i+1)/t}else return Math.round(s*t)/t}const _4="Decimal";function k4(s){const e=uR(s,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Cs(s,_4);const t=e.toString();return t.includes(".")?t:`${t}.0`}const C4="String",P4=/[\x00-\x1f\x7f]+/;function D4(s){if(P4.test(s))throw Cs(s,C4);return`"${s.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function O4(s){return s.description||s.toString().slice(7,-1)}const N4="Token";function ST(s){const e=O4(s);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Cs(e,N4);return e}function Lm(s){switch(typeof s){case"number":if(!pe(s))throw Cs(s,xT);return Number.isInteger(s)?cR(s):k4(s);case"string":return D4(s);case"symbol":return ST(s);case"boolean":return T4(s);case"object":if(s instanceof Date)return I4(s);if(s instanceof Uint8Array)return w4(s);if(s instanceof lR)return ST(s);default:throw Cs(s,xT)}}const M4="Key";function Im(s){if(/^[a-z*][a-z0-9\-_.*]*$/.test(s)===!1)throw Cs(s,M4);return s}function e0(s){return s==null?"":Object.entries(s).map(([e,t])=>t===!0?`;${Im(e)}`:`;${Im(e)}=${Lm(t)}`).join("")}function dR(s){return s instanceof ks?`${Lm(s.value)}${e0(s.params)}`:Lm(s)}function F4(s){return`(${s.value.map(dR).join(" ")})${e0(s.params)}`}function B4(s,e={whitespace:!0}){if(typeof s!="object"||s==null)throw Cs(s,v4);const t=s instanceof Map?s.entries():Object.entries(s),n=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([i,r])=>{r instanceof ks||(r=new ks(r));let o=Im(i);return r.value===!0?o+=e0(r.params):(o+="=",Array.isArray(r.value)?o+=F4(r):o+=dR(r)),o}).join(`,${n}`)}function hR(s,e){return B4(s,e)}const vs="CMCD-Object",gt="CMCD-Request",ar="CMCD-Session",Ti="CMCD-Status",U4={br:vs,ab:vs,d:vs,ot:vs,tb:vs,tpb:vs,lb:vs,tab:vs,lab:vs,url:vs,pb:gt,bl:gt,tbl:gt,dl:gt,ltc:gt,mtp:gt,nor:gt,nrr:gt,rc:gt,sn:gt,sta:gt,su:gt,ttfb:gt,ttfbb:gt,ttlb:gt,cmsdd:gt,cmsds:gt,smrt:gt,df:gt,cs:gt,ts:gt,cid:ar,pr:ar,sf:ar,sid:ar,st:ar,v:ar,msd:ar,bs:Ti,bsd:Ti,cdn:Ti,rtp:Ti,bg:Ti,pt:Ti,ec:Ti,e:Ti},$4={REQUEST:gt};function j4(s){return Object.keys(s).reduce((e,t)=>{var n;return(n=s[t])===null||n===void 0||n.forEach(i=>e[i]=t),e},{})}function V4(s,e){const t={};if(!s)return t;const n=Object.keys(s),i=e?j4(e):{};return n.reduce((r,o)=>{var l;const u=U4[o]||i[o]||$4.REQUEST,d=(l=r[u])!==null&&l!==void 0?l:r[u]={};return d[o]=s[o],r},t)}function G4(s){return["ot","sf","st","e","sta"].includes(s)}function K4(s){return typeof s=="number"?pe(s):s!=null&&s!==""&&s!==!1}const fR="event";function H4(s,e){const t=new URL(s),n=new URL(e);if(t.origin!==n.origin)return s;const i=t.pathname.split("/").slice(1),r=n.pathname.split("/").slice(1,-1);for(;i[0]===r[0];)i.shift(),r.shift();for(;r.length;)r.shift(),i.unshift("..");return i.join("/")+t.search+t.hash}const Nu=s=>Math.round(s),_m=(s,e)=>Array.isArray(s)?s.map(t=>_m(t,e)):s instanceof ks&&typeof s.value=="string"?new ks(_m(s.value,e),s.params):(e.baseUrl&&(s=H4(s,e.baseUrl)),e.version===1?encodeURIComponent(s):s),cu=s=>Nu(s/100)*100,z4=(s,e)=>{let t=s;return e.version>=2&&(s instanceof ks&&typeof s.value=="string"?t=new ks([s]):typeof s=="string"&&(t=[s])),_m(t,e)},W4={br:Nu,d:Nu,bl:cu,dl:cu,mtp:cu,nor:z4,rtp:cu,tb:Nu},pR="request",mR="response",t0=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],q4=["e"],Y4=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Rd(s){return Y4.test(s)}function Q4(s){return t0.includes(s)||q4.includes(s)||Rd(s)}const gR=["d","dl","nor","ot","rtp","su"];function X4(s){return t0.includes(s)||gR.includes(s)||Rd(s)}const J4=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function Z4(s){return t0.includes(s)||gR.includes(s)||J4.includes(s)||Rd(s)}const e5=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function t5(s){return e5.includes(s)||Rd(s)}const n5={[mR]:Z4,[fR]:Q4,[pR]:X4};function yR(s,e={}){const t={};if(s==null||typeof s!="object")return t;const n=e.version||s.v||1,i=e.reportingMode||pR,r=n===1?t5:n5[i];let o=Object.keys(s).filter(r);const l=e.filter;typeof l=="function"&&(o=o.filter(l));const u=i===mR||i===fR;u&&!o.includes("ts")&&o.push("ts"),n>1&&!o.includes("v")&&o.push("v");const d=tt({},W4,e.formatters),h={version:n,reportingMode:i,baseUrl:e.baseUrl};return o.sort().forEach(p=>{let m=s[p];const v=d[p];if(typeof v=="function"&&(m=v(m,h)),p==="v"){if(n===1)return;m=n}p=="pr"&&m===1||(u&&p==="ts"&&!pe(m)&&(m=Date.now()),K4(m)&&(G4(p)&&typeof m=="string"&&(m=new lR(m)),t[p]=m))}),t}function s5(s,e={}){const t={};if(!s)return t;const n=yR(s,e),i=V4(n,e==null?void 0:e.customHeaderMap);return Object.entries(i).reduce((r,[o,l])=>{const u=hR(l,{whitespace:!1});return u&&(r[o]=u),r},t)}function i5(s,e,t){return tt(s,s5(e,t))}const r5="CMCD";function o5(s,e={}){return s?hR(yR(s,e),{whitespace:!1}):""}function a5(s,e={}){if(!s)return"";const t=o5(s,e);return encodeURIComponent(t)}function l5(s,e={}){if(!s)return"";const t=a5(s,e);return`${r5}=${t}`}const ET=/CMCD=[^&#]+/;function c5(s,e,t){const n=l5(e,t);if(!n)return s;if(ET.test(s))return s.replace(ET,n);const i=s.includes("?")?"&":"?";return`${s}${i}${n}`}class u5{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=i=>{try{this.apply(i,{ot:gn.MANIFEST,su:!this.initialized})}catch(r){this.hls.logger.warn("Could not generate manifest CMCD data.",r)}},this.applyFragmentData=i=>{try{const{frag:r,part:o}=i,l=this.hls.levels[r.level],u=this.getObjectType(r),d={d:(o||r).duration*1e3,ot:u};(u===gn.VIDEO||u===gn.AUDIO||u==gn.MUXED)&&(d.br=l.bitrate/1e3,d.tb=this.getTopBandwidth(u)/1e3,d.bl=this.getBufferLength(u));const h=o?this.getNextPart(o):this.getNextFrag(r);h!=null&&h.url&&h.url!==r.url&&(d.nor=h.url),this.apply(i,d)}catch(r){this.hls.logger.warn("Could not generate segment CMCD data.",r)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHED,this.onMediaDetached,this),e.on(R.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHED,this.onMediaDetached,this),e.off(R.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,i;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(i=t.tracks.video)==null?void 0:i.buffer}createData(){var e;return{v:1,sf:y4.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){tt(t,this.createData());const n=t.ot===gn.INIT||t.ot===gn.VIDEO||t.ot===gn.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce((o,l)=>(i.includes(l)&&(o[l]=t[l]),o),{}));const r={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),i5(e.headers,t,r)):e.url=c5(e.url,t,r)}getNextFrag(e){var t;const n=(t=this.hls.levels[e.level])==null?void 0:t.details;if(n){const i=e.sn-n.startSN;return n.fragments[i+1]}}getNextPart(e){var t;const{index:n,fragment:i}=e,r=(t=this.hls.levels[i.level])==null||(t=t.details)==null?void 0:t.partList;if(r){const{sn:o}=i;for(let l=r.length-1;l>=0;l--){const u=r[l];if(u.index===n&&u.fragment.sn===o)return r[l+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return gn.TIMED_TEXT;if(e.sn==="initSegment")return gn.INIT;if(t==="audio")return gn.AUDIO;if(t==="main")return this.hls.audioTracks.length?gn.VIDEO:gn.MUXED}getTopBandwidth(e){let t=0,n;const i=this.hls;if(e===gn.AUDIO)n=i.audioTracks;else{const r=i.maxAutoLevel,o=r>-1?r+1:i.levels.length;n=i.levels.slice(0,o)}return n.forEach(r=>{r.bitrate>t&&(t=r.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,n=e===gn.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Fe.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new n(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,o,l){t(r),this.loader.load(r,o,l)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(r){this.loader=void 0,this.loader=new n(r)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(r,o,l){t(r),this.loader.load(r,o,l)}}}}const d5=3e5;class h5 extends Wn{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===Kt.SendAlternateToPenaltyBox&&n.flags===_n.MoveAllAlternatesMatchingHost){const i=this.levels;let r=this._pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:l,pathwayId:u,type:d}=t.context;l&&i?o=this.getPathwayForGroupId(l,d,o):u&&(o=u)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!r&&i&&(r=this.pathways()),r&&r.length>1&&(this.updatePathwayPriority(r),n.resolved=this.pathwayId!==o),t.details===H.BUFFER_APPEND_ERROR&&!t.fatal?n.resolved=!0:n.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${i&&i.length} priorities: ${it(r)} penalized: ${it(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(r=>{i-n[r]>d5&&delete n[r]});for(let r=0;r<e.length;r++){const o=e[r];if(o in n)continue;if(o===this.pathwayId)return;const l=this.hls.nextLoadLevel,u=this.hls.levels[l];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,Fw(t),this.hls.trigger(R.LEVELS_UPDATED,{levels:t});const d=this.hls.levels[l];u&&d&&this.levels&&(d.attrs["STABLE-VARIANT-ID"]!==u.attrs["STABLE-VARIANT-ID"]&&d.bitrate!==u.bitrate&&this.log(`Unstable Pathways change from bitrate ${u.bitrate} to ${d.bitrate}`),this.hls.nextLoadLevel=l);break}}}getPathwayForGroupId(e,t,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let r=0;r<i.length;r++)if(t===Ge.AUDIO_TRACK&&i[r].hasAudioGroup(e)||t===Ge.SUBTITLE_TRACK&&i[r].hasSubtitleGroup(e))return i[r].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},i={};e.forEach(r=>{const{ID:o,"BASE-ID":l,"URI-REPLACEMENT":u}=r;if(t.some(h=>h.pathwayId===o))return;const d=this.getLevelsForPathway(l).map(h=>{const p=new ht(h.attrs);p["PATHWAY-ID"]=o;const m=p.AUDIO&&`${p.AUDIO}_clone_${o}`,v=p.SUBTITLES&&`${p.SUBTITLES}_clone_${o}`;m&&(n[p.AUDIO]=m,p.AUDIO=m),v&&(i[p.SUBTITLES]=v,p.SUBTITLES=v);const y=vR(h.uri,p["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",u),S=new gl({attrs:p,audioCodec:h.audioCodec,bitrate:h.bitrate,height:h.height,name:h.name,url:y,videoCodec:h.videoCodec,width:h.width});if(h.audioGroups)for(let x=1;x<h.audioGroups.length;x++)S.addGroupId("audio",`${h.audioGroups[x]}_clone_${o}`);if(h.subtitleGroups)for(let x=1;x<h.subtitleGroups.length;x++)S.addGroupId("text",`${h.subtitleGroups[x]}_clone_${o}`);return S});t.push(...d),TT(this.audioTracks,n,u,o),TT(this.subtitleTracks,i,u,o)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let i;try{i=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(i.protocol!=="data:"){const h=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+h)}const r={responseType:"json",url:i.href},o=t.steeringManifestLoadPolicy.default,l=o.errorRetry||o.timeoutRetry||{},u={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},d={onSuccess:(h,p,m,v)=>{this.log(`Loaded steering manifest: "${i}"`);const y=h.data;if((y==null?void 0:y.VERSION)!==1){this.log(`Steering VERSION ${y.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=y.TTL;const{"RELOAD-URI":S,"PATHWAY-CLONES":x,"PATHWAY-PRIORITY":b}=y;if(S)try{this.uri=new self.URL(S,i).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${S}`);return}this.scheduleRefresh(this.uri||m.url),x&&this.clonePathways(x);const w={steeringManifest:y,url:i.toString()};this.hls.trigger(R.STEERING_MANIFEST_LOADED,w),b&&this.updatePathwayPriority(b)},onError:(h,p,m,v)=>{if(this.log(`Error loading steering manifest: ${h.code} ${h.text} (${p.url})`),this.stopLoad(),h.code===410){this.enabled=!1,this.log(`Steering manifest ${p.url} no longer available`);return}let y=this.timeToLoad*1e3;if(h.code===429){const S=this.loader;if(typeof(S==null?void 0:S.getResponseHeader)=="function"){const x=S.getResponseHeader("Retry-After");x&&(y=parseFloat(x)*1e3)}this.log(`Steering manifest ${p.url} rate limited`);return}this.scheduleRefresh(this.uri||p.url,y)},onTimeout:(h,p,m)=>{this.log(`Timeout loading steering manifest (${p.url})`),this.scheduleRefresh(this.uri||p.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(r,u,d)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const i=(n=this.hls)==null?void 0:n.media;if(i&&!i.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function TT(s,e,t,n){s&&Object.keys(e).forEach(i=>{const r=s.filter(o=>o.groupId===i).map(o=>{const l=tt({},o);return l.details=void 0,l.attrs=new ht(l.attrs),l.url=l.attrs.URI=vR(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),l.groupId=l.attrs["GROUP-ID"]=e[i],l.attrs["PATHWAY-ID"]=n,l});s.push(...r)})}function vR(s,e,t,n){const{HOST:i,PARAMS:r,[t]:o}=n;let l;e&&(l=o==null?void 0:o[e],l&&(s=l));const u=new self.URL(s);return i&&!l&&(u.host=i),r&&Object.keys(r).sort().forEach(d=>{d&&u.searchParams.set(d,r[d])}),u.href}class bo extends Wn{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=bo.CDMCleanupPromise?[bo.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:n,initData:i}=t,r=`"${t.type}" event: init data type: "${n}"`;if(this.debug(r),i!==null){if(!this.keyFormatPromise){let o=Object.keys(this.keySystemAccessPromises);o.length||(o=Qa(this.config));const l=o.map(Zf).filter(u=>!!u);this.keyFormatPromise=this.getKeyFormatPromise(l)}this.keyFormatPromise.then(o=>{const l=Pu(o);if(n!=="sinf"||l!==ft.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${n}" for selected key-system ${l}`);return}let u;try{const v=Ct(new Uint8Array(i)),y=Gg(JSON.parse(v).sinf),S=hw(y);if(!S)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");u=new Uint8Array(S.subarray(8,24))}catch(v){this.warn(`${r} Failed to parse sinf: ${v}`);return}const d=Ht(u),{keyIdToKeySessionPromise:h,mediaKeySessions:p}=this;let m=h[d];for(let v=0;v<p.length;v++){const y=p[v],S=y.decryptdata;if(!S.keyId)continue;const x=Ht(S.keyId);if(td(u,S.keyId)||S.uri.replace(/-/g,"").indexOf(d)!==-1){if(m=h[x],!m)continue;if(S.pssh)break;delete h[x],S.pssh=new Uint8Array(i),S.keyId=u,m=h[d]=m.then(()=>this.generateRequestWithPreferredKeySession(y,n,i,"encrypted-event-key-match")),m.catch(b=>this.handleError(b));break}}m||this.handleError(new Error(`Key ID ${d} not encountered in playlist. Key-system sessions ${p.length}.`))}).catch(o=>this.handleError(o))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(R.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(R.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(R.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(R.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,i=t==null?void 0:t[e];if(i)return i.licenseUrl;if(e===ft.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t==null?void 0:t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(o,l,u)=>!!o&&u.indexOf(o)===l,i=t.map(o=>o.audioCodec).filter(n),r=t.map(o=>o.videoCodec).filter(n);return i.length+r.length===0&&r.push("avc1.42e01e"),new Promise((o,l)=>{const u=d=>{const h=d.shift();this.getMediaKeysPromise(h,i,r).then(p=>o({keySystem:h,mediaKeys:p})).catch(p=>{d.length?u(d):p instanceof In?l(p):l(new In({type:Re.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_ACCESS,error:p,fatal:!0},p.message))})};u(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let i=`Configured requestMediaKeySystemAccess is not a function ${n}`;return _w===null&&self.location.protocol==="http:"&&(i=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(i))}return n(e,t)}getMediaKeysPromise(e,t,n){var i;const r=z$(e,t,n,this.config.drmSystemOptions||{});let o=this.keySystemAccessPromises[e],l=(i=o)==null?void 0:i.keySystemAccess;if(!l){this.log(`Requesting encrypted media "${e}" key-system access with config: ${it(r)}`),l=this.requestMediaKeySystemAccess(e,r);const u=o=this.keySystemAccessPromises[e]={keySystemAccess:l};return l.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),l.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const h=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const p=u.mediaKeys=d.createMediaKeys().then(m=>(this.log(`Media-keys created for "${e}"`),u.hasMediaKeys=!0,h.then(v=>v?this.setMediaKeysServerCertificate(m,e,v):m)));return p.catch(m=>{this.error(`Failed to create media-keys for "${e}"}: ${m}`)}),p})}return l.then(()=>o.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Ht(e.keyId||[])} keyUri: ${e.uri}`);const i=n.createSession(),r={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(r),r}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),i=uu(t),r="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,r,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,t){const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyId ${Ht(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),n.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>Zf(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:n})=>this.attemptSetMediaKeys(t,n))}selectKeySystem(e){return new Promise((t,n)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:i})=>{const r=Zf(i);r?t(r):n(new Error(`Unable to find format for key-system "${i}"`))}).catch(n)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Qa(this.config),n=e.map(Pu).filter(i=>!!i&&t.indexOf(i)!==-1);return this.selectKeySystem(n)}getKeyStatus(e){const{mediaKeySessions:t}=this;for(let n=0;n<t.length;n++){const i=f5(e,t[n]);if(i)return i}}loadKey(e){const t=e.keyInfo.decryptdata,n=uu(t),i=this.bannedKeyIds[n];if(i||this.getKeyStatus(t)==="internal-error"){const l=bT(i||"internal-error",t);return this.handleError(l,e.frag),Promise.reject(l)}const r=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${r}`);const o=this.keyIdToKeySessionPromise[n];if(!o){const l=this.getKeySystemForKeyPromise(t).then(({keySystem:u,mediaKeys:d})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${r}`),this.attemptSetMediaKeys(u,d).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:u,mediaKeys:d,decryptdata:t}))))).then(u=>{const d="cenc",h=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(u,d,h,"playlist-key")});return l.catch(u=>this.handleError(u,e.frag)),this.keyIdToKeySessionPromise[n]=l,l}return o.catch(l=>{if(l instanceof In){const u=Ze({},l.data);this.getKeyStatus(t)==="internal-error"&&(u.decryptdata=t);const d=new In(u,l.message);this.handleError(d,e.frag)}}),o}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){if(this.hls)if(e instanceof In){t&&(e.data.frag=t);const n=e.data.decryptdata;this.error(`${e.message}${n?` (${Ht(n.keyId||[])})`:""}`),this.hls.trigger(R.ERROR,e.data)}else this.error(e.message),this.hls.trigger(R.ERROR,{type:Re.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const t=uu(e),n=this.keyIdToKeySessionPromise[t];if(!n){const i=Pu(e.keyFormat),r=i?[i]:Qa(this.config);return this.attemptKeySystemAccess(r)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Qa(this.config)),e.length===0)throw new In({type:Re.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${it({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaResolved=void 0,this.mediaKeys===t)return Promise.resolve();const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then(()=>this.media?this.media.setMediaKeys(t):new Promise((r,o)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return o(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=t,this.media.setMediaKeys(t).then(r).catch(o)}}));return this.mediaKeys=t,this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(r=>n.indexOf(r)===-1)})}generateRequestWithPreferredKeySession(e,t,n,i){var r;const o=(r=this.config.drmSystems)==null||(r=r[e.keySystem])==null?void 0:r.generateRequest;if(o)try{const y=o.call(this.hls,t,n,e);if(!y)throw new Error("Invalid response from configured generateRequest filter");t=y.initDataType,n=y.initData?y.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(y){if(this.warn(y.message),this.hls&&this.hls.config.debug)throw y}if(n===null)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const l=uu(e.decryptdata),u=e.decryptdata.uri;this.log(`Generating key-session request for "${i}" keyId: ${l} URI: ${u} (init data type: ${t} length: ${n.byteLength})`);const d=new Hg,h=e._onmessage=y=>{const S=e.mediaKeysSession;if(!S){d.emit("error",new Error("invalid state"));return}const{messageType:x,message:b}=y;this.log(`"${x}" message event for session "${S.sessionId}" message size: ${b.byteLength}`),x==="license-request"||x==="license-renewal"?this.renewLicense(e,b).catch(w=>{d.eventNames().length?d.emit("error",w):this.handleError(w)}):x==="license-release"?e.keySystem===ft.FAIRPLAY&&this.updateKeySession(e,Em("acknowledged")).then(()=>this.removeSession(e)).catch(w=>this.handleError(w)):this.warn(`unhandled media key message type "${x}"`)},p=(y,S)=>{S.keyStatus=y;let x;y.startsWith("usable")?d.emit("resolved"):y==="internal-error"||y==="output-restricted"||y==="output-downscaled"?x=bT(y,S.decryptdata):y==="expired"?x=new Error(`key expired (keyId: ${l})`):y==="released"?x=new Error("key released"):y==="status-pending"||this.warn(`unhandled key status change "${y}" (keyId: ${l})`),x&&(d.eventNames().length?d.emit("error",x):this.handleError(x))},m=e._onkeystatuseschange=y=>{if(!e.mediaKeysSession){d.emit("error",new Error("invalid state"));return}const x=this.getKeyStatuses(e);if(!Object.keys(x).some(I=>x[I]!=="status-pending"))return;if(x[l]==="expired"){this.log(`Expired key ${it(x)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let w=x[l];if(w)p(w,e);else{var L;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(L=e.keyStatusTimeouts)[l]||(L[l]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const k=this.getKeyStatus(e.decryptdata);if(k&&k!=="status-pending")return this.log(`No status for keyId ${l} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${k} from other session.`),p(k,e);this.log(`key status for ${l} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),w="internal-error",p(w,e)},1e3)),this.log(`No status for keyId ${l} (${it(x)}).`)}};cn(e.mediaKeysSession,"message",h),cn(e.mediaKeysSession,"keystatuseschange",m);const v=new Promise((y,S)=>{d.on("error",S),d.on("resolved",y)});return e.mediaKeysSession.generateRequest(t,n).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${l} URI: ${u}`)}).catch(y=>{throw new In({type:Re.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_NO_SESSION,error:y,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${y}`)}).then(()=>v).catch(y=>(d.removeAllListeners(),this.removeSession(e).then(()=>{throw y}))).then(()=>(d.removeAllListeners(),e))}getKeyStatuses(e){const t={};return e.mediaKeysSession.keyStatuses.forEach((n,i)=>{if(typeof i=="string"&&typeof n=="object"){const l=i;i=n,n=l}const r="buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i);if(e.keySystem===ft.PLAYREADY&&r.length===16){const l=Ht(r);t[l]=n,Lw(r)}const o=Ht(r);n==="internal-error"&&(this.bannedKeyIds[o]=n),this.log(`key status change "${n}" for keyStatuses keyId: ${o} key-session "${e.mediaKeysSession.sessionId}"`),t[o]=n}),t}fetchServerCertificate(e){const t=this.config,n=t.loader,i=new n(t),r=this.getServerCertificateUrl(e);return r?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,l)=>{const u={responseType:"arraybuffer",url:r},d=t.certLoadPolicy.default,h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(m,v,y,S)=>{o(m.data)},onError:(m,v,y,S)=>{l(new In({type:Re.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:Ze({url:u.url,data:void 0},m)},`"${e}" certificate request failed (${r}). Status: ${m.code} (${m.text})`))},onTimeout:(m,v,y)=>{l(new In({type:Re.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:y,response:{url:u.url,data:void 0}},`"${e}" certificate request timed out (${r})`))},onAbort:(m,v,y)=>{l(new Error("aborted"))}};i.load(u,h,p)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((i,r)=>{e.setServerCertificate(n).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${n.byteLength}) on "${t}"`),i(e)}).catch(o=>{r(new In({type:Re.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(i=>{throw new In({type:Re.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:i,fatal:!1},i.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=new DOMParser().parseFromString(n,"application/xml"),r=i.querySelectorAll("HttpHeader");if(r.length>0){let h;for(let p=0,m=r.length;p<m;p++){var o,l;h=r[p];const v=(o=h.querySelector("name"))==null?void 0:o.textContent,y=(l=h.querySelector("value"))==null?void 0:l.textContent;v&&y&&e.setRequestHeader(v,y)}}const u=i.querySelector("Challenge"),d=u==null?void 0:u.textContent;if(!d)throw new Error("Cannot find <Challenge> in key message");return Em(atob(d))}setupLicenseXHR(e,t,n,i){const r=this.config.licenseXhrSetup;return r?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return r.call(this.hls,e,t,n,i)}).catch(o=>{if(!n.decryptdata)throw o;return e.open("POST",t,!0),r.call(this.hls,e,t,n,i)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||i})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((i,r)=>{const o=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${o}`);const l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return r(new Error("invalid state"));if(l.readyState===4)if(l.status===200){this._requestLicenseFailureCount=0;let u=l.response;this.log(`License received ${u instanceof ArrayBuffer?u.byteLength:u}`);const d=this.config.licenseResponseCallback;if(d)try{u=d.call(this.hls,l,o,e)}catch(h){this.error(h)}i(u)}else{const u=n.errorRetry,d=u?u.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>d||l.status>=400&&l.status<500)r(new In({type:Re.KEY_SYSTEM_ERROR,details:H.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:l,response:{url:o,data:void 0,code:l.status,text:l.statusText}},`License Request XHR failed (${o}). Status: ${l.status} (${l.statusText})`));else{const h=d-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${h} attempts left`),this.requestLicense(e,t).then(i,r)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=l,this.setupLicenseXHR(l,o,e,t).then(({xhr:u,licenseChallenge:d})=>{e.keySystem==ft.PLAYREADY&&(d=this.unpackPlayReadyKeyMessage(u,d)),u.send(d)}).catch(r)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,cn(n,"encrypted",this.onMediaEncrypted),cn(n,"waitingforkey",this.onWaitingForKey);const i=this.mediaResolved;i?i():this.mediaKeys=n.mediaKeys}onMediaDetached(){const e=this.media;e&&(xn(e,"encrypted",this.onMediaEncrypted),xn(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const t=this.mediaResolved;if(t&&t(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const n=this.media,i=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Bi.clearKeyUriToKeyIdMap();const r=i.length;bo.CDMCleanupPromise=Promise.all(i.map(o=>this.removeSession(o)).concat((n==null||(e=n.setMediaKeys(null))==null?void 0:e.catch(o=>{this.log(`Could not clear media keys: ${o}`),this.hls&&this.hls.trigger(R.ERROR,{type:Re.OTHER_ERROR,details:H.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${o}`)})}))||Promise.resolve())).catch(o=>{this.log(`Could not close sessions and clear media keys: ${o}`),this.hls&&this.hls.trigger(R.ERROR,{type:Re.OTHER_ERROR,details:H.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${o}`)})}).then(()=>{r&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((i,r)=>(i.indexOf(r.keyFormat)===-1&&i.push(r.keyFormat),i),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n,decryptdata:i}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${Ht((i==null?void 0:i.keyId)||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(e);r>-1&&this.mediaKeySessions.splice(r,1);const{keyStatusTimeouts:o}=e;o&&Object.keys(o).forEach(d=>self.clearTimeout(o[d]));const{drmSystemOptions:l}=this.config;return(q$(l)?new Promise((d,h)=>{self.setTimeout(()=>h(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(d).catch(h)}):Promise.resolve()).catch(d=>{this.log(`Could not remove session: ${d}`),this.hls&&this.hls.trigger(R.ERROR,{type:Re.OTHER_ERROR,details:H.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${d}`)})}).then(()=>t.close()).catch(d=>{this.log(`Could not close session: ${d}`),this.hls&&this.hls.trigger(R.ERROR,{type:Re.OTHER_ERROR,details:H.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${d}`)})})}return Promise.resolve()}}bo.CDMCleanupPromise=void 0;function uu(s){if(!s)throw new Error("Could not read keyId of undefined decryptdata");if(s.keyId===null)throw new Error("keyId is null");return Ht(s.keyId)}function f5(s,e){if(s.keyId&&e.mediaKeysSession.keyStatuses.has(s.keyId))return e.mediaKeysSession.keyStatuses.get(s.keyId);if(s.matches(e.decryptdata))return e.keyStatus}class In extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function bT(s,e){const t=s==="output-restricted",n=t?H.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:H.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new In({type:Re.KEY_SYSTEM_ERROR,details:n,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${s}"`)}class p5{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(R.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(R.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const i=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=i,i&&typeof i.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,n){const i=performance.now();if(t){if(this.lastTime){const r=i-this.lastTime,o=n-this.lastDroppedFrames,l=t-this.lastDecodedFrames,u=1e3*o/r,d=this.hls;if(d.trigger(R.FPS_DROP,{currentDropped:o,currentDecoded:l,totalDroppedFrames:n}),u>0&&o>d.config.fpsDroppedMonitoringThreshold*l){let h=d.currentLevel;d.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(d.autoLevelCapping===-1||d.autoLevelCapping>=h)&&(h=h-1,d.trigger(R.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:d.currentLevel}),d.autoLevelCapping=h,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function xR(s,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=s,e.dispatchEvent(t)}function SR(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues&&!s.cues.getCueById(e.id))try{if(s.addCue(e),!s.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){et.debug(`[texttrack-utils]: ${n}`);try{const i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,s.addCue(i)}catch(i){et.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${i}`)}}t==="disabled"&&(s.mode=t)}function xo(s,e){const t=s.mode;if(t==="disabled"&&(s.mode="hidden"),s.cues)for(let n=s.cues.length;n--;)e&&s.cues[n].removeEventListener("enter",e),s.removeCue(s.cues[n]);t==="disabled"&&(s.mode=t)}function km(s,e,t,n){const i=s.mode;if(i==="disabled"&&(s.mode="hidden"),s.cues&&s.cues.length>0){const r=g5(s.cues,e,t);for(let o=0;o<r.length;o++)(!n||n(r[o]))&&s.removeCue(r[o])}i==="disabled"&&(s.mode=i)}function m5(s,e){if(e<=s[0].startTime)return 0;const t=s.length-1;if(e>s[t].endTime)return-1;let n=0,i=t,r;for(;n<=i;)if(r=Math.floor((i+n)/2),e<s[r].startTime)i=r-1;else if(e>s[r].startTime&&n<t)n=r+1;else return r;return s[n].startTime-e<e-s[i].startTime?n:i}function g5(s,e,t){const n=[],i=m5(s,e);if(i>-1)for(let r=i,o=s.length;r<o;r++){const l=s[r];if(l.startTime>=e&&l.endTime<=t)n.push(l);else if(l.startTime>t)return n}return n}function Mu(s){const e=[];for(let t=0;t<s.length;t++){const n=s[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(s[t])}return e}class y5 extends Jg{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=Mu(this.media.textTracks);for(let r=0;r<n.length;r++)if(n[r].mode==="hidden")t=n[r];else if(n[r].mode==="showing"){t=n[r];break}const i=this.findTrackForTextTrack(t);this.subtitleTrack!==i&&this.setSubtitleTrack(i)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(R.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVEL_LOADING,this.onLevelLoading,this),e.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(R.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const n=this.media;if(!n)return;const i=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,i)return;Mu(n.textTracks).forEach(o=>{xo(o)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:i,details:r}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==i){this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${o==null?void 0:o.groupId}`);return}const l=o.details;o.details=t.details,this.log(`Subtitle track ${n} "${o.name}" lang:${o.lang} group:${i} loaded [${r.startSN}-${r.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,i=this.groupIds;let r=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(o=>(i==null?void 0:i.indexOf(o))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(h=>!n||n.indexOf(h.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(h=>h.default)&&(this.selectDefaultTrack=!1),o.forEach((h,p)=>{h.id=p});else if(!r&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const l=this.hls.config.subtitlePreference;if(!r&&l){this.selectDefaultTrack=!1;const h=As(l,o);if(h>-1)r=o[h];else{const p=As(l,this.tracks);r=this.tracks[p]}}let u=this.findTrackId(r);u===-1&&r&&(u=this.findTrackId(null));const d={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(R.SUBTITLE_TRACKS_UPDATED,d),u!==-1&&this.trackId===-1&&this.setSubtitleTrack(u)}}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const r=t[i];if(!(n&&!r.default||!n&&!e)&&(!e||Lr(r,e)))return i}if(e){for(let i=0;i<t.length;i++){const r=t[i];if(Sl(e.attrs,r.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<t.length;i++){const r=t[i];if(Sl(e.attrs,r.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const i=t[n];if(Rm(i,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Ge.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Lr(e,n))return n;const i=As(e,this.tracksInGroup);if(i>-1){const r=this.tracksInGroup[i];return this.setSubtitleTrack(i),r}else{if(n)return null;{const r=As(e,t);if(r>-1)return t[r]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,i=e.groupId,r=this.getUrlWithDirectives(e.url,t),o=e.details,l=o==null?void 0:o.age;this.log(`Loading subtitle ${n} "${e.name}" lang:${e.lang} group:${i}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${l&&o.live?" age "+l.toFixed(1)+(o.type&&" "+o.type||""):""} ${r}`),this.hls.trigger(R.SUBTITLE_TRACK_LOADING,{url:r,id:n,groupId:i,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Mu(e.textTracks),n=this.currentTrack;let i;if(n&&(i=t.filter(r=>Rm(n,r))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(r=>{r.mode!=="disabled"&&r!==i&&(r.mode="disabled")}),i){const r=this.subtitleDisplay?"showing":"hidden";i.mode!==r&&(i.mode=r)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!pe(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i){this.hls.trigger(R.SUBTITLE_TRACK_SWITCH,{id:e});return}const r=!!i.details&&!i.details.live;if(e===this.trackId&&i===n&&r)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:o,groupId:l="",name:u,type:d,url:h}=i;this.hls.trigger(R.SUBTITLE_TRACK_SWITCH,{id:o,groupId:l,name:u,type:d,url:h});const p=this.switchParams(i.url,n==null?void 0:n.details,i.details);this.loadPlaylist(p)}}function v5(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(i=="x"?r:r&3|8).toString(16)})}}}function rl(s){let e=5381,t=s.length;for(;t;)e=e*33^s.charCodeAt(--t);return(e>>>0).toString()}const Ao=.025;let rd=(function(s){return s[s.Point=0]="Point",s[s.Range=1]="Range",s})({});function x5(s,e,t){return`${s.identifier}-${t+1}-${rl(e)}`}class S5{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const n=this.playoutLimit;return e<=0||isNaN(n)?!1:n===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>n}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return lp(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,n=lp(t,e);return t-n<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=pe(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return lp(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Ao))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?rd.Range:rd.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return E5(this)}}function lp(s,e){return s-e.start<e.duration/2&&!(Math.abs(s-(e.start+e.duration))<Ao)?e.start:e.start+e.duration}function ER(s,e,t){const n=new self.URL(s,t);return n.protocol!=="data:"&&n.searchParams.set("_HLS_primary_id",e),n}function cp(s,e){for(;(t=s.assetList[++e])!=null&&t.error;)var t;return e}function E5(s){return`["${s.identifier}" ${s.cue.pre?"<pre>":s.cue.post?"<post>":""}${s.timelineStart.toFixed(2)}-${s.resumeTime.toFixed(2)}]`}function fo(s){const e=s.timelineStart,t=s.duration||0;return`["${s.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class T5{constructor(e,t,n,i){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(R.PLAYOUT_LIMIT_REACHED,{})};const r=this.hls=new e(t);this.interstitial=n,this.assetItem=i;const o=()=>{this.hasDetails=!0};r.once(R.LEVEL_LOADED,o),r.once(R.AUDIO_TRACK_LOADED,o),r.once(R.SUBTITLE_TRACK_LOADED,o),r.on(R.MEDIA_ATTACHING,(l,{media:u})=>{this.removeMediaListeners(),this.mediaAttached=u,this.interstitial.playoutLimit&&(u.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&r.on(R.BUFFER_APPENDED,()=>{const h=this.bufferedEnd;this.reachedPlayout(h)&&(this._bufferedEosTime=h,r.trigger(R.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=ER(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;const n=Math.min(this._bufferedEosTime||1/0,this.duration),i=this.timelineOffset,r=Fe.bufferInfo(e,i,0);return this.getAssetTime(r.end)>=n-.02}reachedPlayout(e){const n=this.interstitial.playoutLimit;return this.startOffset+e>=n}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Fe.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const n=t-this.startOffset;if(n>0&&n<e)return n}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const n=e-t;if(Math.abs(n)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-t),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=n=>delete n.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,n){var i;(i=this.hls)==null||i.on(e,t)}once(e,t,n){var i;(i=this.hls)==null||i.once(e,t)}off(e,t,n){var i;(i=this.hls)==null||i.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${fo(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const AT=.033;class b5 extends Wn{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((n,i)=>e<=i.startOffset&&t>i.startOffset?(delete i.error,n+1):n,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const i=this.items;if(i)for(i[n]||(t===void 0&&(t=e.start),n=this.findItemIndexAtTime(t));n>=0&&(r=i[n])!=null&&r.event;){var r;n--}return n}findItemIndexAtTime(e,t){const n=this.items;if(n)for(let i=0;i<n.length;i++){let r=n[i];if(t&&t!=="primary"&&(r=r[t]),e===r.start||e>r.start&&e<r.end)return i}return-1}findJumpRestrictedIndex(e,t){const n=this.items;if(n)for(let i=e;i<=t&&n[i];i++){const r=n[i].event;if(r!=null&&r.restrictions.jump&&!r.appendInPlace)return i}return-1}findEventIndex(e){const t=this.items;if(t)for(let i=t.length;i--;){var n;if(((n=t[i].event)==null?void 0:n.identifier)===e)return i}return-1}findAssetIndex(e,t){const n=e.assetList,i=n.length;if(i>1)for(let r=0;r<i;r++){const o=n[r];if(!o.error){const l=o.timelineStart;if(t===l||t>l&&(t<l+(o.duration||0)||r===i-1))return r}}return 0}get assetIdAtEnd(){var e;const t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){const n=t.assetList,i=n[n.length-1];if(i)return i.identifier}return null}parseInterstitialDateRanges(e,t){const n=e.main.details,{dateRanges:i}=n,r=this.events,o=this.parseDateRanges(i,{url:n.url},t),l=Object.keys(i),u=r?r.filter(d=>!l.includes(d.identifier)):[];o.length&&o.sort((d,h)=>{const p=d.cue.pre,m=d.cue.post,v=h.cue.pre,y=h.cue.post;if(p&&!v)return-1;if(v&&!p||m&&!y)return 1;if(y&&!m)return-1;if(!p&&!v&&!m&&!y){const S=d.startTime,x=h.startTime;if(S!==x)return S-x}return d.dateRange.tagOrder-h.dateRange.tagOrder}),this.events=o,u.forEach(d=>{this.removeEvent(d)}),this.updateSchedule(e,u)}updateSchedule(e,t=[],n=!1){const i=this.events||[];if(i.length||t.length||this.length<2){const r=this.items,o=this.parseSchedule(i,e);(n||t.length||(r==null?void 0:r.length)!==o.length||o.some((u,d)=>Math.abs(u.playout.start-r[d].playout.start)>.005||Math.abs(u.playout.end-r[d].playout.end)>.005))&&(this.items=o,this.onScheduleUpdate(t,r))}}parseDateRanges(e,t,n){const i=[],r=Object.keys(e);for(let o=0;o<r.length;o++){const l=r[o],u=e[l];if(u.isInterstitial){let d=this.eventMap[l];d?d.setDateRange(u):(d=new S5(u,t),this.eventMap[l]=d,n===!1&&(d.appendInPlace=n)),i.push(d)}}return i}parseSchedule(e,t){const n=[],i=t.main.details,r=i.live?1/0:i.edge;let o=0;if(e=e.filter(u=>!u.error&&!(u.cue.once&&u.hasPlayed)),e.length){this.resolveOffsets(e,t);let u=0,d=0;if(e.forEach((h,p)=>{const m=h.cue.pre,v=h.cue.post,y=e[p-1]||null,S=h.appendInPlace,x=v?r:h.startOffset,b=h.duration,w=h.timelineOccupancy===rd.Range?b:0,L=h.resumptionOffset,I=(y==null?void 0:y.startTime)===x,k=x+h.cumulativeDuration;let M=S?k+b:x+L;if(m||!v&&x<=0){const C=d;d+=w,h.timelineStart=k;const U=o;o+=b,n.push({event:h,start:k,end:M,playout:{start:U,end:o},integrated:{start:C,end:d}})}else if(x<=r){if(!I){const O=x-u;if(O>AT){const W=u,ne=d;d+=O;const oe=o;o+=O;const se={previousEvent:e[p-1]||null,nextEvent:h,start:W,end:W+O,playout:{start:oe,end:o},integrated:{start:ne,end:d}};n.push(se)}else O>0&&y&&(y.cumulativeDuration+=O,n[n.length-1].end=x)}v&&(M=k),h.timelineStart=k;const C=d;d+=w;const U=o;o+=b,n.push({event:h,start:k,end:M,playout:{start:U,end:o},integrated:{start:C,end:d}})}else return;const P=h.resumeTime;v||P>r?u=r:u=P}),u<r){var l;const h=u,p=d,m=r-u;d+=m;const v=o;o+=m,n.push({previousEvent:((l=n[n.length-1])==null?void 0:l.event)||null,nextEvent:null,start:u,end:h+m,playout:{start:v,end:o},integrated:{start:p,end:d}})}this.setDurations(r,o,d)}else n.push({previousEvent:null,nextEvent:null,start:0,end:r,playout:{start:0,end:r},integrated:{start:0,end:r}}),this.setDurations(r,r,r);return n}setDurations(e,t,n){this.durations={primary:e,playout:t,integrated:n}}resolveOffsets(e,t){const n=t.main.details,i=n.live?1/0:n.edge;let r=0,o=-1;e.forEach((l,u)=>{const d=l.cue.pre,h=l.cue.post,p=d?0:h?i:l.startTime;this.updateAssetDurations(l),o===p?l.cumulativeDuration=r:(r=0,o=p),!h&&l.snapOptions.in&&(l.resumeAnchor=kr(null,n.fragments,l.startOffset+l.resumptionOffset,0,0)||void 0),l.appendInPlace&&!l.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(l,t)||(l.appendInPlace=!1)),!l.appendInPlace&&u+1<e.length&&e[u+1].startTime-e[u].resumeTime<AT&&(e[u+1].appendInPlace=!1,e[u+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${l}`));const v=pe(l.resumeOffset)?l.resumeOffset:l.duration;r+=v})}primaryCanResumeInPlaceAt(e,t){const n=e.resumeTime,i=e.startTime+e.resumptionOffset;return Math.abs(n-i)>Ao?(this.log(`"${e.identifier}" resumption ${n} not aligned with estimated timeline end ${i}`),!1):!Object.keys(t).some(o=>{const l=t[o].details,u=l.edge;if(n>=u)return this.log(`"${e.identifier}" resumption ${n} past ${o} playlist end ${u}`),!1;const d=kr(null,l.fragments,n);if(!d)return this.log(`"${e.identifier}" resumption ${n} does not align with any fragments in ${o} playlist (${l.fragStart}-${l.fragmentEnd})`),!0;const h=o==="audio"?.175:0;return Math.abs(d.start-n)<Ao+h||Math.abs(d.end-n)<Ao+h?!1:(this.log(`"${e.identifier}" resumption ${n} not aligned with ${o} fragment bounds (${d.start}-${d.end} sn: ${d.sn} cc: ${d.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let n=0,i=!1,r=!1;for(let o=0;o<e.assetList.length;o++){const l=e.assetList[o],u=t+n;l.startOffset=n,l.timelineStart=u,i||(i=l.duration===null),r||(r=!!l.error);const d=l.error?0:l.duration||0;n+=d}i&&!r?e.duration=Math.max(n,e.duration):e.duration=n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function is(s){return`[${s.event?'"'+s.event.identifier+'"':"primary"}: ${s.start.toFixed(2)}-${s.end.toFixed(2)}]`}class A5{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const n=e.assetListUrl;let i;try{i=ER(n,this.hls.sessionId,e.baseUrl)}catch(m){const v=this.assignAssetListError(e,H.ASSET_LIST_LOAD_ERROR,m,n);this.hls.trigger(R.ERROR,v);return}t&&i.protocol!=="data:"&&i.searchParams.set("_HLS_start_offset",""+t);const r=this.hls.config,o=r.loader,l=new o(r),u={responseType:"json",url:i.href},d=r.interstitialAssetListLoadPolicy.default,h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(m,v,y,S)=>{const x=m.data,b=x==null?void 0:x.ASSETS;if(!Array.isArray(b)){const w=this.assignAssetListError(e,H.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),y.url,v,S);this.hls.trigger(R.ERROR,w);return}e.assetListResponse=x,this.hls.trigger(R.ASSET_LIST_LOADED,{event:e,assetListResponse:x,networkDetails:S})},onError:(m,v,y,S)=>{const x=this.assignAssetListError(e,H.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${m.code} ${m.text} (${v.url})`),v.url,S,y);this.hls.trigger(R.ERROR,x)},onTimeout:(m,v,y)=>{const S=this.assignAssetListError(e,H.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${v.url})`),v.url,m,y);this.hls.trigger(R.ERROR,S)}};return l.load(u,h,p),this.hls.trigger(R.ASSET_LIST_LOADING,{event:e}),l}assignAssetListError(e,t,n,i,r,o){return e.error=n,{type:Re.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:i,error:n,networkDetails:o,stats:r}}}function wT(s){var e;s==null||(e=s.play())==null||e.catch(()=>{})}function du(s,e){return`[${s}] Advancing timeline position to ${e}`}class w5 extends Wn{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled||!this.schedule)return;const i=n-this.timelinePos;if(Math.abs(i)<1/7056e5)return;const o=i<=-.01;this.timelinePos=n,this.bufferedPos=n;const l=this.playingItem;if(!l){this.checkBuffer();return}if(o&&this.schedule.resetErrorsInRange(n,n-i)&&this.updateSchedule(!0),this.checkBuffer(),o&&n<l.start||n>=l.end){var u;const v=this.findItemIndex(l);let y=this.schedule.findItemIndexAtTime(n);if(y===-1&&(y=v+(o?-1:1),this.log(`seeked ${o?"back ":""}to position not covered by schedule ${n} (resolving from ${v} to ${y})`)),!this.isInterstitial(l)&&(u=this.media)!=null&&u.paused&&(this.shouldPlay=!1),!o&&y>v){const S=this.schedule.findJumpRestrictedIndex(v+1,y);if(S>v){this.setSchedulePosition(S);return}}this.setSchedulePosition(y);return}const d=this.playingAsset;if(!d){if(this.playingLastItem&&this.isInterstitial(l)){const v=l.event.assetList[0];v&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(n,v))}return}const h=d.timelineStart,p=d.duration||0;if(o&&n<h||n>=h+p){var m;(m=l.event)!=null&&m.appendInPlace&&(this.clearAssetPlayers(l.event,l),this.flushFrontBuffer(n)),this.setScheduleToAssetAtTime(n,d)}},this.onTimeupdate=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled)return;if(n>this.timelinePos)this.timelinePos=n,n>this.bufferedPos&&this.checkBuffer();else return;const i=this.playingItem;if(!i||this.playingLastItem)return;if(n>=i.end){this.timelinePos=i.end;const l=this.findItemIndex(i);this.setSchedulePosition(l+1)}const r=this.playingAsset;if(!r)return;const o=r.timelineStart+(r.duration||0);n>=o&&this.setScheduleToAssetAtTime(n,r)},this.onScheduleUpdate=(n,i)=>{const r=this.schedule;if(!r)return;const o=this.playingItem,l=r.events||[],u=r.items||[],d=r.durations,h=n.map(S=>S.identifier),p=!!(l.length||h.length);(p||i)&&this.log(`INTERSTITIALS_UPDATED (${l.length}): ${l}
Schedule: ${u.map(S=>is(S))} pos: ${this.timelinePos}`),h.length&&this.log(`Removed events ${h}`);let m=null,v=null;o&&(m=this.updateItem(o,this.timelinePos),this.itemsMatch(o,m)?this.playingItem=m:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const y=this.bufferingItem;if(y&&(v=this.updateItem(y,this.bufferedPos),this.itemsMatch(y,v)?this.bufferingItem=v:y.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(y.event,null))),n.forEach(S=>{S.assetList.forEach(x=>{this.clearAssetPlayer(x.identifier,null)})}),this.playerQueue.forEach(S=>{if(S.interstitial.appendInPlace){const x=S.assetItem.timelineStart,b=S.timelineOffset-x;if(b)try{S.timelineOffset=x}catch(w){Math.abs(b)>Ao&&this.warn(`${w} ("${S.assetId}" ${S.timelineOffset}->${x})`)}}}),p||i){if(this.hls.trigger(R.INTERSTITIALS_UPDATED,{events:l.slice(0),schedule:u.slice(0),durations:d,removedIds:h}),this.isInterstitial(o)&&h.includes(o.event.identifier)){this.warn(`Interstitial "${o.event.identifier}" removed while playing`),this.primaryFallback(o.event);return}o&&this.trimInPlace(m,o),y&&v!==m&&this.trimInPlace(v,y),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new A5(e),this.schedule=new b5(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(R.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(R.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(R.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(R.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(R.BUFFER_APPENDED,this.onBufferAppended,this),e.on(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(R.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(R.MEDIA_ENDED,this.onMediaEnded,this),e.on(R.ERROR,this.onError,this),e.on(R.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(R.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(R.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(R.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(R.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(R.BUFFER_CODECS,this.onBufferCodecs,this),e.off(R.BUFFER_APPENDED,this.onBufferAppended,this),e.off(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(R.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(R.MEDIA_ENDED,this.onMediaEnded,this),e.off(R.ERROR,this.onError,this),e.off(R.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){xn(e,"play",this.onPlay),xn(e,"pause",this.onPause),xn(e,"seeking",this.onSeeking),xn(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const n=this.media=t.media;cn(n,"seeking",this.onSeeking),cn(n,"timeupdate",this.onTimeupdate),cn(n,"play",this.onPlay),cn(n,"pause",this.onPause)}onMediaAttached(e,t){const n=this.effectivePlayingItem,i=this.detachedData;if(this.detachedData=null,n===null)this.checkStart();else if(!i){this.clearScheduleState();const r=this.findItemIndex(n);this.setSchedulePosition(r)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const n=!!t.transferMedia,i=this.media;if(this.media=null,!n&&(i&&this.removeMediaListeners(i),this.detachedData)){const r=this.getBufferingPlayer();r&&(this.log(`Removing schedule state for detachedData and ${r}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,r.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,n=p=>p&&e.getAssetPlayer(p.identifier),i=(p,m,v,y,S)=>{if(p){let x=p[m].start;const b=p.event;if(b){if(m==="playout"||b.timelineOccupancy!==rd.Point){const w=n(v);(w==null?void 0:w.interstitial)===b&&(x+=w.assetItem.startOffset+w[S])}}else{const w=y==="bufferedPos"?o():e[y];x+=w-p.start}return x}return 0},r=(p,m)=>{var v;if(p!==0&&m!=="primary"&&(v=e.schedule)!=null&&v.length){var y;const S=e.schedule.findItemIndexAtTime(p),x=(y=e.schedule.items)==null?void 0:y[S];if(x){const b=x[m].start-x.start;return p+b}}return p},o=()=>{const p=e.bufferedPos;return p===Number.MAX_VALUE?l("primary"):Math.max(p,0)},l=p=>{var m,v;return(m=e.primaryDetails)!=null&&m.live?e.primaryDetails.edge:((v=e.schedule)==null?void 0:v.durations[p])||0},u=(p,m)=>{var v,y;const S=e.effectivePlayingItem;if(S!=null&&(v=S.event)!=null&&v.restrictions.skip||!e.schedule)return;e.log(`seek to ${p} "${m}"`);const x=e.effectivePlayingItem,b=e.schedule.findItemIndexAtTime(p,m),w=(y=e.schedule.items)==null?void 0:y[b],L=e.getBufferingPlayer(),I=L==null?void 0:L.interstitial,k=I==null?void 0:I.appendInPlace,M=x&&e.itemsMatch(x,w);if(x&&(k||M)){const P=n(e.playingAsset),C=(P==null?void 0:P.media)||e.primaryMedia;if(C){const U=m==="primary"?C.currentTime:i(x,m,e.playingAsset,"timelinePos","currentTime"),O=p-U,W=(k?U:C.currentTime)+O;if(W>=0&&(!P||k||W<=P.duration)){C.currentTime=W;return}}}if(w){let P=p;if(m!=="primary"){const U=w[m].start,O=p-U;P=w.start+O}const C=!e.isInterstitial(w);if((!e.isInterstitial(x)||x.event.appendInPlace)&&(C||w.event.appendInPlace)){const U=e.media||(k?L==null?void 0:L.media:null);U&&(U.currentTime=P)}else if(x){const U=e.findItemIndex(x);if(b>U){const W=e.schedule.findJumpRestrictedIndex(U+1,b);if(W>U){e.setSchedulePosition(W);return}}let O=0;if(C)e.timelinePos=P,e.checkBuffer();else{const W=w.event.assetList,ne=p-(w[m]||w).start;for(let oe=W.length;oe--;){const se=W[oe];if(se.duration&&ne>=se.startOffset&&ne<se.startOffset+se.duration){O=oe;break}}}e.setSchedulePosition(b,O)}}},d=()=>{const p=e.effectivePlayingItem;if(e.isInterstitial(p))return p;const m=t();return e.isInterstitial(m)?m:null},h={get bufferedEnd(){const p=t(),m=e.bufferingItem;if(m&&m===p){var v;return i(m,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-m.playout.start||((v=e.bufferingAsset)==null?void 0:v.startOffset)||0}return 0},get currentTime(){const p=d(),m=e.effectivePlayingItem;return m&&m===p?i(m,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-m.playout.start:0},set currentTime(p){const m=d(),v=e.effectivePlayingItem;v&&v===m&&u(p+v.playout.start,"playout")},get duration(){const p=d();return p?p.playout.end-p.playout.start:0},get assetPlayers(){var p;const m=(p=d())==null?void 0:p.event.assetList;return m?m.map(v=>e.getAssetPlayer(v.identifier)):[]},get playingIndex(){var p;const m=(p=d())==null?void 0:p.event;return m&&e.effectivePlayingAsset?m.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return d()}};return this.manager={get events(){var p;return((p=e.schedule)==null||(p=p.events)==null?void 0:p.slice(0))||[]},get schedule(){var p;return((p=e.schedule)==null||(p=p.items)==null?void 0:p.slice(0))||[]},get interstitialPlayer(){return d()?h:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const p=t();return e.findItemIndex(p)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const p=e.effectivePlayingItem;return e.findItemIndex(p)},primary:{get bufferedEnd(){return o()},get currentTime(){const p=e.timelinePos;return p>0?p:0},set currentTime(p){u(p,"primary")},get duration(){return l("primary")},get seekableStart(){var p;return((p=e.primaryDetails)==null?void 0:p.fragmentStart)||0}},integrated:{get bufferedEnd(){return i(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return i(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(p){u(p,"integrated")},get duration(){return l("integrated")},get seekableStart(){var p;return r(((p=e.primaryDetails)==null?void 0:p.fragmentStart)||0,"integrated")}},skip:()=>{const p=e.effectivePlayingItem,m=p==null?void 0:p.event;if(m&&!m.restrictions.skip){const v=e.findItemIndex(p);if(m.appendInPlace){const y=p.playout.start+p.event.duration;u(y+.001,"playout")}else e.advanceAfterAssetEnded(m,v,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,n=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!n?!1:this.findItemIndex(t)===n.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let i=this.media;!i&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(i=this.primaryMedia);const r=(t=i)==null?void 0:t.currentTime;if(!(r===void 0||!pe(r)))return r}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,t)}transferMediaFromPlayer(e,t){const n=e.interstitial.appendInPlace,i=e.media;if(n&&i===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&i){this.detachedData={media:i};return}const r=e.transferMedia();this.log(`transfer MediaSource from ${e} ${it(r)}`),this.detachedData=r}else t&&i&&(this.shouldPlay||(this.shouldPlay=!i.paused))}transferMediaTo(e,t){var n,i;if(e.media===t)return;let r=null;const o=this.hls,l=e!==o,u=l&&e.interstitial.appendInPlace,d=(n=this.detachedData)==null?void 0:n.mediaSource;let h;if(o.media)u&&(r=o.transferMedia(),this.detachedData=r),h="Primary";else if(d){const y=this.getBufferingPlayer();y?(r=y.transferMedia(),h=`${y}`):h="detached MediaSource"}else h="detached media";if(!r){if(d)r=this.detachedData,this.log(`using detachedData: MediaSource ${it(r)}`);else if(!this.detachedData||o.media===t){const y=this.playerQueue;y.length>1&&y.forEach(S=>{if(l&&S.interstitial.appendInPlace!==u){const x=S.interstitial;this.clearInterstitial(S.interstitial,null),x.appendInPlace=!1,x.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${x}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const p=r&&"mediaSource"in r&&((i=r.mediaSource)==null?void 0:i.readyState)!=="closed",m=p&&r?r:t;this.log(`${p?"transfering MediaSource":"attaching media"} to ${l?e:"Primary"} from ${h} (media.currentTime: ${t.currentTime})`);const v=this.schedule;if(m===r&&v){const y=l&&e.assetId===v.assetIdAtEnd;m.overrides={duration:v.duration,endOfStream:!l||y,cueRemoval:!l}}e.attachMedia(m)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e==null?void 0:e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const n=this.timelinePos,i=this.effectivePlayingItem;if(n===-1){const r=this.hls.startPosition;if(this.log(du("checkStart",r)),this.timelinePos=r,t.length&&t[0].cue.pre){const o=e.findEventIndex(t[0].identifier);this.setSchedulePosition(o)}else if(r>=0||!this.primaryLive){const o=this.timelinePos=r>0?r:0,l=e.findItemIndexAtTime(o);this.setSchedulePosition(l)}}else if(i&&!this.playingItem){const r=e.findItemIndex(i);this.setSchedulePosition(r)}}advanceAssetBuffering(e,t){const n=e.event,i=n.findAssetIndex(t),r=cp(n,i);if(!n.isAssetPastPlayoutLimit(r))this.bufferedToEvent(e,r);else if(this.schedule){var o;const l=(o=this.schedule.items)==null?void 0:o[this.findItemIndex(e)+1];l&&this.bufferedToItem(l)}}advanceAfterAssetEnded(e,t,n){const i=cp(e,n);if(e.isAssetPastPlayoutLimit(i)){if(this.schedule){const r=this.schedule.items;if(r){const o=t+1,l=r.length;if(o>=l){this.setSchedulePosition(-1);return}const u=e.resumeTime;this.timelinePos<u&&(this.log(du("advanceAfterAssetEnded",u)),this.timelinePos=u,e.appendInPlace&&this.advanceInPlace(u),this.checkBuffer(this.bufferedPos<u)),this.setSchedulePosition(o)}}}else{if(e.appendInPlace){const r=e.assetList[i];r&&this.advanceInPlace(r.timelineStart)}this.setSchedulePosition(t,i)}}setScheduleToAssetAtTime(e,t){const n=this.schedule;if(!n)return;const i=t.parentIdentifier,r=n.getEvent(i);if(r){const o=n.findEventIndex(i),l=n.findAssetIndex(r,e);this.advanceAfterAssetEnded(r,o,l-1)}}setSchedulePosition(e,t){var n;const i=(n=this.schedule)==null?void 0:n.items;if(!i||this.playbackDisabled)return;const r=e>=0?i[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${r&&is(r)}) pos: ${this.timelinePos}`);const o=this.waitingItem||this.playingItem,l=this.playingLastItem;if(this.isInterstitial(o)){const h=o.event,p=this.playingAsset,m=p==null?void 0:p.identifier,v=m?this.getAssetPlayer(m):null;if(v&&m&&(!this.eventItemsMatch(o,r)||t!==void 0&&m!==h.assetList[t].identifier)){var u;const y=h.findAssetIndex(p);if(this.log(`INTERSTITIAL_ASSET_ENDED ${y+1}/${h.assetList.length} ${fo(p)}`),this.endedAsset=p,this.playingAsset=null,this.hls.trigger(R.INTERSTITIAL_ASSET_ENDED,{asset:p,assetListIndex:y,event:h,schedule:i.slice(0),scheduleIndex:e,player:v}),o!==this.playingItem){this.itemsMatch(o,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(h,this.findItemIndex(this.playingItem),y);return}this.retreiveMediaSource(m,r),v.media&&!((u=this.detachedData)!=null&&u.mediaSource)&&v.detachMedia()}if(!this.eventItemsMatch(o,r)&&(this.endedItem=o,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${h} ${is(o)}`),h.hasPlayed=!0,this.hls.trigger(R.INTERSTITIAL_ENDED,{event:h,schedule:i.slice(0),scheduleIndex:e}),h.cue.once)){var d;this.updateSchedule();const y=(d=this.schedule)==null?void 0:d.items;if(r&&y){const S=this.findItemIndex(r);this.advanceSchedule(S,y,t,o,l)}return}}this.advanceSchedule(e,i,t,o,l)}advanceSchedule(e,t,n,i,r){const o=this.schedule;if(!o)return;const l=t[e]||null,u=this.primaryMedia,d=this.playerQueue;if(d.length&&d.forEach(h=>{const p=h.interstitial,m=o.findEventIndex(p.identifier);(m<e||m>e+1)&&this.clearInterstitial(p,l)}),this.isInterstitial(l)){this.timelinePos=Math.min(Math.max(this.timelinePos,l.start),l.end);const h=l.event;if(n===void 0){n=o.findAssetIndex(h,this.timelinePos);const y=cp(h,n-1);if(h.isAssetPastPlayoutLimit(y)||h.appendInPlace&&this.timelinePos===l.end){this.advanceAfterAssetEnded(h,e,n);return}n=y}const p=this.waitingItem;this.assetsBuffered(l,u)||this.setBufferingItem(l);let m=this.preloadAssets(h,n);if(this.eventItemsMatch(l,p||i)||(this.waitingItem=l,this.log(`INTERSTITIAL_STARTED ${is(l)} ${h.appendInPlace?"append in place":""}`),this.hls.trigger(R.INTERSTITIAL_STARTED,{event:h,schedule:t.slice(0),scheduleIndex:e})),!h.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${h}`);return}if(h.assetListLoader&&(h.assetListLoader.destroy(),h.assetListLoader=void 0),!u){this.log(`Waiting for attachMedia to start Interstitial ${h}`);return}this.waitingItem=this.endedItem=null,this.playingItem=l;const v=h.assetList[n];if(!v){this.advanceAfterAssetEnded(h,e,n||0);return}if(m||(m=this.getAssetPlayer(v.identifier)),m===null||m.destroyed){const y=h.assetList.length;this.warn(`asset ${n+1}/${y} player destroyed ${h}`),m=this.createAssetPlayer(h,v,n),m.loadSource()}if(!this.eventItemsMatch(l,this.bufferingItem)&&h.appendInPlace&&this.isAssetBuffered(v))return;this.startAssetPlayer(m,n,t,e,u),this.shouldPlay&&wT(m.media)}else l?(this.resumePrimary(l,e,i),this.shouldPlay&&wT(this.hls.media)):r&&this.isInterstitial(i)&&(this.endedItem=null,this.playingItem=i,i.event.appendInPlace||this.attachPrimary(o.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,n){var i,r;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${is(e)}`),!((i=this.detachedData)!=null&&i.mediaSource)){let l=this.timelinePos;(l<e.start||l>=e.end)&&(l=this.getPrimaryResumption(e,t),this.log(du("resumePrimary",l)),this.timelinePos=l),this.attachPrimary(l,e)}if(!n)return;const o=(r=this.schedule)==null?void 0:r.items;o&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${is(e)}`),this.hls.trigger(R.INTERSTITIALS_PRIMARY_RESUMED,{schedule:o.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const n=e.start;if(this.primaryLive){const i=this.primaryDetails;if(t===0)return this.hls.startPosition;if(i&&(n<i.fragmentStart||n>i.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Fe.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,n){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const i=this.primaryMedia;if(!i)return;const r=this.hls;r.media?this.checkBuffer():(this.transferMediaTo(r,i),n&&this.startLoadingPrimaryAt(e,n)),n||(this.log(du("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,t){var n;const i=this.hls;!i.loadingEnabled||!i.media||Math.abs((((n=i.mainForwardBufferInfo)==null?void 0:n.start)||i.media.currentTime)-e)>.5?i.startLoad(e,t):i.bufferingEnabled||i.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(R.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(R.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;const n=this.hls.levels[t.level];if(!n.details)return;const i=Ze(Ze({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=i,this.schedule.parseInterstitialDateRanges(i,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const n=this.hls.audioTracks[t.id],i=this.mediaSelection;if(!i){this.altSelection=Ze(Ze({},this.altSelection),{},{audio:n});return}const r=Ze(Ze({},i),{},{audio:n});this.mediaSelection=r}onSubtitleTrackUpdated(e,t){const n=this.hls.subtitleTracks[t.id],i=this.mediaSelection;if(!i){this.altSelection=Ze(Ze({},this.altSelection),{},{subtitles:n});return}const r=Ze(Ze({},i),{},{subtitles:n});this.mediaSelection=r}onAudioTrackSwitching(e,t){const n=OE(t);this.playerQueue.forEach(({hls:i})=>i&&(i.setAudioOption(t)||i.setAudioOption(n)))}onSubtitleTrackSwitch(e,t){const n=OE(t);this.playerQueue.forEach(({hls:i})=>i&&(i.setSubtitleOption(t)||t.id!==-1&&i.setSubtitleOption(n)))}onBufferCodecs(e,t){const n=t.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const i=this.timelinePos;this.bufferedPos=i,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let i=0;i<t.length;i++){const r=t[i];if(r.cue.post){var n;const o=this.schedule.findEventIndex(r.identifier),l=(n=this.schedule.items)==null?void 0:n[o];this.isInterstitial(l)&&this.eventItemsMatch(l,this.bufferingItem)&&this.bufferedToItem(l,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const n=this.findItemIndex(t);this.setSchedulePosition(n+1)}else this.shouldPlay=!1}updateItem(e,t){var n;const i=(n=this.schedule)==null?void 0:n.items;if(e&&i){const r=this.findItemIndex(e,t);return i[r]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((r,o)=>{e.event.isAssetPastPlayoutLimit(o)&&this.clearAssetPlayer(r.identifier,null)});const n=e.end+.25,i=Fe.bufferInfo(this.primaryMedia,n,0);(i.end>n||(i.nextStart||0)>n)&&(this.log(`trim buffered interstitial ${is(e)} (was ${is(t)})`),this.attachPrimary(n,null,!0),this.flushFrontBuffer(n))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var n;return!!t&&(e===t||e.event.identifier===((n=t.event)==null?void 0:n.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const n=this.mediaSelection;n&&((t=this.schedule)==null||t.updateSchedule(n,[],e))}checkBuffer(e){var t;const n=(t=this.schedule)==null?void 0:t.items;if(!n)return;const i=Fe.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=i.len<1),this.updateBufferedPos(i.end,n,e)}updateBufferedPos(e,t,n){const i=this.schedule,r=this.bufferingItem;if(this.bufferedPos>e||!i)return;if(t.length===1&&this.itemsMatch(t[0],r)){this.bufferedPos=e;return}const o=this.playingItem,l=this.findItemIndex(o);let u=i.findItemIndexAtTime(e);if(this.bufferedPos<e){var d;const h=this.findItemIndex(r),p=Math.min(h+1,t.length-1),m=t[p];if((u===-1&&r&&e>=r.end||(d=m.event)!=null&&d.appendInPlace&&e+.01>=m.start)&&(u=p),this.isInterstitial(r)){const v=r.event;if(p-l>1&&v.appendInPlace===!1||v.assetList.length===0&&v.assetListLoader)return}if(this.bufferedPos=e,u>h&&u>l)this.bufferedToItem(m);else{const v=this.primaryDetails;this.primaryLive&&v&&e>v.edge-v.targetduration&&m.start<v.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(m)&&this.preloadAssets(m.event,0)}}else n&&o&&!this.itemsMatch(o,r)&&(u===l?this.bufferedToItem(o):u===l+1&&this.bufferedToItem(t[u]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(i=>{const r=this.getAssetPlayer(i.identifier);return!(r!=null&&r.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,n=this.schedule;if(!this.itemsMatch(e,t)&&n){const{items:i,events:r}=n;if(!i||!r)return t;const o=this.isInterstitial(e),l=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const u=l?l.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${is(e)}`+(t?` (${u.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(o){const d=n.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((h,p)=>{const m=this.getAssetPlayer(h.identifier);m&&(p===d&&m.loadSource(),m.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(d=>d.pauseBuffering());this.hls.trigger(R.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:r.slice(0),schedule:i.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const n=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(n!==null){this.bufferingAsset=null;const i=this.detachedData;i?i.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),n=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,t){const n=e.event,i=n.assetList.length===0&&!n.assetListLoader,r=n.cue.once;if(i||!r){const o=this.preloadAssets(n,t);if(o!=null&&o.interstitial.appendInPlace){const l=this.primaryMedia;l&&this.bufferAssetPlayer(o,l)}}}preloadAssets(e,t){const n=e.assetUrl,i=e.assetList.length,r=i===0&&!e.assetListLoader,o=e.cue.once;if(r){const u=e.timelineStart;if(e.appendInPlace){var l;const m=this.playingItem;!this.isInterstitial(m)&&(m==null||(l=m.nextEvent)==null?void 0:l.identifier)===e.identifier&&this.flushFrontBuffer(u+.25)}let d,h=0;if(!this.playingItem&&this.primaryLive&&(h=this.hls.startPosition,h===-1&&(h=this.hls.liveSyncPosition||0)),h&&!(e.cue.pre||e.cue.post)){const m=h-u;m>0&&(d=Math.round(m*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${n?1:i} ${e}${d?` live-start: ${h} start-offset: ${d}`:""}`),n)return this.createAsset(e,0,0,u,e.duration,n);const p=this.assetListLoader.loadAssetList(e,d);p&&(e.assetListLoader=p)}else if(!o&&i){for(let d=t;d<i;d++){const h=e.assetList[d],p=this.getAssetPlayerQueueIndex(h.identifier);(p===-1||this.playerQueue[p].destroyed)&&!h.error&&this.createAssetPlayer(e,h,d)}const u=e.assetList[t];if(u){const d=this.getAssetPlayer(u.identifier);return d&&d.loadSource(),d}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(i=>{this.hls.trigger(R.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:i})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let n=0;n<t.length;n++)if(e===t[n].assetId)return n;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let n=0;n<e.length;n++)if(e[n].media===t)return e[n]}return null}createAsset(e,t,n,i,r,o){const l={parentIdentifier:e.identifier,identifier:x5(e,o,t),duration:r,startOffset:n,timelineStart:i,uri:o};return this.createAssetPlayer(e,l,t)}createAssetPlayer(e,t,n){const i=this.hls,r=i.userConfig;let o=r.videoPreference;const l=i.loadLevelObj||i.levels[i.currentLevel];(o||l)&&(o=tt({},o),l.videoCodec&&(o.videoCodec=l.videoCodec),l.videoRange&&(o.allowedVideoRanges=[l.videoRange]));const u=i.audioTracks[i.audioTrack],d=i.subtitleTracks[i.subtitleTrack];let h=0;if(this.primaryLive||e.appendInPlace){const I=this.timelinePos-t.timelineStart;if(I>1){const k=t.duration;k&&I<k&&(h=I)}}const p=t.identifier,m=Ze(Ze({},r),{},{maxMaxBufferLength:Math.min(180,i.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:i.sessionId,assetPlayerId:p,abrEwmaDefaultEstimate:i.bandwidthEstimate,interstitialsController:void 0,startPosition:h,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:u||r.audioPreference,subtitlePreference:d||r.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(m.timelineOffset=t.timelineStart));const v=m.cmcd;v!=null&&v.sessionId&&v.contentId&&(m.cmcd=tt({},v,{contentId:rl(t.uri)})),this.getAssetPlayer(p)&&this.warn(`Duplicate date range identifier ${e} and asset ${p}`);const y=new T5(this.HlsPlayerClass,m,e,t);this.playerQueue.push(y),e.assetList[n]=t;let S=!0;const x=I=>{if(I.live){var k;const C=new Error(`Interstitials MUST be VOD assets ${e}`),U={fatal:!0,type:Re.OTHER_ERROR,details:H.INTERSTITIAL_ASSET_ITEM_ERROR,error:C},O=((k=this.schedule)==null?void 0:k.findEventIndex(e.identifier))||-1;this.handleAssetItemError(U,e,O,n,C.message);return}const M=I.edge-I.fragmentStart,P=t.duration;(S||P===null||M>P)&&(S=!1,this.log(`Interstitial asset "${p}" duration change ${P} > ${M}`),t.duration=M,this.updateSchedule())};y.on(R.LEVEL_UPDATED,(I,{details:k})=>x(k)),y.on(R.LEVEL_PTS_UPDATED,(I,{details:k})=>x(k)),y.on(R.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const b=(I,k)=>{const M=this.getAssetPlayer(p);if(M&&k.tracks){M.off(R.BUFFER_CODECS,b),M.tracks=k.tracks;const P=this.primaryMedia;this.bufferingAsset===M.assetItem&&P&&!M.media&&this.bufferAssetPlayer(M,P)}};y.on(R.BUFFER_CODECS,b);const w=()=>{var I;const k=this.getAssetPlayer(p);if(this.log(`buffered to end of asset ${k}`),!k||!this.schedule)return;const M=this.schedule.findEventIndex(e.identifier),P=(I=this.schedule.items)==null?void 0:I[M];this.isInterstitial(P)&&this.advanceAssetBuffering(P,t)};y.on(R.BUFFERED_TO_END,w);const L=I=>()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;this.shouldPlay=!0;const M=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,M,I)};return y.once(R.MEDIA_ENDED,L(n)),y.once(R.PLAYOUT_LIMIT_REACHED,L(1/0)),y.on(R.ERROR,(I,k)=>{if(!this.schedule)return;const M=this.getAssetPlayer(p);if(k.details===H.BUFFER_STALLED_ERROR){if(M!=null&&M.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(k,e,this.schedule.findEventIndex(e.identifier),n,`Asset player error ${k.error} ${e}`)}),y.on(R.DESTROYING,()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;const k=new Error(`Asset player destroyed unexpectedly ${p}`),M={fatal:!0,type:Re.OTHER_ERROR,details:H.INTERSTITIAL_ASSET_ITEM_ERROR,error:k};this.handleAssetItemError(M,e,this.schedule.findEventIndex(e.identifier),n,k.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${fo(t)}`),this.hls.trigger(R.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:n,event:e,player:y}),y}clearInterstitial(e,t){this.clearAssetPlayers(e,t),e.reset()}clearAssetPlayers(e,t){e.assetList.forEach(n=>{this.clearAssetPlayer(n.identifier,t)})}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const n=this.playerQueue[t];this.transferMediaFromPlayer(n,null),n.resetDetails()}}clearAssetPlayer(e,t){const n=this.getAssetPlayerQueueIndex(e);if(n!==-1){const i=this.playerQueue[n];this.log(`clear ${i} toSegment: ${t&&is(t)}`),this.transferMediaFromPlayer(i,t),this.playerQueue.splice(n,1),i.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,n,i,r){const{interstitial:o,assetItem:l,assetId:u}=e,d=o.assetList.length,h=this.playingAsset;this.endedAsset=null,this.playingAsset=l,(!h||h.identifier!==u)&&(h&&(this.clearAssetPlayer(h.identifier,n[i]),delete h.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${d} ${fo(l)}`),this.hls.trigger(R.INTERSTITIAL_ASSET_STARTED,{asset:l,assetListIndex:t,event:o,schedule:n.slice(0),scheduleIndex:i,player:e})),this.bufferAssetPlayer(e,r)}bufferAssetPlayer(e,t){var n,i;if(!this.schedule)return;const{interstitial:r,assetItem:o}=e,l=this.schedule.findEventIndex(r.identifier),u=(n=this.schedule.items)==null?void 0:n[l];if(!u)return;e.loadSource(),this.setBufferingItem(u),this.bufferingAsset=o;const d=this.getBufferingPlayer();if(d===e)return;const h=r.appendInPlace;if(h&&(d==null?void 0:d.interstitial.appendInPlace)===!1)return;const p=(d==null?void 0:d.tracks)||((i=this.detachedData)==null?void 0:i.tracks)||this.requiredTracks;if(h&&o!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(p&&!sw(p,e.tracks)){const m=new Error(`Asset ${fo(o)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(p)}')`),v={fatal:!0,type:Re.OTHER_ERROR,details:H.INTERSTITIAL_ASSET_ITEM_ERROR,error:m},y=r.findAssetIndex(o);this.handleAssetItemError(v,r,l,y,m.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,n=this.primaryMedia;if(!t||!n)return;const i=n.currentTime,r=t.findAssetIndex(e,i),o=e.assetList[r];if(o){const l=this.getAssetPlayer(o.identifier);if(l){const u=l.currentTime||i-o.timelineStart,d=l.duration-u;if(this.warn(`Stalled at ${u} of ${u+d} in ${l} ${e} (media.currentTime: ${i})`),u&&(d/n.playbackRate<.5||l.bufferedInPlaceToEnd(n))&&l.hls){const h=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,h,r)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,n,i,r){if(e.details===H.BUFFER_STALLED_ERROR)return;const o=t.assetList[i]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${o&&fo(o)} ${e.error}`),!this.schedule)return;const l=(o==null?void 0:o.identifier)||"",u=this.getAssetPlayerQueueIndex(l),d=this.playerQueue[u]||null,h=this.schedule.items,p=tt({},e,{fatal:!1,errorAction:Eo(!0),asset:o,assetListIndex:i,event:t,schedule:h,scheduleIndex:n,player:d});if(this.hls.trigger(R.INTERSTITIAL_ASSET_ERROR,p),!e.fatal)return;const m=this.playingAsset,v=this.bufferingAsset,y=new Error(r);if(o&&(this.clearAssetPlayer(l,null),o.error=y),!t.assetList.some(S=>!S.error))t.error=y;else for(let S=i;S<t.assetList.length;S++)this.resetAssetPlayer(t.assetList[S].identifier);this.updateSchedule(!0),t.error?this.primaryFallback(t):m&&m.identifier===l?this.advanceAfterAssetEnded(t,n,i):v&&v.identifier===l&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,v)}primaryFallback(e){const t=e.timelineStart,n=this.effectivePlayingItem;let i=this.timelinePos;if(n){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${i} playing: ${is(n)} error: ${e.error}`),i===-1&&(i=this.hls.startPosition);const o=this.updateItem(n,i);this.itemsMatch(n,o)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t))}else if(i===-1){this.checkStart();return}if(!this.schedule)return;const r=this.schedule.findItemIndexAtTime(i);this.setSchedulePosition(r)}onAssetListLoaded(e,t){var n,i;const r=t.event,o=r.identifier,l=t.assetListResponse.ASSETS;if(!((n=this.schedule)!=null&&n.hasEvent(o)))return;const u=r.timelineStart,d=r.duration;let h=0;l.forEach((S,x)=>{const b=parseFloat(S.DURATION);this.createAsset(r,x,h,u+h,b,S.URI),h+=b}),r.duration=h,this.log(`Loaded asset-list with duration: ${h} (was: ${d}) ${r}`);const p=this.waitingItem,m=(p==null?void 0:p.event.identifier)===o;this.updateSchedule();const v=(i=this.bufferingItem)==null?void 0:i.event;if(m){var y;const S=this.schedule.findEventIndex(o),x=(y=this.schedule.items)==null?void 0:y[S];if(x){if(!this.playingItem&&this.timelinePos>x.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==S){r.error=new Error(`Interstitial ${l.length?"no longer within playback range":"asset-list is empty"} ${this.timelinePos} ${r}`),this.log(r.error.message),this.updateSchedule(!0),this.primaryFallback(r);return}this.setBufferingItem(x)}this.setSchedulePosition(S)}else if((v==null?void 0:v.identifier)===o){const S=r.assetList[0];if(S){const x=this.getAssetPlayer(S.identifier);if(v.appendInPlace){const b=this.primaryMedia;x&&b&&this.bufferAssetPlayer(x,b)}else x&&x.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case H.ASSET_LIST_PARSING_ERROR:case H.ASSET_LIST_LOAD_ERROR:case H.ASSET_LIST_LOAD_TIMEOUT:{const n=t.interstitial;n&&(this.updateSchedule(!0),this.primaryFallback(n));break}case H.BUFFER_STALLED_ERROR:{const n=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&n.event.appendInPlace){this.handleInPlaceStall(n.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const RT=500;class R5 extends Kg{constructor(e,t,n){super(e,t,n,"subtitle-stream-controller",ye.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(R.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(R.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=te.IDLE,this.setInterval(RT),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:i}=t;if(this.fragContextChanged(n)||(Tt(n)&&(this.fragPrevious=n),this.state=te.IDLE),!i)return;const r=this.tracksBuffered[this.currentTrackId];if(!r)return;let o;const l=n.start;for(let d=0;d<r.length;d++)if(l>=r[d].start&&l<=r[d].end){o=r[d];break}const u=n.start+n.duration;o?o.end=u:(o={start:l,end:u},r.push(o)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:n,endOffset:i}=t;if(n===0&&i!==Number.POSITIVE_INFINITY){const r=i-1;if(r<=0)return;t.endOffsetSubtitles=Math.max(0,r),this.tracksBuffered.forEach(o=>{for(let l=0;l<o.length;){if(o[l].end<=r){o.shift();continue}else if(o[l].start<r)o[l].start=r;else break;l++}}),this.fragmentTracker.removeFragmentsInRange(n,r,ye.SUBTITLE)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===ye.SUBTITLE&&(t.details===H.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==te.STOPPED&&(this.state=te.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&oR(this.levels,t)){this.levels=t.map(n=>new gl(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const i=new gl(n);return this.tracksBuffered[i.id]=[],i}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ye.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const i=this.levels[this.currentTrackId];i!=null&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.state!==te.STOPPED&&this.setInterval(RT)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:i,levels:r}=this,{details:o,id:l}=t;if(!r){this.warn(`Subtitle tracks were reset while loading level ${l}`);return}const u=r[l];if(l>=r.length||!u)return;this.log(`Subtitle track ${l} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let d=0;if(o.live||(n=u.details)!=null&&n.live){if(o.deltaUpdateFailed)return;const p=this.mainDetails;if(!p){this.startFragRequested=!1;return}const m=p.fragments[0];if(!u.details)o.hasProgramDateTime&&p.hasProgramDateTime?(sd(o,p),d=o.fragmentStart):m&&(d=m.start,bm(o,d));else{var h;d=this.alignPlaylists(o,u.details,(h=this.levelLastLoaded)==null?void 0:h.details),d===0&&m&&(d=m.start,bm(o,d))}p&&!this.startFragRequested&&this.setStartPosition(p,d)}u.details=o,this.levelLastLoaded=u,l===i&&(this.hls.trigger(R.SUBTITLE_TRACK_UPDATED,{details:o,id:l,groupId:t.groupId}),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===te.IDLE&&(kr(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),u.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,i=t.decryptdata,r=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&i!=null&&i.key&&i.iv&&To(i.method)){const o=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer,Vg(i.method)).catch(l=>{throw r.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:t}),l}).then(l=>{const u=performance.now();r.trigger(R.FRAG_DECRYPTED,{frag:t,payload:l,stats:{tstart:o,tdecrypt:u}})}).catch(l=>{this.warn(`${l.name}: ${l.message}`),this.state=te.IDLE})}}doTick(){if(!this.media){this.state=te.IDLE;return}if(this.state===te.IDLE){const{currentTrackId:e,levels:t}=this,n=t==null?void 0:t[e];if(!n||!t.length||!n.details||this.waitForLive(n))return;const{config:i}=this,r=this.getLoadPosition(),o=Fe.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],r,i.maxBufferHole),{end:l,len:u}=o,d=n.details,h=this.hls.maxBufferLength+d.levelTargetDuration;if(u>h)return;const p=d.fragments,m=p.length,v=d.edge;let y=null;const S=this.fragPrevious;if(l<v){const w=i.maxFragLookUpTolerance,L=l>v-w?0:w;y=kr(S,p,Math.max(p[0].start,l),L),!y&&S&&S.start<p[0].start&&(y=p[0])}else y=p[m-1];if(y=this.filterReplacedPrimary(y,n.details),!y)return;const x=y.sn-d.startSN,b=p[x-1];if(b&&b.cc===y.cc&&this.fragmentTracker.getState(b)===Pt.NOT_LOADED&&(y=b),this.fragmentTracker.getState(y)===Pt.NOT_LOADED){const w=this.mapToInitFragWhenRequired(y);w&&this.loadFragment(w,n,l)}}}loadFragment(e,t,n){Tt(e)?super.loadFragment(e,t,n):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new L5(this.tracksBuffered[this.currentTrackId]||[])}}class L5{constructor(e){this.buffered=void 0;const t=(n,i,r)=>{if(i=i>>>0,i>r-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${r})`);return e[i][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}const I5={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},TR=s=>String.fromCharCode(I5[s]||s),os=15,Vs=100,_5={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},k5={17:2,18:4,21:6,22:8,23:10,19:13,20:15},C5={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},P5={25:2,26:4,29:6,30:8,31:10,27:13,28:15},D5=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class O5{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;et.log(`${this.time} [${e}] ${n}`)}}}const lr=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class bR{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const i=t[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class N5{constructor(){this.uchar=" ",this.penState=new bR}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class M5{constructor(e){this.chars=[],this.pos=0,this.currPenState=new bR,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<Vs;t++)this.chars.push(new N5);this.logger=e}equals(e){for(let t=0;t<Vs;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Vs;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Vs;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Vs&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Vs)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=TR(e);if(this.pos>=Vs){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<Vs;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<Vs;n++){const i=this.chars[n].uchar;i!==" "&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class up{constructor(e){this.rows=[],this.currRow=os-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<os;t++)this.rows.push(new M5(e));this.logger=e}reset(){for(let e=0;e<os;e++)this.rows[e].clear();this.currRow=os-1}equals(e){let t=!0;for(let n=0;n<os;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<os;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<os;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+it(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let l=0;l<os;l++)this.rows[l].clear();const r=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const l=o.rows[r].cueStartTime,u=this.logger.time;if(l!==null&&u!==null&&l<u)for(let d=0;d<this.nrRollUpRows;d++)this.rows[t-this.nrRollUpRows+d+1].copy(o.rows[r+d])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const r=e.indent,o=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[o].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+it(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",i=-1;for(let r=0;r<os;r++){const o=this.rows[r].getTextString();o&&(i=r+1,e?t.push("Row "+i+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class LT{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new up(n),this.nonDisplayedMemory=new up(n),this.lastOutputScreen=new up(n),this.currRollUpRow=this.displayedMemory.rows[os-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[os-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[n]}this.logger.log(2,"MIDROW: "+it(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class IT{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=B5(),this.logger=void 0;const i=this.logger=new O5;this.channels=[null,new LT(e,t,i),new LT(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const i=t[n]&127,r=t[n+1]&127;let o=!1,l=null;if(i===0&&r===0)continue;this.logger.log(3,()=>"["+lr([t[n],t[n+1]])+"] -> ("+lr([i,r])+")");const u=this.cmdHistory;if(i>=16&&i<=31){if(F5(i,r,u)){hu(null,null,u),this.logger.log(3,()=>"Repeated command ("+lr([i,r])+") is dropped");continue}hu(i,r,this.cmdHistory),o=this.parseCmd(i,r),o||(o=this.parseMidrow(i,r)),o||(o=this.parsePAC(i,r)),o||(o=this.parseBackgroundAttributes(i,r))}else hu(null,null,u);if(!o&&(l=this.parseChars(i,r),l)){const h=this.currentChannel;h&&h>0?this.channels[h].insertChars(l):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!l&&this.logger.log(2,()=>"Couldn't parse cleaned data "+lr([i,r])+" orig: "+lr([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=33&&t<=35;if(!(n||i))return!1;const r=e===20||e===21||e===23?1:2,o=this.channels[r];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=r,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return i?(i.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+lr([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const i=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,r=(e===16||e===24)&&t>=64&&t<=95;if(!(i||r))return!1;const o=e<=23?1:2;t>=64&&t<=95?n=o===1?_5[e]:C5[e]:n=o===1?k5[e]:P5[e];const l=this.channels[o];return l?(l.setPAC(this.interpretPAC(n,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,i.underline=(n&1)===1,n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=Math.floor((n-16)/2)*4,i}parseChars(e,t){let n,i=null,r=null;if(e>=25?(n=2,r=e-8):(n=1,r=e),r>=17&&r<=19){let o;r===17?o=t+80:r===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+TR(o)+"' in channel "+n),i=[o]}else e>=32&&e<=127&&(i=t===0?[e]:[e,t]);return i&&this.logger.log(3,()=>"Char codes =  "+lr(i).join(",")),i}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=45&&t<=47;if(!(n||i))return!1;let r;const o={};e===16||e===24?(r=Math.floor((t-32)/2),o.background=D5[r],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const l=e<=23?1:2;return this.channels[l].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}hu(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function hu(s,e,t){t.a=s,t.b=e}function F5(s,e,t){return t.a===s&&t.b===e}function B5(){return{a:null,b:null}}var n0=(function(){if(nd!=null&&nd.VTTCue)return self.VTTCue;const s=["","lr","rl"],e=["start","middle","end","left","right"];function t(l,u){if(typeof u!="string"||!Array.isArray(l))return!1;const d=u.toLowerCase();return~l.indexOf(d)?d:!1}function n(l){return t(s,l)}function i(l){return t(e,l)}function r(l,...u){let d=1;for(;d<arguments.length;d++){const h=arguments[d];for(const p in h)l[p]=h[p]}return l}function o(l,u,d){const h=this,p={enumerable:!0};h.hasBeenReset=!1;let m="",v=!1,y=l,S=u,x=d,b=null,w="",L=!0,I="auto",k="start",M=50,P="middle",C=50,U="middle";Object.defineProperty(h,"id",r({},p,{get:function(){return m},set:function(O){m=""+O}})),Object.defineProperty(h,"pauseOnExit",r({},p,{get:function(){return v},set:function(O){v=!!O}})),Object.defineProperty(h,"startTime",r({},p,{get:function(){return y},set:function(O){if(typeof O!="number")throw new TypeError("Start time must be set to a number.");y=O,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",r({},p,{get:function(){return S},set:function(O){if(typeof O!="number")throw new TypeError("End time must be set to a number.");S=O,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",r({},p,{get:function(){return x},set:function(O){x=""+O,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",r({},p,{get:function(){return b},set:function(O){b=O,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",r({},p,{get:function(){return w},set:function(O){const W=n(O);if(W===!1)throw new SyntaxError("An invalid or illegal string was specified.");w=W,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",r({},p,{get:function(){return L},set:function(O){L=!!O,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",r({},p,{get:function(){return I},set:function(O){if(typeof O!="number"&&O!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");I=O,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",r({},p,{get:function(){return k},set:function(O){const W=i(O);if(!W)throw new SyntaxError("An invalid or illegal string was specified.");k=W,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",r({},p,{get:function(){return M},set:function(O){if(O<0||O>100)throw new Error("Position must be between 0 and 100.");M=O,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",r({},p,{get:function(){return P},set:function(O){const W=i(O);if(!W)throw new SyntaxError("An invalid or illegal string was specified.");P=W,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",r({},p,{get:function(){return C},set:function(O){if(O<0||O>100)throw new Error("Size must be between 0 and 100.");C=O,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",r({},p,{get:function(){return U},set:function(O){const W=i(O);if(!W)throw new SyntaxError("An invalid or illegal string was specified.");U=W,this.hasBeenReset=!0}})),h.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o})();class U5{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function AR(s){function e(n,i,r,o){return(n|0)*3600+(i|0)*60+(r|0)+parseFloat(o||0)}const t=s.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class $5{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let i=0;i<n.length;++i)if(t===n[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function wR(s,e,t,n){const i=n?s.split(n):[s];for(const r in i){if(typeof i[r]!="string")continue;const o=i[r].split(t);if(o.length!==2)continue;const l=o[0],u=o[1];e(l,u)}}const Cm=new n0(0,0,""),fu=Cm.align==="middle"?"middle":"center";function j5(s,e,t){const n=s;function i(){const l=AR(s);if(l===null)throw new Error("Malformed timestamp: "+n);return s=s.replace(/^[^\sa-zA-Z-]+/,""),l}function r(l,u){const d=new $5;wR(l,function(m,v){let y;switch(m){case"region":for(let S=t.length-1;S>=0;S--)if(t[S].id===v){d.set(m,t[S].region);break}break;case"vertical":d.alt(m,v,["rl","lr"]);break;case"line":y=v.split(","),d.integer(m,y[0]),d.percent(m,y[0])&&d.set("snapToLines",!1),d.alt(m,y[0],["auto"]),y.length===2&&d.alt("lineAlign",y[1],["start",fu,"end"]);break;case"position":y=v.split(","),d.percent(m,y[0]),y.length===2&&d.alt("positionAlign",y[1],["start",fu,"end","line-left","line-right","auto"]);break;case"size":d.percent(m,v);break;case"align":d.alt(m,v,["start",fu,"end","left","right"]);break}},/:/,/\s/),u.region=d.get("region",null),u.vertical=d.get("vertical","");let h=d.get("line","auto");h==="auto"&&Cm.line===-1&&(h=-1),u.line=h,u.lineAlign=d.get("lineAlign","start"),u.snapToLines=d.get("snapToLines",!0),u.size=d.get("size",100),u.align=d.get("align",fu);let p=d.get("position","auto");p==="auto"&&Cm.position===50&&(p=u.align==="start"||u.align==="left"?0:u.align==="end"||u.align==="right"?100:50),u.position=p}function o(){s=s.replace(/^\s+/,"")}if(o(),e.startTime=i(),o(),s.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);s=s.slice(3),o(),e.endTime=i(),o(),r(s,e)}function RR(s){return s.replace(/<br(?: \/)?>/gi,`
`)}class V5{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new U5,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let r=t.buffer,o=0;for(r=RR(r);o<r.length&&r[o]!=="\r"&&r[o]!==`
`;)++o;const l=r.slice(0,o);return r[o]==="\r"&&++o,r[o]===`
`&&++o,t.buffer=r.slice(o),l}function i(r){wR(r,function(o,l){},/:/)}try{let r="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;r=n();const l=r.match(/^()?WEBVTT([ \t].*)?$/);if(!(l!=null&&l[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:r=n(),t.state){case"HEADER":/:/.test(r)?i(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new n0(0,0,""),t.state="CUE",r.indexOf("-->")===-1){t.cue.id=r;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{j5(r,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const l=r.indexOf("-->")!==-1;if(!r||l&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=r}continue;case"BADCUE":r||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const G5=/\r\n|\n\r|\n|\r/g,dp=function(e,t,n=0){return e.slice(n,n+t.length)===t},K5=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),r=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!pe(t)||!pe(n)||!pe(i)||!pe(r))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*i,t+=3600*1e3*r,t};function s0(s,e,t){return rl(s.toString())+rl(e.toString())+rl(t)}const H5=function(e,t,n){let i=e[t],r=e[i.prevCC];if(!r||!r.new&&i.new){e.ccOffset=e.presentationOffset=i.start,i.new=!1;return}for(;(o=r)!=null&&o.new;){var o;e.ccOffset+=i.start-r.start,i.new=!1,i=r,r=e[i.prevCC]}e.presentationOffset=n};function z5(s,e,t,n,i,r,o){const l=new V5,u=Dn(new Uint8Array(s)).trim().replace(G5,`
`).split(`
`),d=[],h=e?J3(e.baseTime,e.timescale):0;let p="00:00.000",m=0,v=0,y,S=!0;l.oncue=function(x){const b=t[n];let w=t.ccOffset;const L=(m-h)/9e4;if(b!=null&&b.new&&(v!==void 0?w=t.ccOffset=b.start:H5(t,n,L)),L){if(!e){y=new Error("Missing initPTS for VTT MPEGTS");return}w=L-t.presentationOffset}const I=x.endTime-x.startTime,k=kn((x.startTime+w-v)*9e4,i*9e4)/9e4;x.startTime=Math.max(k,0),x.endTime=Math.max(k+I,0);const M=x.text.trim();x.text=decodeURIComponent(encodeURIComponent(M)),x.id||(x.id=s0(x.startTime,x.endTime,M)),x.endTime>0&&d.push(x)},l.onparsingerror=function(x){y=x},l.onflush=function(){if(y){o(y);return}r(d)},u.forEach(x=>{if(S)if(dp(x,"X-TIMESTAMP-MAP=")){S=!1,x.slice(16).split(",").forEach(b=>{dp(b,"LOCAL:")?p=b.slice(6):dp(b,"MPEGTS:")&&(m=parseInt(b.slice(7)))});try{v=K5(p)/1e3}catch(b){y=b}return}else x===""&&(S=!1);l.parse(x+`
`)}),l.flush()}const hp="stpp.ttml.im1t",LR=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,IR=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,W5={left:"start",center:"center",right:"end",start:"start",end:"end"};function _T(s,e,t,n){const i=je(new Uint8Array(s),["mdat"]);if(i.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const r=i.map(l=>Dn(l)),o=X3(e.baseTime,1,e.timescale);try{r.forEach(l=>t(q5(l,o)))}catch(l){n(l)}}function q5(s,e){const i=new DOMParser().parseFromString(s,"text/xml").getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(r).reduce((p,m)=>(p[m]=i.getAttribute(`ttp:${m}`)||r[m],p),{}),l=i.getAttribute("xml:space")!=="preserve",u=kT(fp(i,"styling","style")),d=kT(fp(i,"layout","region")),h=fp(i,"body","[begin]");return[].map.call(h,p=>{const m=_R(p,l);if(!m||!p.hasAttribute("begin"))return null;const v=mp(p.getAttribute("begin"),o),y=mp(p.getAttribute("dur"),o);let S=mp(p.getAttribute("end"),o);if(v===null)throw CT(p);if(S===null){if(y===null)throw CT(p);S=v+y}const x=new n0(v-e,S-e,m);x.id=s0(x.startTime,x.endTime,x.text);const b=d[p.getAttribute("region")],w=u[p.getAttribute("style")],L=Y5(b,w,u),{textAlign:I}=L;if(I){const k=W5[I];k&&(x.lineAlign=k),x.align=I}return tt(x,L),x}).filter(p=>p!==null)}function fp(s,e,t){const n=s.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function kT(s){return s.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function _R(s,e){return[].slice.call(s.childNodes).reduce((t,n,i)=>{var r;return n.nodeName==="br"&&i?t+`
`:(r=n.childNodes)!=null&&r.length?_R(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function Y5(s,e,t){const n="http://www.w3.org/ns/ttml#styling";let i=null;const r=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=s!=null&&s.hasAttribute("style")?s.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(i=t[o]),r.reduce((l,u)=>{const d=pp(e,n,u)||pp(s,n,u)||pp(i,n,u);return d&&(l[u]=d),l},{})}function pp(s,e,t){return s&&s.hasAttributeNS(e,t)?s.getAttributeNS(e,t):null}function CT(s){return new Error(`Could not parse ttml timestamp ${s}`)}function mp(s,e){if(!s)return null;let t=AR(s);return t===null&&(LR.test(s)?t=Q5(s,e):IR.test(s)&&(t=X5(s,e))),t}function Q5(s,e){const t=LR.exec(s),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function X5(s,e){const t=IR.exec(s),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class pu{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class J5{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=DT(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(R.FRAG_LOADING,this.onFragLoading,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this),e.on(R.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(R.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(R.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(R.FRAG_LOADING,this.onFragLoading,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this),e.off(R.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(R.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(R.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new pu(this,"textTrack1"),t=new pu(this,"textTrack2"),n=new pu(this,"textTrack3"),i=new pu(this,"textTrack4");this.cea608Parser1=new IT(1,e,t),this.cea608Parser2=new IT(3,n,i)}addCues(e,t,n,i,r){let o=!1;for(let l=r.length;l--;){const u=r[l],d=Z5(u[0],u[1],t,n);if(d>=0&&(u[0]=Math.min(u[0],t),u[1]=Math.max(u[1],n),o=!0,d/(n-t)>.5))return}if(o||r.push([t,n]),this.config.renderTextTracksNatively){const l=this.captionsTracks[e];this.Cues.newCue(l,t,n,i)}else{const l=this.Cues.newCue(null,t,n,i);this.hls.trigger(R.CUES_PARSED,{type:"captions",cues:l,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:i,timescale:r,trackId:o}){const{unparsedVttFrags:l}=this;n===ye.MAIN&&(this.initPTS[t.cc]={baseTime:i,timescale:r,trackId:o}),l.length&&(this.unparsedVttFrags=[],l.forEach(u=>{this.initPTS[u.frag.cc]?this.onFragLoaded(R.FRAG_LOADED,u):this.hls.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:u.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const r=n.textTracks[i];if(PT(r,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:i}=this,{label:r,languageCode:o}=t[e],l=this.getExistingTrack(r,o);if(l)n[e]=l,xo(n[e]),xR(n[e],i);else{const u=this.createTextTrack("captions",r,o);u&&(u[e]=!0,n[e]=u)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,i={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(R.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,n){const i=this.media;if(i)return i.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const n=!!t.transferMedia;if(this.media=null,n)return;const{captionsTracks:i}=this;Object.keys(i).forEach(r=>{xo(i[r]),delete i[r]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=DT(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)xo(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],i=n.some(r=>r.textCodec===hp);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(oR(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const o=this.media,l=o?Mu(o.textTracks):null;if(this.tracks.forEach((u,d)=>{let h;if(l){let p=null;for(let m=0;m<l.length;m++)if(l[m]&&PT(l[m],u)){p=l[m],l[m]=null;break}p&&(h=p)}if(h)xo(h);else{const p=kR(u);h=this.createTextTrack(p,u.name,u.lang),h&&(h.mode="disabled")}h&&this.textTracks.push(h)}),l!=null&&l.length){const u=l.filter(d=>d!==null).map(d=>d.label);u.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${u.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(l=>({label:l.name,kind:l.type.toLowerCase(),default:l.default,subtitleTrack:l}));this.hls.trigger(R.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const i=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!i)return;const r=`textTrack${i[1]}`,o=this.captionsProperties[r];o&&(o.label=n.name,n.lang&&(o.languageCode=n.lang),o.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===ye.MAIN){var n,i;const{cea608Parser1:r,cea608Parser2:o,lastSn:l}=this,{cc:u,sn:d}=t.frag,h=(n=(i=t.part)==null?void 0:i.index)!=null?n:-1;r&&o&&(d!==l+1||d===l&&h!==this.lastPartIndex+1||u!==this.lastCc)&&(r.reset(),o.reset()),this.lastCc=u,this.lastSn=d,this.lastPartIndex=h}}onFragLoaded(e,t){const{frag:n,payload:i}=t;if(n.type===ye.SUBTITLE)if(i.byteLength){const r=n.decryptdata,o="stats"in t;if(r==null||!r.encrypted||o){const l=this.tracks[n.level],u=this.vttCCs;u[n.cc]||(u[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),l&&l.textCodec===hp?this._parseIMSC1(n,i):this._parseVTTs(t)}}else this.hls.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;_T(t,this.initPTS[e.cc],i=>{this._appendCues(i,e.level),n.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},i=>{n.logger.log(`Failed to parse IMSC1: ${i}`),n.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:i})})}_parseVTTs(e){var t;const{frag:n,payload:i}=e,{initPTS:r,unparsedVttFrags:o}=this,l=r.length-1;if(!r[n.cc]&&l===-1){o.push(e);return}const u=this.hls,d=(t=n.initSegment)!=null&&t.data?zn(n.initSegment.data,new Uint8Array(i)).buffer:i;z5(d,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,h=>{this._appendCues(h,n.level),u.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},h=>{const p=h.message==="Missing initPTS for VTT MPEGTS";p?o.push(e):this._fallbackToIMSC1(n,i),u.logger.log(`Failed to parse VTT cue: ${h}`),!(p&&l>n.cc)&&u.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:h})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||_T(t,this.initPTS[e.cc],()=>{n.textCodec=hp,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[t];if(!i||i.mode==="disabled")return;e.forEach(r=>SR(i,r))}else{const i=this.tracks[t];if(!i)return;const r=i.default?"default":"subtitles"+t;n.trigger(R.CUES_PARSED,{type:"subtitles",cues:e,track:r})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===ye.SUBTITLE&&this.onFragLoaded(R.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:i}=t;if(!(n.type===ye.MAIN&&this.closedCaptionsForLevel(n)==="NONE"))for(let r=0;r<i.length;r++){const o=i[r].bytes;if(o){this.cea608Parser1||this.initCea608Parsers();const l=this.extractCea608Data(o);this.cea608Parser1.addData(i[r].pts,l[0]),this.cea608Parser2.addData(i[r].pts,l[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:i,type:r}){const{media:o}=this;if(!(!o||o.currentTime<n)){if(!r||r==="video"){const{captionsTracks:l}=this;Object.keys(l).forEach(u=>km(l[u],t,n))}if(this.config.renderTextTracksNatively&&t===0&&i!==void 0){const{textTracks:l}=this;Object.keys(l).forEach(u=>km(l[u],t,i))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let i=2;for(let r=0;r<n;r++){const o=e[i++],l=127&e[i++],u=127&e[i++];if(l===0&&u===0)continue;if((4&o)!==0){const h=3&o;(h===0||h===1)&&(t[h].push(l),t[h].push(u))}}return t}}function kR(s){return s.characteristics&&/transcribes-spoken-dialog/gi.test(s.characteristics)&&/describes-music-and-sound/gi.test(s.characteristics)?"captions":"subtitles"}function PT(s,e){return!!s&&s.kind===kR(e)&&Rm(e,s)}function Z5(s,e,t,n){return Math.min(e,n)-Math.max(s,t)}function DT(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const ej=/\s/,tj={newCue(s,e,t,n){const i=[];let r,o,l,u,d;const h=self.VTTCue||self.TextTrackCue;for(let m=0;m<n.rows.length;m++)if(r=n.rows[m],l=!0,u=0,d="",!r.isEmpty()){var p;for(let S=0;S<r.chars.length;S++)ej.test(r.chars[S].uchar)&&l?u++:(d+=r.chars[S].uchar,l=!1);r.cueStartTime=e,e===t&&(t+=1e-4),u>=16?u--:u++;const v=RR(d.trim()),y=s0(e,t,v);s!=null&&(p=s.cues)!=null&&p.getCueById(y)||(o=new h(e,t,v),o.id=y,o.line=m+1,o.align="left",o.position=10+Math.min(80,Math.floor(u*8/32)*10),i.push(o))}return s&&i.length&&(i.sort((m,v)=>m.line==="auto"||v.line==="auto"?0:m.line>8&&v.line>8?v.line-m.line:m.line-v.line),i.forEach(m=>SR(s,m))),i}};function nj(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const sj=/(\d+)-(\d+)\/(\d+)/;class OT{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||aj,this.controller=new self.AbortController,this.stats=new Ng}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const r=ij(e,this.controller.signal),o=e.responseType==="arraybuffer",l=o?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:d}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,r),self.clearTimeout(this.requestTimeout),t.timeout=u&&pe(u)?u:d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,e,this.response))},t.timeout),(xl(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(p=>{var m;this.response=this.loader=p;const v=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,e,this.response))},d-(v-i.loading.start)),!p.ok){const{status:S,statusText:x}=p;throw new lj(x||"fetch, bad network response",S,p)}i.loading.first=v,i.total=oj(p.headers)||i.total;const y=(m=this.callbacks)==null?void 0:m.onProgress;return y&&pe(t.highWaterMark)?this.loadProgressively(p,i,e,t.highWaterMark,y):o?p.arrayBuffer():e.responseType==="json"?p.json():p.text()}).then(p=>{var m,v;const y=this.response;if(!y)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const S=p[l];S&&(i.loaded=i.total=S);const x={url:y.url,data:p,code:y.status},b=(m=this.callbacks)==null?void 0:m.onProgress;b&&!pe(t.highWaterMark)&&b(i,e,p,y),(v=this.callbacks)==null||v.onSuccess(x,i,e,y)}).catch(p=>{var m;if(self.clearTimeout(this.requestTimeout),i.aborted)return;const v=p&&p.code||0,y=p?p.message:null;(m=this.callbacks)==null||m.onError({code:v,text:y},e,p?p.details:null,i)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,i=0,r){const o=new $w,l=e.body.getReader(),u=()=>l.read().then(d=>{if(d.done)return o.dataLength&&r(t,n,o.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const h=d.value,p=h.length;return t.loaded+=p,p<i||o.dataLength?(o.push(h),o.dataLength>=i&&r(t,n,o.flush().buffer,e)):r(t,n,h.buffer,e),u()}).catch(()=>Promise.reject());return u()}}function ij(s,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(tt({},s.headers))};return s.rangeEnd&&t.headers.set("Range","bytes="+s.rangeStart+"-"+String(s.rangeEnd-1)),t}function rj(s){const e=sj.exec(s);if(e)return parseInt(e[2])-parseInt(e[1])+1}function oj(s){const e=s.get("Content-Range");if(e){const n=rj(e);if(pe(n))return n}const t=s.get("Content-Length");if(t)return parseInt(t)}function aj(s,e){return new self.Request(s.url,e)}class lj extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const cj=/^age:\s*[\d.]+\s*$/im;class CR{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Ng,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const r=this.xhrSetup;r?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return r(n,t.url)}).catch(o=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),r(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(o=>{var l;(l=this.callbacks)==null||l.onError({code:n.status,text:o.message},t,n,i)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const i=t.headers,{maxTimeToFirstByteMs:r,maxLoadTimeMs:o}=n.loadPolicy;if(i)for(const l in i)e.setRequestHeader(l,i[l]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=r&&pe(r)?r:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const i=t.readyState,r=this.config;if(!n.aborted&&i>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),r.timeout!==r.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),r.timeout=r.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),i===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const d=t.status,h=t.responseType==="text"?t.responseText:null;if(d>=200&&d<300){const y=h??t.response;if(y!=null){var o,l;n.loading.end=Math.max(self.performance.now(),n.loading.first);const S=t.responseType==="arraybuffer"?y.byteLength:y.length;n.loaded=n.total=S,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first);const x=(o=this.callbacks)==null?void 0:o.onProgress;x&&x(n,e,y,t);const b={url:t.responseURL,data:y,code:d};(l=this.callbacks)==null||l.onSuccess(b,n,e,t);return}}const p=r.loadPolicy.errorRetry,m=n.retry,v={url:e.url,data:void 0,code:d};if(ed(p,m,!1,v))this.retry(p);else{var u;et.error(`${d} while loading ${e.url}`),(u=this.callbacks)==null||u.onError({code:d,text:t.statusText},e,t,n)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(ed(e,t,!0))this.retry(e);else{var n;et.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const i=this.callbacks;i&&(this.abortInternal(),i.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Ug(e,n.retry),n.retry++,et.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&cj.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const uj={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},dj=Ze(Ze({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:CR,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:b$,bufferController:f4,capLevelController:Zg,errorController:I$,fpsController:p5,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:_w,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:uj},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},hj()),{},{subtitleStreamController:R5,subtitleTrackController:y5,timelineController:J5,audioStreamController:c4,audioTrackController:u4,emeController:bo,cmcdController:u5,contentSteeringController:h5,interstitialsController:w5});function hj(){return{cueHandler:tj,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function fj(s,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Pm(s),i=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return i.forEach(o=>{const l=`${o==="level"?"playlist":o}LoadPolicy`,u=e[l]===void 0,d=[];r.forEach(h=>{const p=`${o}Loading${h}`,m=e[p];if(m!==void 0&&u){d.push(p);const v=n[l].default;switch(e[l]={default:v},h){case"TimeOut":v.maxLoadTimeMs=m,v.maxTimeToFirstByteMs=m;break;case"MaxRetry":v.errorRetry.maxNumRetry=m,v.timeoutRetry.maxNumRetry=m;break;case"RetryDelay":v.errorRetry.retryDelayMs=m,v.timeoutRetry.retryDelayMs=m;break;case"MaxRetryTimeout":v.errorRetry.maxRetryDelayMs=m,v.timeoutRetry.maxRetryDelayMs=m;break}}}),d.length&&t.warn(`hls.js config: "${d.join('", "')}" setting(s) are deprecated, use "${l}": ${it(e[l])}`)}),Ze(Ze({},n),e)}function Pm(s){return s&&typeof s=="object"?Array.isArray(s)?s.map(Pm):Object.keys(s).reduce((e,t)=>(e[t]=Pm(s[t]),e),{}):s}function pj(s,e){const t=s.loader;t!==OT&&t!==CR?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),s.progressive=!1):nj()&&(s.loader=OT,s.progressive=!0,s.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const Fu=2,mj=.1,gj=.05,yj=100;class vj extends Aw{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var n;(n=this.media)!=null&&n.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var n;this.ended=((n=this.media)==null?void 0:n.currentTime)||1,this.hls.trigger(R.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(yj),this.mediaSource=t.mediaSource;const n=this.media=t.media;cn(n,"playing",this.onMediaPlaying),cn(n,"waiting",this.onMediaWaiting),cn(n,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:n}=this;n&&(xn(n,"playing",this.onMediaPlaying),xn(n,"waiting",this.onMediaWaiting),xn(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var n,i;const r=(n=this.hls)==null?void 0:n.config;if(!r)return;const o=this.media;if(!o)return;const{seeking:l}=o,u=this.seeking&&!l,d=!this.seeking&&l,h=o.paused&&!l||o.ended||o.playbackRate===0;if(this.seeking=l,e!==t){t&&(this.ended=0),this.moved=!0,l||(this.nudgeRetry=0,r.nudgeOnVideoHole&&!h&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(d||u){u&&this.stallResolved(e);return}if(h){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&o.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(R.MEDIA_ENDED,{stalled:!1}));return}if(!Fe.getBuffered(o).length){this.nudgeRetry=0;return}const p=Fe.bufferInfo(o,e,0),m=p.nextStart||0,v=this.fragmentTracker;if(l&&v&&this.hls){const M=NT(this.hls.inFlightFragments,e),P=p.len>Fu,C=!m||M||m-e>Fu&&!v.getPartialFragment(e);if(P||C)return;this.moved=!1}const y=(i=this.hls)==null?void 0:i.latestLevelDetails;if(!this.moved&&this.stalled!==null&&v){if(!(p.len>0)&&!m)return;const P=Math.max(m,p.start||0)-e,U=!!(y!=null&&y.live)?y.targetduration*2:Fu,O=mu(e,v);if(P>0&&(P<=U||O)){o.paused||this._trySkipBufferHole(O);return}}const S=r.detectStallWithCurrentTimeMs,x=self.performance.now(),b=this.waiting;let w=this.stalled;if(w===null)if(b>0&&x-b<S)w=this.stalled=b;else{this.stalled=x;return}const L=x-w;if(!l&&(L>=S||b)&&this.hls){var I;if(((I=this.mediaSource)==null?void 0:I.readyState)==="ended"&&!(y!=null&&y.live)&&Math.abs(e-((y==null?void 0:y.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(R.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(p),!this.media||!this.hls)return}const k=Fe.bufferInfo(o,e,r.maxBufferHole);this._tryFixBufferStall(k,L,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(n)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(R.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var n;const i=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(n=this.buffered.audio)!=null&&n.length&&i&&i.length>1&&e>i.end(0)){const r=Fe.bufferedInfo(Fe.timeRangesToArray(this.buffered.audio),e,0);if(r.len>1&&t>=r.start){const o=Fe.timeRangesToArray(i),l=Fe.bufferedInfo(o,t,0).bufferedIndex;if(l>-1&&l<o.length-1){const u=Fe.bufferedInfo(o,e,0).bufferedIndex,d=o[l].end,h=o[l+1].start;if((u===-1||u>l)&&h-d<1&&e-d<2){const p=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${d} -> ${h} buffered index: ${u}`);this.warn(p.message),this.media.currentTime+=1e-6;let m=mu(e,this.fragmentTracker);m&&"fragment"in m?m=m.fragment:m||(m=void 0);const v=Fe.bufferInfo(this.media,e,0);this.hls.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:p,reason:p.message,frag:m,buffer:v.len,bufferInfo:v})}}}}}_tryFixBufferStall(e,t,n){var i,r;const{fragmentTracker:o,media:l}=this,u=(i=this.hls)==null?void 0:i.config;if(!l||!o||!u)return;const d=(r=this.hls)==null?void 0:r.latestLevelDetails,h=mu(n,o);if((h||d!=null&&d.live&&n<d.fragmentStart)&&(this._trySkipBufferHole(h)||!this.media))return;const p=e.buffered,m=this.adjacentTraversal(e,n);(p&&p.length>1&&e.len>u.maxBufferHole||e.nextStart&&(e.nextStart-n<u.maxBufferHole||m))&&(t>u.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const n=this.fragmentTracker,i=e.nextStart;if(n&&i){const r=n.getFragAtPos(t,ye.MAIN),o=n.getFragAtPos(i,ye.MAIN);if(r&&o)return o.sn-r.sn<2}return!1}_reportStall(e){const{hls:t,media:n,stallReported:i,stalled:r}=this;if(!i&&r!==null&&n&&t){this.stallReported=!0;const o=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${it(e)})`);this.warn(o.message),t.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.BUFFER_STALLED_ERROR,fatal:!1,error:o,buffer:e.len,bufferInfo:e,stalled:{start:r}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:n,media:i}=this,r=(t=this.hls)==null?void 0:t.config;if(!i||!n||!r)return 0;const o=i.currentTime,l=Fe.bufferInfo(i,o,0),u=o<l.start?l.start:l.nextStart;if(u&&this.hls){const h=l.len<=r.maxBufferHole,p=l.len>0&&l.len<1&&i.readyState<3,m=u-o;if(m>0&&(h||p)){if(m>r.maxBufferHole){let y=!1;if(o===0){const S=n.getAppendedFrag(0,ye.MAIN);S&&u<S.end&&(y=!0)}if(!y&&e){var d;if(!((d=this.hls.loadLevelObj)!=null&&d.details)||NT(this.hls.inFlightFragments,u))return 0;let x=!1,b=e.end;for(;b<u;){const w=mu(b,n);if(w)b+=w.duration;else{x=!0;break}}if(x)return 0}}const v=Math.max(u+gj,o+mj);if(this.warn(`skipping hole, adjusting currentTime from ${o} to ${v}`),this.moved=!0,i.currentTime=v,!(e!=null&&e.gap)){const y=new Error(`fragment loaded with buffer holes, seeking from ${o} to ${v}`),S={type:Re.MEDIA_ERROR,details:H.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:y,reason:y.message,buffer:l.len,bufferInfo:l};e&&("fragment"in e?S.part=e:S.frag=e),this.hls.trigger(R.ERROR,S)}return v}}return 0}_tryNudgeBuffer(e){const{hls:t,media:n,nudgeRetry:i}=this,r=t==null?void 0:t.config;if(!n||!r)return 0;const o=n.currentTime;if(this.nudgeRetry++,i<r.nudgeMaxRetry){const l=o+(i+1)*r.nudgeOffset,u=new Error(`Nudging 'currentTime' from ${o} to ${l}`);this.warn(u.message),n.currentTime=l,t.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.BUFFER_NUDGE_ON_STALL,error:u,fatal:!1,buffer:e.len,bufferInfo:e})}else{const l=new Error(`Playhead still not moving while enough data buffered @${o} after ${r.nudgeMaxRetry} nudges`);this.error(l.message),t.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.BUFFER_STALLED_ERROR,error:l,fatal:!0,buffer:e.len,bufferInfo:e})}}}function NT(s,e){const t=MT(s.main);if(t&&t.start<=e)return t;const n=MT(s.audio);return n&&n.start<=e?n:null}function MT(s){if(!s)return null;switch(s.state){case te.IDLE:case te.STOPPED:case te.ENDED:case te.ERROR:return null}return s.frag}function mu(s,e){return e.getAppendedFrag(s,ye.MAIN)||e.getPartialFragment(s)}const xj=.25;function Dm(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function gp(s,e,t,n,i){let r=new s(e,t,"");try{r.value=n,i&&(r.type=i)}catch{r=new s(e,t,it(i?Ze({type:i},n):n))}return r}const gu=(()=>{const s=Dm();try{s&&new s(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class Sj{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(R.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(R.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(R.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var n;this.media=t.media,((n=t.overrides)==null?void 0:n.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&xo(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return xR(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:n,enableID3MetadataCues:i}=this.hls.config;if(!n&&!i)return;const{samples:r}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=Dm();if(o)for(let l=0;l<r.length;l++){const u=r[l].type;if(u===Cn.emsg&&!n||!i)continue;const d=Ww(r[l].data),h=r[l].pts;let p=h+r[l].duration;p>gu&&(p=gu),p-h<=0&&(p=h+xj);for(let v=0;v<d.length;v++){const y=d[v];if(!qw(y)){this.updateId3CueEnds(h,u);const S=gp(o,h,p,y,u);S&&this.id3Track.addCue(S)}}}}updateId3CueEnds(e,t){var n;const i=(n=this.id3Track)==null?void 0:n.cues;if(i)for(let r=i.length;r--;){const o=i[r];o.type===t&&o.startTime<e&&o.endTime===gu&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:i}){const{id3Track:r,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:l,enableID3MetadataCues:u}}=o;if(r&&(l||u)){let d;i==="audio"?d=h=>h.type===Cn.audioId3&&u:i==="video"?d=h=>h.type===Cn.emsg&&l:d=h=>h.type===Cn.audioId3&&u||h.type===Cn.emsg&&l,km(r,t,n,d)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:n,timelineOffset:i,enableDateRangeMetadataCues:r,interstitialsController:o}=this.hls.config;if(!r)return;const l=Dm();if(n&&i&&!o){const{fragmentStart:S,fragmentEnd:x}=e;let b=this.assetCue;b?(b.startTime=S,b.endTime=x):l&&(b=this.assetCue=gp(l,S,x,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),b&&(b.id=n,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(b),b.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:u}=this,{dateRanges:d}=e,h=Object.keys(d);let p=this.dateRangeCuesAppended;if(u&&t){var m;if((m=u.cues)!=null&&m.length){const S=Object.keys(p).filter(x=>!h.includes(x));for(let x=S.length;x--;){var v;const b=S[x],w=(v=p[b])==null?void 0:v.cues;delete p[b],w&&Object.keys(w).forEach(L=>{const I=w[L];if(I){I.removeEventListener("enter",this.onEventCueEnter);try{u.removeCue(I)}catch{}}})}}else p=this.dateRangeCuesAppended={}}const y=e.fragments[e.fragments.length-1];if(!(h.length===0||!pe(y==null?void 0:y.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let S=0;S<h.length;S++){const x=h[S],b=d[x],w=b.startTime,L=p[x],I=(L==null?void 0:L.cues)||{};let k=(L==null?void 0:L.durationKnown)||!1,M=gu;const{duration:P,endDate:C}=b;if(C&&P!==null)M=w+P,k=!0;else if(b.endOnNext&&!k){const O=h.reduce((W,ne)=>{if(ne!==b.id){const oe=d[ne];if(oe.class===b.class&&oe.startDate>b.startDate&&(!W||b.startDate<W.startDate))return oe}return W},null);O&&(M=O.startTime,k=!0)}const U=Object.keys(b.attr);for(let O=0;O<U.length;O++){const W=U[O];if(!j$(W))continue;const ne=I[W];if(ne)k&&!(L!=null&&L.durationKnown)?ne.endTime=M:Math.abs(ne.startTime-w)>.01&&(ne.startTime=w,ne.endTime=M);else if(l){let oe=b.attr[W];V$(W)&&(oe=iw(oe));const re=gp(l,w,M,{key:W,data:oe},Cn.dateRange);re&&(re.id=x,this.id3Track.addCue(re),I[W]=re,o&&(W==="X-ASSET-LIST"||W==="X-ASSET-URL")&&re.addEventListener("enter",this.onEventCueEnter))}}p[x]={cues:I,dateRange:b,durationKnown:k}}}}}class Ej{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,n=this.levelDetails;if(!t||!n)return;this.currentTime=t.currentTime;const i=this.computeLatency();if(i===null)return;this._latency=i;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:o}=this.config;if(!r||o===1||!n.live)return;const l=this.targetLatency;if(l===null)return;const u=i-l,d=Math.min(this.maxLatency,l+n.targetduration);if(u<d&&u>.05&&this.forwardBufferLength>1){const p=Math.min(2,Math.max(1,o)),m=Math.round(2/(1+Math.exp(-.75*u-this.edgeStalled))*20)/20,v=Math.min(p,Math.max(1,m));this.changeMediaPlaybackRate(t,v)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:r,liveSyncDurationCount:o,lowLatencyMode:l}=this.config,u=this.hls.userConfig;let d=l&&n||t;(this._targetLatencyUpdated||u.liveSyncDuration||u.liveSyncDurationCount||d===0)&&(d=r!==void 0?r:o*i);const h=i;return d+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,h)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const n=this.levelDetails;if(n===null)return null;const i=n.edge,r=e-t-this.edgeStalled,o=i-n.totalduration,l=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(o,r),l)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(R.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(R.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var n;t.details===H.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(n=this.levelDetails)!=null&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var n,i;e.playbackRate!==t&&((n=this.hls)==null||n.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(i=this.targetLatency)==null?void 0:i.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class Tj extends Jg{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this),e.on(R.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this),e.off(R.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,i=[],r={},o={};let l=!1,u=!1,d=!1;t.levels.forEach(h=>{const p=h.attrs;let{audioCodec:m,videoCodec:v}=h;m&&(h.audioCodec=m=Qu(m,n)||void 0),v&&(v=h.videoCodec=i$(v));const{width:y,height:S,unknownCodecs:x}=h,b=(x==null?void 0:x.length)||0;if(l||(l=!!(y&&S)),u||(u=!!v),d||(d=!!m),b||m&&!this.isAudioSupported(m)||v&&!this.isVideoSupported(v)){this.log(`Some or all CODECS not supported "${p.CODECS}"`);return}const{CODECS:w,"FRAME-RATE":L,"HDCP-LEVEL":I,"PATHWAY-ID":k,RESOLUTION:M,"VIDEO-RANGE":P}=p,U=`${`${k||"."}-`}${h.bitrate}-${M}-${L}-${w}-${P}-${I}`;if(r[U])if(r[U].uri!==h.url&&!h.attrs["PATHWAY-ID"]){const O=o[U]+=1;h.attrs["PATHWAY-ID"]=new Array(O+1).join(".");const W=this.createLevel(h);r[U]=W,i.push(W)}else r[U].addGroupId("audio",p.AUDIO),r[U].addGroupId("text",p.SUBTITLES);else{const O=this.createLevel(h);r[U]=O,o[U]=1,i.push(O)}}),this.filterAndSortMediaOptions(i,t,l,u,d)}createLevel(e){const t=new gl(e),n=e.supplemental;if(n!=null&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const i=new Error(`SUPPLEMENTAL-CODECS not supported "${n.videoCodec}"`);this.log(i.message),t.supportedResult=gw(i,[])}return t}isAudioSupported(e){return pl(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return pl(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,n,i,r){var o;let l=[],u=[],d=e;const h=((o=t.stats)==null?void 0:o.parsing)||{};if((n||i)&&r&&(d=d.filter(({videoCodec:w,videoRange:L,width:I,height:k})=>(!!w||!!(I&&k))&&p$(L))),d.length===0){Promise.resolve().then(()=>{if(this.hls){let w="no level with compatible codecs found in manifest",L=w;t.levels.length&&(L=`one or more CODECS in variant not supported: ${it(t.levels.map(k=>k.attrs.CODECS).filter((k,M,P)=>P.indexOf(k)===M))}`,this.warn(L),w+=` (${L})`);const I=new Error(w);this.hls.trigger(R.ERROR,{type:Re.MEDIA_ERROR,details:H.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:I,reason:L})}}),h.end=performance.now();return}t.audioTracks&&(l=t.audioTracks.filter(w=>!w.audioCodec||this.isAudioSupported(w.audioCodec)),FT(l)),t.subtitles&&(u=t.subtitles,FT(u));const p=d.slice(0);d.sort((w,L)=>{if(w.attrs["HDCP-LEVEL"]!==L.attrs["HDCP-LEVEL"])return(w.attrs["HDCP-LEVEL"]||"")>(L.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&w.height!==L.height)return w.height-L.height;if(w.frameRate!==L.frameRate)return w.frameRate-L.frameRate;if(w.videoRange!==L.videoRange)return Xu.indexOf(w.videoRange)-Xu.indexOf(L.videoRange);if(w.videoCodec!==L.videoCodec){const I=IE(w.videoCodec),k=IE(L.videoCodec);if(I!==k)return k-I}if(w.uri===L.uri&&w.codecSet!==L.codecSet){const I=Yu(w.codecSet),k=Yu(L.codecSet);if(I!==k)return k-I}return w.averageBitrate!==L.averageBitrate?w.averageBitrate-L.averageBitrate:0});let m=p[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==p.length)){for(let w=0;w<p.length;w++)if(p[w].pathwayId===d[0].pathwayId){m=p[w];break}}this._levels=d;for(let w=0;w<d.length;w++)if(d[w]===m){var v;this._firstLevel=w;const L=m.bitrate,I=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${L}`),((v=this.hls.userConfig)==null?void 0:v.abrEwmaDefaultEstimate)===void 0){const k=Math.min(L,this.hls.config.abrEwmaDefaultEstimateMax);k>I&&I===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=k)}break}const y=r&&!i,S=this.hls.config,x=!!(S.audioStreamController&&S.audioTrackController),b={levels:d,audioTracks:l,subtitleTracks:u,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:r,video:i,altAudio:x&&!y&&l.some(w=>!!w.url)};h.end=performance.now(),this.hls.trigger(R.MANIFEST_PARSED,b)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const h=new Error("invalid level idx"),p=e<0;if(this.hls.trigger(R.ERROR,{type:Re.OTHER_ERROR,details:H.LEVEL_SWITCH_ERROR,level:e,fatal:p,error:h,reason:h.message}),p)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,r=i?i.attrs["PATHWAY-ID"]:void 0,o=t[e],l=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n===e&&i&&r===l)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${l?" with Pathway "+l:""} from level ${n}${r?" with Pathway "+r:""}`);const u={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(R.LEVEL_SWITCHING,u);const d=o.details;if(!d||d.live){const h=this.switchParams(o.uri,i==null?void 0:i.details,d);this.loadPlaylist(h)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),n=e.filter(i=>t.indexOf(i)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=n}}onError(e,t){t.fatal||!t.context||t.context.type===Ge.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===ye.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(r=>!!n[r]))return;const i=this._levels[t.level];i!=null&&i.loadError&&(this.log(`Resetting level error count of ${i.loadError} on frag buffered`),i.loadError=0)}}onLevelLoaded(e,t){var n;const{level:i,details:r}=t,o=t.levelInfo;if(!o){var l;this.warn(`Invalid level index ${i}`),(l=t.deliveryDirectives)!=null&&l.skip&&(r.deltaUpdateFailed=!0);return}if(o===this.currentLevel||t.withoutMultiVariant){o.fragmentError===0&&(o.loadError=0);let u=o.details;u===t.details&&u.advanced&&(u=void 0),this.playlistLoaded(i,t,u)}else(n=t.deliveryDirectives)!=null&&n.skip&&(r.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=this.getUrlWithDirectives(e.uri,t),i=this.currentLevelIndex,r=e.attrs["PATHWAY-ID"],o=e.details,l=o==null?void 0:o.age;this.log(`Loading level index ${i}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${r?" Pathway "+r:""}${l&&o.live?" age "+l.toFixed(1)+(o.type&&" "+o.type||""):""} ${n}`),this.hls.trigger(R.LEVEL_LOADING,{url:n,level:i,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const n=this._levels.filter((r,o)=>o!==e?!0:(this.steering&&this.steering.removeLevel(r),r===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,r.details&&r.details.fragments.forEach(l=>l.level=-1)),!1));Fw(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const i=n.length-1;this._firstLevel=Math.min(this._firstLevel,i),this._startLevel&&(this._startLevel=Math.min(this._startLevel,i)),this.hls.trigger(R.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(R.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function FT(s){const e={};s.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}function PR(){return self.SourceBuffer||self.WebKitSourceBuffer}function DR(){if(!ji())return!1;const e=PR();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function bj(){if(!DR())return!1;const s=ji();return typeof(s==null?void 0:s.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>s.isTypeSupported(ml(e,"video")))||["mp4a.40.2","fLaC"].some(e=>s.isTypeSupported(ml(e,"audio"))))}function Aj(){var s;const e=PR();return typeof(e==null||(s=e.prototype)==null?void 0:s.changeType)=="function"}const wj=100;class Rj extends Kg{constructor(e,t,n){super(e,t,n,"stream-controller",ye.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const i=this.media,r=i?i.currentTime:null;if(r===null||!pe(r)||(this.log(`Media seeked to ${r.toFixed(3)}`),!this.getBufferedFrag(r)))return;const o=this.getFwdBufferInfoAtPos(i,r,ye.MAIN,0);if(o===null||o.len===0){this.warn(`Main forward buffer length at ${r} on "seeked" event ${o?o.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(R.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(R.BUFFER_CREATED,this.onBufferCreated,this),e.on(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(R.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(R.BUFFER_CREATED,this.onBufferCreated,this),e.off(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:n,hls:i}=this;if(this.stopLoad(),this.setInterval(wj),this.level=-1,!this.startFragRequested){let r=i.startLevel;r===-1&&(i.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=i.firstAutoLevel),i.nextLoadLevel=r,this.level=i.loadLevel,this._hasEnoughToStart=!!t}n>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n),this.state=te.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=te.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case te.WAITING_LEVEL:{const{levels:e,level:t}=this,n=e==null?void 0:e[t],i=n==null?void 0:n.details;if(i&&(!i.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(i))break;this.state=te.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=te.IDLE;break}break}case te.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===te.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:i}=this;if(t===null||!i&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const r=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[r]))return;const o=n[r],l=this.getMainFwdBufferInfo();if(l===null)return;const u=this.getLevelDetails();if(u&&this._streamEnded(l,u)){const S={};this.altAudio===2&&(S.type="video"),this.hls.trigger(R.BUFFER_EOS,S),this.state=te.ENDED;return}if(!this.buffering)return;e.loadLevel!==r&&e.manualLevel===-1&&this.log(`Adapting to level ${r} from level ${this.level}`),this.level=e.nextLoadLevel=r;const d=o.details;if(!d||this.state===te.WAITING_LEVEL||this.waitForLive(o)){this.level=r,this.state=te.WAITING_LEVEL,this.startFragRequested=!1;return}const h=l.len,p=this.getMaxBufferLength(o.maxBitrate);if(h>=p)return;this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);const m=this.backtrackFragment?this.backtrackFragment.start:l.end;let v=this.getNextFragment(m,d);if(this.couldBacktrack&&!this.fragPrevious&&v&&Tt(v)&&this.fragmentTracker.getState(v)!==Pt.OK){var y;const x=((y=this.backtrackFragment)!=null?y:v).sn-d.startSN,b=d.fragments[x-1];b&&v.cc===b.cc&&(v=b,this.fragmentTracker.removeFragment(b))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(v&&this.isLoopLoading(v,m)){if(!v.gap){const x=this.audioOnly&&!this.altAudio?nt.AUDIO:nt.VIDEO,b=(x===nt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;b&&this.afterBufferFlushed(b,x,ye.MAIN)}v=this.getNextFragmentLoopLoading(v,d,l,ye.MAIN,p)}v&&(v.initSegment&&!v.initSegment.data&&!this.bitrateTest&&(v=v.initSegment),this.loadFragment(v,o,m))}loadFragment(e,t,n){const i=this.fragmentTracker.getState(e);i===Pt.NOT_LOADED||i===Pt.PARTIAL?Tt(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ye.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const r=this.getLevelDetails();if(r!=null&&r.live){const l=this.getMainFwdBufferInfo();if(!l||l.len<r.targetduration*2)return}if(!t.paused&&e){const l=this.hls.nextLoadLevel,u=e[l],d=this.fragLastKbps;d&&this.fragCurrent?n=this.fragCurrent.duration*u.maxBitrate/(1e3*d)+1:n=0}else n=0;const o=this.getBufferedFrag(t.currentTime+n);if(o){const l=this.followingBufferedFrag(o);if(l){this.abortCurrentFrag();const u=l.maxStartPTS?l.maxStartPTS:l.start,d=l.duration,h=Math.max(o.end,u+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(h,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case te.KEY_LOADING:case te.FRAG_LOADING:case te.FRAG_LOADING_WAITING_RETRY:case te.PARSING:case te.PARSED:this.state=te.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;cn(n,"playing",this.onMediaPlaying),cn(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:n}=this;n&&(xn(n,"playing",this.onMediaPlaying),xn(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(R.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let n=!1,i=!1;for(let r=0;r<t.levels.length;r++){const o=t.levels[r].audioCodec;o&&(n=n||o.indexOf("mp4a.40.2")!==-1,i=i||o.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=n&&i&&!Aj(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==te.IDLE)return;const i=t.levelInfo;(!i.details||i.details.live&&(this.levelLastLoaded!==i||i.details.expired)||this.waitForCdnTuneIn(i.details))&&(this.state=te.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:i,startFragRequested:r}=this,o=t.level,l=t.details,u=l.totalduration;if(!i){this.warn(`Levels were reset while loading level ${o}`);return}this.log(`Level ${o} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""}, cc [${l.startCC}, ${l.endCC}] duration:${u}`);const d=t.levelInfo,h=this.fragCurrent;h&&(this.state===te.FRAG_LOADING||this.state===te.FRAG_LOADING_WAITING_RETRY)&&h.level!==t.level&&h.loader&&this.abortCurrentFrag();let p=0;if(l.live||(n=d.details)!=null&&n.live){var m;if(this.checkLiveUpdate(l),l.deltaUpdateFailed)return;p=this.alignPlaylists(l,d.details,(m=this.levelLastLoaded)==null?void 0:m.details)}if(d.details=l,this.levelLastLoaded=d,r||this.setStartPosition(l,p),this.hls.trigger(R.LEVEL_UPDATED,{details:l,level:o}),this.state===te.WAITING_LEVEL){if(this.waitForCdnTuneIn(l))return;this.state=te.IDLE}r&&l.live&&this.synchronizeToLiveEdge(l),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,r=this.getLoadPosition(),o=e.fragmentStart,l=e.edge,u=r>=o-t.maxFragLookUpTolerance&&r<=l;if(i!==null&&n.duration>i&&(r<i||!u)){const h=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!u&&n.readyState<4||r<l-h)&&(this._hasEnoughToStart||(this.nextLoadPosition=i),n.readyState))if(this.warn(`Playback: ${r.toFixed(3)} is located too far from the end of live sliding playlist: ${l}, reset currentTime to : ${i.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var d;const p=Fe.bufferInfo(n,i,0);if(!((d=p.buffered)!=null&&d.length)){n.currentTime=i;return}if(p.start<=r){n.currentTime=i;return}const{nextStart:v}=Fe.bufferedInfo(p.buffered,r,0);v&&(n.currentTime=v)}else n.currentTime=i}}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:i,payload:r}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const l=o[n.level];if(!l){this.warn(`Level ${n.level} not found on progress`);return}const u=l.details;if(!u){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const d=l.videoCodec,h=u.PTSKnown||!u.live,p=(t=n.initSegment)==null?void 0:t.data,m=this._getAudioCodec(l),v=this.transmuxer=this.transmuxer||new rR(this.hls,ye.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),y=i?i.index:-1,S=y!==-1,x=new jg(n.level,n.sn,n.stats.chunkCount,r.byteLength,y,S),b=this.initPTS[n.cc];v.push(r,p,m,d,n,i,u.totalduration,h,x,b)}onAudioTrackSwitching(e,t){const n=this.hls,i=this.altAudio!==0;if(Ju(t.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(i){this.altAudio=0,this.fragmentTracker.removeAllFragments(),n.once(R.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(R.AUDIO_TRACK_SWITCHED,t)}),n.trigger(R.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}n.trigger(R.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=Ju(t.url,this.hls);if(n){const i=this.videoBuffer;i&&this.mediaBuffer!==i&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,t){const n=t.tracks;let i,r,o=!1;for(const l in n){const u=n[l];if(u.id==="main"){if(r=l,i=u,l==="video"){const d=n[l];d&&(this.videoBuffer=d.buffer)}}else o=!0}o&&i?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:i}=t,r=n.type===ye.MAIN;if(r){if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===te.PARSED&&(this.state=te.IDLE);return}const l=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*l.total/(l.buffering.end-l.loading.first)),Tt(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}const o=this.media;o&&(!this._hasEnoughToStart&&Fe.getBuffered(o).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),r&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var n;if(t.fatal){this.state=te.ERROR;return}switch(t.details){case H.FRAG_GAP:case H.FRAG_PARSING_ERROR:case H.FRAG_DECRYPT_ERROR:case H.FRAG_LOAD_ERROR:case H.FRAG_LOAD_TIMEOUT:case H.KEY_LOAD_ERROR:case H.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ye.MAIN,t);break;case H.LEVEL_LOAD_ERROR:case H.LEVEL_LOAD_TIMEOUT:case H.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===te.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===Ge.LEVEL&&(this.state=te.IDLE);break;case H.BUFFER_ADD_CODEC_ERROR:case H.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case H.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case H.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=te.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==nt.AUDIO||!this.altAudio){const n=(t===nt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;n&&(this.afterBufferFlushed(n,t,ye.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const i=this.timelineOffset;i&&n&&(n+=i);const r=this.getLevelDetails(),o=Fe.getBuffered(e),l=o.length?o.start(0):0,u=l-n,d=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||u>0&&(u<d||this.loadingParts&&u<2*((r==null?void 0:r.partTarget)||0)))&&(this.log(`adjusting start position by ${u} to match buffer start`),n+=u,this.startPosition=n),t<n&&(this.log(`seek to target start position ${n} from current time ${t} buffer start ${l}`),e.currentTime=n)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:i}=this,r=n==null?void 0:n.frag;if(!r||this.fragContextChanged(r))return;t.fragmentError=0,this.state=te.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const o=r.stats;o.parsing.start=o.parsing.end=o.buffering.start=o.buffering.end=self.performance.now(),i.trigger(R.FRAG_LOADED,n),r.bitrateTest=!1}).catch(n=>{this.state===te.STOPPED||this.state===te.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:n}=this,{remuxResult:i,chunkMeta:r}=e,o=this.getCurrentContext(r);if(!o){this.resetWhenMissingContext(r);return}const{frag:l,part:u,level:d}=o,{video:h,text:p,id3:m,initSegment:v}=i,{details:y}=d,S=this.altAudio?void 0:i.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=te.PARSING,v){const x=v.tracks;if(x){const I=l.initSegment||l;if(this.unhandledEncryptionError(v,l))return;this._bufferInitSegment(d,x,I,r),n.trigger(R.FRAG_PARSING_INIT_SEGMENT,{frag:I,id:t,tracks:x})}const b=v.initPTS,w=v.timescale,L=this.initPTS[l.cc];if(pe(b)&&(!L||L.baseTime!==b||L.timescale!==w)){const I=v.trackId;this.initPTS[l.cc]={baseTime:b,timescale:w,trackId:I},n.trigger(R.INIT_PTS_FOUND,{frag:l,id:t,initPTS:b,timescale:w,trackId:I})}}if(h&&y){S&&h.type==="audiovideo"&&this.logMuxedErr(l);const x=y.fragments[l.sn-1-y.startSN],b=l.sn===y.startSN,w=!x||l.cc>x.cc;if(i.independent!==!1){const{startPTS:L,endPTS:I,startDTS:k,endDTS:M}=h;if(u)u.elementaryStreams[h.type]={startPTS:L,endPTS:I,startDTS:k,endDTS:M};else if(h.firstKeyFrame&&h.independent&&r.id===1&&!w&&(this.couldBacktrack=!0),h.dropped&&h.independent){const P=this.getMainFwdBufferInfo(),C=(P?P.end:this.getLoadPosition())+this.config.maxBufferHole,U=h.firstKeyFramePTS?h.firstKeyFramePTS:L;if(!b&&C<U-this.config.maxBufferHole&&!w){this.backtrack(l);return}else w&&(l.gap=!0);l.setElementaryStreamInfo(h.type,l.start,I,l.start,M,!0)}else b&&L-(y.appliedTimelineOffset||0)>Fu&&(l.gap=!0);l.setElementaryStreamInfo(h.type,L,I,k,M),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(h,l,u,r,b||w)}else if(b||w)l.gap=!0;else{this.backtrack(l);return}}if(S){const{startPTS:x,endPTS:b,startDTS:w,endDTS:L}=S;u&&(u.elementaryStreams[nt.AUDIO]={startPTS:x,endPTS:b,startDTS:w,endDTS:L}),l.setElementaryStreamInfo(nt.AUDIO,x,b,w,L),this.bufferFragmentData(S,l,u,r)}if(y&&m!=null&&m.samples.length){const x={id:t,frag:l,details:y,samples:m.samples};n.trigger(R.FRAG_PARSING_METADATA,x)}if(y&&p){const x={id:t,frag:l,details:y,samples:p.samples};n.trigger(R.FRAG_PARSING_USERDATA,x)}}logMuxedErr(e){this.warn(`${Tt(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,n,i){if(this.state!==te.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(n));const{audio:r,video:o,audiovideo:l}=t;if(r){const d=e.audioCodec;let h=ku(r.codec,d);h==="mp4a"&&(h="mp4a.40.5");const p=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){h&&(h.indexOf("mp4a.40.5")!==-1?h="mp4a.40.2":h="mp4a.40.5");const m=r.metadata;m&&"channelCount"in m&&(m.channelCount||1)!==1&&p.indexOf("firefox")===-1&&(h="mp4a.40.5")}h&&h.indexOf("mp4a.40.5")!==-1&&p.indexOf("android")!==-1&&r.container!=="audio/mpeg"&&(h="mp4a.40.2",this.log(`Android: force audio codec to ${h}`)),d&&d!==h&&this.log(`Swapping manifest audio codec "${d}" for "${h}"`),r.levelCodec=h,r.id=ye.MAIN,this.log(`Init audio buffer, container:${r.container}, codecs[selected/level/parsed]=[${h||""}/${d||""}/${r.codec}]`),delete t.audiovideo}if(o){o.levelCodec=e.videoCodec,o.id=ye.MAIN;const d=o.codec;if((d==null?void 0:d.length)===4)switch(d){case"hvc1":case"hev1":o.codec="hvc1.1.6.L120.90";break;case"av01":o.codec="av01.0.04M.08";break;case"avc1":o.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${d}]${o.codec!==d?" parsed-corrected="+o.codec:""}${o.supplemental?" supplemental="+o.supplemental:""}`),delete t.audiovideo}l&&(this.log(`Init audiovideo buffer, container:${l.container}, codecs[level/parsed]=[${e.codecs}/${l.codec}]`),delete t.video,delete t.audio);const u=Object.keys(t);if(u.length){if(this.hls.trigger(R.BUFFER_CODECS,t),!this.hls)return;u.forEach(d=>{const p=t[d].initSegment;p!=null&&p.byteLength&&this.hls.trigger(R.BUFFER_APPENDING,{type:d,data:p,frag:n,part:null,chunkMeta:i,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,ye.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,n=e==null?void 0:e[t];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=te.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(Fe.isBuffered(e,n)?t=this.getAppendedFrag(n):Fe.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const i=this.fragPlaying,r=t.level;(!i||t.sn!==i.sn||i.level!==r)&&(this.fragPlaying=t,this.hls.trigger(R.FRAG_CHANGED,{frag:t}),(!i||i.level!==r)&&this.hls.trigger(R.LEVEL_SWITCHED,{level:r}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return pe(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(pe(t)){const n=this.getLevelDetails(),i=this.currentFrag||(n?kr(null,n.fragments,t):null);if(i){const r=i.programDateTime;if(r!==null){const o=r+(t-i.start)*1e3;return new Date(o)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Lj extends Wn{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyIdToKeyInfo){const i=this.keyIdToKeyInfo[n].loader;if(i){var t;if(e&&e!==((t=i.context)==null?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=H.KEY_LOAD_ERROR,n,i,r){return new Ks({type:Re.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:r,error:n,networkDetails:i})}loadClear(e,t,n){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let i=0,r=t.length;i<r;i++){const o=t[i];if(e.cc<=o.cc&&(!Tt(e)||!Tt(o)||e.sn<o.sn)||!n&&i==r-1)return this.emeController.selectKeySystemFormat(o).then(l=>{if(!this.emeController)return;o.setKeyFormat(l);const u=Pu(l);if(u)return this.emeController.getKeySystemAccess([u])})}if(this.config.requireKeySystemAccessOnStart){const i=Qa(this.config);if(i.length)return this.emeController.getKeySystemAccess(i)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,i;t&&e.setKeyFormat(t);const r=e.decryptdata;if(!r){const d=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,H.KEY_LOAD_ERROR,d))}const o=r.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,H.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));const l=yp(r);let u=this.keyIdToKeyInfo[l];if((n=u)!=null&&n.decryptdata.key)return r.key=u.decryptdata.key,Promise.resolve({frag:e,keyInfo:u});if(this.emeController&&(i=u)!=null&&i.keyLoadPromise)switch(this.emeController.getKeyStatus(u.decryptdata)){case"usable":case"usable-in-future":return u.keyLoadPromise.then(h=>{const{keyInfo:p}=h;return r.key=p.decryptdata.key,{frag:e,keyInfo:p}})}switch(this.log(`${this.keyIdToKeyInfo[l]?"Rel":"L"}oading${r.keyId?" keyId: "+Ht(r.keyId):""} URI: ${r.uri} from ${e.type} ${e.level}`),u=this.keyIdToKeyInfo[l]={decryptdata:r,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},r.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return r.keyFormat==="identity"?this.loadKeyHTTP(u,e):this.loadKeyEME(u,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(u,e);default:return Promise.reject(this.createKeyLoadError(e,H.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${r.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var i;if(!e.decryptdata.keyId&&(i=t.initSegment)!=null&&i.data){const o=zU(t.initSegment.data);if(o.length){let l=o[0];l.some(u=>u!==0)?(this.log(`Using keyId found in init segment ${Ht(l)}`),Bi.setKeyIdForUri(e.decryptdata.uri,l)):(l=Bi.addKeyIdForUri(e.decryptdata.uri),this.log(`Generating keyId to patch media ${Ht(l)}`)),e.decryptdata.keyId=l}}if(!e.decryptdata.keyId&&!Tt(t))return Promise.resolve(n);const r=this.emeController.loadKey(n);return(e.keyLoadPromise=r.then(o=>(e.mediaKeySessionContext=o,n))).catch(o=>{throw e.keyLoadPromise=null,"data"in o&&(o.data.frag=t),o})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,i=n.loader,r=new i(n);return t.keyLoader=e.loader=r,e.keyLoadPromise=new Promise((o,l)=>{const u={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},d=n.keyLoadPolicy.default,h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(m,v,y,S)=>{const{frag:x,keyInfo:b}=y,w=yp(b.decryptdata);if(!x.decryptdata||b!==this.keyIdToKeyInfo[w])return l(this.createKeyLoadError(x,H.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),S));b.decryptdata.key=x.decryptdata.key=new Uint8Array(m.data),x.keyLoader=null,b.loader=null,o({frag:x,keyInfo:b})},onError:(m,v,y,S)=>{this.resetLoader(v),l(this.createKeyLoadError(t,H.KEY_LOAD_ERROR,new Error(`HTTP Error ${m.code} loading key ${m.text}`),y,Ze({url:u.url,data:void 0},m)))},onTimeout:(m,v,y)=>{this.resetLoader(v),l(this.createKeyLoadError(t,H.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),y))},onAbort:(m,v,y)=>{this.resetLoader(v),l(this.createKeyLoadError(t,H.INTERNAL_ABORTED,new Error("key loading aborted"),y))}};r.load(u,h,p)})}resetLoader(e){const{frag:t,keyInfo:n,url:i}=e,r=n.loader;t.keyLoader===r&&(t.keyLoader=null,n.loader=null);const o=yp(n.decryptdata)||i;delete this.keyIdToKeyInfo[o],r&&r.destroy()}}function yp(s){if(s.keyFormat!==Wt.FAIRPLAY){const e=s.keyId;if(e)return Ht(e)}return s.uri}function BT(s){const{type:e}=s;switch(e){case Ge.AUDIO_TRACK:return ye.AUDIO;case Ge.SUBTITLE_TRACK:return ye.SUBTITLE;default:return ye.MAIN}}function vp(s,e){let t=s.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class Ij{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(R.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_LOADING,this.onLevelLoading,this),e.off(R.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(R.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,i=t.loader,r=n||i,o=new r(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ge.MANIFEST,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:n,level:i,pathwayId:r,url:o,deliveryDirectives:l,levelInfo:u}=t;this.load({id:n,level:i,pathwayId:r,responseType:"text",type:Ge.LEVEL,url:o,deliveryDirectives:l,levelOrTrack:u})}onAudioTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:o,track:l}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Ge.AUDIO_TRACK,url:r,deliveryDirectives:o,levelOrTrack:l})}onSubtitleTrackLoading(e,t){const{id:n,groupId:i,url:r,deliveryDirectives:o,track:l}=t;this.load({id:n,groupId:i,level:null,responseType:"text",type:Ge.SUBTITLE_TRACK,url:r,deliveryDirectives:o,levelOrTrack:l})}onLevelsUpdated(e,t){const n=this.loaders[Ge.LEVEL];if(n){const i=n.context;i&&!t.levels.some(r=>r===i.levelOrTrack)&&(n.abort(),delete this.loaders[Ge.LEVEL])}}load(e){var t;const n=this.hls.config;let i=this.getInternalLoader(e);if(i){const d=this.hls.logger,h=i.context;if(h&&h.levelOrTrack===e.levelOrTrack&&(h.url===e.url||h.deliveryDirectives&&!e.deliveryDirectives)){h.url===e.url?d.log(`[playlist-loader]: ignore ${e.url} ongoing request`):d.log(`[playlist-loader]: ignore ${e.url} in favor of ${h.url}`);return}d.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),i.abort()}let r;if(e.type===Ge.MANIFEST?r=n.manifestLoadPolicy.default:r=tt({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),pe((t=e.deliveryDirectives)==null?void 0:t.part)){let d;if(e.type===Ge.LEVEL&&e.level!==null?d=this.hls.levels[e.level].details:e.type===Ge.AUDIO_TRACK&&e.id!==null?d=this.hls.audioTracks[e.id].details:e.type===Ge.SUBTITLE_TRACK&&e.id!==null&&(d=this.hls.subtitleTracks[e.id].details),d){const h=d.partTarget,p=d.targetduration;if(h&&p){const m=Math.max(h*3,p*.8)*1e3;r=tt({},r,{maxTimeToFirstByteMs:Math.min(m,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(m,r.maxTimeToFirstByteMs)})}}}const o=r.errorRetry||r.timeoutRetry||{},l={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},u={onSuccess:(d,h,p,m)=>{const v=this.getInternalLoader(p);this.resetInternalLoader(p.type);const y=d.data;h.parsing.start=performance.now(),ws.isMediaPlaylist(y)||p.type!==Ge.MANIFEST?this.handleTrackOrLevelPlaylist(d,h,p,m||null,v):this.handleMasterPlaylist(d,h,p,m)},onError:(d,h,p,m)=>{this.handleNetworkError(h,p,!1,d,m)},onTimeout:(d,h,p)=>{this.handleNetworkError(h,p,!0,void 0,d)}};i.load(e,l,u)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,n,i){const r=this.hls,o=e.data,l=vp(e,n),u=ws.parseMasterPlaylist(o,l);if(u.playlistParsingError){t.parsing.end=performance.now(),this.handleManifestParsingError(e,n,u.playlistParsingError,i,t);return}const{contentSteering:d,levels:h,sessionData:p,sessionKeys:m,startTimeOffset:v,variableList:y}=u;this.variableList=y,h.forEach(w=>{const{unknownCodecs:L}=w;if(L){const{preferManagedMediaSource:I}=this.hls.config;let{audioCodec:k,videoCodec:M}=w;for(let P=L.length;P--;){const C=L[P];pl(C,"audio",I)?(w.audioCodec=k=k?`${k},${C}`:C,jo.audio[k.substring(0,4)]=2,L.splice(P,1)):pl(C,"video",I)&&(w.videoCodec=M=M?`${M},${C}`:C,jo.video[M.substring(0,4)]=2,L.splice(P,1))}}});const{AUDIO:S=[],SUBTITLES:x,"CLOSED-CAPTIONS":b}=ws.parseMasterPlaylistMedia(o,l,u);S.length&&!S.some(L=>!L.url)&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),S.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new ht({}),bitrate:0,url:""})),r.trigger(R.MANIFEST_LOADED,{levels:h,audioTracks:S,subtitles:x,captions:b,contentSteering:d,url:l,stats:t,networkDetails:i,sessionData:p,sessionKeys:m,startTimeOffset:v,variableList:y})}handleTrackOrLevelPlaylist(e,t,n,i,r){const o=this.hls,{id:l,level:u,type:d}=n,h=vp(e,n),p=pe(u)?u:pe(l)?l:0,m=BT(n),v=ws.parseLevelPlaylist(e.data,h,p,m,0,this.variableList);if(d===Ge.MANIFEST){const y={attrs:new ht({}),bitrate:0,details:v,name:"",url:h};v.requestScheduled=t.loading.start+Ow(v,0),o.trigger(R.MANIFEST_LOADED,{levels:[y],audioTracks:[],url:h,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=v,this.handlePlaylistLoaded(v,e,t,n,i,r)}handleManifestParsingError(e,t,n,i,r){this.hls.trigger(R.ERROR,{type:Re.NETWORK_ERROR,details:H.MANIFEST_PARSING_ERROR,fatal:t.type===Ge.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:i,stats:r})}handleNetworkError(e,t,n=!1,i,r){let o=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===Ge.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===Ge.AUDIO_TRACK||e.type===Ge.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const l=new Error(o);this.hls.logger.warn(`[playlist-loader]: ${o}`);let u=H.UNKNOWN,d=!1;const h=this.getInternalLoader(e);switch(e.type){case Ge.MANIFEST:u=n?H.MANIFEST_LOAD_TIMEOUT:H.MANIFEST_LOAD_ERROR,d=!0;break;case Ge.LEVEL:u=n?H.LEVEL_LOAD_TIMEOUT:H.LEVEL_LOAD_ERROR,d=!1;break;case Ge.AUDIO_TRACK:u=n?H.AUDIO_TRACK_LOAD_TIMEOUT:H.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case Ge.SUBTITLE_TRACK:u=n?H.SUBTITLE_TRACK_LOAD_TIMEOUT:H.SUBTITLE_LOAD_ERROR,d=!1;break}h&&this.resetInternalLoader(e.type);const p={type:Re.NETWORK_ERROR,details:u,fatal:d,url:e.url,loader:h,context:e,error:l,networkDetails:t,stats:r};if(i){const m=(t==null?void 0:t.url)||e.url;p.response=Ze({url:m,data:void 0},i)}this.hls.trigger(R.ERROR,p)}handlePlaylistLoaded(e,t,n,i,r,o){const l=this.hls,{type:u,level:d,levelOrTrack:h,id:p,groupId:m,deliveryDirectives:v}=i,y=vp(t,i),S=BT(i);let x=typeof i.level=="number"&&S===ye.MAIN?d:void 0;const b=e.playlistParsingError;if(b){if(this.hls.logger.warn(`${b} ${e.url}`),!l.config.ignorePlaylistParsingErrors){l.trigger(R.ERROR,{type:Re.NETWORK_ERROR,details:H.LEVEL_PARSING_ERROR,fatal:!1,url:y,error:b,reason:b.message,response:t,context:i,level:x,parent:S,networkDetails:r,stats:n});return}e.playlistParsingError=null}if(!e.fragments.length){const w=e.playlistParsingError=new Error("No Segments found in Playlist");l.trigger(R.ERROR,{type:Re.NETWORK_ERROR,details:H.LEVEL_EMPTY_ERROR,fatal:!1,url:y,error:w,reason:w.message,response:t,context:i,level:x,parent:S,networkDetails:r,stats:n});return}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),u){case Ge.MANIFEST:case Ge.LEVEL:if(x){if(!h)x=0;else if(h!==l.levels[x]){const w=l.levels.indexOf(h);w>-1&&(x=w)}}l.trigger(R.LEVEL_LOADED,{details:e,levelInfo:h||l.levels[0],level:x||0,id:p||0,stats:n,networkDetails:r,deliveryDirectives:v,withoutMultiVariant:u===Ge.MANIFEST});break;case Ge.AUDIO_TRACK:l.trigger(R.AUDIO_TRACK_LOADED,{details:e,track:h,id:p||0,groupId:m||"",stats:n,networkDetails:r,deliveryDirectives:v});break;case Ge.SUBTITLE_TRACK:l.trigger(R.SUBTITLE_TRACK_LOADED,{details:e,track:h,id:p||0,groupId:m||"",stats:n,networkDetails:r,deliveryDirectives:v});break}}}class Zt{static get version(){return yl}static isMSESupported(){return DR()}static isSupported(){return bj()}static getMediaSource(){return ji()}static get Events(){return R}static get MetadataSchema(){return Cn}static get ErrorTypes(){return Re}static get ErrorDetails(){return H}static get DefaultConfig(){return Zt.defaultConfig?Zt.defaultConfig:dj}static set DefaultConfig(e){Zt.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Hg,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=OU(e.debug||!1,"Hls instance",e.assetPlayerId),n=this.config=fj(Zt.DefaultConfig,e,t);this.userConfig=e,n.progressive&&pj(n,t);const{abrController:i,bufferController:r,capLevelController:o,errorController:l,fpsController:u}=n,d=new l(this),h=this.abrController=new i(this),p=new _$(this),m=n.interstitialsController,v=m?this.interstitialsController=new m(this,Zt):null,y=this.bufferController=new r(this,p),S=this.capLevelController=new o(this),x=new u(this),b=new Ij(this),w=n.contentSteeringController,L=w?new w(this):null,I=this.levelController=new Tj(this,L),k=new Sj(this),M=new Lj(this.config,this.logger),P=this.streamController=new Rj(this,p,M),C=this.gapController=new vj(this,p);S.setStreamController(P),x.setStreamController(P);const U=[b,I,P];v&&U.splice(1,0,v),L&&U.splice(1,0,L),this.networkControllers=U;const O=[h,y,C,S,x,k,p];this.audioTrackController=this.createController(n.audioTrackController,U);const W=n.audioStreamController;W&&U.push(this.audioStreamController=new W(this,p,M)),this.subtitleTrackController=this.createController(n.subtitleTrackController,U);const ne=n.subtitleStreamController;ne&&U.push(this.subtititleStreamController=new ne(this,p,M)),this.createController(n.timelineController,O),M.emeController=this.emeController=this.createController(n.emeController,O),this.cmcdController=this.createController(n.cmcdController,O),this.latencyController=this.createController(Ej,O),this.coreComponents=O,U.push(d);const oe=d.onErrorOut;typeof oe=="function"&&this.on(R.ERROR,oe,d),this.on(R.MANIFEST_LOADED,b.onManifestLoaded,b)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,i){this._emitter.off(e,t,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const i=e===R.ERROR;this.trigger(R.ERROR,{type:Re.OTHER_ERROR,details:H.INTERNAL_EXCEPTION,fatal:i,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(R.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const r=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(R.ERROR,{type:Re.OTHER_ERROR,details:H.ATTACH_MEDIA_ERROR,fatal:!0,error:r});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,n=t?e.media:e,i=t?e:{media:n};this._media=n,this.trigger(R.MEDIA_ATTACHING,i)}detachMedia(){this.logger.log("detachMedia"),this.trigger(R.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(R.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,n=this._url,i=this._url=Og.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${i}`),t&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(R.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length&&(this.networkControllers[n].startLoad(e,t),!(!this.started||!this.networkControllers));n++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[ye.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[ye.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[ye.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=v5()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){f$(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let i;if(t===-1&&e!=null&&e.length?i=e.length-1:i=t,n)for(let r=i;r--;){const o=e[r].attrs["HDCP-LEVEL"];if(o&&o<=n)return r}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const n=xw(t);return yw(e,n,navigator.mediaCapabilities)}}Zt.defaultConfig=void 0;function _j({channel:s,onClose:e,onToggleFavorite:t,isFavorite:n}){const i=B.useRef(null),r=B.useRef(null),o=B.useRef(null),l=B.useRef(null),u=B.useRef(null),d=B.useRef(null),[h,p]=B.useState(!1),[m,v]=B.useState(1),[y,S]=B.useState(!1),[x,b]=B.useState(!1),[w,L]=B.useState(!1),[I,k]=B.useState(!0),[M,P]=B.useState(!0),[C,U]=B.useState(null),[O,W]=B.useState(1),[ne,oe]=B.useState(!1),[se,re]=B.useState(!1),[X,Z]=B.useState(0),[F,ee]=B.useState(null),J=B.useRef(null),D=3;B.useEffect(()=>!(s!=null&&s.url)||!i.current?void 0:((()=>{P(!0),U(null),d.current&&d.current.destroy();const We=i.current;if(Zt.isSupported()){const Bt=new Zt({enableWorker:!0,lowLatencyMode:!0,backBufferLength:90});d.current=Bt,Bt.on(Zt.Events.MEDIA_ATTACHED,()=>{Bt.loadSource(s.url)}),Bt.on(Zt.Events.MANIFEST_PARSED,()=>{We.play().catch(()=>p(!1)),P(!1),Z(0)}),Bt.on(Zt.Events.ERROR,(Ki,Ue)=>{Ue.fatal&&(console.error("HLS error:",Ue),X<D?j():(U("Stream unavailable. Please try another channel."),P(!1)))}),Bt.attachMedia(We)}else We.canPlayType("application/vnd.apple.mpegurl")?(We.src=s.url,We.addEventListener("loadedmetadata",()=>{We.play().catch(()=>p(!1)),P(!1)})):(We.src=s.url,We.addEventListener("loadedmetadata",()=>{We.play().catch(()=>p(!1)),P(!1)}))})(),()=>{d.current&&d.current.destroy()}),[s==null?void 0:s.url]);const j=B.useCallback(()=>{re(!0),Z(xe=>xe+1),setTimeout(()=>{d.current&&d.current.destroy();const xe=i.current;if(xe&&Zt.isSupported()){const We=new Zt;d.current=We,We.attachMedia(xe),We.loadSource(s.url)}else xe&&(xe.src=s.url,xe.load());re(!1)},2e3)},[s==null?void 0:s.url]);B.useEffect(()=>{const xe=i.current;if(!xe)return;const We=()=>p(!0),Bt=()=>p(!1),Ki=()=>P(!0),Ue=()=>P(!1);return xe.addEventListener("play",We),xe.addEventListener("pause",Bt),xe.addEventListener("waiting",Ki),xe.addEventListener("canplay",Ue),()=>{xe.removeEventListener("play",We),xe.removeEventListener("pause",Bt),xe.removeEventListener("waiting",Ki),xe.removeEventListener("canplay",Ue)}},[]),B.useEffect(()=>{const xe=i.current;if(!(!xe||o.current)){try{const We=window.AudioContext||window.webkitAudioContext;o.current=new We,l.current=o.current.createGain(),u.current=o.current.createMediaElementSource(xe),u.current.connect(l.current),l.current.connect(o.current.destination)}catch{console.log("Web Audio API not available")}return()=>{o.current&&o.current.close().catch(()=>{})}}},[]),B.useEffect(()=>{l.current&&(l.current.gain.value=O)},[O]);const ie=B.useCallback(()=>{J.current&&clearTimeout(J.current),k(!0),J.current=setTimeout(()=>{h&&!ne&&k(!1)},3e3)},[h,ne]),ce=()=>{if(w)return;const xe=i.current;xe.paused?xe.play():xe.pause()},de=xe=>{const We=i.current;We.volume=xe,v(xe),S(xe===0)},fe=()=>{const xe=i.current;y?(xe.volume=m||1,S(!1)):(xe.volume=0,S(!0))},ve=()=>{var xe;document.fullscreenElement?(document.exitFullscreen(),b(!1)):((xe=r.current)==null||xe.requestFullscreen(),b(!0))},Ie=()=>{if(!w)return;const xe=setTimeout(()=>{L(!1),localStorage.setItem("iptv_player_locked","false")},1500);ee(xe)},Me=()=>{F&&(clearTimeout(F),ee(null))},Qe=()=>{const xe=!w;L(xe),localStorage.setItem("iptv_player_locked",String(xe)),xe&&k(!1)},Lt=()=>{Z(0),U(null),P(!0),d.current&&d.current.destroy();const xe=i.current;if(xe&&Zt.isSupported()){const We=new Zt;d.current=We,We.attachMedia(xe),We.loadSource(s.url)}else xe&&(xe.src=s.url,xe.load())};return A.jsx("div",{ref:r,className:"relative w-full rounded-2xl overflow-hidden bg-black",onMouseMove:ie,onTouchStart:ie,children:A.jsxs("div",{className:"relative aspect-video",children:[A.jsx("video",{ref:i,className:"w-full h-full object-contain bg-black",playsInline:!0,onClick:w?void 0:ce,crossOrigin:"anonymous"}),A.jsx(tn,{children:(M||se)&&A.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/80 flex flex-col items-center justify-center",children:[A.jsx(Ee.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:A.jsx(i1,{className:"w-12 h-12 text-cyan-400"})}),A.jsx("p",{className:"mt-4 text-cyan-400 font-medium",children:se?`Reconnecting... (${X}/${D})`:"Loading stream..."})]})}),A.jsx(tn,{children:C&&A.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/90 flex flex-col items-center justify-center",children:[A.jsx(n1,{className:"w-16 h-16 text-red-400 mb-4"}),A.jsx("p",{className:"text-white font-medium mb-2",children:"Stream Error"}),A.jsx("p",{className:"text-gray-400 text-sm mb-6 text-center px-4",children:C}),A.jsxs("button",{onClick:Lt,className:"px-6 py-3 bg-cyan-500/20 border border-cyan-500/50 rounded-lg text-cyan-400 font-medium flex items-center gap-2 hover:bg-cyan-500/30 transition-colors",children:[A.jsx(sx,{className:"w-4 h-4"}),"Retry"]})]})}),A.jsx(tn,{children:w&&A.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 flex items-center justify-center",onTouchStart:Ie,onTouchEnd:Me,onMouseDown:Ie,onMouseUp:Me,onMouseLeave:Me,children:[A.jsx(Ee.div,{initial:{scale:0},animate:{scale:1},className:"p-4 rounded-full bg-black/50 backdrop-blur-sm",children:A.jsx(nx,{className:"w-8 h-8 text-white/50"})}),A.jsx("p",{className:"absolute bottom-20 text-white/50 text-sm",children:"Long press to unlock"})]})}),A.jsx(tn,{children:I&&!w&&!C&&A.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-black/50",children:[A.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 flex items-center justify-between",children:[A.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-white/80 hover:text-white transition-colors",children:[A.jsx(l_,{className:"w-6 h-6"}),A.jsx("span",{className:"font-medium",children:"Back"})]}),A.jsx("div",{className:"flex items-center gap-4",children:A.jsx("button",{onClick:t,className:`p-2 rounded-full transition-colors ${n?"text-yellow-400 bg-yellow-400/20":"text-white/80 hover:text-white"}`,children:A.jsx(od,{className:"w-5 h-5",fill:n?"currentColor":"none"})})})]}),A.jsx("div",{className:"absolute top-16 left-4 right-4",children:A.jsxs("div",{className:"flex items-center gap-3",children:[s.logo&&A.jsx("img",{src:s.logo,alt:s.name,className:"w-12 h-12 rounded-lg object-contain bg-white/10 p-1"}),A.jsxs("div",{children:[A.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.name,s.country&&A.jsx("span",{className:"text-lg",children:Js(s.country)})]}),A.jsx("p",{className:"text-sm text-white/60",children:s.group})]})]})}),A.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:!h&&!M&&A.jsx(Ee.button,{initial:{scale:0},animate:{scale:1},whileTap:{scale:.9},onClick:ce,className:"w-20 h-20 rounded-full bg-cyan-500/80 flex items-center justify-center shadow-[0_0_40px_rgba(0,245,255,0.5)] pointer-events-auto",children:A.jsx(Sp,{className:"w-10 h-10 text-white ml-1",fill:"white"})})}),A.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 space-y-4",children:A.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[A.jsxs("div",{className:"flex items-center gap-2 lg:gap-3",children:[A.jsx("button",{onClick:ce,className:"p-2 lg:p-3 rounded-full bg-white/10 hover:bg-white/20 transition-colors",children:h?A.jsx(X_,{className:"w-5 h-5 lg:w-6 lg:h-6 text-white"}):A.jsx(Sp,{className:"w-5 h-5 lg:w-6 lg:h-6 text-white ml-0.5"})}),A.jsxs("div",{className:"flex items-center gap-2 group",children:[A.jsx("button",{onClick:fe,className:"p-2 lg:p-3 rounded-full bg-white/10 hover:bg-white/20 transition-colors",children:y?A.jsx(wk,{className:"w-4 h-4 lg:w-5 lg:h-5 text-white"}):m>.5?A.jsx(bk,{className:"w-4 h-4 lg:w-5 lg:h-5 text-white"}):A.jsx(Ek,{className:"w-4 h-4 lg:w-5 lg:h-5 text-white"})}),A.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:y?0:m,onChange:xe=>de(parseFloat(xe.target.value)),className:"w-16 lg:w-20 opacity-0 group-hover:opacity-100 transition-opacity accent-cyan-400 hidden sm:block"})]}),A.jsxs("button",{onClick:()=>W(xe=>xe>=2?1:xe+.5),className:`px-2 py-1.5 lg:px-3 lg:py-2 rounded-lg font-medium text-xs lg:text-sm flex items-center gap-1 transition-colors ${O>1?"bg-cyan-500/30 text-cyan-400 border border-cyan-500/50":"bg-white/10 text-white/80 hover:bg-white/20"}`,children:[A.jsx(ol,{className:"w-3 h-3 lg:w-4 lg:h-4"}),O*100,"%"]})]}),A.jsxs("div",{className:"flex items-center gap-1 lg:gap-2",children:[A.jsx("button",{onClick:Lt,className:"p-2 lg:p-3 rounded-full bg-white/10 hover:bg-white/20 transition-colors",children:A.jsx(sx,{className:"w-4 h-4 lg:w-5 lg:h-5 text-white"})}),A.jsx("button",{onClick:Qe,className:"p-2 lg:p-3 rounded-full bg-white/10 hover:bg-white/20 transition-colors",children:w?A.jsx(nx,{className:"w-4 h-4 lg:w-5 lg:h-5 text-white"}):A.jsx(D_,{className:"w-4 h-4 lg:w-5 lg:h-5 text-white"})}),A.jsx("button",{onClick:()=>oe(!ne),className:`p-2 lg:p-3 rounded-full transition-colors ${ne?"bg-cyan-500/30 text-cyan-400":"bg-white/10 hover:bg-white/20 text-white"}`,children:A.jsx(o1,{className:"w-4 h-4 lg:w-5 lg:h-5"})}),A.jsx("button",{onClick:ve,className:"p-2 lg:p-3 rounded-full bg-white/10 hover:bg-white/20 transition-colors",children:x?A.jsx(U_,{className:"w-4 h-4 lg:w-5 lg:h-5 text-white"}):A.jsx(F_,{className:"w-4 h-4 lg:w-5 lg:h-5 text-white"})})]})]})}),A.jsx(tn,{children:ne&&A.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"absolute bottom-20 lg:bottom-24 right-4 w-56 lg:w-64 bg-black/95 backdrop-blur-xl rounded-xl border border-white/10 overflow-hidden",children:[A.jsxs("div",{className:"p-3 lg:p-4 border-b border-white/10 flex items-center justify-between",children:[A.jsx("span",{className:"font-medium text-white text-sm lg:text-base",children:"Settings"}),A.jsx("button",{onClick:()=>oe(!1),children:A.jsx(ad,{className:"w-4 h-4 text-gray-400"})})]}),A.jsx("div",{className:"p-3 lg:p-4 space-y-4",children:A.jsxs("div",{children:[A.jsx("label",{className:"text-xs lg:text-sm text-gray-400 block mb-2",children:"Sound Boost"}),A.jsx("div",{className:"flex gap-2",children:[1,1.5,2].map(xe=>A.jsxs("button",{onClick:()=>W(xe),className:`flex-1 py-1.5 lg:py-2 rounded-lg text-xs lg:text-sm font-medium transition-colors ${O===xe?"bg-cyan-500 text-white":"bg-white/10 text-white/70 hover:bg-white/20"}`,children:[xe*100,"%"]},xe))})]})})]})})]})})]})})}function kj({channel:s,epgData:e}){const[t,n]=B.useState(null),[i,r]=B.useState([]),[o,l]=B.useState(0);return B.useEffect(()=>{if(!e||e.length===0){const p=new Date,m=[];for(let v=0;v<6;v++){const y=new Date(p.getTime()+(v-1)*2*60*60*1e3),S=new Date(y.getTime()+7200*1e3);m.push({title:v===0?"Live Broadcast":`Upcoming Show ${v}`,description:"Program information not available",start:y,end:S,isMock:!0})}n(m[0]),r(m.slice(1,5));return}const u=new Date,d=e.find(p=>new Date(p.start)<=u&&new Date(p.end)>u),h=e.filter(p=>new Date(p.start)>u).slice(0,4);n(d),r(h)},[e]),B.useEffect(()=>{if(!t)return;const u=()=>{const h=new Date().getTime(),p=new Date(t.start).getTime(),v=new Date(t.end).getTime()-p,y=h-p;l(Math.min(100,Math.max(0,y/v*100)))};u();const d=setInterval(u,3e4);return()=>clearInterval(d)},[t]),A.jsxs("div",{className:"mt-6 space-y-4",children:[A.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative rounded-xl overflow-hidden",children:[A.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500/10 to-purple-500/10"}),A.jsxs("div",{className:"relative p-5 border border-cyan-500/20 rounded-xl backdrop-blur-sm",children:[A.jsxs("div",{className:"flex items-start justify-between mb-4",children:[A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsxs("div",{className:"relative",children:[A.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),A.jsx("div",{className:"absolute inset-0 w-3 h-3 bg-red-500 rounded-full animate-ping"})]}),A.jsx("span",{className:"text-sm font-medium text-red-400 uppercase tracking-wide",children:"Live Now"})]}),A.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[A.jsx(s1,{className:"w-4 h-4"}),A.jsx("span",{children:t?`${qf(t.start)} - ${qf(t.end)}`:"--:-- - --:--"})]})]}),A.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:(t==null?void 0:t.title)||"Live Broadcast"}),(t==null?void 0:t.description)&&!(t!=null&&t.isMock)&&A.jsx("p",{className:"text-gray-400 text-sm mb-4 line-clamp-2",children:t.description}),(t==null?void 0:t.isMock)&&A.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-sm mb-4",children:[A.jsx(I_,{className:"w-4 h-4"}),A.jsx("span",{children:"Schedule not available for this channel"})]}),A.jsxs("div",{className:"relative h-2 bg-gray-800 rounded-full overflow-hidden",children:[A.jsx(Ee.div,{className:"absolute h-full bg-gradient-to-r from-cyan-500 to-purple-500 rounded-full",initial:{width:0},animate:{width:`${o}%`},transition:{duration:.5}}),A.jsx("div",{className:"absolute h-full w-1 bg-white rounded-full shadow-[0_0_10px_rgba(255,255,255,0.8)]",style:{left:`${o}%`,transform:"translateX(-50%)"}})]}),A.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:[A.jsxs("span",{children:[Math.round(o),"% completed"]}),A.jsx("span",{children:t?`${Math.round((100-o)/100*120)} min remaining`:""})]})]})]}),i.length>0&&A.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"space-y-3",children:[A.jsxs("h4",{className:"text-sm font-semibold text-gray-400 uppercase tracking-wide flex items-center gap-2",children:[A.jsx(Mm,{className:"w-4 h-4 text-cyan-400"}),"Up Next"]}),A.jsx("div",{className:"grid gap-2",children:i.map((u,d)=>A.jsxs(Ee.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*(d+1)},className:"flex items-center gap-4 p-3 rounded-lg bg-white/5 border border-white/5 hover:border-cyan-500/30 transition-colors group",children:[A.jsx("div",{className:"flex-shrink-0 w-20 text-center",children:A.jsx("span",{className:"text-sm font-medium text-cyan-400",children:qf(u.start)})}),A.jsxs("div",{className:"flex-1 min-w-0",children:[A.jsx("h5",{className:"text-sm font-medium text-white truncate group-hover:text-cyan-400 transition-colors",children:u.title}),u.description&&!u.isMock&&A.jsx("p",{className:"text-xs text-gray-500 truncate",children:u.description})]}),A.jsx("div",{className:"flex-shrink-0",children:A.jsx(r1,{className:"w-4 h-4 text-gray-600"})})]},d))})]})]})}function Cj({channels:s,onSelect:e,onClose:t}){const[n,i]=B.useState(""),[r,o]=B.useState([]),[l,u]=B.useState([]),d=B.useRef(null);B.useEffect(()=>{var v;(v=d.current)==null||v.focus();const m=localStorage.getItem("iptv_recent_searches");m&&u(JSON.parse(m))},[]),B.useEffect(()=>{if(!n.trim()){o([]);return}const m=n.toLowerCase(),v=s.filter(y=>{var S,x;return y.name.toLowerCase().includes(m)||((S=y.group)==null?void 0:S.toLowerCase().includes(m))||((x=y.tvgName)==null?void 0:x.toLowerCase().includes(m))}).slice(0,20);o(v)},[n,s]);const h=m=>{const v=[m.name,...l.filter(y=>y!==m.name)].slice(0,5);u(v),localStorage.setItem("iptv_recent_searches",JSON.stringify(v)),e(m)},p=m=>{m.key==="Escape"&&t()};return A.jsx(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/95 backdrop-blur-xl",onClick:t,children:A.jsxs(Ee.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},className:"max-w-2xl mx-auto pt-20 px-4",onClick:m=>m.stopPropagation(),children:[A.jsxs("div",{className:"relative mb-8",children:[A.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500/20 to-purple-500/20 rounded-2xl blur-xl"}),A.jsxs("div",{className:"relative flex items-center bg-[#12121a] border border-cyan-500/30 rounded-2xl overflow-hidden shadow-[0_0_30px_rgba(0,245,255,0.1)]",children:[A.jsx(Ep,{className:"w-6 h-6 text-cyan-400 ml-5"}),A.jsx("input",{ref:d,type:"text",value:n,onChange:m=>i(m.target.value),onKeyDown:p,placeholder:"Search channels, categories...",className:"flex-1 px-4 py-5 bg-transparent text-white text-lg outline-none placeholder-gray-500"}),n&&A.jsx("button",{onClick:()=>i(""),className:"p-2 mr-3 rounded-full hover:bg-white/10 transition-colors",children:A.jsx(ad,{className:"w-5 h-5 text-gray-400"})}),A.jsx("button",{onClick:t,className:"px-6 py-5 border-l border-white/10 text-gray-400 hover:text-white hover:bg-white/5 transition-colors",children:"ESC"})]})]}),r.length>0?A.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-2",children:[A.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:[r.length," channels found"]}),A.jsx("div",{className:"max-h-[60vh] overflow-y-auto space-y-2 pr-2 scrollbar-thin scrollbar-thumb-cyan-500/20 scrollbar-track-transparent",children:r.map((m,v)=>A.jsxs(Ee.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:v*.03},onClick:()=>h(m),className:"w-full flex items-center gap-4 p-4 rounded-xl bg-white/5 border border-transparent hover:border-cyan-500/30 hover:bg-white/10 transition-all group text-left",children:[m.logo?A.jsx("img",{src:m.logo,alt:m.name,className:"w-12 h-12 rounded-lg object-contain bg-black/50 p-1"}):A.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-cyan-500/20 to-purple-500/20 flex items-center justify-center",children:A.jsx(Cr,{className:"w-6 h-6 text-gray-500"})}),A.jsxs("div",{className:"flex-1 min-w-0",children:[A.jsx("h4",{className:"font-medium text-white truncate group-hover:text-cyan-400 transition-colors",children:m.name}),A.jsx("p",{className:"text-sm text-gray-500 truncate",children:m.group})]}),m.country&&A.jsx("span",{className:"text-xl flex-shrink-0",children:Js(m.country)})]},m.id))})]}):n?A.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[A.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-800 flex items-center justify-center",children:A.jsx(Ep,{className:"w-8 h-8 text-gray-600"})}),A.jsxs("p",{className:"text-gray-400",children:['No channels found for "',n,'"']})]}):A.jsxs("div",{className:"space-y-6",children:[l.length>0&&A.jsxs("div",{children:[A.jsxs("h3",{className:"text-sm font-medium text-gray-500 mb-3 flex items-center gap-2",children:[A.jsx(A_,{className:"w-4 h-4"}),"Recent Searches"]}),A.jsx("div",{className:"flex flex-wrap gap-2",children:l.map((m,v)=>A.jsx("button",{onClick:()=>i(m),className:"px-4 py-2 rounded-full bg-white/5 text-gray-300 hover:bg-white/10 hover:text-white transition-colors text-sm",children:m},v))})]}),A.jsxs("div",{children:[A.jsxs("h3",{className:"text-sm font-medium text-gray-500 mb-3 flex items-center gap-2",children:[A.jsx(a1,{className:"w-4 h-4"}),"Popular Categories"]}),A.jsx("div",{className:"flex flex-wrap gap-2",children:["Sports","News","Movies","Entertainment","Kids","Music"].map(m=>A.jsx("button",{onClick:()=>i(m),className:"px-4 py-2 rounded-full bg-gradient-to-r from-cyan-500/10 to-purple-500/10 border border-cyan-500/20 text-cyan-400 hover:bg-cyan-500/20 transition-colors text-sm",children:m},m))})]})]})]})})}function Pj({userCountry:s,setUserCountry:e,onClose:t}){const[n,i]=B.useState(""),[r,o]=B.useState(""),[l,u]=B.useState(!1),[d,h]=B.useState("dark"),[p,m]=B.useState(!1),[v,y]=B.useState(null);B.useEffect(()=>{const w=localStorage.getItem("iptv_custom_playlist"),L=localStorage.getItem("iptv_theme"),I=localStorage.getItem("iptv_performance_mode");w&&(i(w),o(w)),L&&h(L),I&&m(I==="true")},[]);const S=()=>{r&&r.endsWith(".m3u")?(localStorage.setItem("iptv_custom_playlist",r),i(r),y("success"),setTimeout(()=>y(null),2e3)):r?(y("error"),setTimeout(()=>y(null),2e3)):(localStorage.removeItem("iptv_custom_playlist"),i(""),y("success"),setTimeout(()=>y(null),2e3))},x=()=>{confirm("Are you sure you want to reset all data? This will clear favorites, recent channels, and settings.")&&(localStorage.removeItem("iptv_favorites"),localStorage.removeItem("iptv_recent"),localStorage.removeItem("iptv_custom_playlist"),localStorage.removeItem("iptv_recent_searches"),localStorage.removeItem("iptv_country"),window.location.reload())},b=["US","UK","IN","DE","FR","ES","IT","BR","MX","CA","AU","JP"];return A.jsx(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/80 backdrop-blur-xl flex items-center justify-center p-4",onClick:t,children:A.jsxs(Ee.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"w-full max-w-lg bg-[#0d0d15] border border-cyan-500/20 rounded-2xl overflow-hidden shadow-[0_0_50px_rgba(0,245,255,0.1)]",onClick:w=>w.stopPropagation(),children:[A.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-white/10",children:[A.jsx("h2",{className:"text-xl font-bold text-white",children:"Settings"}),A.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:A.jsx(ad,{className:"w-5 h-5 text-gray-400"})})]}),A.jsxs("div",{className:"p-5 space-y-6 max-h-[70vh] overflow-y-auto",children:[A.jsxs("div",{className:"space-y-3",children:[A.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-400",children:[A.jsx(Fm,{className:"w-4 h-4 text-cyan-400"}),"Your Location"]}),A.jsxs("button",{onClick:()=>u(!l),className:"w-full flex items-center justify-between p-4 rounded-xl bg-white/5 border border-white/10 hover:border-cyan-500/30 transition-colors",children:[A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsx("span",{className:"text-2xl",children:Js(s==null?void 0:s.code)}),A.jsx("span",{className:"text-white",children:(s==null?void 0:s.name)||"Select country"})]}),A.jsx("span",{className:"text-gray-500",children:"Change"})]}),l&&A.jsxs(Ee.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"space-y-2 pt-2",children:[A.jsx("p",{className:"text-xs text-gray-500",children:"Popular countries:"}),A.jsx("div",{className:"grid grid-cols-4 gap-2",children:b.map(w=>A.jsxs("button",{onClick:()=>{e({code:w,name:nw[w]}),u(!1)},className:`p-3 rounded-lg text-center transition-colors ${(s==null?void 0:s.code)===w?"bg-cyan-500/20 border border-cyan-500/50":"bg-white/5 border border-transparent hover:border-white/20"}`,children:[A.jsx("span",{className:"text-2xl block mb-1",children:Js(w)}),A.jsx("span",{className:"text-xs text-gray-400",children:w})]},w))})]})]}),A.jsxs("div",{className:"space-y-3",children:[A.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-400",children:[A.jsx(k_,{className:"w-4 h-4 text-cyan-400"}),"Custom M3U Playlist"]}),A.jsxs("div",{className:"space-y-2",children:[A.jsx("input",{type:"text",value:r,onChange:w=>o(w.target.value),placeholder:"https://example.com/playlist.m3u",className:"w-full px-4 py-3 rounded-xl bg-white/5 border border-white/10 text-white placeholder-gray-500 outline-none focus:border-cyan-500/50 transition-colors"}),A.jsxs("div",{className:"flex gap-2",children:[A.jsx("button",{onClick:S,className:`flex-1 py-3 rounded-xl font-medium transition-colors flex items-center justify-center gap-2 ${v==="success"?"bg-green-500/20 text-green-400 border border-green-500/50":v==="error"?"bg-red-500/20 text-red-400 border border-red-500/50":"bg-cyan-500/20 text-cyan-400 border border-cyan-500/50 hover:bg-cyan-500/30"}`,children:v==="success"?A.jsxs(A.Fragment,{children:[A.jsx(i_,{className:"w-4 h-4"}),"Saved"]}):v==="error"?A.jsxs(A.Fragment,{children:[A.jsx(n1,{className:"w-4 h-4"}),"Invalid URL"]}):"Save & Apply"}),n&&A.jsx("button",{onClick:()=>{o(""),localStorage.removeItem("iptv_custom_playlist"),i("")},className:"px-4 py-3 rounded-xl bg-white/5 text-gray-400 hover:text-white hover:bg-white/10 transition-colors",children:"Reset"})]}),A.jsx("p",{className:"text-xs text-gray-500",children:"Add a custom M3U playlist URL. Leave empty to use the default playlist."})]})]}),A.jsxs("div",{className:"space-y-3",children:[A.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-400",children:[A.jsx(Y_,{className:"w-4 h-4 text-cyan-400"}),"Theme"]}),A.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{id:"dark",icon:G_,label:"Dark"},{id:"light",icon:fk,label:"Light"},{id:"system",icon:j_,label:"System"}].map(w=>A.jsxs("button",{onClick:()=>{h(w.id),localStorage.setItem("iptv_theme",w.id)},className:`p-4 rounded-xl flex flex-col items-center gap-2 transition-colors ${d===w.id?"bg-cyan-500/20 border border-cyan-500/50 text-cyan-400":"bg-white/5 border border-transparent text-gray-400 hover:border-white/20"}`,children:[A.jsx(w.icon,{className:"w-5 h-5"}),A.jsx("span",{className:"text-sm",children:w.label})]},w.id))})]}),A.jsxs("div",{className:"space-y-3",children:[A.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-400",children:[A.jsx(ol,{className:"w-4 h-4 text-cyan-400"}),"Performance Mode"]}),A.jsxs("button",{onClick:()=>{const w=!p;m(w),localStorage.setItem("iptv_performance_mode",String(w))},className:`w-full p-4 rounded-xl flex items-center justify-between transition-colors ${p?"bg-cyan-500/20 border border-cyan-500/50":"bg-white/5 border border-white/10"}`,children:[A.jsxs("div",{children:[A.jsx("span",{className:p?"text-cyan-400":"text-white",children:p?"Enabled":"Disabled"}),A.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Reduces animations for better performance"})]}),A.jsx("div",{className:`w-12 h-6 rounded-full transition-colors ${p?"bg-cyan-500":"bg-gray-600"}`,children:A.jsx(Ee.div,{className:"w-6 h-6 rounded-full bg-white shadow-lg",animate:{x:p?24:0}})})]})]}),A.jsxs("div",{className:"pt-4 border-t border-white/10",children:[A.jsxs("button",{onClick:x,className:"w-full p-4 rounded-xl bg-red-500/10 border border-red-500/20 text-red-400 hover:bg-red-500/20 transition-colors flex items-center justify-center gap-2",children:[A.jsx(mk,{className:"w-5 h-5"}),"Reset All Data"]}),A.jsx("p",{className:"text-xs text-gray-500 text-center mt-2",children:"This will clear all saved data including favorites and settings"})]})]}),A.jsx("div",{className:"p-5 border-t border-white/10 bg-black/20",children:A.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-500 text-sm",children:[A.jsx(ol,{className:"w-4 h-4 text-cyan-400"}),A.jsx("span",{children:"StreamVerse v1.0"})]})})]})})}function Dj(){return A.jsxs("div",{className:"fixed inset-0 bg-[#0a0a0f] flex items-center justify-center",children:[A.jsxs("div",{className:"absolute inset-0",children:[A.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-900/20 via-transparent to-cyan-900/20"}),A.jsx(Ee.div,{className:"absolute top-1/3 left-1/4 w-96 h-96 bg-cyan-500/10 rounded-full blur-3xl",animate:{scale:[1,1.2,1],opacity:[.3,.5,.3]},transition:{duration:3,repeat:1/0}}),A.jsx(Ee.div,{className:"absolute bottom-1/3 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl",animate:{scale:[1.2,1,1.2],opacity:[.5,.3,.5]},transition:{duration:3,repeat:1/0}})]}),A.jsxs("div",{className:"relative z-10 text-center",children:[A.jsx("div",{className:"flex items-center justify-center gap-8 mb-8",children:[nk,Cr,r1].map((s,e)=>A.jsx(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:e*.2},children:A.jsx(Ee.div,{className:"p-4 rounded-xl bg-gradient-to-br from-cyan-500/20 to-purple-500/20 border border-cyan-500/30",animate:{y:[0,-10,0],boxShadow:["0 0 20px rgba(0, 245, 255, 0.2)","0 0 40px rgba(0, 245, 255, 0.4)","0 0 20px rgba(0, 245, 255, 0.2)"]},transition:{duration:2,repeat:1/0,delay:e*.3},children:A.jsx(s,{className:"w-8 h-8 text-cyan-400"})})},e))}),A.jsx(Ee.h2,{className:"text-2xl font-bold text-white mb-4",initial:{opacity:0},animate:{opacity:1},children:"Loading Channels"}),A.jsx("div",{className:"flex items-center justify-center gap-2",children:[0,1,2].map(s=>A.jsx(Ee.div,{className:"w-3 h-3 rounded-full bg-cyan-400",animate:{scale:[1,1.5,1],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:s*.2}},s))}),A.jsx(Ee.p,{className:"mt-6 text-gray-500 text-sm",animate:{opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0},children:"Fetching stream data from satellites..."})]})]})}function Oj({channels:s,onSelectChannel:e,userCountry:t,favorites:n,recentlyPlayed:i}){const[r,o]=B.useState([]),[l,u]=B.useState(!0);B.useEffect(()=>{d()},[s.length]);const d=async()=>{if(s.length){u(!0);try{const h=new Date().toISOString().split("T")[0],p=s.slice(0,50).map(S=>({name:S.name,category:S.category,country:S.country,group:S.group})),m={favoriteCategories:[...new Set(n.map(S=>S.category))],recentCategories:[...new Set(i.map(S=>S.category))],userCountry:t==null?void 0:t.code},y=(await pr.integrations.Core.InvokeLLM({prompt:`Today is ${h}. Analyze current events, trending topics, and the following IPTV channels to create 3-4 thematic channel grids.

Available channels sample: ${JSON.stringify(p,null,2)}

User preferences: ${JSON.stringify(m,null,2)}

Create themed grids based on:
1. Current major events (sports tournaments, holidays, cultural events happening NOW in ${h})
2. Trending topics and seasonal content
3. User's viewing preferences and location
4. Time-relevant content (e.g., morning news, primetime entertainment)

For each theme, provide:
- A catchy, event-specific title (e.g., " Champions League Finals", " Oscar Season Cinema", " Holiday Specials")
- A brief description explaining why this theme is relevant now
- Filter criteria to select matching channels (by category, keywords in name/group, country)

Return ONLY themes that are actually relevant to TODAY'S date and current events.`,add_context_from_internet:!0,response_json_schema:{type:"object",properties:{themes:{type:"array",items:{type:"object",properties:{title:{type:"string"},description:{type:"string"},icon:{type:"string"},filters:{type:"object",properties:{categories:{type:"array",items:{type:"string"}},keywords:{type:"array",items:{type:"string"}},countries:{type:"array",items:{type:"string"}}}}}}}}}})).themes.map(S=>{const x=s.filter(b=>{var k,M,P;const w=!((k=S.filters.categories)!=null&&k.length)||S.filters.categories.some(C=>b.category===C),L=!((M=S.filters.keywords)!=null&&M.length)||S.filters.keywords.some(C=>b.name.toLowerCase().includes(C.toLowerCase())||b.group.toLowerCase().includes(C.toLowerCase())),I=!((P=S.filters.countries)!=null&&P.length)||S.filters.countries.includes(b.country);return w&&L&&I});return{...S,channels:x.slice(0,12)}}).filter(S=>S.channels.length>=3);o(y)}catch(h){console.error("Failed to generate thematic grids:",h),o([])}finally{u(!1)}}};return l?A.jsx("div",{className:"flex items-center justify-center py-12",children:A.jsxs("div",{className:"text-center",children:[A.jsx(i1,{className:"w-8 h-8 text-cyan-400 animate-spin mx-auto mb-3"}),A.jsx("p",{className:"text-gray-500",children:"Discovering trending content..."})]})}):r.length?A.jsxs("div",{className:"space-y-8 mb-8",children:[A.jsxs("div",{className:"flex items-center gap-3",children:[A.jsx(uk,{className:"w-6 h-6 text-cyan-400"}),A.jsx("h2",{className:"text-2xl font-bold text-white",children:"Trending Now"}),A.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-cyan-500/20 to-purple-500/20 rounded-full text-xs text-cyan-400 border border-cyan-500/30",children:"AI Curated"})]}),A.jsx("div",{className:"space-y-6",children:r.map((h,p)=>A.jsx(Nj,{theme:h,onSelectChannel:e},p))})]}):null}function Nj({theme:s,onSelectChannel:e}){const[t,n]=B.useState(!0);return A.jsxs(Ee.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"rounded-2xl bg-gradient-to-br from-white/5 to-white/[0.02] border border-white/10 overflow-hidden",children:[A.jsx("div",{className:"p-6 bg-gradient-to-r from-cyan-500/10 via-purple-500/10 to-cyan-500/10",children:A.jsxs("div",{className:"flex items-start justify-between",children:[A.jsxs("div",{className:"flex-1",children:[A.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[A.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-cyan-500/20 to-purple-500/20",children:A.jsx(a1,{className:"w-5 h-5 text-cyan-400"})}),A.jsx("h3",{className:"text-xl font-bold text-white",children:s.title}),A.jsxs("span",{className:"px-2 py-0.5 bg-cyan-500/30 text-cyan-300 text-xs rounded-full",children:[s.channels.length," channels"]})]}),A.jsx("p",{className:"text-sm text-gray-400 ml-11",children:s.description})]}),A.jsx("button",{onClick:()=>n(!t),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:A.jsx(Ee.div,{animate:{rotate:t?90:0},transition:{duration:.2},children:A.jsx(Mm,{className:"w-5 h-5 text-gray-400"})})})]})}),A.jsx(tn,{children:t&&A.jsx(Ee.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:"overflow-hidden",children:A.jsx("div",{className:"p-6 pt-4",children:A.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:s.channels.map(i=>A.jsx(Mj,{channel:i,onClick:()=>e(i)},i.id))})})})})]})}function Mj({channel:s,onClick:e}){const[t,n]=B.useState(!1);return A.jsx(Ee.div,{whileHover:{scale:1.05,y:-4},onClick:e,className:"group relative cursor-pointer",children:A.jsxs("div",{className:"relative rounded-xl overflow-hidden ring-1 ring-white/10 hover:ring-cyan-500/50 transition-all bg-gradient-to-br from-[#12121a] to-[#0a0a0f]",children:[A.jsxs("div",{className:"relative aspect-video bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center",children:[s.logo&&!t?A.jsx("img",{src:s.logo,alt:s.name,className:"w-full h-full object-contain p-3",onError:()=>n(!0)}):A.jsx("span",{className:"text-xs text-gray-600 text-center px-2 line-clamp-2",children:s.name}),A.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity"})]}),A.jsx("div",{className:"p-2",children:A.jsx("p",{className:"text-xs font-medium text-white truncate",children:s.name})}),A.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:A.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500/10 to-purple-500/10"})})]})})}const Fj="https://iptv-org.github.io/iptv/index.m3u";function Bj(){const[s,e]=B.useState(!1),[t,n]=B.useState(!0),[i,r]=B.useState(null),[o,l]=B.useState([]),[u,d]=B.useState({}),[h,p]=B.useState({}),[m,v]=B.useState(null),[y,S]=B.useState([]),[x,b]=B.useState([]),[w,L]=B.useState(!1),[I,k]=B.useState(!1),[M,P]=B.useState("all"),[C,U]=B.useState({});B.useEffect(()=>{localStorage.getItem("iptv_verified")==="true"&&e(!0)},[]),B.useEffect(()=>{const se=localStorage.getItem("iptv_favorites"),re=localStorage.getItem("iptv_recent");se&&S(JSON.parse(se)),re&&b(JSON.parse(re))},[]),B.useEffect(()=>{if(!s)return;(async()=>{const re=localStorage.getItem("iptv_country");if(re){r(JSON.parse(re));return}try{const Z=await(await fetch("https://ipapi.co/json/")).json(),F={name:Z.country_name,code:Z.country_code};r(F),localStorage.setItem("iptv_country",JSON.stringify(F))}catch{console.log("Country detection failed, using default"),r({name:"United States",code:"US"})}})()},[s]),B.useEffect(()=>{if(!s||!i)return;(async()=>{n(!0);try{const X=localStorage.getItem("iptv_custom_playlist")||Fj,F=await(await fetch(X)).text(),J=xU(F).sort((ie,ce)=>{var ve,Ie;const de=((ve=ie.country)==null?void 0:ve.toUpperCase())===i.code,fe=((Ie=ce.country)==null?void 0:Ie.toUpperCase())===i.code;return de&&!fe?-1:!de&&fe?1:ie.name.localeCompare(ce.name)}),D={},j={};J.forEach(ie=>{const ce=EU(ie);D[ce]||(D[ce]=[]),D[ce].push(ie);const de=ie.country||"Unknown";j[de]||(j[de]=[]),j[de].push(ie)}),l(J),d(D),p(j),n(!1)}catch(re){console.error("Failed to load playlist:",re),n(!1)}})()},[s,i]);const O=()=>{localStorage.setItem("iptv_verified","true"),e(!0)},W=se=>{v(se);const re=[se,...x.filter(X=>X.url!==se.url)].slice(0,20);b(re),localStorage.setItem("iptv_recent",JSON.stringify(re))},ne=se=>{const re=y.some(Z=>Z.url===se.url);let X;re?X=y.filter(Z=>Z.url!==se.url):X=[...y,se],S(X),localStorage.setItem("iptv_favorites",JSON.stringify(X))},oe=se=>y.some(re=>re.url===se.url);return s?t?A.jsx(Dj,{}):A.jsxs("div",{className:"min-h-screen bg-[#0a0a0f] text-white overflow-hidden",children:[A.jsxs("div",{className:"fixed inset-0 pointer-events-none",children:[A.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-900/20 via-transparent to-cyan-900/20"}),A.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-cyan-500/10 rounded-full blur-3xl animate-pulse"}),A.jsx("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl animate-pulse delay-1000"})]}),A.jsxs("div",{className:"relative z-10 flex",children:[A.jsx(AU,{activeView:M,setActiveView:P,onSearch:()=>L(!0),onSettings:()=>k(!0),userCountry:i}),A.jsx("main",{className:"flex-1 ml-16 lg:ml-20",children:A.jsx(tn,{mode:"wait",children:m?A.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"p-4 lg:p-6",children:[A.jsx(_j,{channel:m,onClose:()=>v(null),onToggleFavorite:()=>ne(m),isFavorite:oe(m)}),A.jsx(kj,{channel:m,epgData:C[m.tvgId]}),A.jsxs("div",{className:"mt-6",children:[A.jsx("h3",{className:"text-lg font-semibold text-cyan-400 mb-4",children:"More Channels"}),A.jsx(SE,{channels:o.filter(se=>se.url!==m.url).slice(0,12),onSelect:W,onToggleFavorite:ne,isFavorite:oe,userCountry:i,compact:!0})]})]},"player"):A.jsxs(Ee.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"p-4 lg:p-6",children:[M==="all"&&A.jsx(Oj,{channels:o,onSelectChannel:W,userCountry:i,favorites:y,recentlyPlayed:x}),A.jsx(SE,{channels:M==="favorites"?y:M==="recent"?x:M==="all"?o:u[M]||h[M]||o,categories:u,countries:h,onSelect:W,onToggleFavorite:ne,isFavorite:oe,userCountry:i,activeView:M,setActiveView:P})]},"grid")})})]}),A.jsxs(tn,{children:[w&&A.jsx(Cj,{channels:o,onSelect:se=>{W(se),L(!1)},onClose:()=>L(!1)}),I&&A.jsx(Pj,{userCountry:i,setUserCountry:se=>{r(se),localStorage.setItem("iptv_country",JSON.stringify(se))},onClose:()=>k(!1)})]})]}):A.jsx(vU,{onVerify:O})}const Uj={Home:Bj},OR={mainPage:"Home",Pages:Uj};function $j(){const s=Km(),{isAuthenticated:e}=Ib(),{Pages:t,mainPage:n}=OR,i=n;return B.useEffect(()=>{const r=s.pathname;let o;if(r==="/"||r==="")o=i;else{const l=r.replace(/^\//,"").split("/")[0];o=Object.keys(t).find(h=>h.toLowerCase()===l.toLowerCase())||null}e&&o&&pr.appLogs.logUserInApp(o).catch(()=>{})},[s,e,t,i]),null}function jj({}){var i;const e=Km().pathname.substring(1),{data:t,isFetched:n}=qC({queryKey:["user"],queryFn:async()=>{try{return{user:await pr.auth.me(),isAuthenticated:!0}}catch{return{user:null,isAuthenticated:!1}}}});return A.jsx("div",{className:"min-h-screen flex items-center justify-center p-6 bg-slate-50",children:A.jsx("div",{className:"max-w-md w-full",children:A.jsxs("div",{className:"text-center space-y-6",children:[A.jsxs("div",{className:"space-y-2",children:[A.jsx("h1",{className:"text-7xl font-light text-slate-300",children:"404"}),A.jsx("div",{className:"h-0.5 w-16 bg-slate-200 mx-auto"})]}),A.jsxs("div",{className:"space-y-3",children:[A.jsx("h2",{className:"text-2xl font-medium text-slate-800",children:"Page Not Found"}),A.jsxs("p",{className:"text-slate-600 leading-relaxed",children:["The page ",A.jsxs("span",{className:"font-medium text-slate-700",children:['"',e,'"']})," could not be found in this application."]})]}),n&&t.isAuthenticated&&((i=t.user)==null?void 0:i.role)==="admin"&&A.jsx("div",{className:"mt-8 p-4 bg-slate-100 rounded-lg border border-slate-200",children:A.jsxs("div",{className:"flex items-start space-x-3",children:[A.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-orange-100 flex items-center justify-center mt-0.5",children:A.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400"})}),A.jsxs("div",{className:"text-left space-y-1",children:[A.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Admin Note"}),A.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:"This could mean that the AI hasn't implemented this page yet. Ask it to implement it in the chat."})]})]})}),A.jsx("div",{className:"pt-6",children:A.jsxs("button",{onClick:()=>window.location.href="/",className:"inline-flex items-center px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 hover:border-slate-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500",children:[A.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Go Home"]})})]})})})}const Vj=()=>A.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-b from-white to-slate-50",children:A.jsx("div",{className:"max-w-md w-full p-8 bg-white rounded-lg shadow-lg border border-slate-100",children:A.jsxs("div",{className:"text-center",children:[A.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 mb-6 rounded-full bg-orange-100",children:A.jsx("svg",{className:"w-8 h-8 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),A.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-4",children:"Access Restricted"}),A.jsx("p",{className:"text-slate-600 mb-8",children:"You are not registered to use this application. Please contact the app administrator to request access."}),A.jsxs("div",{className:"p-4 bg-slate-50 rounded-md text-sm text-slate-600",children:[A.jsx("p",{children:"If you believe this is an error, you can:"}),A.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[A.jsx("li",{children:"Verify you are logged in with the correct account"}),A.jsx("li",{children:"Contact the app administrator for access"}),A.jsx("li",{children:"Try logging out and back in again"})]})]})]})})}),{Pages:NR,Layout:UT,mainPage:Gj}=OR,MR=Gj,Kj=NR[MR],$T=({children:s,currentPageName:e})=>UT?A.jsx(UT,{currentPageName:e,children:s}):A.jsx(A.Fragment,{children:s}),Hj=()=>{const{isLoadingAuth:s,isLoadingPublicSettings:e,authError:t,navigateToLogin:n}=Ib();if(e||s)return A.jsx("div",{className:"fixed inset-0 flex items-center justify-center",children:A.jsx("div",{className:"w-8 h-8 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin"})});if(t){if(t.type==="user_not_registered")return A.jsx(Vj,{});if(t.type==="auth_required")return n(),null}return A.jsxs(DP,{children:[A.jsx(xu,{path:"/",element:A.jsx($T,{currentPageName:MR,children:A.jsx(Kj,{})})}),Object.entries(NR).map(([i,r])=>A.jsx(xu,{path:`/${i}`,element:A.jsx($T,{currentPageName:i,children:A.jsx(r,{})})},i)),A.jsx(xu,{path:"*",element:A.jsx(jj,{})})]})};function zj(){return A.jsx(KN,{children:A.jsxs(MC,{client:YC,children:[A.jsxs(MP,{children:[A.jsx($j,{}),A.jsx(Hj,{})]}),A.jsx(uC,{})]})})}KI.createRoot(document.getElementById("root")).render(A.jsx(zj,{}));
